query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1906796.02..1906796.70 rows=1 width=236) (actual time=21246.945..21247.016 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1906796.02..1906800.08 rows=6 width=236) (actual time=21246.944..21247.014 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1906796.02..1906798.89 rows=24 width=236) (actual time=21246.921..21246.993 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1905795.96..1905795.98 rows=6 width=236) (actual time=21238.236..21238.237 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1905795.72..1905795.89 rows=6 width=236) (actual time=21238.210..21238.218 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312611.40 rows=14829608 width=25) (actual time=0.319..5538.354 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 22.645 ms
 Execution Time: 21248.008 ms
(20 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1906796.02..1906796.70 rows=1 width=236) (actual time=18653.662..18653.746 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1906796.02..1906800.08 rows=6 width=236) (actual time=18653.661..18653.744 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1906796.02..1906798.89 rows=24 width=236) (actual time=18653.614..18653.702 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1905795.96..1905795.98 rows=6 width=236) (actual time=18649.603..18649.606 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1905795.72..1905795.89 rows=6 width=236) (actual time=18649.579..18649.588 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312611.40 rows=14829608 width=25) (actual time=1.295..2747.547 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.915 ms
 Execution Time: 18653.829 ms
(20 rows)

query 2 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=404125.88..404125.89 rows=1 width=193) (actual time=1694.990..1695.104 rows=100 loops=1)
   ->  Sort  (cost=404125.88..404125.89 rows=1 width=193) (actual time=1694.989..1695.096 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 69kB
         ->  Nested Loop  (cost=1049.89..404125.87 rows=1 width=193) (actual time=6.697..1692.900 rows=4737 loops=1)
               Join Filter: (nation.n_nationkey = supplier.s_nationkey)
               Rows Removed by Join Filter: 18948
               ->  Nested Loop  (cost=0.00..2.62 rows=5 width=30) (actual time=0.587..0.593 rows=5 loops=1)
                     Join Filter: (nation.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 20
                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.239..0.240 rows=1 loops=1)
                           Filter: (r_name = 'AMERICA'::bpchar)
                           Rows Removed by Filter: 4
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.341..0.344 rows=25 loops=1)
               ->  Materialize  (cost=1049.89..404123.18 rows=1 width=171) (actual time=0.692..337.846 rows=4737 loops=5)
                     ->  Nested Loop  (cost=1049.89..404123.17 rows=1 width=171) (actual time=3.455..1684.640 rows=4737 loops=1)
                           ->  Nested Loop  (cost=1049.59..404119.16 rows=1 width=34) (actual time=2.861..1368.055 rows=4737 loops=1)
                                 ->  Gather  (cost=1000.00..50165.62 rows=6850 width=30) (actual time=0.727..5.400 rows=8046 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.62 rows=1712 width=30) (actual time=0.206..183.428 rows=1609 loops=5)
                                             Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                                             Rows Removed by Filter: 398391
                                 ->  Index Only Scan using q2_idx_2 on partsupp  (cost=49.59..51.66 rows=1 width=14) (actual time=0.002..0.002 rows=1 loops=8046)
                                       Index Cond: ((ps_partkey = part.p_partkey) AND (ps_supplycost = (SubPlan 1)))
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Aggregate  (cost=49.15..49.16 rows=1 width=32) (actual time=0.166..0.166 rows=1 loops=8046)
                                               ->  Nested Loop  (cost=2.54..49.14 rows=3 width=6) (actual time=0.148..0.163 rows=1 loops=8046)
                                                     Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                                                     Rows Removed by Join Filter: 3
                                                     ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=8046)
                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                           Rows Removed by Filter: 4
                                                     ->  Hash Join  (cost=2.54..47.87 rows=17 width=10) (actual time=0.125..0.161 rows=4 loops=8046)
                                                           Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                           ->  Nested Loop  (cost=0.97..46.25 rows=17 width=10) (actual time=0.124..0.158 rows=4 loops=8046)
                                                                 ->  Index Only Scan using q2_idx_2 on partsupp partsupp_1  (cost=0.43..2.73 rows=17 width=10) (actual time=0.113..0.116 rows=4 loops=8046)
                                                                       Index Cond: (ps_partkey = part.p_partkey)
                                                                       Heap Fetches: 0
                                                                 ->  Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.54..2.56 rows=1 width=8) (actual time=0.010..0.010 rows=1 loops=32184)
                                                                       Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                                                       Heap Fetches: 0
                                                           ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.015..0.015 rows=25 loops=1)
                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                 ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.006..0.009 rows=25 loops=1)
                           ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4.01 rows=1 width=145) (actual time=0.066..0.066 rows=1 loops=4737)
                                 Index Cond: (s_suppkey = partsupp.ps_suppkey)
 Planning Time: 27.925 ms
 Execution Time: 1695.886 ms
(50 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=404125.88..404125.89 rows=1 width=193) (actual time=187.756..187.863 rows=100 loops=1)
   ->  Sort  (cost=404125.88..404125.89 rows=1 width=193) (actual time=187.755..187.856 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 68kB
         ->  Nested Loop  (cost=1049.89..404125.87 rows=1 width=193) (actual time=0.508..186.142 rows=4737 loops=1)
               Join Filter: (nation.n_nationkey = supplier.s_nationkey)
               Rows Removed by Join Filter: 18948
               ->  Nested Loop  (cost=0.00..2.62 rows=5 width=30) (actual time=0.009..0.015 rows=5 loops=1)
                     Join Filter: (nation.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 20
                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.005..0.007 rows=1 loops=1)
                           Filter: (r_name = 'AMERICA'::bpchar)
                           Rows Removed by Filter: 4
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.003 rows=25 loops=1)
               ->  Materialize  (cost=1049.89..404123.18 rows=1 width=171) (actual time=0.076..36.704 rows=4737 loops=5)
                     ->  Nested Loop  (cost=1049.89..404123.17 rows=1 width=171) (actual time=0.375..180.584 rows=4737 loops=1)
                           ->  Nested Loop  (cost=1049.59..404119.16 rows=1 width=34) (actual time=0.370..164.173 rows=4737 loops=1)
                                 ->  Gather  (cost=1000.00..50165.62 rows=6850 width=30) (actual time=0.319..3.785 rows=8046 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.62 rows=1712 width=30) (actual time=0.104..109.312 rows=1609 loops=5)
                                             Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                                             Rows Removed by Filter: 398391
                                 ->  Index Only Scan using q2_idx_2 on partsupp  (cost=49.59..51.66 rows=1 width=14) (actual time=0.001..0.001 rows=1 loops=8046)
                                       Index Cond: ((ps_partkey = part.p_partkey) AND (ps_supplycost = (SubPlan 1)))
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Aggregate  (cost=49.15..49.16 rows=1 width=32) (actual time=0.018..0.018 rows=1 loops=8046)
                                               ->  Nested Loop  (cost=2.54..49.14 rows=3 width=6) (actual time=0.013..0.017 rows=1 loops=8046)
                                                     Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                                                     Rows Removed by Join Filter: 3
                                                     ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=8046)
                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                           Rows Removed by Filter: 4
                                                     ->  Hash Join  (cost=2.54..47.87 rows=17 width=10) (actual time=0.006..0.015 rows=4 loops=8046)
                                                           Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                           ->  Nested Loop  (cost=0.97..46.25 rows=17 width=10) (actual time=0.006..0.014 rows=4 loops=8046)
                                                                 ->  Index Only Scan using q2_idx_2 on partsupp partsupp_1  (cost=0.43..2.73 rows=17 width=10) (actual time=0.003..0.003 rows=4 loops=8046)
                                                                       Index Cond: (ps_partkey = part.p_partkey)
                                                                       Heap Fetches: 0
                                                                 ->  Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.54..2.56 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=32184)
                                                                       Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                                                       Heap Fetches: 0
                                                           ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.009..0.009 rows=25 loops=1)
                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                 ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.002..0.005 rows=25 loops=1)
                           ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4.01 rows=1 width=145) (actual time=0.003..0.003 rows=1 loops=4737)
                                 Index Cond: (s_suppkey = partsupp.ps_suppkey)
 Planning Time: 2.173 ms
 Execution Time: 187.945 ms
(50 rows)

query 3 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2329315.50..2329315.53 rows=10 width=44) (actual time=11015.954..11026.892 rows=10 loops=1)
   ->  Sort  (cost=2329315.50..2337069.78 rows=3101712 width=44) (actual time=11015.952..11026.890 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Finalize GroupAggregate  (cost=1792039.18..2262288.62 rows=3101712 width=44) (actual time=10851.818..11003.733 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1792039.18..2184745.82 rows=3101712 width=44) (actual time=10851.810..10923.568 rows=118451 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1791039.12..1814301.96 rows=775428 width=44) (actual time=10841.439..10879.027 rows=23690 loops=5)
                           Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           ->  Sort  (cost=1791039.12..1792977.69 rows=775428 width=24) (actual time=10841.424..10844.474 rows=60306 loops=5)
                                 Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                                 Sort Method: quicksort  Memory: 6225kB
                                 Worker 0:  Sort Method: quicksort  Memory: 6261kB
                                 Worker 1:  Sort Method: quicksort  Memory: 6433kB
                                 Worker 2:  Sort Method: quicksort  Memory: 6107kB
                                 Worker 3:  Sort Method: quicksort  Memory: 6213kB
                                 ->  Parallel Hash Join  (cost=358926.21..1703824.30 rows=775428 width=24) (actual time=2340.255..10822.685 rows=60306 loops=5)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1312611.40 rows=8092833 width=16) (actual time=0.733..7650.246 rows=6506846 loops=5)
                                             Filter: (l_shipdate > '1995-03-07'::date)
                                             Rows Removed by Filter: 5490365
                                       ->  Parallel Hash  (cost=354434.16..354434.16 rows=359364 width=12) (actual time=2336.181..2336.354 rows=290361 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 84576kB
                                             ->  Parallel Hash Join  (cost=41573.21..354434.16 rows=359364 width=12) (actual time=281.334..2227.047 rows=290361 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..308149.77 rows=1794730 width=16) (actual time=0.666..1584.237 rows=1447887 loops=5)
                                                         Filter: (o_orderdate < '1995-03-07'::date)
                                                         Rows Removed by Filter: 1552113
                                                   ->  Parallel Hash  (cost=40634.60..40634.60 rows=75089 width=4) (actual time=280.155..280.156 rows=60055 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..40634.60 rows=75089 width=4) (actual time=1.115..260.381 rows=60055 loops=5)
                                                               Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                               Rows Removed by Filter: 239945
 Planning Time: 31.772 ms
 Execution Time: 11027.796 ms
(37 rows)

SET
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2329315.50..2329315.53 rows=10 width=44) (actual time=4831.963..4843.400 rows=10 loops=1)
   ->  Sort  (cost=2329315.50..2337069.78 rows=3101712 width=44) (actual time=4831.961..4843.397 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Finalize GroupAggregate  (cost=1792039.18..2262288.62 rows=3101712 width=44) (actual time=4666.207..4819.994 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1792039.18..2184745.82 rows=3101712 width=44) (actual time=4666.194..4739.781 rows=118468 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1791039.12..1814301.96 rows=775428 width=44) (actual time=4660.570..4697.842 rows=23694 loops=5)
                           Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           ->  Sort  (cost=1791039.12..1792977.69 rows=775428 width=24) (actual time=4660.559..4663.369 rows=60306 loops=5)
                                 Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                                 Sort Method: quicksort  Memory: 6135kB
                                 Worker 0:  Sort Method: quicksort  Memory: 6161kB
                                 Worker 1:  Sort Method: quicksort  Memory: 6260kB
                                 Worker 2:  Sort Method: quicksort  Memory: 6229kB
                                 Worker 3:  Sort Method: quicksort  Memory: 6454kB
                                 ->  Parallel Hash Join  (cost=358926.21..1703824.30 rows=775428 width=24) (actual time=1138.612..4638.680 rows=60306 loops=5)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1312611.40 rows=8092833 width=16) (actual time=0.038..2554.550 rows=6506846 loops=5)
                                             Filter: (l_shipdate > '1995-03-07'::date)
                                             Rows Removed by Filter: 5490365
                                       ->  Parallel Hash  (cost=354434.16..354434.16 rows=359364 width=12) (actual time=1135.081..1135.117 rows=290361 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 84576kB
                                             ->  Parallel Hash Join  (cost=41573.21..354434.16 rows=359364 width=12) (actual time=91.619..1019.224 rows=290361 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..308149.77 rows=1794730 width=16) (actual time=0.051..527.947 rows=1447887 loops=5)
                                                         Filter: (o_orderdate < '1995-03-07'::date)
                                                         Rows Removed by Filter: 1552113
                                                   ->  Parallel Hash  (cost=40634.60..40634.60 rows=75089 width=4) (actual time=90.952..90.952 rows=60055 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..40634.60 rows=75089 width=4) (actual time=0.020..67.074 rows=60055 loops=5)
                                                               Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                               Rows Removed by Filter: 239945
 Planning Time: 1.425 ms
 Execution Time: 4843.519 ms
(37 rows)

query 4 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=596959.37..596959.88 rows=1 width=24) (actual time=5168.114..5212.376 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=596959.37..596961.91 rows=5 width=24) (actual time=5168.113..5212.374 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Gather Merge  (cost=596959.37..596961.76 rows=20 width=24) (actual time=5168.085..5212.368 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=595959.31..595959.32 rows=5 width=24) (actual time=5160.714..5160.715 rows=4 loops=5)
                     Sort Key: orders.o_orderpriority
                     Sort Method: quicksort  Memory: 25kB
                     Worker 0:  Sort Method: quicksort  Memory: 25kB
                     Worker 1:  Sort Method: quicksort  Memory: 25kB
                     Worker 2:  Sort Method: quicksort  Memory: 25kB
                     Worker 3:  Sort Method: quicksort  Memory: 25kB
                     ->  Partial HashAggregate  (cost=595959.20..595959.25 rows=5 width=24) (actual time=5160.692..5160.694 rows=5 loops=5)
                           Group Key: orders.o_orderpriority
                           ->  Nested Loop Semi Join  (cost=8900.25..595252.44 rows=141352 width=16) (actual time=155.021..5104.621 rows=102764 loops=5)
                                 ->  Parallel Bitmap Heap Scan on orders  (cost=8899.68..272288.62 rows=141396 width=20) (actual time=153.807..3957.253 rows=112085 loops=5)
                                       Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                       Heap Blocks: exact=46504
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8758.28 rows=565585 width=0) (actual time=107.208..107.208 rows=560424 loops=1)
                                             Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 ->  Index Only Scan using q21_idx_2 on lineitem  (cost=0.56..2.56 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=560424)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Heap Fetches: 0
 Planning Time: 27.604 ms
 Execution Time: 5214.117 ms
(26 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=596959.37..596959.88 rows=1 width=24) (actual time=1155.141..1193.136 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=596959.37..596961.91 rows=5 width=24) (actual time=1155.140..1193.134 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Gather Merge  (cost=596959.37..596961.76 rows=20 width=24) (actual time=1155.126..1193.125 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=595959.31..595959.32 rows=5 width=24) (actual time=1144.685..1144.687 rows=4 loops=5)
                     Sort Key: orders.o_orderpriority
                     Sort Method: quicksort  Memory: 25kB
                     Worker 0:  Sort Method: quicksort  Memory: 25kB
                     Worker 1:  Sort Method: quicksort  Memory: 25kB
                     Worker 2:  Sort Method: quicksort  Memory: 25kB
                     Worker 3:  Sort Method: quicksort  Memory: 25kB
                     ->  Partial HashAggregate  (cost=595959.20..595959.25 rows=5 width=24) (actual time=1144.663..1144.665 rows=5 loops=5)
                           Group Key: orders.o_orderpriority
                           ->  Nested Loop Semi Join  (cost=8900.25..595252.44 rows=141352 width=16) (actual time=146.814..1107.543 rows=102764 loops=5)
                                 ->  Parallel Bitmap Heap Scan on orders  (cost=8899.68..272288.62 rows=141396 width=20) (actual time=146.773..650.229 rows=112085 loops=5)
                                       Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                       Heap Blocks: exact=49160
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8758.28 rows=565585 width=0) (actual time=98.679..98.680 rows=560424 loops=1)
                                             Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 ->  Index Only Scan using q21_idx_2 on lineitem  (cost=0.56..2.56 rows=1 width=4) (actual time=0.004..0.004 rows=1 loops=560424)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Heap Fetches: 0
 Planning Time: 1.744 ms
 Execution Time: 1193.220 ms
(26 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=660383.35..660383.36 rows=1 width=58) (actual time=7693.307..7740.623 rows=1 loops=1)
   ->  Sort  (cost=660383.35..660383.42 rows=25 width=58) (actual time=7693.306..7740.621 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=660143.24..660383.23 rows=25 width=58) (actual time=7684.221..7740.604 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=660143.24..660382.17 rows=100 width=58) (actual time=7682.790..7740.567 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=659143.18..659370.20 rows=25 width=58) (actual time=7669.626..7677.174 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=659143.18..659188.52 rows=18136 width=38) (actual time=7668.388..7669.076 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1519kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1503kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1522kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1497kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1510kB
                                 ->  Parallel Hash Join  (cost=82164.89..657860.37 rows=18136 width=38) (actual time=631.918..7658.189 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=78473.29..651788.54 rows=453378 width=50) (actual time=612.372..7512.818 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=78472.73..350653.55 rows=113380 width=38) (actual time=611.968..5349.955 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=35679.31..305450.81 rows=566900 width=8) (actual time=339.312..4868.992 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52667
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..35112.41 rows=2267598 width=0) (actual time=279.077..279.077 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.89..41855.89 rows=75002 width=38) (actual time=271.934..271.937 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.89 rows=75002 width=38) (actual time=1.658..244.536 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=8) (actual time=1.094..205.795 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.552..0.554 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.546..0.552 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.374..0.376 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.165..0.166 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.162..0.163 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Only Scan using q5_idx_1 on lineitem  (cost=0.56..2.62 rows=4 width=20) (actual time=0.022..0.023 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=16.852..16.853 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.094..11.000 rows=20000 loops=5)
 Planning Time: 38.432 ms
 Execution Time: 7741.449 ms
(51 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=660383.35..660383.36 rows=1 width=58) (actual time=2206.478..2253.734 rows=1 loops=1)
   ->  Sort  (cost=660383.35..660383.42 rows=25 width=58) (actual time=2206.477..2253.732 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=660143.24..660383.23 rows=25 width=58) (actual time=2197.052..2253.714 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=660143.24..660382.17 rows=100 width=58) (actual time=2195.139..2253.677 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=659143.18..659370.20 rows=25 width=58) (actual time=2183.786..2189.298 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=659143.18..659188.52 rows=18136 width=38) (actual time=2182.545..2183.272 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1560kB
                                 Worker 0:  Sort Method: quicksort  Memory: 2090kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1505kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1448kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1332kB
                                 ->  Parallel Hash Join  (cost=82164.89..657860.37 rows=18136 width=38) (actual time=488.755..2174.403 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=78473.29..651788.54 rows=453378 width=50) (actual time=472.261..2031.032 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=78472.73..350653.55 rows=113380 width=38) (actual time=472.201..1097.579 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=35679.31..305450.81 rows=566900 width=8) (actual time=313.633..769.924 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=54533
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..35112.41 rows=2267598 width=0) (actual time=253.663..253.663 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.89..41855.89 rows=75002 width=38) (actual time=158.016..158.019 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25248kB
                                                         ->  Hash Join  (cost=2.51..41855.89 rows=75002 width=38) (actual time=0.079..127.254 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=8) (actual time=0.032..88.348 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.037..0.040 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.031..0.038 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.015..0.016 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Only Scan using q5_idx_1 on lineitem  (cost=0.56..2.62 rows=4 width=20) (actual time=0.008..0.009 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.907..15.908 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5056kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.033..9.258 rows=20000 loops=5)
 Planning Time: 4.681 ms
 Execution Time: 2253.824 ms
(51 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1368614.48..1368614.49 rows=1 width=32) (actual time=11063.245..11106.631 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1368614.48..1368614.49 rows=1 width=32) (actual time=11063.243..11106.628 rows=1 loops=1)
         ->  Gather  (cost=1368614.04..1368614.45 rows=4 width=32) (actual time=11056.515..11106.612 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1367614.04..1367614.05 rows=1 width=32) (actual time=11048.544..11048.545 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=233374.93..1366135.06 rows=295796 width=12) (actual time=1319.744..10903.061 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=80040 lossy=53962
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..233079.14 rows=1183185 width=0) (actual time=1228.798..1228.799 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 22.209 ms
 Execution Time: 11107.568 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1368614.48..1368614.49 rows=1 width=32) (actual time=3185.185..3228.206 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1368614.48..1368614.49 rows=1 width=32) (actual time=3185.184..3228.204 rows=1 loops=1)
         ->  Gather  (cost=1368614.04..1368614.45 rows=4 width=32) (actual time=3181.025..3228.188 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1367614.04..1367614.05 rows=1 width=32) (actual time=3176.846..3176.847 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=233374.93..1366135.06 rows=295796 width=12) (actual time=1183.709..3075.612 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=85486 lossy=57870
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..233079.14 rows=1183185 width=0) (actual time=1089.252..1089.252 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 1.124 ms
 Execution Time: 3228.256 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1733332.38..1733332.97 rows=1 width=92) (actual time=11144.691..11156.892 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1733332.38..1739236.35 rows=10048 width=92) (actual time=11144.690..11156.890 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Gather Merge  (cost=1733332.38..1738558.11 rows=40192 width=92) (actual time=11137.688..11156.870 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=1732332.32..1732770.80 rows=10048 width=92) (actual time=11127.049..11131.141 rows=4 loops=5)
                     Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                     ->  Sort  (cost=1732332.32..1732369.84 rows=15008 width=72) (actual time=11125.515..11126.174 rows=10409 loops=5)
                           Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 1988kB
                           Worker 0:  Sort Method: quicksort  Memory: 1938kB
                           Worker 1:  Sort Method: quicksort  Memory: 2024kB
                           Worker 2:  Sort Method: quicksort  Memory: 2072kB
                           Worker 3:  Sort Method: quicksort  Memory: 2028kB
                           ->  Parallel Hash Join  (cost=361613.41..1731291.26 rows=15008 width=72) (actual time=2484.805..11114.683 rows=11559 loops=5)
                                 Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                 Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                 Rows Removed by Join Filter: 11632
                                 ->  Parallel Hash Join  (cost=358563.36..1726474.40 rows=360627 width=46) (actual time=2461.804..11016.657 rows=289625 loops=5)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350105.08 rows=4507836 width=24) (actual time=0.763..8027.994 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=354812.82..354812.82 rows=300043 width=30) (actual time=2458.852..2458.901 rows=238235 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 91072kB
                                             ->  Parallel Hash Join  (cost=41224.76..354812.82 rows=300043 width=30) (actual time=270.343..2350.318 rows=238235 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=8) (actual time=0.655..1387.793 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=40849.75..40849.75 rows=30001 width=30) (actual time=269.407..269.409 rows=23924 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 8576kB
                                                         ->  Hash Join  (cost=1.40..40849.75 rows=30001 width=30) (actual time=0.734..260.103 rows=23924 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=8) (actual time=0.707..227.043 rows=300000 loops=5)
                                                               ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.016..0.017 rows=2 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.013 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                                 ->  Parallel Hash  (cost=2991.23..2991.23 rows=4706 width=30) (actual time=14.445..14.446 rows=1596 loops=5)
                                       Buckets: 8192  Batches: 1  Memory Usage: 640kB
                                       ->  Hash Join  (cost=1.40..2991.23 rows=4706 width=30) (actual time=0.312..13.925 rows=1596 loops=5)
                                             Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.240..11.801 rows=20000 loops=5)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.065..0.066 rows=2 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.061..0.063 rows=2 loops=5)
                                                         Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning Time: 41.456 ms
 Execution Time: 11157.709 ms
(51 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1733332.38..1733332.97 rows=1 width=92) (actual time=4622.348..4636.483 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1733332.38..1739236.35 rows=10048 width=92) (actual time=4622.346..4636.481 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Gather Merge  (cost=1733332.38..1738558.11 rows=40192 width=92) (actual time=4620.178..4636.469 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=1732332.32..1732770.80 rows=10048 width=92) (actual time=4612.293..4616.376 rows=3 loops=5)
                     Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                     ->  Sort  (cost=1732332.32..1732369.84 rows=15008 width=72) (actual time=4610.780..4611.670 rows=9890 loops=5)
                           Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 1953kB
                           Worker 0:  Sort Method: quicksort  Memory: 2092kB
                           Worker 1:  Sort Method: quicksort  Memory: 2079kB
                           Worker 2:  Sort Method: quicksort  Memory: 1955kB
                           Worker 3:  Sort Method: quicksort  Memory: 1971kB
                           ->  Parallel Hash Join  (cost=361613.41..1731291.26 rows=15008 width=72) (actual time=1333.979..4602.503 rows=11559 loops=5)
                                 Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                 Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                 Rows Removed by Join Filter: 11632
                                 ->  Parallel Hash Join  (cost=358563.36..1726474.40 rows=360627 width=46) (actual time=1327.975..4512.384 rows=289625 loops=5)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350105.08 rows=4507836 width=24) (actual time=0.043..2553.406 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=354812.82..354812.82 rows=300043 width=30) (actual time=1325.971..1325.998 rows=238235 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 91040kB
                                             ->  Parallel Hash Join  (cost=41224.76..354812.82 rows=300043 width=30) (actual time=96.204..1210.471 rows=238235 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=8) (actual time=0.045..392.645 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=40849.75..40849.75 rows=30001 width=30) (actual time=95.762..95.764 rows=23924 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 8576kB
                                                         ->  Hash Join  (cost=1.40..40849.75 rows=30001 width=30) (actual time=0.033..84.083 rows=23924 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=8) (actual time=0.011..33.751 rows=300000 loops=5)
                                                               ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.014..0.015 rows=2 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.010..0.012 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                                 ->  Parallel Hash  (cost=2991.23..2991.23 rows=4706 width=30) (actual time=5.228..5.229 rows=1596 loops=5)
                                       Buckets: 8192  Batches: 1  Memory Usage: 608kB
                                       ->  Hash Join  (cost=1.40..2991.23 rows=4706 width=30) (actual time=0.034..4.777 rows=1596 loops=5)
                                             Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.009..1.660 rows=20000 loops=5)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.020..0.020 rows=2 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.014..0.016 rows=2 loops=5)
                                                         Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning Time: 3.315 ms
 Execution Time: 4636.566 ms
(51 rows)

query 8 run 1
SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=428950.50..428950.80 rows=1 width=40) (actual time=5643.380..5658.036 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=428950.50..429676.11 rows=2406 width=40) (actual time=5643.379..5658.035 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=428950.50..429591.90 rows=2406 width=72) (actual time=5640.758..5658.026 rows=3 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Partial GroupAggregate  (cost=427950.49..428321.21 rows=2406 width=72) (actual time=5635.606..5638.150 rows=2 loops=2)
                     Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                     ->  Sort  (cost=427950.49..427986.33 rows=14338 width=46) (actual time=5633.030..5633.498 rows=11921 loops=2)
                           Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 1340kB
                           Worker 0:  Sort Method: quicksort  Memory: 1292kB
                           ->  Hash Join  (cost=423779.24..426960.63 rows=14338 width=46) (actual time=5592.443..5630.684 rows=11921 loops=2)
                                 Hash Cond: (supplier.s_nationkey = n2.n_nationkey)
                                 ->  Parallel Hash Join  (cost=423777.68..426843.35 rows=14338 width=20) (actual time=5592.290..5627.221 rows=11921 loops=2)
                                       Hash Cond: (supplier.s_suppkey = lineitem.l_suppkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.190..25.181 rows=50000 loops=2)
                                       ->  Parallel Hash  (cost=423701.50..423701.50 rows=6094 width=20) (actual time=5591.711..5591.717 rows=11921 loops=2)
                                             Buckets: 32768  Batches: 1  Memory Usage: 1600kB
                                             ->  Hash Join  (cost=382346.78..423701.50 rows=6094 width=20) (actual time=5147.963..5587.370 rows=11921 loops=2)
                                                   Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                   ->  Parallel Hash Join  (cost=382344.27..423523.80 rows=30468 width=24) (actual time=5147.848..5580.806 rows=59296 loops=2)
                                                         Hash Cond: (customer.c_custkey = orders.o_custkey)
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=8) (actual time=0.672..270.717 rows=750000 loops=2)
                                                         ->  Parallel Hash  (cost=381963.42..381963.42 rows=30468 width=24) (actual time=5146.736..5146.739 rows=59296 loops=2)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 8224kB
                                                               ->  Parallel Hash Join  (cost=60066.39..381963.42 rows=30468 width=24) (actual time=2788.817..5119.710 rows=59296 loops=2)
                                                                     Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                                                     ->  Parallel Seq Scan on orders  (cost=0.00..317526.12 rows=1145263 width=12) (actual time=0.364..1849.218 rows=2278756 loops=2)
                                                                           Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                                           Rows Removed by Filter: 5221244
                                                                     ->  Parallel Hash  (cost=58819.19..58819.19 rows=99776 width=20) (actual time=2787.039..2787.040 rows=194760 loops=2)
                                                                           Buckets: 524288  Batches: 1  Memory Usage: 25472kB
                                                                           ->  Nested Loop  (cost=0.56..58819.19 rows=99776 width=20) (actual time=1.450..2698.068 rows=194760 loops=2)
                                                                                 ->  Parallel Seq Scan on part  (cost=0.00..47230.69 rows=3326 width=4) (actual time=0.491..352.337 rows=6506 loops=2)
                                                                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                                       Rows Removed by Filter: 993494
                                                                                 ->  Index Only Scan using q8_idx_1 on lineitem  (cost=0.56..3.14 rows=34 width=24) (actual time=0.289..0.355 rows=30 loops=13011)
                                                                                       Index Cond: (l_partkey = part.p_partkey)
                                                                                       Heap Fetches: 0
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.090..0.092 rows=5 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.086..0.090 rows=5 loops=2)
                                                               Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.002..0.004 rows=25 loops=2)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.080..0.081 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.078..0.079 rows=1 loops=2)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.130..0.131 rows=25 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.122..0.125 rows=25 loops=2)
 Planning Time: 47.353 ms
 Execution Time: 5658.885 ms
(55 rows)

SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=428950.50..428950.80 rows=1 width=40) (actual time=1947.183..1962.954 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=428950.50..429676.11 rows=2406 width=40) (actual time=1947.182..1962.952 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=428950.50..429591.90 rows=2406 width=72) (actual time=1944.513..1962.941 rows=3 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Partial GroupAggregate  (cost=427950.49..428321.21 rows=2406 width=72) (actual time=1941.713..1944.737 rows=2 loops=2)
                     Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                     ->  Sort  (cost=427950.49..427986.33 rows=14338 width=46) (actual time=1939.121..1939.987 rows=11921 loops=2)
                           Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 1321kB
                           Worker 0:  Sort Method: quicksort  Memory: 1311kB
                           ->  Hash Join  (cost=423779.24..426960.63 rows=14338 width=46) (actual time=1920.613..1937.337 rows=11921 loops=2)
                                 Hash Cond: (supplier.s_nationkey = n2.n_nationkey)
                                 ->  Parallel Hash Join  (cost=423777.68..426843.35 rows=14338 width=20) (actual time=1920.560..1934.209 rows=11921 loops=2)
                                       Hash Cond: (supplier.s_suppkey = lineitem.l_suppkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.007..3.448 rows=50000 loops=2)
                                       ->  Parallel Hash  (cost=423701.50..423701.50 rows=6094 width=20) (actual time=1920.117..1920.502 rows=11921 loops=2)
                                             Buckets: 32768  Batches: 1  Memory Usage: 1600kB
                                             ->  Hash Join  (cost=382346.78..423701.50 rows=6094 width=20) (actual time=1702.934..1917.420 rows=11921 loops=2)
                                                   Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                   ->  Parallel Hash Join  (cost=382344.27..423523.80 rows=30468 width=24) (actual time=1702.891..1912.422 rows=59296 loops=2)
                                                         Hash Cond: (customer.c_custkey = orders.o_custkey)
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=8) (actual time=0.010..50.411 rows=750000 loops=2)
                                                         ->  Parallel Hash  (cost=381963.42..381963.42 rows=30468 width=24) (actual time=1702.429..1702.811 rows=59296 loops=2)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 8256kB
                                                               ->  Parallel Hash Join  (cost=60066.39..381963.42 rows=30468 width=24) (actual time=278.425..1679.579 rows=59296 loops=2)
                                                                     Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                                                     ->  Parallel Seq Scan on orders  (cost=0.00..317526.12 rows=1145263 width=12) (actual time=0.044..958.601 rows=2278756 loops=2)
                                                                           Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                                           Rows Removed by Filter: 5221244
                                                                     ->  Parallel Hash  (cost=58819.19..58819.19 rows=99776 width=20) (actual time=277.094..277.095 rows=194760 loops=2)
                                                                           Buckets: 524288  Batches: 1  Memory Usage: 25472kB
                                                                           ->  Nested Loop  (cost=0.56..58819.19 rows=99776 width=20) (actual time=0.084..219.679 rows=194760 loops=2)
                                                                                 ->  Parallel Seq Scan on part  (cost=0.00..47230.69 rows=3326 width=4) (actual time=0.063..122.756 rows=6506 loops=2)
                                                                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                                       Rows Removed by Filter: 993494
                                                                                 ->  Index Only Scan using q8_idx_1 on lineitem  (cost=0.56..3.14 rows=34 width=24) (actual time=0.004..0.011 rows=30 loops=13011)
                                                                                       Index Cond: (l_partkey = part.p_partkey)
                                                                                       Heap Fetches: 0
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.020..0.021 rows=5 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.015..0.020 rows=5 loops=2)
                                                               Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.002..0.004 rows=25 loops=2)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.010..0.010 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=2)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.025..0.026 rows=25 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.017..0.020 rows=25 loops=2)
 Planning Time: 4.439 ms
 Execution Time: 1963.052 ms
(55 rows)

query 9 run 1
SET
SET
SET
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=770336.39..770336.93 rows=1 width=66) (actual time=10875.522..11075.708 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=770336.39..802603.17 rows=60150 width=66) (actual time=10875.520..11075.706 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=770336.39..799144.54 rows=240600 width=66) (actual time=10875.508..11075.694 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=769336.33..769486.71 rows=60150 width=66) (actual time=10864.313..10864.328 rows=140 loops=5)
                     Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
                     Sort Method: quicksort  Memory: 49kB
                     Worker 0:  Sort Method: quicksort  Memory: 49kB
                     Worker 1:  Sort Method: quicksort  Memory: 49kB
                     Worker 2:  Sort Method: quicksort  Memory: 49kB
                     Worker 3:  Sort Method: quicksort  Memory: 49kB
                     ->  Partial HashAggregate  (cost=763508.92..764561.54 rows=60150 width=66) (actual time=10863.577..10864.130 rows=175 loops=5)
                           Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
                           ->  Hash Join  (cost=384352.79..744951.44 rows=1060427 width=57) (actual time=9066.139..10181.310 rows=649638 loops=5)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=384351.22..736392.24 rows=1060427 width=31) (actual time=9066.027..9964.293 rows=649638 loops=5)
                                       Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=8) (actual time=0.764..1698.396 rows=3000000 loops=5)
                                       ->  Parallel Hash  (cost=363845.89..363845.89 rows=1060427 width=31) (actual time=6890.972..6890.977 rows=649638 loops=5)
                                             Buckets: 524288  Batches: 16  Memory Usage: 18464kB
                                             ->  Parallel Hash Join  (cost=196618.11..363845.89 rows=1060427 width=31) (actual time=5993.753..6704.395 rows=649638 loops=5)
                                                   Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Hash Join  (cost=193073.57..357517.61 rows=1060427 width=35) (actual time=5970.906..6502.289 rows=649638 loops=5)
                                                         Hash Cond: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))
                                                         ->  Parallel Index Only Scan using q2_idx_2 on partsupp  (cost=0.43..121620.77 rows=2000344 width=14) (actual time=0.695..461.899 rows=1600000 loops=5)
                                                               Heap Fetches: 0
                                                         ->  Parallel Hash  (cost=168881.74..168881.74 rows=1060427 width=33) (actual time=5191.756..5191.757 rows=649638 loops=5)
                                                               Buckets: 524288  Batches: 16  Memory Usage: 18560kB
                                                               ->  Nested Loop  (cost=1.12..168881.74 rows=1060427 width=33) (actual time=0.895..4970.569 rows=649638 loops=5)
                                                                     ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.55..45731.74 rows=35352 width=4) (actual time=0.185..169.405 rows=21662 loops=5)
                                                                           Filter: ((p_name)::text ~~ '%navy%'::text)
                                                                           Rows Removed by Filter: 378338
                                                                           Heap Fetches: 0
                                                                     ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..3.14 rows=34 width=29) (actual time=0.185..0.217 rows=30 loops=108312)
                                                                           Index Cond: (l_partkey = part.p_partkey)
                                                                           Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=22.596..22.596 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.097..17.261 rows=20000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.083..0.083 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.074..0.077 rows=25 loops=5)
 Planning Time: 51.206 ms
 Execution Time: 11077.086 ms
(46 rows)

SET
SET
SET
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=770336.39..770336.93 rows=1 width=66) (actual time=5273.019..5481.267 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=770336.39..802603.17 rows=60150 width=66) (actual time=5273.017..5481.265 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=770336.39..799144.54 rows=240600 width=66) (actual time=5272.999..5481.249 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=769336.33..769486.71 rows=60150 width=66) (actual time=5261.126..5261.227 rows=140 loops=5)
                     Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
                     Sort Method: quicksort  Memory: 49kB
                     Worker 0:  Sort Method: quicksort  Memory: 49kB
                     Worker 1:  Sort Method: quicksort  Memory: 49kB
                     Worker 2:  Sort Method: quicksort  Memory: 49kB
                     Worker 3:  Sort Method: quicksort  Memory: 49kB
                     ->  Partial HashAggregate  (cost=763508.92..764561.54 rows=60150 width=66) (actual time=5260.413..5261.031 rows=175 loops=5)
                           Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
                           ->  Hash Join  (cost=384352.79..744951.44 rows=1060427 width=57) (actual time=3464.783..4600.113 rows=649638 loops=5)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=384351.22..736392.24 rows=1060427 width=31) (actual time=3464.728..4376.209 rows=649638 loops=5)
                                       Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=8) (actual time=0.266..560.674 rows=3000000 loops=5)
                                       ->  Parallel Hash  (cost=363845.89..363845.89 rows=1060427 width=31) (actual time=2348.155..2348.247 rows=649638 loops=5)
                                             Buckets: 524288  Batches: 16  Memory Usage: 18464kB
                                             ->  Parallel Hash Join  (cost=196618.11..363845.89 rows=1060427 width=31) (actual time=1450.811..2164.238 rows=649638 loops=5)
                                                   Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Hash Join  (cost=193073.57..357517.61 rows=1060427 width=35) (actual time=1440.712..1963.839 rows=649638 loops=5)
                                                         Hash Cond: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))
                                                         ->  Parallel Index Only Scan using q2_idx_2 on partsupp  (cost=0.43..121620.77 rows=2000344 width=14) (actual time=0.054..292.098 rows=1600000 loops=5)
                                                               Heap Fetches: 0
                                                         ->  Parallel Hash  (cost=168881.74..168881.74 rows=1060427 width=33) (actual time=817.623..817.624 rows=649638 loops=5)
                                                               Buckets: 524288  Batches: 16  Memory Usage: 18528kB
                                                               ->  Nested Loop  (cost=1.12..168881.74 rows=1060427 width=33) (actual time=0.117..582.262 rows=649638 loops=5)
                                                                     ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.55..45731.74 rows=35352 width=4) (actual time=0.083..137.214 rows=21662 loops=5)
                                                                           Filter: ((p_name)::text ~~ '%navy%'::text)
                                                                           Rows Removed by Filter: 378338
                                                                           Heap Fetches: 0
                                                                     ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..3.14 rows=34 width=29) (actual time=0.005..0.016 rows=30 loops=108312)
                                                                           Index Cond: (l_partkey = part.p_partkey)
                                                                           Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=9.889..9.890 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.011..3.329 rows=20000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.029..0.029 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.020..0.023 rows=25 loops=5)
 Planning Time: 5.814 ms
 Execution Time: 5481.984 ms
(46 rows)

query 10 run 1
SET
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=797940.40..797940.45 rows=20 width=202) (actual time=11919.321..11975.499 rows=20 loops=1)
   ->  Sort  (cost=797940.40..799366.95 rows=570620 width=202) (actual time=11919.319..11975.495 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  Finalize GroupAggregate  (cost=698028.11..782756.41 rows=570620 width=202) (actual time=11204.233..11847.369 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=698028.11..769917.46 rows=570620 width=202) (actual time=11204.223..11515.335 rows=381205 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=697028.05..700951.06 rows=142655 width=202) (actual time=11177.301..11355.457 rows=76241 loops=5)
                           Group Key: customer.c_custkey, nation.n_name
                           ->  Sort  (cost=697028.05..697384.69 rows=142655 width=182) (actual time=11177.276..11212.153 rows=229080 loops=5)
                                 Sort Key: customer.c_custkey, nation.n_name
                                 Sort Method: external merge  Disk: 42256kB
                                 Worker 0:  Sort Method: external merge  Disk: 44664kB
                                 Worker 1:  Sort Method: external merge  Disk: 43112kB
                                 Worker 2:  Sort Method: external merge  Disk: 44504kB
                                 Worker 3:  Sort Method: external merge  Disk: 44024kB
                                 ->  Nested Loop  (cost=274166.96..684815.23 rows=142655 width=182) (actual time=4137.886..11012.732 rows=229080 loops=5)
                                       ->  Hash Join  (cost=274166.40..317470.34 rows=142604 width=174) (actual time=4135.475..4480.126 rows=114632 loops=5)
                                             Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                             ->  Parallel Hash Join  (cost=274164.84..317030.99 rows=142604 width=152) (actual time=4135.397..4437.006 rows=114632 loops=5)
                                                   Hash Cond: (customer.c_custkey = orders.o_custkey)
                                                   ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=148) (actual time=0.906..129.704 rows=300000 loops=5)
                                                   ->  Parallel Hash  (cost=272382.29..272382.29 rows=142604 width=8) (actual time=4133.414..4133.415 rows=114632 loops=5)
                                                         Buckets: 1048576  Batches: 1  Memory Usage: 30688kB
                                                         ->  Parallel Bitmap Heap Scan on orders  (cost=8975.22..272382.29 rows=142604 width=8) (actual time=159.674..4078.794 rows=114632 loops=5)
                                                               Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                               Heap Blocks: exact=46167
                                                               ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8832.61 rows=570418 width=0) (actual time=108.322..108.322 rows=573160 loops=1)
                                                                     Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.063..0.064 rows=25 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.054..0.057 rows=25 loops=5)
                                       ->  Index Only Scan using q10_idx_2 on lineitem  (cost=0.56..2.57 rows=1 width=16) (actual time=0.055..0.056 rows=2 loops=573160)
                                             Index Cond: ((l_orderkey = orders.o_orderkey) AND (l_returnflag = 'R'::bpchar))
                                             Heap Fetches: 0
 Planning Time: 32.554 ms
 Execution Time: 11981.388 ms
(39 rows)

SET
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=797940.40..797940.45 rows=20 width=202) (actual time=3069.242..3123.805 rows=20 loops=1)
   ->  Sort  (cost=797940.40..799366.95 rows=570620 width=202) (actual time=3069.241..3123.802 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  Finalize GroupAggregate  (cost=698028.11..782756.41 rows=570620 width=202) (actual time=2370.045..2993.834 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=698028.11..769917.46 rows=570620 width=202) (actual time=2370.039..2666.176 rows=381205 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=697028.05..700951.06 rows=142655 width=202) (actual time=2351.510..2531.491 rows=76241 loops=5)
                           Group Key: customer.c_custkey, nation.n_name
                           ->  Sort  (cost=697028.05..697384.69 rows=142655 width=182) (actual time=2351.491..2385.542 rows=229080 loops=5)
                                 Sort Key: customer.c_custkey, nation.n_name
                                 Sort Method: external merge  Disk: 39256kB
                                 Worker 0:  Sort Method: external merge  Disk: 45968kB
                                 Worker 1:  Sort Method: external merge  Disk: 43752kB
                                 Worker 2:  Sort Method: external merge  Disk: 45944kB
                                 Worker 3:  Sort Method: external merge  Disk: 43616kB
                                 ->  Nested Loop  (cost=274166.96..684815.23 rows=142655 width=182) (actual time=779.435..2195.099 rows=229080 loops=5)
                                       ->  Hash Join  (cost=274166.40..317470.34 rows=142604 width=174) (actual time=779.367..1056.370 rows=114632 loops=5)
                                             Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                             ->  Parallel Hash Join  (cost=274164.84..317030.99 rows=142604 width=152) (actual time=779.326..1019.898 rows=114632 loops=5)
                                                   Hash Cond: (customer.c_custkey = orders.o_custkey)
                                                   ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=148) (actual time=0.036..74.761 rows=300000 loops=5)
                                                   ->  Parallel Hash  (cost=272382.29..272382.29 rows=142604 width=8) (actual time=777.372..777.373 rows=114632 loops=5)
                                                         Buckets: 1048576  Batches: 1  Memory Usage: 30688kB
                                                         ->  Parallel Bitmap Heap Scan on orders  (cost=8975.22..272382.29 rows=142604 width=8) (actual time=154.100..735.980 rows=114632 loops=5)
                                                               Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                               Heap Blocks: exact=50318
                                                               ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8832.61 rows=570418 width=0) (actual time=102.790..102.790 rows=573160 loops=1)
                                                                     Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.024..0.025 rows=25 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.015..0.018 rows=25 loops=5)
                                       ->  Index Only Scan using q10_idx_2 on lineitem  (cost=0.56..2.57 rows=1 width=16) (actual time=0.009..0.009 rows=2 loops=573160)
                                             Index Cond: ((l_orderkey = orders.o_orderkey) AND (l_returnflag = 'R'::bpchar))
                                             Heap Fetches: 0
 Planning Time: 2.518 ms
 Execution Time: 3128.726 ms
(39 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=421663.54..421663.54 rows=1 width=36) (actual time=3781.299..3796.464 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=182745.25..182745.26 rows=1 width=32) (actual time=151.912..152.011 rows=1 loops=1)
           ->  Gather  (cost=182744.81..182745.22 rows=4 width=32) (actual time=151.903..152.004 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=181744.81..181744.82 rows=1 width=32) (actual time=148.716..148.718 rows=1 loops=4)
                       ->  Nested Loop  (cost=1.11..181144.71 rows=80014 width=10) (actual time=0.108..126.316 rows=80200 loops=4)
                             ->  Nested Loop  (cost=0.68..33545.04 rows=1000 width=4) (actual time=0.091..33.896 rows=1002 loops=4)
                                   ->  Parallel Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.54..4596.54 rows=25000 width=8) (actual time=0.038..6.778 rows=25000 loops=4)
                                         Heap Fetches: 0
                                   ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..1.16 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=100000)
                                         Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                         Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..146.82 rows=78 width=14) (actual time=0.005..0.082 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=238918.28..239185.00 rows=106685 width=36) (actual time=3781.298..3796.364 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=188661.09..238384.86 rows=106685 width=36) (actual time=3781.289..3796.355 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=188661.09..228783.20 rows=320056 width=36) (actual time=3312.695..3449.074 rows=317111 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=187661.03..189661.38 rows=80014 width=36) (actual time=3302.485..3356.021 rows=63422 loops=5)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=187661.03..187861.07 rows=80014 width=14) (actual time=3302.468..3307.692 rows=64160 loops=5)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 4510kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4488kB
                                 Worker 1:  Sort Method: quicksort  Memory: 4570kB
                                 Worker 2:  Sort Method: quicksort  Memory: 6196kB
                                 Worker 3:  Sort Method: quicksort  Memory: 4492kB
                                 ->  Nested Loop  (cost=1.11..181144.71 rows=80014 width=14) (actual time=1.560..3273.118 rows=64160 loops=5)
                                       ->  Nested Loop  (cost=0.68..33545.04 rows=1000 width=4) (actual time=0.274..36.713 rows=802 loops=5)
                                             ->  Parallel Index Only Scan using q2_idx_3 on supplier  (cost=0.54..4596.54 rows=25000 width=8) (actual time=0.154..11.416 rows=20000 loops=5)
                                                   Heap Fetches: 0
                                             ->  Index Scan using nation_pkey on nation  (cost=0.14..1.16 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=100000)
                                                   Index Cond: (n_nationkey = supplier.s_nationkey)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..146.82 rows=78 width=18) (actual time=0.365..4.015 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 19.550 ms
 Execution Time: 3797.132 ms
(48 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=421663.54..421663.54 rows=1 width=36) (actual time=613.636..630.899 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=182745.25..182745.26 rows=1 width=32) (actual time=150.768..150.873 rows=1 loops=1)
           ->  Gather  (cost=182744.81..182745.22 rows=4 width=32) (actual time=150.426..150.861 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=181744.81..181744.82 rows=1 width=32) (actual time=147.882..147.883 rows=1 loops=4)
                       ->  Nested Loop  (cost=1.11..181144.71 rows=80014 width=10) (actual time=0.113..126.112 rows=80200 loops=4)
                             ->  Nested Loop  (cost=0.68..33545.04 rows=1000 width=4) (actual time=0.095..33.933 rows=1002 loops=4)
                                   ->  Parallel Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.54..4596.54 rows=25000 width=8) (actual time=0.040..6.798 rows=25000 loops=4)
                                         Heap Fetches: 0
                                   ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..1.16 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=100000)
                                         Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                         Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..146.82 rows=78 width=14) (actual time=0.005..0.081 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=238918.28..239185.00 rows=106685 width=36) (actual time=613.635..630.793 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=188661.09..238384.86 rows=106685 width=36) (actual time=613.628..630.785 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=188661.09..228783.20 rows=320056 width=36) (actual time=170.982..286.829 rows=316579 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=187661.03..189661.38 rows=80014 width=36) (actual time=165.252..217.848 rows=63316 loops=5)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=187661.03..187861.07 rows=80014 width=14) (actual time=165.239..170.497 rows=64160 loops=5)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 3367kB
                                 Worker 0:  Sort Method: quicksort  Memory: 3213kB
                                 Worker 1:  Sort Method: quicksort  Memory: 6860kB
                                 Worker 2:  Sort Method: quicksort  Memory: 6721kB
                                 Worker 3:  Sort Method: quicksort  Memory: 7168kB
                                 ->  Nested Loop  (cost=1.11..181144.71 rows=80014 width=14) (actual time=0.091..145.449 rows=64160 loops=5)
                                       ->  Nested Loop  (cost=0.68..33545.04 rows=1000 width=4) (actual time=0.071..34.757 rows=802 loops=5)
                                             ->  Parallel Index Only Scan using q2_idx_3 on supplier  (cost=0.54..4596.54 rows=25000 width=8) (actual time=0.028..5.640 rows=20000 loops=5)
                                                   Heap Fetches: 0
                                             ->  Index Scan using nation_pkey on nation  (cost=0.14..1.16 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=100000)
                                                   Index Cond: (n_nationkey = supplier.s_nationkey)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..146.82 rows=78 width=18) (actual time=0.009..0.125 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.579 ms
 Execution Time: 630.987 ms
(48 rows)

query 12 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=451082.95..451083.47 rows=1 width=27) (actual time=2676.327..2682.780 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=451082.95..451086.59 rows=7 width=27) (actual time=2676.326..2682.779 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Gather Merge  (cost=451082.95..451086.31 rows=28 width=27) (actual time=2676.299..2682.772 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=450082.90..450082.91 rows=7 width=27) (actual time=2668.759..2668.762 rows=2 loops=5)
                     Sort Key: lineitem.l_shipmode
                     Sort Method: quicksort  Memory: 25kB
                     Worker 0:  Sort Method: quicksort  Memory: 25kB
                     Worker 1:  Sort Method: quicksort  Memory: 25kB
                     Worker 2:  Sort Method: quicksort  Memory: 25kB
                     Worker 3:  Sort Method: quicksort  Memory: 25kB
                     ->  Partial HashAggregate  (cost=450082.73..450082.80 rows=7 width=27) (actual time=2668.741..2668.743 rows=2 loops=5)
                           Group Key: lineitem.l_shipmode
                           ->  Parallel Hash Join  (cost=135782.19..448802.95 rows=73130 width=27) (actual time=618.193..2642.956 rows=62252 loops=5)
                                 Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=20) (actual time=0.727..1401.392 rows=3000000 loops=5)
                                 ->  Parallel Hash  (cost=134868.07..134868.07 rows=73130 width=15) (actual time=616.577..616.577 rows=62252 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 18784kB
                                       ->  Parallel Index Only Scan using q12_idx_1 on lineitem  (cost=0.56..134868.07 rows=73130 width=15) (actual time=0.211..597.838 rows=62252 loops=5)
                                             Index Cond: ((l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                             Filter: (l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[]))
                                             Rows Removed by Filter: 155618
                                             Heap Fetches: 0
 Planning Time: 29.458 ms
 Execution Time: 2683.570 ms
(27 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=451082.95..451083.47 rows=1 width=27) (actual time=1316.921..1321.958 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=451082.95..451086.59 rows=7 width=27) (actual time=1316.919..1321.956 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Gather Merge  (cost=451082.95..451086.31 rows=28 width=27) (actual time=1316.906..1321.947 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=450082.90..450082.91 rows=7 width=27) (actual time=1309.503..1309.506 rows=2 loops=5)
                     Sort Key: lineitem.l_shipmode
                     Sort Method: quicksort  Memory: 25kB
                     Worker 0:  Sort Method: quicksort  Memory: 25kB
                     Worker 1:  Sort Method: quicksort  Memory: 25kB
                     Worker 2:  Sort Method: quicksort  Memory: 25kB
                     Worker 3:  Sort Method: quicksort  Memory: 25kB
                     ->  Partial HashAggregate  (cost=450082.73..450082.80 rows=7 width=27) (actual time=1309.485..1309.488 rows=2 loops=5)
                           Group Key: lineitem.l_shipmode
                           ->  Parallel Hash Join  (cost=135782.19..448802.95 rows=73130 width=27) (actual time=222.177..1280.768 rows=62252 loops=5)
                                 Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=20) (actual time=0.414..368.012 rows=3000000 loops=5)
                                 ->  Parallel Hash  (cost=134868.07..134868.07 rows=73130 width=15) (actual time=221.095..221.095 rows=62252 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 18784kB
                                       ->  Parallel Index Only Scan using q12_idx_1 on lineitem  (cost=0.56..134868.07 rows=73130 width=15) (actual time=0.036..202.967 rows=62252 loops=5)
                                             Index Cond: ((l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                             Filter: (l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[]))
                                             Rows Removed by Filter: 155618
                                             Heap Fetches: 0
 Planning Time: 1.263 ms
 Execution Time: 1322.021 ms
(27 rows)

query 13 run 1
SET
SET
SET
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1691347.07..1691347.08 rows=1 width=16) (actual time=6294.491..6395.437 rows=1 loops=1)
   ->  Sort  (cost=1691347.07..1691347.57 rows=200 width=16) (actual time=6294.490..6395.435 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1691344.07..1691346.07 rows=200 width=16) (actual time=6294.469..6395.420 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  Finalize GroupAggregate  (cost=866042.98..1668843.59 rows=1500032 width=12) (actual time=4763.345..6178.544 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Gather Merge  (cost=866042.98..1623842.63 rows=6000128 width=12) (actual time=4763.338..5838.786 rows=1500000 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Partial GroupAggregate  (cost=865042.92..908169.49 rows=1500032 width=12) (actual time=4740.814..5459.358 rows=300000 loops=5)
                                 Group Key: customer.c_custkey
                                 ->  Sort  (cost=865042.92..874418.34 rows=3750166 width=8) (actual time=4740.803..5087.739 rows=3067521 loops=5)
                                       Sort Key: customer.c_custkey
                                       Sort Method: external merge  Disk: 53176kB
                                       Worker 0:  Sort Method: external merge  Disk: 56120kB
                                       Worker 1:  Sort Method: external merge  Disk: 50752kB
                                       Worker 2:  Sort Method: external merge  Disk: 58872kB
                                       Worker 3:  Sort Method: external merge  Disk: 49344kB
                                       ->  Parallel Hash Left Join  (cost=369677.27..418927.49 rows=3750166 width=8) (actual time=2718.544..3893.248 rows=3067521 loops=5)
                                             Hash Cond: (customer.c_custkey = orders.o_custkey)
                                             ->  Parallel Index Only Scan using customer_pkey on customer  (cost=0.43..19482.67 rows=375008 width=4) (actual time=0.870..61.037 rows=300000 loops=5)
                                                   Heap Fetches: 0
                                             ->  Parallel Hash  (cost=308149.77..308149.77 rows=3750166 width=8) (actual time=2527.308..2527.309 rows=2967517 loops=5)
                                                   Buckets: 1048576  Batches: 32  Memory Usage: 26528kB
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..308149.77 rows=3750166 width=8) (actual time=0.129..1990.157 rows=2967517 loops=5)
                                                         Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                                         Rows Removed by Filter: 32483
 Planning Time: 17.648 ms
 Execution Time: 6404.330 ms
(31 rows)

SET
SET
SET
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1691347.07..1691347.08 rows=1 width=16) (actual time=5715.414..5818.765 rows=1 loops=1)
   ->  Sort  (cost=1691347.07..1691347.57 rows=200 width=16) (actual time=5715.413..5818.764 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1691344.07..1691346.07 rows=200 width=16) (actual time=5715.395..5818.751 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  Finalize GroupAggregate  (cost=866042.98..1668843.59 rows=1500032 width=12) (actual time=4087.299..5601.286 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Gather Merge  (cost=866042.98..1623842.63 rows=6000128 width=12) (actual time=4087.296..5256.227 rows=1500000 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Partial GroupAggregate  (cost=865042.92..908169.49 rows=1500032 width=12) (actual time=4060.056..4766.496 rows=300000 loops=5)
                                 Group Key: customer.c_custkey
                                 ->  Sort  (cost=865042.92..874418.34 rows=3750166 width=8) (actual time=4060.046..4399.682 rows=3067521 loops=5)
                                       Sort Key: customer.c_custkey
                                       Sort Method: external merge  Disk: 60936kB
                                       Worker 0:  Sort Method: external merge  Disk: 55048kB
                                       Worker 1:  Sort Method: external merge  Disk: 49632kB
                                       Worker 2:  Sort Method: external merge  Disk: 47808kB
                                       Worker 3:  Sort Method: external merge  Disk: 54832kB
                                       ->  Parallel Hash Left Join  (cost=369677.27..418927.49 rows=3750166 width=8) (actual time=2046.405..3232.153 rows=3067521 loops=5)
                                             Hash Cond: (customer.c_custkey = orders.o_custkey)
                                             ->  Parallel Index Only Scan using customer_pkey on customer  (cost=0.43..19482.67 rows=375008 width=4) (actual time=0.064..44.804 rows=300000 loops=5)
                                                   Heap Fetches: 0
                                             ->  Parallel Hash  (cost=308149.77..308149.77 rows=3750166 width=8) (actual time=1864.482..1864.482 rows=2967517 loops=5)
                                                   Buckets: 1048576  Batches: 32  Memory Usage: 26528kB
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..308149.77 rows=3750166 width=8) (actual time=0.257..1293.004 rows=2967517 loops=5)
                                                         Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                                         Rows Removed by Filter: 32483
 Planning Time: 0.932 ms
 Execution Time: 5827.328 ms
(31 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=929115.07..929115.09 rows=1 width=32) (actual time=5317.936..5360.371 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=929115.07..929115.09 rows=1 width=32) (actual time=5317.935..5360.369 rows=1 loops=1)
         ->  Gather  (cost=929114.62..929115.03 rows=4 width=64) (actual time=5311.865..5360.345 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=928114.62..928114.63 rows=1 width=64) (actual time=5304.730..5304.732 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65968.93..924766.60 rows=191315 width=33) (actual time=696.279..5162.969 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13738.49..872033.96 rows=191315 width=16) (actual time=294.167..4597.485 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=82943
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13547.18 rows=765261 width=0) (actual time=188.720..188.721 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.75..45980.75 rows=499975 width=25) (actual time=399.898..399.898 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.75 rows=499975 width=25) (actual time=0.844..263.316 rows=400000 loops=5)
 Planning Time: 29.152 ms
 Execution Time: 5361.234 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=929115.07..929115.09 rows=1 width=32) (actual time=1789.800..1830.337 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=929115.07..929115.09 rows=1 width=32) (actual time=1789.799..1830.335 rows=1 loops=1)
         ->  Gather  (cost=929114.62..929115.03 rows=4 width=64) (actual time=1783.286..1830.315 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=928114.62..928114.63 rows=1 width=64) (actual time=1778.513..1778.516 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65968.93..924766.60 rows=191315 width=33) (actual time=562.351..1686.667 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13738.49..872033.96 rows=191315 width=16) (actual time=277.028..1274.583 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=84664
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13547.18 rows=765261 width=0) (actual time=172.382..172.382 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.75..45980.75 rows=499975 width=25) (actual time=282.600..282.601 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.75 rows=499975 width=25) (actual time=0.044..127.293 rows=400000 loops=5)
 Planning Time: 1.627 ms
 Execution Time: 1830.382 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2742635.55..2742747.99 rows=1 width=104) (actual time=13285.694..13341.937 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1389508.05..1389508.06 rows=1 width=32) (actual time=2948.160..2957.088 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1387063.85..1388285.95 rows=97768 width=36) (actual time=2904.374..2950.873 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Gather  (cost=1343801.51..1384130.81 rows=391072 width=36) (actual time=2555.588..2650.540 rows=398536 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1342801.51..1344023.61 rows=97768 width=36) (actual time=2551.546..2602.191 rows=99634 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=40069.88..1337221.19 rows=558032 width=16) (actual time=437.819..2116.736 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=109344 lossy=73099
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..39511.85 rows=2232128 width=0) (actual time=341.834..341.835 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1353127.50..1408109.89 rows=489 width=104) (actual time=13285.692..13333.007 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1353127.20..1406551.41 rows=489 width=36) (actual time=13285.045..13332.358 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1353127.20..1399952.07 rows=391072 width=36) (actual time=10118.969..10234.970 rows=346215 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1352127.15..1352371.57 rows=97768 width=36) (actual time=10085.881..10093.060 rows=69821 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 10804kB
                           Worker 0:  Sort Method: quicksort  Memory: 10802kB
                           Worker 1:  Sort Method: quicksort  Memory: 10804kB
                           Worker 2:  Sort Method: quicksort  Memory: 10797kB
                           Worker 3:  Sort Method: quicksort  Memory: 10797kB
                           ->  Partial HashAggregate  (cost=1342801.51..1344023.61 rows=97768 width=36) (actual time=9991.036..10056.793 rows=98924 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=40069.88..1337221.19 rows=558032 width=16) (actual time=488.146..9511.172 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=80468 lossy=53651
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..39511.85 rows=2232128 width=0) (actual time=397.380..397.380 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.18 rows=1 width=72) (actual time=0.642..0.643 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 21.922 ms
 Execution Time: 13344.594 ms
(43 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2742635.55..2742747.99 rows=1 width=104) (actual time=6034.500..6093.972 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1389508.05..1389508.06 rows=1 width=32) (actual time=2947.343..2957.211 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1387063.85..1388285.95 rows=97768 width=36) (actual time=2901.125..2950.954 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Gather  (cost=1343801.51..1384130.81 rows=391072 width=36) (actual time=2552.066..2648.433 rows=398578 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1342801.51..1344023.61 rows=97768 width=36) (actual time=2547.667..2598.633 rows=99644 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=40069.88..1337221.19 rows=558032 width=16) (actual time=436.512..2113.872 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=108910 lossy=72569
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..39511.85 rows=2232128 width=0) (actual time=340.939..340.939 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1353127.50..1408109.89 rows=489 width=104) (actual time=6034.499..6084.102 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1353127.20..1406551.41 rows=489 width=36) (actual time=6034.455..6084.057 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1353127.20..1399952.07 rows=391072 width=36) (actual time=2868.176..2986.897 rows=346162 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1352127.15..1352371.57 rows=97768 width=36) (actual time=2839.493..2846.848 rows=69819 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 10803kB
                           Worker 0:  Sort Method: quicksort  Memory: 10804kB
                           Worker 1:  Sort Method: quicksort  Memory: 10762kB
                           Worker 2:  Sort Method: quicksort  Memory: 10810kB
                           Worker 3:  Sort Method: quicksort  Memory: 10815kB
                           ->  Partial HashAggregate  (cost=1342801.51..1344023.61 rows=97768 width=36) (actual time=2744.581..2810.253 rows=98897 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=40069.88..1337221.19 rows=558032 width=16) (actual time=458.323..2354.865 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=81285 lossy=54098
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..39511.85 rows=2232128 width=0) (actual time=364.772..364.772 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.18 rows=1 width=72) (actual time=0.039..0.039 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.583 ms
 Execution Time: 6096.110 ms
(43 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=307060.81..307060.81 rows=1 width=44) (actual time=4689.223..4692.309 rows=1 loops=1)
   ->  Sort  (cost=307060.81..307444.00 rows=153275 width=44) (actual time=4689.221..4692.308 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=297390.57..306294.44 rows=153275 width=44) (actual time=4008.076..4685.346 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=297390.57..298864.80 rows=589689 width=40) (actual time=4008.025..4391.013 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Gather  (cost=58873.02..229352.58 rows=589689 width=40) (actual time=405.274..1126.654 rows=1186319 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Parallel Hash Join  (cost=57873.02..169383.68 rows=147422 width=40) (actual time=397.437..1126.052 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..112356.65 rows=1000172 width=8) (actual time=42.797..579.364 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.056..41.965 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.38..53480.38 rows=73695 width=40) (actual time=353.881..353.882 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.38 rows=73695 width=40) (actual time=0.106..328.105 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 20.322 ms
 Execution Time: 4700.839 ms
(29 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=307060.81..307060.81 rows=1 width=44) (actual time=4356.098..4359.074 rows=1 loops=1)
   ->  Sort  (cost=307060.81..307444.00 rows=153275 width=44) (actual time=4356.097..4359.073 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=297390.57..306294.44 rows=153275 width=44) (actual time=3677.593..4352.147 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=297390.57..298864.80 rows=589689 width=40) (actual time=3677.543..4059.957 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Gather  (cost=58873.02..229352.58 rows=589689 width=40) (actual time=187.968..795.835 rows=1186319 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Parallel Hash Join  (cost=57873.02..169383.68 rows=147422 width=40) (actual time=180.850..778.798 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..112356.65 rows=1000172 width=8) (actual time=25.769..423.329 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.084..25.487 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.38..53480.38 rows=73695 width=40) (actual time=154.304..154.304 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.38 rows=73695 width=40) (actual time=0.014..124.607 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 0.902 ms
 Execution Time: 4366.945 ms
(29 rows)

query 17 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1761516.62..1761516.63 rows=1 width=32) (actual time=29121.184..29153.014 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1761516.62..1761516.63 rows=1 width=32) (actual time=29121.183..29153.012 rows=1 loops=1)
         ->  Gather  (cost=1761516.18..1761516.59 rows=4 width=32) (actual time=29098.229..29152.998 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1760516.18..1760516.19 rows=1 width=32) (actual time=29068.071..29068.074 rows=1 loops=5)
                     ->  Nested Loop  (cost=48502.92..1760505.60 rows=4234 width=8) (actual time=638.940..29067.637 rows=1064 loops=5)
                           Join Filter: (part.p_partkey = lineitem.l_partkey)
                           ->  Merge Join  (cost=48502.36..1759178.01 rows=424 width=40) (actual time=633.958..27757.313 rows=399 loops=5)
                                 Merge Cond: (part.p_partkey = lineitem_1.l_partkey)
                                 ->  Sort  (cost=48501.79..48502.98 rows=476 width=4) (actual time=309.390..309.659 rows=399 loops=5)
                                       Sort Key: part.p_partkey
                                       Sort Method: quicksort  Memory: 45kB
                                       Worker 0:  Sort Method: quicksort  Memory: 42kB
                                       Worker 1:  Sort Method: quicksort  Memory: 43kB
                                       Worker 2:  Sort Method: quicksort  Memory: 43kB
                                       Worker 3:  Sort Method: quicksort  Memory: 43kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.62 rows=476 width=4) (actual time=0.570..309.100 rows=399 loops=5)
                                             Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                             Rows Removed by Filter: 399601
                                 ->  GroupAggregate  (cost=0.56..1688430.84 rows=1779101 width=36) (actual time=3.078..27265.474 rows=1997418 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Index Only Scan using q17_idx_1 on lineitem lineitem_1  (cost=0.56..1361794.88 rows=59989888 width=9) (actual time=1.102..17158.017 rows=59908363 loops=5)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..2.99 rows=11 width=17) (actual time=3.148..3.277 rows=3 loops=1996)
                                 Index Cond: ((l_partkey = lineitem_1.l_partkey) AND (l_quantity < ((0.2 * avg(lineitem_1.l_quantity)))))
                                 Heap Fetches: 0
 Planning Time: 25.074 ms
 Execution Time: 29153.929 ms
(29 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1761516.62..1761516.63 rows=1 width=32) (actual time=28682.991..28683.091 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1761516.62..1761516.63 rows=1 width=32) (actual time=28682.990..28683.089 rows=1 loops=1)
         ->  Gather  (cost=1761516.18..1761516.59 rows=4 width=32) (actual time=28682.979..28683.083 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1760516.18..1760516.19 rows=1 width=32) (actual time=27814.301..27814.302 rows=1 loops=5)
                     ->  Nested Loop  (cost=48502.92..1760505.60 rows=4234 width=8) (actual time=436.720..27813.994 rows=1064 loops=5)
                           Join Filter: (part.p_partkey = lineitem.l_partkey)
                           ->  Merge Join  (cost=48502.36..1759178.01 rows=424 width=40) (actual time=431.274..27792.556 rows=399 loops=5)
                                 Merge Cond: (part.p_partkey = lineitem_1.l_partkey)
                                 ->  Sort  (cost=48501.79..48502.98 rows=476 width=4) (actual time=140.433..141.404 rows=399 loops=5)
                                       Sort Key: part.p_partkey
                                       Sort Method: quicksort  Memory: 46kB
                                       Worker 0:  Sort Method: quicksort  Memory: 39kB
                                       Worker 1:  Sort Method: quicksort  Memory: 46kB
                                       Worker 2:  Sort Method: quicksort  Memory: 39kB
                                       Worker 3:  Sort Method: quicksort  Memory: 46kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.62 rows=476 width=4) (actual time=0.195..140.262 rows=399 loops=5)
                                             Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                             Rows Removed by Filter: 399601
                                 ->  GroupAggregate  (cost=0.56..1688430.84 rows=1779101 width=36) (actual time=0.078..27466.771 rows=1988928 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Index Only Scan using q17_idx_1 on lineitem lineitem_1  (cost=0.56..1361794.88 rows=59989888 width=9) (actual time=0.039..17246.526 rows=59654123 loops=5)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..2.99 rows=11 width=17) (actual time=0.045..0.049 rows=3 loops=1996)
                                 Index Cond: ((l_partkey = lineitem_1.l_partkey) AND (l_quantity < ((0.2 * avg(lineitem_1.l_quantity)))))
                                 Heap Fetches: 0
 Planning Time: 1.953 ms
 Execution Time: 28683.149 ms
(29 rows)

query 18 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=7831762.92..7831763.17 rows=100 width=71) (actual time=27960.539..28130.231 rows=99 loops=1)
   ->  Sort  (cost=7831762.92..7881738.86 rows=19990373 width=71) (actual time=27960.538..28130.223 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  Finalize GroupAggregate  (cost=4124469.99..7067745.24 rows=19990373 width=71) (actual time=27960.314..28130.129 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Gather Merge  (cost=4124469.99..6617961.86 rows=19990372 width=71) (actual time=27960.306..28130.050 rows=99 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=4123469.94..4235915.78 rows=4997593 width=71) (actual time=27946.622..27946.674 rows=20 loops=5)
                           Group Key: customer.c_custkey, orders.o_orderkey
                           ->  Sort  (cost=4123469.94..4135963.92 rows=4997593 width=44) (actual time=27946.604..27946.623 rows=139 loops=5)
                                 Sort Key: customer.c_custkey, orders.o_orderkey
                                 Sort Method: quicksort  Memory: 34kB
                                 Worker 0:  Sort Method: quicksort  Memory: 34kB
                                 Worker 1:  Sort Method: quicksort  Memory: 36kB
                                 Worker 2:  Sort Method: quicksort  Memory: 39kB
                                 Worker 3:  Sort Method: quicksort  Memory: 34kB
                                 ->  Parallel Hash Join  (cost=412016.98..3457605.20 rows=4997593 width=44) (actual time=27430.032..27946.548 rows=139 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Hash Join  (cost=367632.30..3400101.80 rows=4997593 width=25) (actual time=27070.084..27585.884 rows=139 loops=5)
                                             Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                             ->  Merge Join  (cost=1.13..2948551.84 rows=4999157 width=13) (actual time=1498.445..24672.384 rows=139 loops=5)
                                                   Merge Cond: (lineitem.l_orderkey = lineitem_1.l_orderkey)
                                                   ->  Parallel Index Only Scan using q18_idx_1 on lineitem  (cost=0.56..911870.72 rows=14997472 width=9) (actual time=1.436..1273.331 rows=11983287 loops=5)
                                                         Heap Fetches: 0
                                                   ->  GroupAggregate  (cost=0.56..1886706.40 rows=4999157 width=4) (actual time=475.386..22768.593 rows=99 loops=5)
                                                         Group Key: lineitem_1.l_orderkey
                                                         Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                         Rows Removed by Filter: 14999901
                                                         ->  Index Only Scan using q18_idx_1 on lineitem lineitem_1  (cost=0.56..1361794.88 rows=59989888 width=9) (actual time=0.015..7350.962 rows=59986052 loops=5)
                                                               Heap Fetches: 0
                                             ->  Parallel Hash  (cost=298773.41..298773.41 rows=3750541 width=20) (actual time=2258.713..2258.714 rows=3000000 loops=5)
                                                   Buckets: 524288  Batches: 32  Memory Usage: 29920kB
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=20) (actual time=1.112..1608.190 rows=3000000 loops=5)
                                       ->  Parallel Hash  (cost=39697.08..39697.08 rows=375008 width=23) (actual time=357.613..357.614 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=23) (actual time=1.126..253.943 rows=300000 loops=5)
 Planning Time: 28.345 ms
 Execution Time: 28131.098 ms
(40 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=7831762.92..7831763.17 rows=100 width=71) (actual time=26101.345..26251.344 rows=99 loops=1)
   ->  Sort  (cost=7831762.92..7881738.86 rows=19990373 width=71) (actual time=26101.344..26251.337 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  Finalize GroupAggregate  (cost=4124469.99..7067745.24 rows=19990373 width=71) (actual time=26101.115..26251.243 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Gather Merge  (cost=4124469.99..6617961.86 rows=19990372 width=71) (actual time=26101.094..26251.161 rows=99 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=4123469.94..4235915.78 rows=4997593 width=71) (actual time=26088.656..26092.868 rows=20 loops=5)
                           Group Key: customer.c_custkey, orders.o_orderkey
                           ->  Sort  (cost=4123469.94..4135963.92 rows=4997593 width=44) (actual time=26088.644..26092.822 rows=139 loops=5)
                                 Sort Key: customer.c_custkey, orders.o_orderkey
                                 Sort Method: quicksort  Memory: 39kB
                                 Worker 0:  Sort Method: quicksort  Memory: 35kB
                                 Worker 1:  Sort Method: quicksort  Memory: 29kB
                                 Worker 2:  Sort Method: quicksort  Memory: 37kB
                                 Worker 3:  Sort Method: quicksort  Memory: 36kB
                                 ->  Parallel Hash Join  (cost=412016.98..3457605.20 rows=4997593 width=44) (actual time=25575.625..26092.743 rows=139 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Hash Join  (cost=367632.30..3400101.80 rows=4997593 width=25) (actual time=25335.830..25852.233 rows=139 loops=5)
                                             Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                             ->  Merge Join  (cost=1.13..2948551.84 rows=4999157 width=13) (actual time=1336.382..23892.586 rows=139 loops=5)
                                                   Merge Cond: (lineitem.l_orderkey = lineitem_1.l_orderkey)
                                                   ->  Parallel Index Only Scan using q18_idx_1 on lineitem  (cost=0.56..911870.72 rows=14997472 width=9) (actual time=1.067..1282.393 rows=11983287 loops=5)
                                                         Heap Fetches: 0
                                                   ->  GroupAggregate  (cost=0.56..1886706.40 rows=4999157 width=4) (actual time=464.726..21934.477 rows=99 loops=5)
                                                         Group Key: lineitem_1.l_orderkey
                                                         Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                         Rows Removed by Filter: 14999901
                                                         ->  Index Only Scan using q18_idx_1 on lineitem lineitem_1  (cost=0.56..1361794.88 rows=59989888 width=9) (actual time=0.013..6701.098 rows=59986052 loops=5)
                                                               Heap Fetches: 0
                                             ->  Parallel Hash  (cost=298773.41..298773.41 rows=3750541 width=20) (actual time=1331.880..1331.881 rows=3000000 loops=5)
                                                   Buckets: 524288  Batches: 32  Memory Usage: 29920kB
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298773.41 rows=3750541 width=20) (actual time=0.037..596.324 rows=3000000 loops=5)
                                       ->  Parallel Hash  (cost=39697.08..39697.08 rows=375008 width=23) (actual time=236.735..236.736 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 98688kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39697.08 rows=375008 width=23) (actual time=0.036..116.668 rows=300000 loops=5)
 Planning Time: 2.386 ms
 Execution Time: 26251.425 ms
(40 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=67571.14..67571.15 rows=1 width=32) (actual time=881.575..881.846 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=67571.14..67571.15 rows=1 width=32) (actual time=881.573..881.844 rows=1 loops=1)
         ->  Gather  (cost=67570.71..67571.11 rows=4 width=32) (actual time=876.968..881.821 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=66570.71..66570.71 rows=1 width=32) (actual time=868.954..868.955 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.69..66568.56 rows=286 width=12) (actual time=7.677..868.554 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62229.94 rows=1201 width=30) (actual time=0.377..219.322 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Only Scan using q19_idx_1 on lineitem  (cost=0.69..3.60 rows=1 width=21) (actual time=0.656..0.678 rows=0 loops=4781)
                                 Index Cond: ((l_partkey = part.p_partkey) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar))
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 7
                                 Heap Fetches: 0
 Planning Time: 32.504 ms
 Execution Time: 882.672 ms
(17 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=67571.14..67571.15 rows=1 width=32) (actual time=147.032..151.208 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=67571.14..67571.15 rows=1 width=32) (actual time=147.031..151.206 rows=1 loops=1)
         ->  Gather  (cost=67570.71..67571.11 rows=4 width=32) (actual time=143.745..151.185 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=66570.71..66570.71 rows=1 width=32) (actual time=139.410..139.410 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.69..66568.56 rows=286 width=12) (actual time=0.556..139.234 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62229.94 rows=1201 width=30) (actual time=0.103..122.976 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Only Scan using q19_idx_1 on lineitem  (cost=0.69..3.60 rows=1 width=21) (actual time=0.015..0.017 rows=0 loops=4781)
                                 Index Cond: ((l_partkey = part.p_partkey) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar))
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 7
                                 Heap Fetches: 0
 Planning Time: 2.891 ms
 Execution Time: 151.262 ms
(17 rows)

query 20 run 1
SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3078119.17..3078119.18 rows=1 width=52) (actual time=33410.493..33410.652 rows=1 loops=1)
   ->  Sort  (cost=3078119.17..3078119.18 rows=1 width=52) (actual time=33410.492..33410.650 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=1621135.13..3078119.16 rows=1 width=52) (actual time=10373.945..33408.813 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.660..34.496 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.242..0.245 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.411..26.686 rows=100000 loops=1)
               ->  Materialize  (cost=1621135.13..3073466.86 rows=3 width=8) (actual time=2.128..5.759 rows=44445 loops=4095)
                     ->  Merge Join  (cost=1621135.13..3073466.84 rows=3 width=8) (actual time=8712.032..17549.901 rows=59002 loops=1)
                           Merge Cond: (lineitem.l_partkey = partsupp.ps_partkey)
                           Join Filter: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity)))))
                           Rows Removed by Join Filter: 177498
                           ->  Finalize GroupAggregate  (cost=1620134.09..2923457.29 rows=4848830 width=40) (actual time=8707.332..17170.208 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Gather Merge  (cost=1620134.09..2759390.44 rows=9133440 width=40) (actual time=8707.322..11886.369 rows=8160052 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Partial GroupAggregate  (cost=1619134.03..1670509.63 rows=2283360 width=40) (actual time=8634.982..9927.107 rows=1632096 loops=5)
                                             Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                             ->  Sort  (cost=1619134.03..1624842.43 rows=2283360 width=13) (actual time=8634.969..8904.001 rows=1824714 loops=5)
                                                   Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                                   Sort Method: external merge  Disk: 43112kB
                                                   Worker 0:  Sort Method: external merge  Disk: 41408kB
                                                   Worker 1:  Sort Method: external merge  Disk: 40544kB
                                                   Worker 2:  Sort Method: external merge  Disk: 39808kB
                                                   Worker 3:  Sort Method: external merge  Disk: 40528kB
                                                   ->  Parallel Seq Scan on lineitem  (cost=0.00..1350105.08 rows=2283360 width=13) (actual time=0.224..7811.100 rows=1824738 loops=5)
                                                         Filter: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                                         Rows Removed by Filter: 10172473
                           ->  Materialize  (cost=1001.04..70576.06 rows=80822 width=16) (actual time=4.060..48.368 rows=237286 loops=1)
                                 ->  Gather Merge  (cost=1001.04..70374.01 rows=80822 width=16) (actual time=4.055..32.677 rows=86872 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 3
                                       ->  Nested Loop  (cost=0.98..59747.27 rows=20206 width=16) (actual time=0.370..197.289 rows=21718 loops=4)
                                             ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.55..45731.74 rows=5050 width=4) (actual time=0.263..95.872 rows=5430 loops=4)
                                                   Filter: ((p_name)::text ~~ 'olive%'::text)
                                                   Rows Removed by Filter: 494570
                                                   Heap Fetches: 0
                                             ->  Index Only Scan using q20_idx_1 on partsupp  (cost=0.43..2.61 rows=17 width=12) (actual time=0.017..0.018 rows=4 loops=21718)
                                                   Index Cond: (ps_partkey = part.p_partkey)
                                                   Heap Fetches: 0
 Planning Time: 33.247 ms
 Execution Time: 33416.512 ms
(50 rows)

SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3078119.17..3078119.18 rows=1 width=52) (actual time=27838.778..27838.919 rows=1 loops=1)
   ->  Sort  (cost=3078119.17..3078119.18 rows=1 width=52) (actual time=27838.777..27838.917 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=1621135.13..3078119.16 rows=1 width=52) (actual time=5124.482..27837.315 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.017..17.337 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.009 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.008..6.355 rows=100000 loops=1)
               ->  Materialize  (cost=1621135.13..3073466.86 rows=3 width=8) (actual time=0.855..4.429 rows=44445 loops=4095)
                     ->  Merge Join  (cost=1621135.13..3073466.84 rows=3 width=8) (actual time=3501.592..12145.435 rows=59002 loops=1)
                           Merge Cond: (lineitem.l_partkey = partsupp.ps_partkey)
                           Join Filter: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity)))))
                           Rows Removed by Join Filter: 177498
                           ->  Finalize GroupAggregate  (cost=1620134.09..2923457.29 rows=4848830 width=40) (actual time=3497.619..11787.522 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Gather Merge  (cost=1620134.09..2759390.44 rows=9133440 width=40) (actual time=3497.609..6552.514 rows=8159200 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Partial GroupAggregate  (cost=1619134.03..1670509.63 rows=2283360 width=40) (actual time=3430.802..4717.883 rows=1631924 loops=5)
                                             Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                             ->  Sort  (cost=1619134.03..1624842.43 rows=2283360 width=13) (actual time=3430.786..3699.641 rows=1824714 loops=5)
                                                   Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                                   Sort Method: external merge  Disk: 40528kB
                                                   Worker 0:  Sort Method: external merge  Disk: 42968kB
                                                   Worker 1:  Sort Method: external merge  Disk: 41832kB
                                                   Worker 2:  Sort Method: external merge  Disk: 39536kB
                                                   Worker 3:  Sort Method: external merge  Disk: 40528kB
                                                   ->  Parallel Seq Scan on lineitem  (cost=0.00..1350105.08 rows=2283360 width=13) (actual time=0.040..2456.894 rows=1824738 loops=5)
                                                         Filter: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                                         Rows Removed by Filter: 10172473
                           ->  Materialize  (cost=1001.04..70576.06 rows=80822 width=16) (actual time=3.418..33.630 rows=237286 loops=1)
                                 ->  Gather Merge  (cost=1001.04..70374.01 rows=80822 width=16) (actual time=3.413..18.100 rows=86872 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 3
                                       ->  Nested Loop  (cost=0.98..59747.27 rows=20206 width=16) (actual time=0.063..71.018 rows=21718 loops=4)
                                             ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.55..45731.74 rows=5050 width=4) (actual time=0.041..53.725 rows=5430 loops=4)
                                                   Filter: ((p_name)::text ~~ 'olive%'::text)
                                                   Rows Removed by Filter: 494570
                                                   Heap Fetches: 0
                                             ->  Index Only Scan using q20_idx_1 on partsupp  (cost=0.43..2.61 rows=17 width=12) (actual time=0.002..0.003 rows=4 loops=21718)
                                                   Index Cond: (ps_partkey = part.p_partkey)
                                                   Heap Fetches: 0
 Planning Time: 1.982 ms
 Execution Time: 27844.572 ms
(50 rows)

query 21 run 1
SET
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=650286.71..650286.71 rows=1 width=34) (actual time=18407.969..18633.339 rows=100 loops=1)
   ->  Sort  (cost=650286.71..650286.71 rows=1 width=34) (actual time=18407.968..18633.332 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=650286.68..650286.70 rows=1 width=34) (actual time=18401.024..18632.117 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=650286.68..650286.68 rows=1 width=26) (actual time=18401.016..18627.907 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=346122.87..650286.67 rows=1 width=26) (actual time=4648.563..18446.179 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 27756
                           ->  Nested Loop  (cost=346122.31..650284.02 rows=1 width=38) (actual time=4647.557..8948.604 rows=65960 loops=1)
                                 ->  Gather  (cost=346121.87..650281.57 rows=1 width=34) (actual time=4647.254..4934.892 rows=134155 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Hash Anti Join  (cost=345121.87..649281.47 rows=1 width=34) (actual time=4715.534..5365.477 rows=26831 loops=5)
                                             Hash Cond: (l1.l_orderkey = l3.l_orderkey)
                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                             Rows Removed by Join Filter: 109330
                                             ->  Parallel Hash Join  (cost=3021.13..283026.98 rows=199966 width=34) (actual time=21.941..1690.230 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l1  (cost=0.56..260083.28 rows=4999157 width=8) (actual time=0.095..934.477 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=21.782..21.784 rows=798 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 384kB
                                                         ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.580..21.410 rows=798 loops=5)
                                                               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.327..18.905 rows=20000 loops=5)
                                                               ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.214..0.215 rows=1 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.210..0.212 rows=1 loops=5)
                                                                           Filter: (n_name = 'PERU'::bpchar)
                                                                           Rows Removed by Filter: 24
                                             ->  Parallel Hash  (cost=260083.28..260083.28 rows=4999157 width=8) (actual time=2865.081..2865.081 rows=7585870 loops=5)
                                                   Buckets: 1048576  Batches: 64  Memory Usage: 31520kB
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l3  (cost=0.56..260083.28 rows=4999157 width=8) (actual time=0.256..1750.137 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                 ->  Index Only Scan using q21_idx_3 on orders  (cost=0.43..2.45 rows=1 width=4) (actual time=0.029..0.029 rows=0 loops=134155)
                                       Index Cond: ((o_orderkey = l1.l_orderkey) AND (o_orderstatus = 'F'::bpchar))
                                       Heap Fetches: 0
                           ->  Index Only Scan using q21_idx_1 on lineitem l2  (cost=0.56..2.63 rows=4 width=8) (actual time=0.142..0.143 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
                                 Heap Fetches: 0
 Planning Time: 33.980 ms
 Execution Time: 18634.326 ms
(46 rows)

SET
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=650286.71..650286.71 rows=1 width=34) (actual time=5642.152..5875.655 rows=100 loops=1)
   ->  Sort  (cost=650286.71..650286.71 rows=1 width=34) (actual time=5642.151..5875.647 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=650286.68..650286.70 rows=1 width=34) (actual time=5635.412..5874.465 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=650286.68..650286.68 rows=1 width=26) (actual time=5635.403..5870.380 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=346122.87..650286.67 rows=1 width=26) (actual time=4141.096..5704.873 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 27756
                           ->  Nested Loop  (cost=346122.31..650284.02 rows=1 width=38) (actual time=4141.086..5438.552 rows=65960 loops=1)
                                 ->  Gather  (cost=346121.87..650281.57 rows=1 width=34) (actual time=4141.025..4996.794 rows=134155 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Hash Anti Join  (cost=345121.87..649281.47 rows=1 width=34) (actual time=4116.662..4996.630 rows=26831 loops=5)
                                             Hash Cond: (l1.l_orderkey = l3.l_orderkey)
                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                             Rows Removed by Join Filter: 109336
                                             ->  Parallel Hash Join  (cost=3021.13..283026.98 rows=199966 width=34) (actual time=5.999..1658.526 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l1  (cost=0.56..260083.28 rows=4999157 width=8) (actual time=0.021..947.766 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=5.860..5.862 rows=798 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                         ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.056..4.712 rows=798 loops=5)
                                                               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.012..1.715 rows=20000 loops=5)
                                                               ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.031..0.031 rows=1 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.028..0.029 rows=1 loops=5)
                                                                           Filter: (n_name = 'PERU'::bpchar)
                                                                           Rows Removed by Filter: 24
                                             ->  Parallel Hash  (cost=260083.28..260083.28 rows=4999157 width=8) (actual time=2299.306..2299.307 rows=7585870 loops=5)
                                                   Buckets: 1048576  Batches: 64  Memory Usage: 31520kB
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l3  (cost=0.56..260083.28 rows=4999157 width=8) (actual time=0.029..1130.803 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                 ->  Index Only Scan using q21_idx_3 on orders  (cost=0.43..2.45 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=134155)
                                       Index Cond: ((o_orderkey = l1.l_orderkey) AND (o_orderstatus = 'F'::bpchar))
                                       Heap Fetches: 0
                           ->  Index Only Scan using q21_idx_1 on lineitem l2  (cost=0.56..2.63 rows=4 width=8) (actual time=0.004..0.004 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
                                 Heap Fetches: 0
 Planning Time: 2.844 ms
 Execution Time: 5875.742 ms
(46 rows)

query 22 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=96524.20..96524.35 rows=1 width=72) (actual time=846.064..859.815 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46821.17..46821.18 rows=1 width=32) (actual time=355.997..356.109 rows=1 loops=1)
           ->  Gather  (cost=46820.74..46821.15 rows=4 width=32) (actual time=352.460..356.095 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.74..45820.75 rows=1 width=32) (actual time=344.100..344.101 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.96 rows=11909 width=6) (actual time=0.350..335.338 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  Finalize GroupAggregate  (cost=49703.02..50830.19 rows=7343 width=72) (actual time=846.063..859.701 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Gather Merge  (cost=49703.02..50628.25 rows=7344 width=72) (actual time=845.564..859.693 rows=5 loops=1)
               Workers Planned: 4
               Params Evaluated: $1
               Workers Launched: 3
               ->  Partial GroupAggregate  (cost=48702.96..48753.45 rows=1836 width=72) (actual time=486.173..487.122 rows=3 loops=4)
                     Group Key: ("substring"((customer.c_phone)::text, 1, 2))
                     ->  Sort  (cost=48702.96..48707.55 rows=1836 width=38) (actual time=485.700..485.972 rows=6772 loops=4)
                           Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
                           Sort Method: quicksort  Memory: 1141kB
                           Worker 0:  Sort Method: quicksort  Memory: 1135kB
                           Worker 1:  Sort Method: quicksort  Memory: 1126kB
                           Worker 2:  Sort Method: quicksort  Memory: 1113kB
                           ->  Nested Loop Anti Join  (cost=0.43..48603.43 rows=1836 width=38) (actual time=0.070..479.356 rows=15877 loops=4)
                                 ->  Parallel Seq Scan on customer  (cost=0.00..45790.96 rows=4375 width=26) (actual time=0.018..171.620 rows=47782 loops=4)
                                       Filter: ((c_acctbal > $1) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                       Rows Removed by Filter: 327218
                                 ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.64 rows=17 width=4) (actual time=0.006..0.006 rows=1 loops=191129)
                                       Index Cond: (o_custkey = customer.c_custkey)
                                       Heap Fetches: 0
 Planning Time: 19.869 ms
 Execution Time: 860.576 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=96524.20..96524.35 rows=1 width=72) (actual time=515.088..528.981 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46821.17..46821.18 rows=1 width=32) (actual time=228.461..228.555 rows=1 loops=1)
           ->  Gather  (cost=46820.74..46821.15 rows=4 width=32) (actual time=225.232..228.538 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.74..45820.75 rows=1 width=32) (actual time=221.053..221.053 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.96 rows=11909 width=6) (actual time=0.016..212.849 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  Finalize GroupAggregate  (cost=49703.02..50830.19 rows=7343 width=72) (actual time=515.087..528.885 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Gather Merge  (cost=49703.02..50628.25 rows=7344 width=72) (actual time=514.590..528.875 rows=5 loops=1)
               Workers Planned: 4
               Params Evaluated: $1
               Workers Launched: 3
               ->  Partial GroupAggregate  (cost=48702.96..48753.45 rows=1836 width=72) (actual time=282.645..283.457 rows=3 loops=4)
                     Group Key: ("substring"((customer.c_phone)::text, 1, 2))
                     ->  Sort  (cost=48702.96..48707.55 rows=1836 width=38) (actual time=282.173..282.420 rows=6186 loops=4)
                           Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
                           Sort Method: quicksort  Memory: 1543kB
                           Worker 0:  Sort Method: quicksort  Memory: 1117kB
                           Worker 1:  Sort Method: quicksort  Memory: 1119kB
                           Worker 2:  Sort Method: quicksort  Memory: 1121kB
                           ->  Nested Loop Anti Join  (cost=0.43..48603.43 rows=1836 width=38) (actual time=0.058..276.783 rows=15877 loops=4)
                                 ->  Parallel Seq Scan on customer  (cost=0.00..45790.96 rows=4375 width=26) (actual time=0.016..155.433 rows=47782 loops=4)
                                       Filter: ((c_acctbal > $1) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                       Rows Removed by Filter: 327218
                                 ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.64 rows=17 width=4) (actual time=0.002..0.002 rows=1 loops=191129)
                                       Index Cond: (o_custkey = customer.c_custkey)
                                       Heap Fetches: 0
 Planning Time: 0.755 ms
 Execution Time: 529.048 ms
(33 rows)

