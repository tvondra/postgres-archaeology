query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832442.35..1832442.98 rows=1 width=236) (actual time=20263.873..20264.932 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832442.35..1832446.16 rows=6 width=236) (actual time=20263.872..20264.930 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832442.35..1832445.22 rows=24 width=236) (actual time=20263.843..20264.905 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831442.29..1831442.30 rows=6 width=236) (actual time=20255.630..20255.631 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1831442.08..1831442.21 rows=6 width=236) (actual time=20255.598..20255.609 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 32kB
                           Worker 0:  Batches: 1  Memory Usage: 32kB
                           Worker 1:  Batches: 1  Memory Usage: 32kB
                           Worker 2:  Batches: 1  Memory Usage: 32kB
                           Worker 3:  Batches: 1  Memory Usage: 32kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312589.48 rows=14824360 width=25) (actual time=0.561..4247.854 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 23.465 ms
 Execution Time: 20266.007 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832442.35..1832442.98 rows=1 width=236) (actual time=19461.305..19461.735 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832442.35..1832446.16 rows=6 width=236) (actual time=19461.304..19461.733 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832442.35..1832445.22 rows=24 width=236) (actual time=19461.273..19461.706 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831442.29..1831442.30 rows=6 width=236) (actual time=19457.052..19457.053 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1831442.08..1831442.21 rows=6 width=236) (actual time=19457.021..19457.029 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 32kB
                           Worker 0:  Batches: 1  Memory Usage: 32kB
                           Worker 1:  Batches: 1  Memory Usage: 32kB
                           Worker 2:  Batches: 1  Memory Usage: 32kB
                           Worker 3:  Batches: 1  Memory Usage: 32kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312589.48 rows=14824360 width=25) (actual time=0.029..2706.692 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 1.107 ms
 Execution Time: 19461.819 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=551588.32..551588.33 rows=1 width=192) (actual time=32564.325..32564.341 rows=100 loops=1)
   ->  Sort  (cost=551588.32..551588.33 rows=1 width=192) (actual time=32564.324..32564.333 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 68kB
         ->  Nested Loop  (cost=52.83..551588.31 rows=1 width=192) (actual time=35.055..32560.513 rows=4737 loops=1)
               Join Filter: (nation.n_nationkey = supplier.s_nationkey)
               Rows Removed by Join Filter: 18948
               ->  Nested Loop  (cost=0.00..2.62 rows=5 width=30) (actual time=0.444..0.452 rows=5 loops=1)
                     Join Filter: (nation.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 20
                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.222..0.223 rows=1 loops=1)
                           Filter: (r_name = 'AMERICA'::bpchar)
                           Rows Removed by Filter: 4
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.217..0.220 rows=25 loops=1)
               ->  Materialize  (cost=52.83..551585.61 rows=1 width=170) (actual time=5.723..6511.029 rows=4737 loops=5)
                     ->  Nested Loop  (cost=52.83..551585.61 rows=1 width=170) (actual time=28.608..32544.130 rows=4737 loops=1)
                           Join Filter: (partsupp.ps_suppkey = supplier.s_suppkey)
                           Rows Removed by Join Filter: 236714834
                           ->  Nested Loop  (cost=52.83..547114.61 rows=1 width=34) (actual time=2.504..1263.996 rows=4737 loops=1)
                                 ->  Index Only Scan using q2_idx_1 on part  (cost=0.43..54326.37 rows=9042 width=30) (actual time=0.320..269.680 rows=8046 loops=1)
                                       Index Cond: (p_size = 16)
                                       Filter: ((p_type)::text ~~ '%NICKEL'::text)
                                       Rows Removed by Filter: 32185
                                       Heap Fetches: 0
                                 ->  Index Only Scan using q2_idx_2 on partsupp  (cost=52.41..54.49 rows=1 width=14) (actual time=0.002..0.002 rows=1 loops=8046)
                                       Index Cond: ((ps_partkey = part.p_partkey) AND (ps_supplycost = (SubPlan 1)))
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Aggregate  (cost=51.96..51.97 rows=1 width=32) (actual time=0.118..0.118 rows=1 loops=8046)
                                               ->  Nested Loop  (cost=2.41..51.95 rows=4 width=6) (actual time=0.104..0.114 rows=1 loops=8046)
                                                     Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                                                     Rows Removed by Join Filter: 3
                                                     ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=8046)
                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                           Rows Removed by Filter: 4
                                                     ->  Hash Join  (cost=2.41..50.65 rows=19 width=10) (actual time=0.086..0.111 rows=4 loops=8046)
                                                           Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                           ->  Nested Loop  (cost=0.85..49.03 rows=19 width=10) (actual time=0.085..0.108 rows=4 loops=8046)
                                                                 ->  Index Only Scan using q2_idx_2 on partsupp partsupp_1  (cost=0.43..2.77 rows=19 width=10) (actual time=0.077..0.079 rows=4 loops=8046)
                                                                       Index Cond: (ps_partkey = part.p_partkey)
                                                                       Heap Fetches: 0
                                                                 ->  Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.42..2.43 rows=1 width=8) (actual time=0.007..0.007 rows=1 loops=32184)
                                                                       Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                                                       Heap Fetches: 0
                                                           ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.009..0.010 rows=25 loops=1)
                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                 ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.002..0.005 rows=25 loops=1)
                           ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.001..2.659 rows=49972 loops=4737)
 Planning Time: 31.815 ms
 Execution Time: 32565.171 ms
(50 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=551588.32..551588.33 rows=1 width=192) (actual time=30714.037..30714.051 rows=100 loops=1)
   ->  Sort  (cost=551588.32..551588.33 rows=1 width=192) (actual time=30714.036..30714.044 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 68kB
         ->  Nested Loop  (cost=52.83..551588.31 rows=1 width=192) (actual time=14.832..30711.122 rows=4737 loops=1)
               Join Filter: (nation.n_nationkey = supplier.s_nationkey)
               Rows Removed by Join Filter: 18948
               ->  Nested Loop  (cost=0.00..2.62 rows=5 width=30) (actual time=0.009..0.016 rows=5 loops=1)
                     Join Filter: (nation.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 20
                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                           Filter: (r_name = 'AMERICA'::bpchar)
                           Rows Removed by Filter: 4
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.004 rows=25 loops=1)
               ->  Materialize  (cost=52.83..551585.61 rows=1 width=170) (actual time=2.215..6141.273 rows=4737 loops=5)
                     ->  Nested Loop  (cost=52.83..551585.61 rows=1 width=170) (actual time=11.074..30695.371 rows=4737 loops=1)
                           Join Filter: (partsupp.ps_suppkey = supplier.s_suppkey)
                           Rows Removed by Join Filter: 236714834
                           ->  Nested Loop  (cost=52.83..547114.61 rows=1 width=34) (actual time=0.072..319.850 rows=4737 loops=1)
                                 ->  Index Only Scan using q2_idx_1 on part  (cost=0.43..54326.37 rows=9042 width=30) (actual time=0.018..85.925 rows=8046 loops=1)
                                       Index Cond: (p_size = 16)
                                       Filter: ((p_type)::text ~~ '%NICKEL'::text)
                                       Rows Removed by Filter: 32185
                                       Heap Fetches: 0
                                 ->  Index Only Scan using q2_idx_2 on partsupp  (cost=52.41..54.49 rows=1 width=14) (actual time=0.001..0.002 rows=1 loops=8046)
                                       Index Cond: ((ps_partkey = part.p_partkey) AND (ps_supplycost = (SubPlan 1)))
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Aggregate  (cost=51.96..51.97 rows=1 width=32) (actual time=0.024..0.024 rows=1 loops=8046)
                                               ->  Nested Loop  (cost=2.41..51.95 rows=4 width=6) (actual time=0.017..0.020 rows=1 loops=8046)
                                                     Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                                                     Rows Removed by Join Filter: 3
                                                     ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=8046)
                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                           Rows Removed by Filter: 4
                                                     ->  Hash Join  (cost=2.41..50.65 rows=19 width=10) (actual time=0.009..0.018 rows=4 loops=8046)
                                                           Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                           ->  Nested Loop  (cost=0.85..49.03 rows=19 width=10) (actual time=0.008..0.016 rows=4 loops=8046)
                                                                 ->  Index Only Scan using q2_idx_2 on partsupp partsupp_1  (cost=0.43..2.77 rows=19 width=10) (actual time=0.004..0.005 rows=4 loops=8046)
                                                                       Index Cond: (ps_partkey = part.p_partkey)
                                                                       Heap Fetches: 0
                                                                 ->  Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.42..2.43 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=32184)
                                                                       Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                                                       Heap Fetches: 0
                                                           ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.009..0.010 rows=25 loops=1)
                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                 ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.001..0.005 rows=25 loops=1)
                           ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.001..2.651 rows=49972 loops=4737)
 Planning Time: 2.364 ms
 Execution Time: 30714.138 ms
(50 rows)

query 3 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2327089.21..2327089.24 rows=10 width=44) (actual time=9545.717..9556.487 rows=10 loops=1)
   ->  Sort  (cost=2327089.21..2334982.96 rows=3157500 width=44) (actual time=9545.715..9556.484 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1793963.39..2258856.77 rows=3157500 width=44) (actual time=9323.667..9535.255 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1793963.39..2172025.52 rows=3157500 width=24) (actual time=9323.653..9375.983 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1792963.34..1794936.77 rows=789375 width=24) (actual time=9313.431..9316.482 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 6285kB
                           Worker 0:  Sort Method: quicksort  Memory: 6195kB
                           Worker 1:  Sort Method: quicksort  Memory: 6304kB
                           Worker 2:  Sort Method: quicksort  Memory: 6246kB
                           Worker 3:  Sort Method: quicksort  Memory: 6210kB
                           ->  Parallel Hash Join  (cost=359044.77..1704077.67 rows=789375 width=24) (actual time=2297.061..9295.711 rows=60306 loops=5)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..1312589.48 rows=8125330 width=16) (actual time=0.521..6169.047 rows=6506846 loops=5)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 5490365
                                 ->  Parallel Hash  (cost=354491.17..354491.17 rows=364288 width=12) (actual time=2293.227..2293.407 rows=290361 loops=5)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 84608kB
                                       ->  Parallel Hash Join  (cost=41572.41..354491.17 rows=364288 width=12) (actual time=262.797..2189.579 rows=290361 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308139.86 rows=1820527 width=16) (actual time=0.621..1567.239 rows=1447887 loops=5)
                                                   Filter: (o_orderdate < '1995-03-07'::date)
                                                   Rows Removed by Filter: 1552113
                                             ->  Parallel Hash  (cost=40634.45..40634.45 rows=75037 width=4) (actual time=261.652..261.653 rows=60055 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                   ->  Parallel Seq Scan on customer  (cost=0.00..40634.45 rows=75037 width=4) (actual time=0.312..241.615 rows=60055 loops=5)
                                                         Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                         Rows Removed by Filter: 239945
 Planning Time: 28.042 ms
 Execution Time: 9556.925 ms
(35 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2327089.21..2327089.24 rows=10 width=44) (actual time=4780.629..4790.899 rows=10 loops=1)
   ->  Sort  (cost=2327089.21..2334982.96 rows=3157500 width=44) (actual time=4780.628..4790.897 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1793963.39..2258856.77 rows=3157500 width=44) (actual time=4558.550..4769.796 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1793963.39..2172025.52 rows=3157500 width=24) (actual time=4558.537..4609.290 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1792963.34..1794936.77 rows=789375 width=24) (actual time=4553.296..4556.415 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 6079kB
                           Worker 0:  Sort Method: quicksort  Memory: 6192kB
                           Worker 1:  Sort Method: quicksort  Memory: 6332kB
                           Worker 2:  Sort Method: quicksort  Memory: 6448kB
                           Worker 3:  Sort Method: quicksort  Memory: 6188kB
                           ->  Parallel Hash Join  (cost=359044.77..1704077.67 rows=789375 width=24) (actual time=1117.532..4533.664 rows=60306 loops=5)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..1312589.48 rows=8125330 width=16) (actual time=0.040..2420.640 rows=6506846 loops=5)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 5490365
                                 ->  Parallel Hash  (cost=354491.17..354491.17 rows=364288 width=12) (actual time=1115.137..1115.295 rows=290361 loops=5)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 84576kB
                                       ->  Parallel Hash Join  (cost=41572.41..354491.17 rows=364288 width=12) (actual time=89.299..984.485 rows=290361 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308139.86 rows=1820527 width=16) (actual time=0.052..498.274 rows=1447887 loops=5)
                                                   Filter: (o_orderdate < '1995-03-07'::date)
                                                   Rows Removed by Filter: 1552113
                                             ->  Parallel Hash  (cost=40634.45..40634.45 rows=75037 width=4) (actual time=88.582..88.583 rows=60055 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                   ->  Parallel Seq Scan on customer  (cost=0.00..40634.45 rows=75037 width=4) (actual time=0.018..67.502 rows=60055 loops=5)
                                                         Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                         Rows Removed by Filter: 239945
 Planning Time: 2.210 ms
 Execution Time: 4790.969 ms
(35 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283943.27..550355.84 rows=1 width=24) (actual time=10362.160..10389.893 rows=1 loops=1)
   ->  GroupAggregate  (cost=283943.27..1616006.11 rows=5 width=24) (actual time=10362.158..10389.890 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283943.27..1613089.82 rows=583248 width=16) (actual time=4242.246..10346.786 rows=103030 loops=1)
               ->  Gather Merge  (cost=283942.83..353793.03 rows=583375 width=20) (actual time=4241.222..4336.091 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282942.77..283307.38 rows=145844 width=20) (actual time=4229.365..4232.330 rows=23328 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 11785kB
                           Worker 0:  Sort Method: quicksort  Memory: 11732kB
                           Worker 1:  Sort Method: quicksort  Memory: 12023kB
                           Worker 2:  Sort Method: quicksort  Memory: 11839kB
                           Worker 3:  Sort Method: quicksort  Memory: 11767kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6978.03..270433.68 rows=145844 width=20) (actual time=130.978..4177.774 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46127
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6832.19 rows=583375 width=0) (actual time=86.324..86.325 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Only Scan using q4_idx_1 on lineitem  (cost=0.44..2.44 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Heap Fetches: 0
 Planning Time: 26.857 ms
 Execution Time: 10390.900 ms
(24 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283943.27..550355.84 rows=1 width=24) (actual time=1157.703..1184.695 rows=1 loops=1)
   ->  GroupAggregate  (cost=283943.27..1616006.11 rows=5 width=24) (actual time=1157.701..1184.692 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283943.27..1613089.82 rows=583248 width=16) (actual time=707.235..1170.074 rows=103030 loops=1)
               ->  Gather Merge  (cost=283942.83..353793.03 rows=583375 width=20) (actual time=707.181..765.266 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282942.77..283307.38 rows=145844 width=20) (actual time=698.402..700.725 rows=23429 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 13015kB
                           Worker 0:  Sort Method: quicksort  Memory: 12265kB
                           Worker 1:  Sort Method: quicksort  Memory: 11519kB
                           Worker 2:  Sort Method: quicksort  Memory: 10735kB
                           Worker 3:  Sort Method: quicksort  Memory: 11610kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6978.03..270433.68 rows=145844 width=20) (actual time=128.114..658.356 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=52655
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6832.19 rows=583375 width=0) (actual time=82.281..82.282 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Only Scan using q4_idx_1 on lineitem  (cost=0.44..2.44 rows=1 width=4) (actual time=0.003..0.003 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Heap Fetches: 0
 Planning Time: 2.201 ms
 Execution Time: 1184.757 ms
(24 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=650943.83..650943.83 rows=1 width=58) (actual time=7500.493..7545.608 rows=1 loops=1)
   ->  Sort  (cost=650943.83..650943.89 rows=25 width=58) (actual time=7500.492..7545.606 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=650704.29..650943.70 rows=25 width=58) (actual time=7490.694..7545.589 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=650704.29..650942.64 rows=100 width=58) (actual time=7489.184..7545.553 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=649704.24..649930.67 rows=25 width=58) (actual time=7474.560..7480.862 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=649704.24..649749.46 rows=18090 width=38) (actual time=7473.256..7473.928 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1505kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1501kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1494kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1520kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1530kB
                                 ->  Parallel Hash Join  (cost=73537.03..648425.01 rows=18090 width=38) (actual time=551.707..7461.939 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69845.44..642359.06 rows=452257 width=50) (actual time=533.986..7322.815 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69844.87..341997.69 rows=113089 width=38) (actual time=533.662..5139.873 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=27051.69..296801.37 rows=565445 width=8) (actual time=261.634..4656.063 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52329
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..26486.25 rows=2261781 width=0) (actual time=203.355..203.355 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.69..41855.69 rows=74999 width=38) (actual time=271.377..271.380 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.69 rows=74999 width=38) (actual time=0.875..244.948 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.96 rows=374996 width=8) (actual time=0.228..205.013 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.636..0.638 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.629..0.636 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.273..0.275 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.349..0.349 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.345..0.346 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Only Scan using q5_idx_1 on lineitem  (cost=0.56..2.62 rows=4 width=20) (actual time=0.022..0.023 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.585..15.585 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5088kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.161..9.724 rows=20000 loops=5)
 Planning Time: 35.993 ms
 Execution Time: 7545.953 ms
(51 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=650943.83..650943.83 rows=1 width=58) (actual time=2080.589..2125.126 rows=1 loops=1)
   ->  Sort  (cost=650943.83..650943.89 rows=25 width=58) (actual time=2080.587..2125.123 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=650704.29..650943.70 rows=25 width=58) (actual time=2069.850..2125.102 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=650704.29..650942.64 rows=100 width=58) (actual time=2067.102..2125.055 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=649704.24..649930.67 rows=25 width=58) (actual time=2056.806..2062.890 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=649704.24..649749.46 rows=18090 width=38) (actual time=2055.514..2056.250 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1616kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1437kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1490kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1318kB
                                 Worker 3:  Sort Method: quicksort  Memory: 2072kB
                                 ->  Parallel Hash Join  (cost=73537.03..648425.01 rows=18090 width=38) (actual time=419.218..2047.277 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69845.44..642359.06 rows=452257 width=50) (actual time=402.172..1913.680 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69844.87..341997.69 rows=113089 width=38) (actual time=402.124..1009.833 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=27051.69..296801.37 rows=565445 width=8) (actual time=245.748..682.906 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=56926
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..26486.25 rows=2261781 width=0) (actual time=190.191..190.191 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.69..41855.69 rows=74999 width=38) (actual time=155.711..155.713 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.69 rows=74999 width=38) (actual time=0.081..128.700 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.96 rows=374996 width=8) (actual time=0.032..90.164 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.038..0.039 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.031..0.037 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.014..0.016 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.012..0.012 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Only Scan using q5_idx_1 on lineitem  (cost=0.56..2.62 rows=4 width=20) (actual time=0.008..0.009 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=16.555..16.556 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.032..9.823 rows=20000 loops=5)
 Planning Time: 6.119 ms
 Execution Time: 2125.224 ms
(51 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1376523.95..1376523.96 rows=1 width=32) (actual time=10748.988..10789.869 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1376523.95..1376523.96 rows=1 width=32) (actual time=10748.987..10789.866 rows=1 loops=1)
         ->  Gather  (cost=1376523.52..1376523.93 rows=4 width=32) (actual time=10742.626..10789.846 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1375523.52..1375523.53 rows=1 width=32) (actual time=10733.815..10733.816 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=233576.31..1374019.41 rows=300820 width=12) (actual time=1460.096..10582.766 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=80732 lossy=54145
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..233275.49 rows=1203280 width=0) (actual time=1375.835..1375.835 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 22.248 ms
 Execution Time: 10790.850 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1376523.95..1376523.96 rows=1 width=32) (actual time=3279.980..3324.044 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1376523.95..1376523.96 rows=1 width=32) (actual time=3279.979..3324.041 rows=1 loops=1)
         ->  Gather  (cost=1376523.52..1376523.93 rows=4 width=32) (actual time=3276.324..3324.023 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1375523.52..1375523.53 rows=1 width=32) (actual time=3272.132..3272.133 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=233576.31..1374019.41 rows=300820 width=12) (actual time=1324.915..3168.698 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=77430 lossy=52404
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..233275.49 rows=1203280 width=0) (actual time=1236.573..1236.573 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 1.308 ms
 Execution Time: 3324.153 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420609.97..1421662.09 rows=1 width=116) (actual time=33668.995..33674.332 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420609.97..11967053.31 rows=10024 width=116) (actual time=33668.994..33674.330 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420609.97..11965994.21 rows=60583 width=96) (actual time=7184.568..33644.146 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349052
               ->  Nested Loop  (cost=1420609.54..8277865.60 rows=1514576 width=76) (actual time=7160.663..28552.631 rows=363473 loops=1)
                     ->  Gather Merge  (cost=1420609.11..1601956.32 rows=1514576 width=76) (actual time=7159.369..7633.161 rows=363473 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419609.05..1420555.66 rows=378644 width=76) (actual time=7129.654..7173.081 rows=73131 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 27216kB
                                 Worker 0:  Sort Method: external merge  Disk: 26296kB
                                 Worker 1:  Sort Method: external merge  Disk: 27024kB
                                 Worker 2:  Sort Method: external merge  Disk: 26632kB
                                 Worker 3:  Sort Method: external merge  Disk: 26776kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372506.77 rows=378644 width=76) (actual time=17.586..6822.464 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350078.77 rows=4549260 width=24) (actual time=0.466..6207.471 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=16.769..16.772 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 992kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.304..15.686 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.223..13.329 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.072..0.074 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.063..0.069 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.053..0.054 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.003..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.006 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=8) (actual time=0.057..0.057 rows=1 loops=363473)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.013..0.013 rows=1 loops=363473)
                     Index Cond: (c_custkey = orders.o_custkey)
                     Heap Fetches: 0
 Planning Time: 34.577 ms
 Execution Time: 33678.400 ms
(46 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420609.97..1421662.09 rows=1 width=116) (actual time=5648.437..5654.339 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420609.97..11967053.31 rows=10024 width=116) (actual time=5648.436..5654.337 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420609.97..11965994.21 rows=60583 width=96) (actual time=3594.437..5640.886 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349054
               ->  Nested Loop  (cost=1420609.54..8277865.60 rows=1514576 width=76) (actual time=3594.221..4764.348 rows=363475 loops=1)
                     ->  Gather Merge  (cost=1420609.11..1601956.32 rows=1514576 width=76) (actual time=3594.167..3829.777 rows=363475 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419609.05..1420555.66 rows=378644 width=76) (actual time=3566.935..3596.882 rows=73102 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 28008kB
                                 Worker 0:  Sort Method: external merge  Disk: 22984kB
                                 Worker 1:  Sort Method: external merge  Disk: 27056kB
                                 Worker 2:  Sort Method: external merge  Disk: 27904kB
                                 Worker 3:  Sort Method: external merge  Disk: 28000kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372506.77 rows=378644 width=76) (actual time=13.222..3205.772 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350078.77 rows=4549260 width=24) (actual time=0.049..2532.192 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=11.589..11.591 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 928kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.062..10.974 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.025..6.351 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.031..0.033 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.021..0.028 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.013 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.003..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.007 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363475)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363475)
                     Index Cond: (c_custkey = orders.o_custkey)
                     Heap Fetches: 0
 Planning Time: 4.875 ms
 Execution Time: 5658.231 ms
(46 rows)

query 8 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=384877.94..385032.12 rows=1 width=64) (actual time=6955.695..6963.762 rows=1 loops=1)
   ->  GroupAggregate  (cost=384877.94..755837.22 rows=2406 width=64) (actual time=6955.694..6963.761 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=384877.94..755306.54 rows=24128 width=70) (actual time=3086.436..6945.392 rows=11818 loops=1)
               ->  Nested Loop  (cost=384877.79..754627.30 rows=24128 width=20) (actual time=3086.427..6926.703 rows=11818 loops=1)
                     ->  Nested Loop  (cost=384877.37..696439.72 rows=24128 width=20) (actual time=3086.097..6714.103 rows=11818 loops=1)
                           Join Filter: (n1.n_regionkey = region.r_regionkey)
                           Rows Removed by Join Filter: 47509
                           ->  Nested Loop  (cost=384877.37..694629.04 rows=120641 width=24) (actual time=3085.489..6686.609 rows=59327 loops=1)
                                 ->  Nested Loop  (cost=384877.22..691650.75 rows=120641 width=24) (actual time=3085.243..6624.293 rows=59327 loops=1)
                                       ->  Gather Merge  (cost=384876.80..399321.70 rows=120641 width=24) (actual time=3084.729..3135.778 rows=59327 loops=1)
                                             Workers Planned: 4
                                             Workers Launched: 4
                                             ->  Sort  (cost=383876.74..383952.14 rows=30160 width=24) (actual time=3075.245..3076.502 rows=12606 loops=5)
                                                   Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                                   Sort Method: quicksort  Memory: 2623kB
                                                   Worker 0:  Sort Method: quicksort  Memory: 2626kB
                                                   Worker 1:  Sort Method: quicksort  Memory: 2619kB
                                                   Worker 2:  Sort Method: quicksort  Memory: 2680kB
                                                   Worker 3:  Sort Method: quicksort  Memory: 2560kB
                                                   ->  Parallel Hash Join  (cost=59791.34..381632.78 rows=30160 width=24) (actual time=1161.476..3062.086 rows=23719 loops=5)
                                                         Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..317514.23 rows=1133817 width=12) (actual time=0.581..1667.854 rows=911503 loops=5)
                                                               Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                               Rows Removed by Filter: 2088497
                                                         ->  Parallel Hash  (cost=58544.51..58544.51 rows=99746 width=20) (actual time=1159.734..1159.736 rows=77904 loops=5)
                                                               Buckets: 524288  Batches: 1  Memory Usage: 25504kB
                                                               ->  Nested Loop  (cost=0.56..58544.51 rows=99746 width=20) (actual time=0.899..1130.719 rows=77904 loops=5)
                                                                     ->  Parallel Seq Scan on part  (cost=0.00..47230.91 rows=3326 width=4) (actual time=0.333..140.706 rows=2602 loops=5)
                                                                           Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                           Rows Removed by Filter: 397398
                                                                     ->  Index Only Scan using q8_idx_1 on lineitem  (cost=0.56..3.09 rows=31 width=24) (actual time=0.312..0.377 rows=30 loops=13011)
                                                                           Index Cond: (l_partkey = part.p_partkey)
                                                                           Heap Fetches: 0
                                       ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.058..0.058 rows=1 loops=59327)
                                             Index Cond: (c_custkey = orders.o_custkey)
                                             Heap Fetches: 0
                                 ->  Memoize  (cost=0.15..1.17 rows=1 width=8) (actual time=0.000..0.000 rows=1 loops=59327)
                                       Cache Key: customer.c_nationkey
                                       Cache Mode: logical
                                       Hits: 59302  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 3kB
                                       ->  Index Scan using nation_pkey on nation n1  (cost=0.14..1.16 rows=1 width=8) (actual time=0.013..0.013 rows=1 loops=25)
                                             Index Cond: (n_nationkey = customer.c_nationkey)
                           ->  Materialize  (cost=0.00..1.07 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=59327)
                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.201..0.203 rows=1 loops=1)
                                       Filter: (r_name = 'AMERICA'::bpchar)
                                       Rows Removed by Filter: 4
                     ->  Index Only Scan using q2_idx_3 on supplier  (cost=0.42..2.41 rows=1 width=8) (actual time=0.017..0.017 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
                           Heap Fetches: 0
               ->  Memoize  (cost=0.15..1.17 rows=1 width=30) (actual time=0.000..0.000 rows=1 loops=11818)
                     Cache Key: supplier.s_nationkey
                     Cache Mode: logical
                     Hits: 11793  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 4kB
                     ->  Index Scan using nation_pkey on nation n2  (cost=0.14..1.16 rows=1 width=30) (actual time=0.004..0.004 rows=1 loops=25)
                           Index Cond: (n_nationkey = supplier.s_nationkey)
 Planning Time: 39.736 ms
 Execution Time: 6964.118 ms
(58 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=384877.94..385032.12 rows=1 width=64) (actual time=1195.294..1206.586 rows=1 loops=1)
   ->  GroupAggregate  (cost=384877.94..755837.22 rows=2406 width=64) (actual time=1195.293..1206.584 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=384877.94..755306.54 rows=24128 width=70) (actual time=944.301..1198.024 rows=11818 loops=1)
               ->  Nested Loop  (cost=384877.79..754627.30 rows=24128 width=20) (actual time=944.286..1188.728 rows=11818 loops=1)
                     ->  Nested Loop  (cost=384877.37..696439.72 rows=24128 width=20) (actual time=944.272..1163.107 rows=11818 loops=1)
                           Join Filter: (n1.n_regionkey = region.r_regionkey)
                           Rows Removed by Join Filter: 47508
                           ->  Nested Loop  (cost=384877.37..694629.04 rows=120641 width=24) (actual time=944.205..1147.665 rows=59326 loops=1)
                                 ->  Nested Loop  (cost=384877.22..691650.75 rows=120641 width=24) (actual time=944.190..1120.746 rows=59326 loops=1)
                                       ->  Gather Merge  (cost=384876.80..399321.70 rows=120641 width=24) (actual time=944.147..976.628 rows=59326 loops=1)
                                             Workers Planned: 4
                                             Workers Launched: 4
                                             ->  Sort  (cost=383876.74..383952.14 rows=30160 width=24) (actual time=938.222..939.046 rows=12577 loops=5)
                                                   Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                                   Sort Method: quicksort  Memory: 2900kB
                                                   Worker 0:  Sort Method: quicksort  Memory: 2654kB
                                                   Worker 1:  Sort Method: quicksort  Memory: 2320kB
                                                   Worker 2:  Sort Method: quicksort  Memory: 2399kB
                                                   Worker 3:  Sort Method: quicksort  Memory: 2835kB
                                                   ->  Parallel Hash Join  (cost=59791.34..381632.78 rows=30160 width=24) (actual time=152.583..921.903 rows=23719 loops=5)
                                                         Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..317514.23 rows=1133817 width=12) (actual time=0.265..507.599 rows=911503 loops=5)
                                                               Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                               Rows Removed by Filter: 2088497
                                                         ->  Parallel Hash  (cost=58544.51..58544.51 rows=99746 width=20) (actual time=151.496..151.497 rows=77904 loops=5)
                                                               Buckets: 524288  Batches: 1  Memory Usage: 25536kB
                                                               ->  Nested Loop  (cost=0.56..58544.51 rows=99746 width=20) (actual time=0.055..115.168 rows=77904 loops=5)
                                                                     ->  Parallel Seq Scan on part  (cost=0.00..47230.91 rows=3326 width=4) (actual time=0.026..68.872 rows=2602 loops=5)
                                                                           Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                           Rows Removed by Filter: 397398
                                                                     ->  Index Only Scan using q8_idx_1 on lineitem  (cost=0.56..3.09 rows=31 width=24) (actual time=0.006..0.014 rows=30 loops=13011)
                                                                           Index Cond: (l_partkey = part.p_partkey)
                                                                           Heap Fetches: 0
                                       ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=59326)
                                             Index Cond: (c_custkey = orders.o_custkey)
                                             Heap Fetches: 0
                                 ->  Memoize  (cost=0.15..1.17 rows=1 width=8) (actual time=0.000..0.000 rows=1 loops=59326)
                                       Cache Key: customer.c_nationkey
                                       Cache Mode: logical
                                       Hits: 59301  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 3kB
                                       ->  Index Scan using nation_pkey on nation n1  (cost=0.14..1.16 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=25)
                                             Index Cond: (n_nationkey = customer.c_nationkey)
                           ->  Materialize  (cost=0.00..1.07 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=59326)
                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                       Filter: (r_name = 'AMERICA'::bpchar)
                                       Rows Removed by Filter: 4
                     ->  Index Only Scan using q2_idx_3 on supplier  (cost=0.42..2.41 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
                           Heap Fetches: 0
               ->  Memoize  (cost=0.15..1.17 rows=1 width=30) (actual time=0.000..0.000 rows=1 loops=11818)
                     Cache Key: supplier.s_nationkey
                     Cache Mode: logical
                     Hits: 11793  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 4kB
                     ->  Index Scan using nation_pkey on nation n2  (cost=0.14..1.16 rows=1 width=30) (actual time=0.001..0.001 rows=1 loops=25)
                           Index Cond: (n_nationkey = supplier.s_nationkey)
 Planning Time: 6.191 ms
 Execution Time: 1206.698 ms
(58 rows)

query 9 run 1
SET
SET
SET
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=599917.00..600047.19 rows=1 width=90) (actual time=11359.709..11488.842 rows=1 loops=1)
   ->  GroupAggregate  (cost=599917.00..8430868.94 rows=60150 width=90) (actual time=11359.707..11488.840 rows=1 loops=1)
         Group Key: nation.n_name, EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=599917.00..8376951.33 rows=3029449 width=81) (actual time=10147.183..11466.922 rows=11401 loops=1)
               Join Filter: (supplier.s_suppkey = partsupp.ps_suppkey)
               ->  Gather Merge  (cost=599916.56..962646.55 rows=3029449 width=63) (actual time=10146.509..10291.263 rows=11401 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=598916.51..600809.91 rows=757362 width=63) (actual time=10071.829..10073.733 rows=2774 loops=5)
                           Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
                           Sort Method: external merge  Disk: 49872kB
                           Worker 0:  Sort Method: external merge  Disk: 54296kB
                           Worker 1:  Sort Method: external merge  Disk: 50840kB
                           Worker 2:  Sort Method: external merge  Disk: 53840kB
                           Worker 3:  Sort Method: external merge  Disk: 48416kB
                           ->  Hash Join  (cost=150371.03..504617.75 rows=757362 width=63) (actual time=7083.053..8749.010 rows=649638 loops=5)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=150369.47..502291.09 rows=757362 width=41) (actual time=7082.931..8494.027 rows=649638 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Hash Join  (cost=146824.93..496758.39 rows=757362 width=33) (actual time=7066.479..8153.676 rows=649638 loops=5)
                                             Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..298765.49 rows=3749749 width=8) (actual time=0.519..1550.560 rows=3000000 loops=5)
                                             ->  Parallel Hash  (cost=131440.91..131440.91 rows=757362 width=33) (actual time=4967.317..4967.318 rows=649638 loops=5)
                                                   Buckets: 524288  Batches: 8  Memory Usage: 32736kB
                                                   ->  Nested Loop  (cost=0.99..131440.91 rows=757362 width=33) (actual time=0.941..4767.396 rows=649638 loops=5)
                                                         ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.19 rows=25252 width=4) (actual time=0.122..165.974 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                               Heap Fetches: 0
                                                         ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..3.09 rows=31 width=29) (actual time=0.180..0.209 rows=30 loops=108312)
                                                               Index Cond: (l_partkey = part.p_partkey)
                                                               Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.621..15.621 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5056kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.076..9.964 rows=20000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.055..0.055 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.044..0.047 rows=25 loops=5)
               ->  Index Only Scan using q2_idx_2 on partsupp  (cost=0.43..2.43 rows=1 width=14) (actual time=0.101..0.101 rows=1 loops=11401)
                     Index Cond: ((ps_partkey = lineitem.l_partkey) AND (ps_suppkey = lineitem.l_suppkey))
                     Heap Fetches: 0
 Planning Time: 46.212 ms
 Execution Time: 11496.533 ms
(43 rows)

SET
SET
SET
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=599917.00..600047.19 rows=1 width=90) (actual time=5001.340..5126.877 rows=1 loops=1)
   ->  GroupAggregate  (cost=599917.00..8430868.94 rows=60150 width=90) (actual time=5001.339..5126.875 rows=1 loops=1)
         Group Key: nation.n_name, EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=599917.00..8376951.33 rows=3029449 width=81) (actual time=4947.639..5117.385 rows=11401 loops=1)
               Join Filter: (supplier.s_suppkey = partsupp.ps_suppkey)
               ->  Gather Merge  (cost=599916.56..962646.55 rows=3029449 width=63) (actual time=4947.583..5079.442 rows=11401 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=598916.51..600809.91 rows=757362 width=63) (actual time=4913.900..4915.415 rows=2760 loops=5)
                           Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
                           Sort Method: external merge  Disk: 46344kB
                           Worker 0:  Sort Method: external merge  Disk: 52288kB
                           Worker 1:  Sort Method: external merge  Disk: 50824kB
                           Worker 2:  Sort Method: external merge  Disk: 53160kB
                           Worker 3:  Sort Method: external merge  Disk: 54648kB
                           ->  Hash Join  (cost=150371.03..504617.75 rows=757362 width=63) (actual time=1906.400..3606.971 rows=649638 loops=5)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=150369.47..502291.09 rows=757362 width=41) (actual time=1906.318..3358.201 rows=649638 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Hash Join  (cost=146824.93..496758.39 rows=757362 width=33) (actual time=1894.956..3015.831 rows=649638 loops=5)
                                             Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..298765.49 rows=3749749 width=8) (actual time=0.056..536.972 rows=3000000 loops=5)
                                             ->  Parallel Hash  (cost=131440.91..131440.91 rows=757362 width=33) (actual time=715.991..715.992 rows=649638 loops=5)
                                                   Buckets: 524288  Batches: 8  Memory Usage: 32736kB
                                                   ->  Nested Loop  (cost=0.99..131440.91 rows=757362 width=33) (actual time=0.071..531.344 rows=649638 loops=5)
                                                         ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.19 rows=25252 width=4) (actual time=0.043..167.467 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                               Heap Fetches: 0
                                                         ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..3.09 rows=31 width=29) (actual time=0.005..0.014 rows=30 loops=108312)
                                                               Index Cond: (l_partkey = part.p_partkey)
                                                               Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=10.740..10.741 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.008..3.445 rows=20000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.020..0.021 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.008..0.011 rows=25 loops=5)
               ->  Index Only Scan using q2_idx_2 on partsupp  (cost=0.43..2.43 rows=1 width=14) (actual time=0.003..0.003 rows=1 loops=11401)
                     Index Cond: ((ps_partkey = lineitem.l_partkey) AND (ps_suppkey = lineitem.l_suppkey))
                     Heap Fetches: 0
 Planning Time: 8.129 ms
 Execution Time: 5134.049 ms
(43 rows)

query 10 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=779504.79..779504.84 rows=20 width=201) (actual time=8104.738..8155.433 rows=20 loops=1)
   ->  Sort  (cost=779504.79..780886.28 rows=552596 width=201) (actual time=8104.736..8155.429 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=684820.63..764800.41 rows=552596 width=201) (actual time=6998.719..8029.816 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=684820.63..750985.51 rows=552596 width=181) (actual time=6998.702..7270.739 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=683820.57..684165.94 rows=138149 width=181) (actual time=6977.679..7006.192 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 42464kB
                           Worker 0:  Sort Method: external merge  Disk: 44328kB
                           Worker 1:  Sort Method: external merge  Disk: 43072kB
                           Worker 2:  Sort Method: external merge  Disk: 39904kB
                           Worker 3:  Sort Method: external merge  Disk: 48760kB
                           ->  Hash Join  (cost=628746.58..672025.50 rows=138149 width=181) (actual time=6484.916..6842.400 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=628745.02..671599.82 rows=138149 width=159) (actual time=6484.798..6790.892 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.96 rows=374996 width=147) (actual time=0.252..144.681 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=627018.16..627018.16 rows=138149 width=16) (actual time=6483.476..6483.478 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85216kB
                                             ->  Nested Loop  (cost=6631.77..627018.16 rows=138149 width=16) (actual time=136.104..6355.141 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6631.21..269978.27 rows=138604 width=8) (actual time=133.713..4125.126 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46478
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6492.61 rows=554417 width=0) (actual time=86.215..86.215 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Only Scan using q10_idx_2 on lineitem  (cost=0.56..2.57 rows=1 width=16) (actual time=0.018..0.018 rows=2 loops=573160)
                                                         Index Cond: ((l_orderkey = orders.o_orderkey) AND (l_returnflag = 'R'::bpchar))
                                                         Heap Fetches: 0
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.055..0.056 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.047..0.050 rows=25 loops=5)
 Planning Time: 32.268 ms
 Execution Time: 8161.419 ms
(37 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=779504.79..779504.84 rows=20 width=201) (actual time=3178.112..3231.749 rows=20 loops=1)
   ->  Sort  (cost=779504.79..780886.28 rows=552596 width=201) (actual time=3178.111..3231.745 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=684820.63..764800.41 rows=552596 width=201) (actual time=2053.177..3105.578 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=684820.63..750985.51 rows=552596 width=181) (actual time=2053.157..2329.620 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=683820.57..684165.94 rows=138149 width=181) (actual time=2036.900..2063.591 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 50376kB
                           Worker 0:  Sort Method: external merge  Disk: 39040kB
                           Worker 1:  Sort Method: external merge  Disk: 46392kB
                           Worker 2:  Sort Method: external merge  Disk: 42432kB
                           Worker 3:  Sort Method: external merge  Disk: 40304kB
                           ->  Hash Join  (cost=628746.58..672025.50 rows=138149 width=181) (actual time=1607.043..1898.357 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=628745.02..671599.82 rows=138149 width=159) (actual time=1606.962..1840.588 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.96 rows=374996 width=147) (actual time=0.027..65.759 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=627018.16..627018.16 rows=138149 width=16) (actual time=1605.386..1605.387 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6631.77..627018.16 rows=138149 width=16) (actual time=131.681..1495.215 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6631.21..269978.27 rows=138604 width=8) (actual time=131.603..501.917 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=53146
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6492.61 rows=554417 width=0) (actual time=82.331..82.331 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Only Scan using q10_idx_2 on lineitem  (cost=0.56..2.57 rows=1 width=16) (actual time=0.008..0.008 rows=2 loops=573160)
                                                         Index Cond: ((l_orderkey = orders.o_orderkey) AND (l_returnflag = 'R'::bpchar))
                                                         Heap Fetches: 0
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.018..0.019 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.010..0.013 rows=25 loops=5)
 Planning Time: 2.954 ms
 Execution Time: 3238.561 ms
(37 rows)

query 11 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=467705.99..467705.99 rows=1 width=36) (actual time=1881.721..1881.859 rows=0 loops=1)
   InitPlan 1 (returns $2)
     ->  Finalize Aggregate  (cost=207467.76..207467.77 rows=1 width=32) (actual time=462.537..462.619 rows=1 loops=1)
           ->  Gather  (cost=207467.33..207467.74 rows=4 width=32) (actual time=462.432..462.609 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=206467.33..206467.34 rows=1 width=32) (actual time=459.484..459.487 rows=1 loops=4)
                       ->  Hash Join  (cost=2341.31..205867.24 rows=80011 width=10) (actual time=4.027..433.450 rows=80200 loops=4)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195224.77 rows=2000278 width=14) (actual time=0.032..210.549 rows=2000000 loops=4)
                             ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=3.930..3.931 rows=4010 loops=4)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=0.518..3.466 rows=4010 loops=4)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.011..0.013 rows=1 loops=4)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=39.29..2250.00 rows=4000 width=8) (actual time=0.504..3.057 rows=4010 loops=4)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.287..0.287 rows=4010 loops=4)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=260238.22..260504.92 rows=106681 width=36) (actual time=1881.720..1881.775 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=213383.36..259704.81 rows=106681 width=36) (actual time=1881.712..1881.767 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=213383.36..251703.71 rows=320044 width=14) (actual time=1190.308..1230.603 rows=320800 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=212383.30..212583.33 rows=80011 width=14) (actual time=1182.299..1185.172 rows=64160 loops=5)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 4514kB
                           Worker 0:  Sort Method: quicksort  Memory: 4561kB
                           Worker 1:  Sort Method: quicksort  Memory: 4528kB
                           Worker 2:  Sort Method: quicksort  Memory: 4587kB
                           Worker 3:  Sort Method: quicksort  Memory: 4530kB
                           ->  Hash Join  (cost=2341.31..205867.24 rows=80011 width=14) (actual time=35.601..1171.465 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195224.77 rows=2000278 width=18) (actual time=0.496..920.925 rows=1600000 loops=5)
                                 ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=34.981..34.983 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=0.840..33.831 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.066..0.069 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=39.29..2250.00 rows=4000 width=8) (actual time=0.770..33.089 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.391..0.391 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 16.819 ms
 Execution Time: 1882.302 ms
(54 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=467705.99..467705.99 rows=1 width=36) (actual time=1163.762..1163.903 rows=0 loops=1)
   InitPlan 1 (returns $2)
     ->  Finalize Aggregate  (cost=207467.76..207467.77 rows=1 width=32) (actual time=472.236..472.319 rows=1 loops=1)
           ->  Gather  (cost=207467.33..207467.74 rows=4 width=32) (actual time=472.094..472.308 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=206467.33..206467.34 rows=1 width=32) (actual time=466.373..466.376 rows=1 loops=4)
                       ->  Hash Join  (cost=2341.31..205867.24 rows=80011 width=10) (actual time=3.893..439.044 rows=80200 loops=4)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195224.77 rows=2000278 width=14) (actual time=0.032..212.852 rows=2000000 loops=4)
                             ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=3.802..3.803 rows=4010 loops=4)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=0.524..3.364 rows=4010 loops=4)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.010..0.013 rows=1 loops=4)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=39.29..2250.00 rows=4000 width=8) (actual time=0.511..2.970 rows=4010 loops=4)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.284..0.284 rows=4010 loops=4)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=260238.22..260504.92 rows=106681 width=36) (actual time=1163.761..1163.818 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=213383.36..259704.81 rows=106681 width=36) (actual time=1163.754..1163.811 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=213383.36..251703.71 rows=320044 width=14) (actual time=462.409..503.595 rows=320800 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=212383.30..212583.33 rows=80011 width=14) (actual time=457.731..460.604 rows=64160 loops=5)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 6600kB
                           Worker 0:  Sort Method: quicksort  Memory: 6630kB
                           Worker 1:  Sort Method: quicksort  Memory: 4590kB
                           Worker 2:  Sort Method: quicksort  Memory: 4076kB
                           Worker 3:  Sort Method: quicksort  Memory: 3895kB
                           ->  Hash Join  (cost=2341.31..205867.24 rows=80011 width=14) (actual time=4.580..445.985 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195224.77 rows=2000278 width=18) (actual time=0.036..211.364 rows=1600000 loops=5)
                                 ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=4.465..4.467 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=0.509..3.982 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.011..0.014 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=39.29..2250.00 rows=4000 width=8) (actual time=0.495..3.568 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.273..0.274 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 1.202 ms
 Execution Time: 1163.976 ms
(54 rows)

query 12 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=144614.47..332919.69 rows=1 width=27) (actual time=10953.506..10957.542 rows=1 loops=1)
   ->  GroupAggregate  (cost=144614.47..1462751.04 rows=7 width=27) (actual time=10953.505..10957.540 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=144614.47..1457674.43 rows=290088 width=27) (actual time=601.870..10852.471 rows=155572 loops=1)
               ->  Gather Merge  (cost=144614.03..179347.61 rows=290088 width=15) (actual time=601.031..699.363 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=143613.97..143795.28 rows=72522 width=15) (actual time=588.538..591.774 rows=32335 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 4480kB
                           Worker 0:  Sort Method: quicksort  Memory: 4459kB
                           Worker 1:  Sort Method: quicksort  Memory: 4425kB
                           Worker 2:  Sort Method: quicksort  Memory: 4488kB
                           Worker 3:  Sort Method: quicksort  Memory: 4420kB
                           ->  Parallel Index Only Scan using q12_idx_1 on lineitem  (cost=0.43..137759.23 rows=72522 width=15) (actual time=0.276..575.075 rows=62252 loops=5)
                                 Index Cond: ((l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Filter: (l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[]))
                                 Rows Removed by Filter: 155618
                                 Heap Fetches: 0
               ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=20) (actual time=0.064..0.064 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 24.508 ms
 Execution Time: 10958.029 ms
(23 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=144614.47..332919.69 rows=1 width=27) (actual time=715.378..721.326 rows=1 loops=1)
   ->  GroupAggregate  (cost=144614.47..1462751.04 rows=7 width=27) (actual time=715.377..721.324 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=144614.47..1457674.43 rows=290088 width=27) (actual time=226.055..674.334 rows=155572 loops=1)
               ->  Gather Merge  (cost=144614.03..179347.61 rows=290088 width=15) (actual time=226.002..268.649 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=143613.97..143795.28 rows=72522 width=15) (actual time=220.888..222.838 rows=32223 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3883kB
                           Worker 0:  Sort Method: quicksort  Memory: 6375kB
                           Worker 1:  Sort Method: quicksort  Memory: 6413kB
                           Worker 2:  Sort Method: quicksort  Memory: 6522kB
                           Worker 3:  Sort Method: quicksort  Memory: 3688kB
                           ->  Parallel Index Only Scan using q12_idx_1 on lineitem  (cost=0.43..137759.23 rows=72522 width=15) (actual time=0.033..208.778 rows=62252 loops=5)
                                 Index Cond: ((l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Filter: (l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[]))
                                 Rows Removed by Filter: 155618
                                 Heap Fetches: 0
               ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 1.663 ms
 Execution Time: 721.386 ms
(23 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1430437.72..1430437.73 rows=1 width=16) (actual time=17707.966..17707.969 rows=1 loops=1)
   ->  Sort  (cost=1430437.72..1430438.22 rows=200 width=16) (actual time=17707.964..17707.966 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1430434.72..1430436.72 rows=200 width=16) (actual time=17707.937..17707.945 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1275767.20..1407934.96 rows=1499984 width=12) (actual time=15078.541..17536.323 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=55341.99..666493.96 rows=14997495 width=8) (actual time=348.266..11195.760 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448755.44 rows=14997495 width=8) (actual time=0.790..5069.788 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=30732.19..30732.19 rows=1499984 width=4) (actual time=346.043..346.044 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..30732.19 rows=1499984 width=4) (actual time=0.410..161.014 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 15.755 ms
 Execution Time: 17762.953 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1430437.72..1430437.73 rows=1 width=16) (actual time=17131.187..17131.190 rows=1 loops=1)
   ->  Sort  (cost=1430437.72..1430438.22 rows=200 width=16) (actual time=17131.185..17131.188 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1430434.72..1430436.72 rows=200 width=16) (actual time=17131.159..17131.167 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1275767.20..1407934.96 rows=1499984 width=12) (actual time=14515.118..16959.556 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=55341.99..666493.96 rows=14997495 width=8) (actual time=313.588..10674.454 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448755.44 rows=14997495 width=8) (actual time=0.032..4590.581 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=30732.19..30732.19 rows=1499984 width=4) (actual time=312.165..312.166 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..30732.19 rows=1499984 width=4) (actual time=0.027..128.996 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.767 ms
 Execution Time: 17186.241 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=941522.86..941522.88 rows=1 width=32) (actual time=5275.772..5317.382 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=941522.86..941522.88 rows=1 width=32) (actual time=5275.770..5317.380 rows=1 loops=1)
         ->  Gather  (cost=941522.41..941522.82 rows=4 width=64) (actual time=5267.388..5317.356 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=940522.41..940522.42 rows=1 width=64) (actual time=5259.762..5259.766 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=66329.98..937088.75 rows=196209 width=33) (actual time=676.915..5111.446 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=14099.14..884342.86 rows=196209 width=16) (actual time=290.443..4559.859 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=84004
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13902.93 rows=784837 width=0) (actual time=191.259..191.259 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.93..45980.93 rows=499993 width=25) (actual time=384.274..384.277 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.93 rows=499993 width=25) (actual time=0.412..252.041 rows=400000 loops=5)
 Planning Time: 28.276 ms
 Execution Time: 5317.745 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=941522.86..941522.88 rows=1 width=32) (actual time=1691.244..1733.764 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=941522.86..941522.88 rows=1 width=32) (actual time=1691.243..1733.762 rows=1 loops=1)
         ->  Gather  (cost=941522.41..941522.82 rows=4 width=64) (actual time=1683.369..1733.738 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=940522.41..940522.42 rows=1 width=64) (actual time=1676.763..1676.766 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=66329.98..937088.75 rows=196209 width=33) (actual time=546.456..1580.376 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=14099.14..884342.86 rows=196209 width=16) (actual time=272.283..1182.457 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=78295
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13902.93 rows=784837 width=0) (actual time=173.346..173.346 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.93..45980.93 rows=499993 width=25) (actual time=271.285..271.285 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.93 rows=499993 width=25) (actual time=0.036..129.506 rows=400000 loops=5)
 Planning Time: 2.049 ms
 Execution Time: 1733.814 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2726391.92..2726499.81 rows=1 width=103) (actual time=13527.079..13584.770 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1381304.85..1381304.86 rows=1 width=32) (actual time=3114.652..3123.700 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1378871.80..1380088.33 rows=97322 width=36) (actual time=3002.621..3117.717 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 46129kB  Disk Usage: 11680kB
                 ->  Gather  (cost=1335806.82..1375952.14 rows=389288 width=36) (actual time=2587.001..2754.426 rows=398575 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1334806.82..1336023.34 rows=97322 width=36) (actual time=2582.649..2716.007 rows=99644 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 5  Memory Usage: 33841kB  Disk Usage: 7552kB
                             Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7336kB
                             Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7368kB
                             Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7344kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=39208.63..1329349.73 rows=545709 width=16) (actual time=441.548..2077.547 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=109585 lossy=73134
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..38662.93 rows=2182836 width=0) (actual time=350.863..350.864 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1345087.05..1397629.35 rows=487 width=103) (actual time=13527.077..13575.719 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1345086.76..1396077.51 rows=487 width=36) (actual time=13526.472..13575.112 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1345086.76..1391698.02 rows=389288 width=36) (actual time=10187.316..10300.684 rows=346279 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1344086.70..1344330.01 rows=97322 width=36) (actual time=10139.767..10147.801 rows=69804 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 16992kB
                           Worker 0:  Sort Method: quicksort  Memory: 16987kB
                           Worker 1:  Sort Method: quicksort  Memory: 16985kB
                           Worker 2:  Sort Method: quicksort  Memory: 16987kB
                           Worker 3:  Sort Method: quicksort  Memory: 16985kB
                           ->  Partial HashAggregate  (cost=1334806.82..1336023.34 rows=97322 width=36) (actual time=9962.686..10109.620 rows=98948 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 5  Memory Usage: 33841kB  Disk Usage: 7040kB
                                 Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7040kB
                                 Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7016kB
                                 Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7024kB
                                 Worker 3:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7024kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=39208.63..1329349.73 rows=545709 width=16) (actual time=490.892..9402.282 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=80164 lossy=53684
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..38662.93 rows=2182836 width=0) (actual time=403.442..403.443 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.18 rows=1 width=71) (actual time=0.599..0.599 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 24.078 ms
 Execution Time: 13590.348 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2726391.92..2726499.81 rows=1 width=103) (actual time=6287.619..6344.107 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1381304.85..1381304.86 rows=1 width=32) (actual time=3107.998..3118.278 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1378871.80..1380088.33 rows=97322 width=36) (actual time=2996.229..3112.271 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 46129kB  Disk Usage: 11704kB
                 ->  Gather  (cost=1335806.82..1375952.14 rows=389288 width=36) (actual time=2583.284..2750.046 rows=398532 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1334806.82..1336023.34 rows=97322 width=36) (actual time=2579.494..2711.794 rows=99633 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 5  Memory Usage: 33841kB  Disk Usage: 7552kB
                             Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7360kB
                             Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7320kB
                             Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7344kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=39208.63..1329349.73 rows=545709 width=16) (actual time=440.149..2074.147 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=109227 lossy=72917
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..38662.93 rows=2182836 width=0) (actual time=348.810..348.811 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1345087.05..1397629.35 rows=487 width=103) (actual time=6287.617..6333.825 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1345086.76..1396077.51 rows=487 width=36) (actual time=6287.572..6333.778 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1345086.76..1391698.02 rows=389288 width=36) (actual time=2960.122..3069.740 rows=346080 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1344086.70..1344330.01 rows=97322 width=36) (actual time=2917.829..2925.588 rows=69713 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 17015kB
                           Worker 0:  Sort Method: quicksort  Memory: 17026kB
                           Worker 1:  Sort Method: quicksort  Memory: 16911kB
                           Worker 2:  Sort Method: quicksort  Memory: 17006kB
                           Worker 3:  Sort Method: quicksort  Memory: 16929kB
                           ->  Partial HashAggregate  (cost=1334806.82..1336023.34 rows=97322 width=36) (actual time=2741.949..2885.070 rows=98880 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 5  Memory Usage: 33841kB  Disk Usage: 7096kB
                                 Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7136kB
                                 Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 3824kB
                                 Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7072kB
                                 Worker 3:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 6944kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=39208.63..1329349.73 rows=545709 width=16) (actual time=449.258..2293.724 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=83849 lossy=55626
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..38662.93 rows=2182836 width=0) (actual time=361.118..361.118 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.18 rows=1 width=71) (actual time=0.041..0.041 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.886 ms
 Execution Time: 6349.752 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=261972.18..261972.18 rows=1 width=44) (actual time=2598.671..2603.392 rows=1 loops=1)
   ->  Sort  (cost=261972.18..262355.60 rows=153370 width=44) (actual time=2598.669..2603.389 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=183058.91..261205.33 rows=153370 width=44) (actual time=1971.484..2596.000 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=183058.91..253766.29 rows=590534 width=40) (actual time=1971.423..2327.807 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=182058.85..182427.94 rows=147634 width=40) (actual time=1850.166..1869.936 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 24920kB
                           Worker 0:  Sort Method: quicksort  Memory: 23950kB
                           Worker 1:  Sort Method: quicksort  Memory: 24710kB
                           Worker 2:  Sort Method: quicksort  Memory: 25028kB
                           Worker 3:  Sort Method: quicksort  Memory: 24796kB
                           ->  Parallel Hash Join  (cost=57874.85..169383.25 rows=147634 width=40) (actual time=361.649..1099.101 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..112354.48 rows=1000139 width=8) (actual time=47.053..589.830 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.452..46.036 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.82..53480.82 rows=73806 width=40) (actual time=313.898..313.899 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26336kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.82 rows=73806 width=40) (actual time=0.104..288.531 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 18.658 ms
 Execution Time: 2603.966 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=261972.18..261972.18 rows=1 width=44) (actual time=2235.176..2244.209 rows=1 loops=1)
   ->  Sort  (cost=261972.18..262355.60 rows=153370 width=44) (actual time=2235.174..2244.207 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=183058.91..261205.33 rows=153370 width=44) (actual time=1607.551..2236.767 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=183058.91..253766.29 rows=590534 width=40) (actual time=1607.489..1966.075 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=182058.85..182427.94 rows=147634 width=40) (actual time=1558.890..1578.717 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 21871kB
                           Worker 0:  Sort Method: quicksort  Memory: 26125kB
                           Worker 1:  Sort Method: quicksort  Memory: 23664kB
                           Worker 2:  Sort Method: quicksort  Memory: 25682kB
                           Worker 3:  Sort Method: quicksort  Memory: 26062kB
                           ->  Parallel Hash Join  (cost=57874.85..169383.25 rows=147634 width=40) (actual time=185.235..792.443 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..112354.48 rows=1000139 width=8) (actual time=26.926..431.523 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.083..26.643 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.82..53480.82 rows=73806 width=40) (actual time=157.580..157.581 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.82 rows=73806 width=40) (actual time=0.014..126.856 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 1.092 ms
 Execution Time: 2244.508 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1765500.09..1765500.11 rows=1 width=32) (actual time=30823.250..30823.356 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1765500.09..1765500.11 rows=1 width=32) (actual time=30823.249..30823.353 rows=1 loops=1)
         ->  Gather  (cost=1765499.66..1765500.07 rows=4 width=32) (actual time=30823.228..30823.339 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1764499.66..1764499.67 rows=1 width=32) (actual time=30727.134..30727.136 rows=1 loops=5)
                     ->  Nested Loop  (cost=48504.96..1764487.44 rows=4886 width=8) (actual time=642.204..30726.686 rows=1064 loops=5)
                           Join Filter: (part.p_partkey = lineitem.l_partkey)
                           ->  Merge Join  (cost=48504.39..1762982.01 rows=489 width=40) (actual time=640.562..29561.463 rows=399 loops=5)
                                 Merge Cond: (part.p_partkey = lineitem_1.l_partkey)
                                 ->  Sort  (cost=48503.83..48505.10 rows=510 width=4) (actual time=301.393..301.626 rows=399 loops=5)
                                       Sort Key: part.p_partkey
                                       Sort Method: quicksort  Memory: 44kB
                                       Worker 0:  Sort Method: quicksort  Memory: 43kB
                                       Worker 1:  Sort Method: quicksort  Memory: 43kB
                                       Worker 2:  Sort Method: quicksort  Memory: 43kB
                                       Worker 3:  Sort Method: quicksort  Memory: 43kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.89 rows=510 width=4) (actual time=0.412..301.096 rows=399 loops=5)
                                             Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                             Rows Removed by Filter: 399601
                                 ->  GroupAggregate  (cost=0.56..1690500.41 rows=1917627 width=36) (actual time=2.633..29115.893 rows=1995657 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Index Only Scan using q17_idx_1 on lineitem lineitem_1  (cost=0.56..1361821.65 rows=59982872 width=9) (actual time=1.388..18178.811 rows=59855435 loops=5)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..2.95 rows=10 width=17) (actual time=2.807..2.916 rows=3 loops=1996)
                                 Index Cond: ((l_partkey = lineitem_1.l_partkey) AND (l_quantity < ((0.2 * avg(lineitem_1.l_quantity)))))
                                 Heap Fetches: 0
 Planning Time: 26.336 ms
 Execution Time: 30824.028 ms
(29 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1765500.09..1765500.11 rows=1 width=32) (actual time=30248.414..30248.507 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1765500.09..1765500.11 rows=1 width=32) (actual time=30248.413..30248.505 rows=1 loops=1)
         ->  Gather  (cost=1765499.66..1765500.07 rows=4 width=32) (actual time=30248.402..30248.498 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1764499.66..1764499.67 rows=1 width=32) (actual time=29627.989..29627.991 rows=1 loops=5)
                     ->  Nested Loop  (cost=48504.96..1764487.44 rows=4886 width=8) (actual time=404.026..29627.644 rows=1064 loops=5)
                           Join Filter: (part.p_partkey = lineitem.l_partkey)
                           ->  Merge Join  (cost=48504.39..1762982.01 rows=489 width=40) (actual time=403.979..29609.235 rows=399 loops=5)
                                 Merge Cond: (part.p_partkey = lineitem_1.l_partkey)
                                 ->  Sort  (cost=48503.83..48505.10 rows=510 width=4) (actual time=139.383..139.551 rows=399 loops=5)
                                       Sort Key: part.p_partkey
                                       Sort Method: quicksort  Memory: 48kB
                                       Worker 0:  Sort Method: quicksort  Memory: 46kB
                                       Worker 1:  Sort Method: quicksort  Memory: 45kB
                                       Worker 2:  Sort Method: quicksort  Memory: 39kB
                                       Worker 3:  Sort Method: quicksort  Memory: 37kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.89 rows=510 width=4) (actual time=0.147..139.208 rows=399 loops=5)
                                             Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                             Rows Removed by Filter: 399601
                                 ->  GroupAggregate  (cost=0.56..1690500.41 rows=1917627 width=36) (actual time=0.079..29318.957 rows=1989606 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Index Only Scan using q17_idx_1 on lineitem lineitem_1  (cost=0.56..1361821.65 rows=59982872 width=9) (actual time=0.040..18069.128 rows=59674506 loops=5)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..2.95 rows=10 width=17) (actual time=0.040..0.044 rows=3 loops=1996)
                                 Index Cond: ((l_partkey = lineitem_1.l_partkey) AND (l_quantity < ((0.2 * avg(lineitem_1.l_quantity)))))
                                 Heap Fetches: 0
 Planning Time: 2.158 ms
 Execution Time: 30248.566 ms
(29 rows)

query 18 run 1
SET
SET
SET
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=7359472.69..7359472.94 rows=100 width=71) (actual time=31688.441..31688.454 rows=99 loops=1)
   ->  Sort  (cost=7359472.69..7409447.50 rows=19989924 width=71) (actual time=31688.440..31688.447 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=5994212.73..6595472.16 rows=19989924 width=71) (actual time=31687.942..31688.354 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3153kB
               ->  Hash Join  (cost=78577.14..4741719.06 rows=19989924 width=44) (actual time=3218.217..31687.594 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=91.50..4328670.72 rows=19989924 width=25) (actual time=691.333..30907.575 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..2604883.51 rows=4998573 width=24) (actual time=525.565..23023.556 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..568516.36 rows=14998995 width=20) (actual time=0.693..3290.444 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..1886401.77 rows=4998573 width=4) (actual time=416.035..18837.046 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Only Scan using q18_idx_1 on lineitem lineitem_1  (cost=0.56..1361551.65 rows=59982872 width=9) (actual time=0.461..6618.804 rows=59986052 loops=1)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q18_idx_1 on lineitem  (cost=0.56..1361551.65 rows=59982872 width=9) (actual time=0.015..5267.124 rows=59916431 loops=1)
                                 Heap Fetches: 0
                     ->  Hash  (cost=50946.84..50946.84 rows=1499984 width=23) (actual time=672.094..672.094 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50946.84 rows=1499984 width=23) (actual time=0.304..415.341 rows=1500000 loops=1)
 Planning Time: 32.089 ms
 Execution Time: 31689.576 ms
(27 rows)

SET
SET
SET
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=7359472.69..7359472.94 rows=100 width=71) (actual time=30127.229..30127.242 rows=99 loops=1)
   ->  Sort  (cost=7359472.69..7409447.50 rows=19989924 width=71) (actual time=30127.228..30127.235 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=5994212.73..6595472.16 rows=19989924 width=71) (actual time=30126.745..30127.147 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3153kB
               ->  Hash Join  (cost=78577.14..4741719.06 rows=19989924 width=44) (actual time=2917.334..30126.193 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=91.50..4328670.72 rows=19989924 width=25) (actual time=635.724..29479.041 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..2604883.51 rows=4998573 width=24) (actual time=469.320..21593.613 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..568516.36 rows=14998995 width=20) (actual time=0.045..2528.514 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..1886401.77 rows=4998573 width=4) (actual time=389.140..18176.188 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Only Scan using q18_idx_1 on lineitem lineitem_1  (cost=0.56..1361551.65 rows=59982872 width=9) (actual time=0.033..6067.881 rows=59986052 loops=1)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q18_idx_1 on lineitem  (cost=0.56..1361551.65 rows=59982872 width=9) (actual time=0.014..5272.245 rows=59916431 loops=1)
                                 Heap Fetches: 0
                     ->  Hash  (cost=50946.84..50946.84 rows=1499984 width=23) (actual time=539.308..539.309 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50946.84 rows=1499984 width=23) (actual time=0.024..291.047 rows=1500000 loops=1)
 Planning Time: 2.958 ms
 Execution Time: 30127.777 ms
(27 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=67330.73..67330.74 rows=1 width=32) (actual time=846.690..848.531 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=67330.73..67330.74 rows=1 width=32) (actual time=846.689..848.528 rows=1 loops=1)
         ->  Gather  (cost=67330.30..67330.71 rows=4 width=32) (actual time=842.182..848.501 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=66330.30..66330.31 rows=1 width=32) (actual time=835.211..835.212 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..66328.22 rows=277 width=12) (actual time=11.979..834.773 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.69 rows=1185 width=30) (actual time=0.944..195.335 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Only Scan using q19_idx_1 on lineitem  (cost=0.56..3.45 rows=1 width=21) (actual time=0.645..0.668 rows=0 loops=4781)
                                 Index Cond: ((l_partkey = part.p_partkey) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar))
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 7
                                 Heap Fetches: 0
 Planning Time: 34.305 ms
 Execution Time: 848.808 ms
(17 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=67330.73..67330.74 rows=1 width=32) (actual time=154.438..156.449 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=67330.73..67330.74 rows=1 width=32) (actual time=154.433..156.441 rows=1 loops=1)
         ->  Gather  (cost=67330.30..67330.71 rows=4 width=32) (actual time=150.052..156.423 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=66330.30..66330.31 rows=1 width=32) (actual time=146.009..146.011 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..66328.22 rows=277 width=12) (actual time=0.532..145.839 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.69 rows=1185 width=30) (actual time=0.178..130.467 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Only Scan using q19_idx_1 on lineitem  (cost=0.56..3.45 rows=1 width=21) (actual time=0.015..0.016 rows=0 loops=4781)
                                 Index Cond: ((l_partkey = part.p_partkey) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar))
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 7
                                 Heap Fetches: 0
 Planning Time: 3.004 ms
 Execution Time: 156.713 ms
(17 rows)

query 20 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2529296.68..2776916.27 rows=1 width=51) (actual time=17028.371..17029.673 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2529296.68..2776916.27 rows=1 width=51) (actual time=17028.369..17029.671 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 12329
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=25.047..26.279 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=19.858..19.877 rows=390 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 407kB
                     Worker 0:  Sort Method: quicksort  Memory: 246kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.299..18.524 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.137..13.514 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.097..0.098 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.093..0.095 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2525173.75..2772157.46 rows=3 width=8) (actual time=15531.379..17002.337 rows=12330 loops=1)
               ->  Hash Join  (cost=2525173.75..2772157.45 rows=3 width=8) (actual time=15531.375..16999.552 rows=12330 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 25
                     ->  HashAggregate  (cost=2455029.94..2617115.36 rows=4851322 width=40) (actual time=14977.793..16267.316 rows=1144758 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 64  Batches: 117  Memory Usage: 34321kB  Disk Usage: 388616kB
                           ->  Seq Scan on lineitem  (cost=0.00..2024886.08 rows=9145916 width=13) (actual time=0.469..10498.751 rows=9123688 loops=1)
                                 Filter: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Filter: 50862364
                     ->  Hash  (cost=68931.50..68931.50 rows=80820 width=16) (actual time=553.270..553.338 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.86..68931.50 rows=80820 width=16) (actual time=0.308..534.097 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.86..59849.50 rows=20205 width=16) (actual time=0.306..532.986 rows=17374 loops=5)
                                       ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.19 rows=5050 width=4) (actual time=0.271..189.765 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                             Heap Fetches: 0
                                       ->  Index Only Scan using q20_idx_1 on partsupp  (cost=0.43..2.64 rows=19 width=12) (actual time=0.077..0.078 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
                                             Heap Fetches: 0
 Planning Time: 36.151 ms
 Execution Time: 17081.934 ms
(45 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2529296.68..2776916.27 rows=1 width=51) (actual time=14367.490..14368.802 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2529296.68..2776916.27 rows=1 width=51) (actual time=14367.488..14368.800 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 12329
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=13.335..14.570 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=11.502..11.521 rows=393 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 385kB
                     Worker 0:  Sort Method: quicksort  Memory: 267kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.072..10.258 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.006..3.472 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.016..0.017 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.012..0.014 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2525173.75..2772157.46 rows=3 width=8) (actual time=12879.980..14353.201 rows=12330 loops=1)
               ->  Hash Join  (cost=2525173.75..2772157.45 rows=3 width=8) (actual time=12879.977..14350.370 rows=12330 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 25
                     ->  HashAggregate  (cost=2455029.94..2617115.36 rows=4851322 width=40) (actual time=12765.441..14057.555 rows=1144758 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 64  Batches: 117  Memory Usage: 34321kB  Disk Usage: 388616kB
                           ->  Seq Scan on lineitem  (cost=0.00..2024886.08 rows=9145916 width=13) (actual time=0.050..8500.808 rows=9123688 loops=1)
                                 Filter: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Filter: 50862364
                     ->  Hash  (cost=68931.50..68931.50 rows=80820 width=16) (actual time=114.246..114.312 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.86..68931.50 rows=80820 width=16) (actual time=0.298..98.360 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.86..59849.50 rows=20205 width=16) (actual time=0.373..98.549 rows=17374 loops=5)
                                       ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.19 rows=5050 width=4) (actual time=0.351..80.101 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                             Heap Fetches: 0
                                       ->  Index Only Scan using q20_idx_1 on partsupp  (cost=0.43..2.64 rows=19 width=12) (actual time=0.003..0.004 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
                                             Heap Fetches: 0
 Planning Time: 2.498 ms
 Execution Time: 14420.267 ms
(45 rows)

query 21 run 1
SET
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=650297.83..650297.84 rows=1 width=34) (actual time=19423.011..19629.226 rows=100 loops=1)
   ->  Sort  (cost=650297.83..650297.84 rows=1 width=34) (actual time=19423.009..19629.219 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=650297.80..650297.82 rows=1 width=34) (actual time=19415.804..19628.003 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=650297.80..650297.81 rows=1 width=26) (actual time=19415.794..19623.526 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=346126.04..650297.79 rows=1 width=26) (actual time=4906.551..19438.417 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 27756
                           ->  Nested Loop  (cost=346125.47..650295.15 rows=1 width=38) (actual time=4905.239..9606.956 rows=65960 loops=1)
                                 ->  Gather  (cost=346125.04..650292.70 rows=1 width=34) (actual time=4904.839..5153.209 rows=134155 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Hash Anti Join  (cost=345125.04..649292.60 rows=1 width=34) (actual time=4880.130..5574.191 rows=26831 loops=5)
                                             Hash Cond: (l1.l_orderkey = l3.l_orderkey)
                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                             Rows Removed by Join Filter: 109330
                                             ->  Parallel Hash Join  (cost=3021.13..283037.12 rows=199943 width=34) (actual time=21.549..1777.277 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l1  (cost=0.56..260095.75 rows=4998573 width=8) (actual time=0.023..1025.117 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=21.394..21.396 rows=798 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                         ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.578..20.960 rows=798 loops=5)
                                                               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.305..18.484 rows=20000 loops=5)
                                                               ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.248..0.248 rows=1 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.243..0.245 rows=1 loops=5)
                                                                           Filter: (n_name = 'PERU'::bpchar)
                                                                           Rows Removed by Filter: 24
                                             ->  Parallel Hash  (cost=260095.75..260095.75 rows=4998573 width=8) (actual time=2936.742..2936.743 rows=7585870 loops=5)
                                                   Buckets: 1048576  Batches: 64  Memory Usage: 31520kB
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l3  (cost=0.56..260095.75 rows=4998573 width=8) (actual time=0.212..1801.217 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                 ->  Index Only Scan using q21_idx_3 on orders  (cost=0.43..2.45 rows=1 width=4) (actual time=0.032..0.032 rows=0 loops=134155)
                                       Index Cond: ((o_orderkey = l1.l_orderkey) AND (o_orderstatus = 'F'::bpchar))
                                       Heap Fetches: 0
                           ->  Index Only Scan using q21_idx_1 on lineitem l2  (cost=0.56..2.63 rows=4 width=8) (actual time=0.148..0.148 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
                                 Heap Fetches: 0
 Planning Time: 32.437 ms
 Execution Time: 19629.590 ms
(46 rows)

SET
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=650297.83..650297.84 rows=1 width=34) (actual time=5824.043..6053.759 rows=100 loops=1)
   ->  Sort  (cost=650297.83..650297.84 rows=1 width=34) (actual time=5824.041..6053.751 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=650297.80..650297.82 rows=1 width=34) (actual time=5816.874..6052.538 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=650297.80..650297.81 rows=1 width=26) (actual time=5816.861..6048.111 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=346126.04..650297.79 rows=1 width=26) (actual time=4177.270..5880.280 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 27756
                           ->  Nested Loop  (cost=346125.47..650295.15 rows=1 width=38) (actual time=4177.257..5612.316 rows=65960 loops=1)
                                 ->  Gather  (cost=346125.04..650292.70 rows=1 width=34) (actual time=4177.222..5158.937 rows=134155 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Hash Anti Join  (cost=345125.04..649292.60 rows=1 width=34) (actual time=4268.448..5163.866 rows=26831 loops=5)
                                             Hash Cond: (l1.l_orderkey = l3.l_orderkey)
                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                             Rows Removed by Join Filter: 109324
                                             ->  Parallel Hash Join  (cost=3021.13..283037.12 rows=199943 width=34) (actual time=6.329..1741.799 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l1  (cost=0.56..260095.75 rows=4998573 width=8) (actual time=0.064..1010.965 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=6.180..6.182 rows=798 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 320kB
                                                         ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.052..5.753 rows=798 loops=5)
                                                               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.008..2.631 rows=20000 loops=5)
                                                               ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.030..0.031 rows=1 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=5)
                                                                           Filter: (n_name = 'PERU'::bpchar)
                                                                           Rows Removed by Filter: 24
                                             ->  Parallel Hash  (cost=260095.75..260095.75 rows=4998573 width=8) (actual time=2351.485..2351.486 rows=7585870 loops=5)
                                                   Buckets: 1048576  Batches: 64  Memory Usage: 31520kB
                                                   ->  Parallel Index Only Scan using q21_idx_2 on lineitem l3  (cost=0.56..260095.75 rows=4998573 width=8) (actual time=0.034..1159.838 rows=7585870 loops=5)
                                                         Heap Fetches: 0
                                 ->  Index Only Scan using q21_idx_3 on orders  (cost=0.43..2.45 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=134155)
                                       Index Cond: ((o_orderkey = l1.l_orderkey) AND (o_orderstatus = 'F'::bpchar))
                                       Heap Fetches: 0
                           ->  Index Only Scan using q21_idx_1 on lineitem l2  (cost=0.56..2.63 rows=4 width=8) (actual time=0.004..0.004 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
                                 Heap Fetches: 0
 Planning Time: 3.757 ms
 Execution Time: 6053.846 ms
(46 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93876.64..93878.44 rows=1 width=72) (actual time=1781.735..1787.016 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.91..46820.92 rows=1 width=32) (actual time=311.795..311.891 rows=1 loops=1)
           ->  Gather  (cost=46820.48..46820.89 rows=4 width=32) (actual time=308.710..311.873 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.48..45820.49 rows=1 width=32) (actual time=301.295..301.296 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.65 rows=11933 width=6) (actual time=0.076..292.489 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.72..60523.12 rows=7472 width=72) (actual time=1781.734..1786.919 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.72..60336.32 rows=7472 width=38) (actual time=489.071..1780.109 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.28..49150.64 rows=17500 width=26) (actual time=488.584..511.328 rows=27128 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 4
                     ->  Sort  (cost=46055.22..46066.16 rows=4375 width=26) (actual time=170.464..171.212 rows=6222 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 5493kB
                           Worker 0:  Sort Method: quicksort  Memory: 5065kB
                           Worker 1:  Sort Method: quicksort  Memory: 2562kB
                           Worker 2:  Sort Method: quicksort  Memory: 2611kB
                           Worker 3:  Sort Method: quicksort  Memory: 5348kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.65 rows=4375 width=26) (actual time=0.015..155.708 rows=38226 loops=5)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.63 rows=17 width=4) (actual time=0.046..0.046 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 13.274 ms
 Execution Time: 1787.685 ms
(32 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93876.64..93878.44 rows=1 width=72) (actual time=444.759..450.889 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.91..46820.92 rows=1 width=32) (actual time=209.752..209.852 rows=1 loops=1)
           ->  Gather  (cost=46820.48..46820.89 rows=4 width=32) (actual time=206.158..209.833 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.48..45820.49 rows=1 width=32) (actual time=201.051..201.052 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.65 rows=11933 width=6) (actual time=0.016..191.434 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.72..60523.12 rows=7472 width=72) (actual time=444.758..450.787 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.72..60336.32 rows=7472 width=38) (actual time=380.447..448.743 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.28..49150.64 rows=17500 width=26) (actual time=380.365..393.854 rows=27129 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 4
                     ->  Sort  (cost=46055.22..46066.16 rows=4375 width=26) (actual time=166.372..166.958 rows=6280 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 5547kB
                           Worker 0:  Sort Method: quicksort  Memory: 2541kB
                           Worker 1:  Sort Method: quicksort  Memory: 5231kB
                           Worker 2:  Sort Method: quicksort  Memory: 5198kB
                           Worker 3:  Sort Method: quicksort  Memory: 2562kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.65 rows=4375 width=26) (actual time=0.015..151.657 rows=38226 loops=5)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.63 rows=17 width=4) (actual time=0.002..0.002 rows=1 loops=27129)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 1.131 ms
 Execution Time: 450.956 ms
(32 rows)

