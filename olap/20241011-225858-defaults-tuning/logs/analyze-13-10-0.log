query 1 run 1
SET
SET
SET
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4243842.54..4243842.54 rows=1 width=236) (actual time=72331.596..72331.597 rows=1 loops=1)
   ->  Sort  (cost=4243842.54..4243842.55 rows=6 width=236) (actual time=72331.595..72331.595 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4243842.34..4243842.51 rows=6 width=236) (actual time=72331.567..72331.575 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               Batches: 1  Memory Usage: 24kB
               ->  Seq Scan on lineitem  (cost=0.00..1874971.10 rows=59221781 width=25) (actual time=0.399..11255.497 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning Time: 13.395 ms
 Execution Time: 72332.318 ms
(12 rows)

SET
SET
SET
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4243842.54..4243842.54 rows=1 width=236) (actual time=68631.482..68631.483 rows=1 loops=1)
   ->  Sort  (cost=4243842.54..4243842.55 rows=6 width=236) (actual time=68631.481..68631.482 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4243842.34..4243842.51 rows=6 width=236) (actual time=68631.455..68631.463 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               Batches: 1  Memory Usage: 24kB
               ->  Seq Scan on lineitem  (cost=0.00..1874971.10 rows=59221781 width=25) (actual time=0.026..9484.745 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning Time: 0.748 ms
 Execution Time: 68631.541 ms
(12 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1000665.86..1000665.87 rows=1 width=192) (actual time=4946.655..4946.672 rows=100 loops=1)
   ->  Sort  (cost=1000665.86..1000665.87 rows=1 width=192) (actual time=4946.654..4946.664 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=558016.06..1000665.85 rows=1 width=192) (actual time=3128.661..4943.887 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89212.15 rows=6783 width=30) (actual time=0.410..793.675 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=558015.63..566015.12 rows=1599898 width=172) (actual time=3127.133..3589.457 rows=1603828 loops=1)
                     ->  Sort  (cost=558015.63..562015.38 rows=1599898 width=172) (actual time=3127.129..3408.123 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305262.50 rows=1599898 width=172) (actual time=43.300..2456.592 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255216.92 rows=7999492 width=14) (actual time=0.575..1074.290 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=42.707..42.709 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.984..37.071 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.343..24.881 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.632..0.634 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.627..0.632 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.318..0.319 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.303..0.304 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.300..0.301 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=62.90..62.91 rows=1 width=32) (actual time=0.059..0.059 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..62.89 rows=3 width=6) (actual time=0.049..0.057 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..61.62 rows=17 width=10) (actual time=0.043..0.054 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..60.00 rows=17 width=10) (actual time=0.042..0.053 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.73 rows=17 width=10) (actual time=0.038..0.039 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.013 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 20.409 ms
 Execution Time: 4984.627 ms
(53 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1000665.86..1000665.87 rows=1 width=192) (actual time=3905.737..3905.753 rows=100 loops=1)
   ->  Sort  (cost=1000665.86..1000665.87 rows=1 width=192) (actual time=3905.735..3905.745 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=558016.06..1000665.85 rows=1 width=192) (actual time=2709.533..3903.478 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89212.15 rows=6783 width=30) (actual time=0.015..474.807 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=558015.63..566015.12 rows=1599898 width=172) (actual time=2709.410..3145.737 rows=1603828 loops=1)
                     ->  Sort  (cost=558015.63..562015.38 rows=1599898 width=172) (actual time=2709.408..2967.918 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305262.50 rows=1599898 width=172) (actual time=25.489..2055.053 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255216.92 rows=7999492 width=14) (actual time=0.035..774.061 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=25.436..25.438 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.036..20.309 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.012..5.865 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.020..0.022 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.015..0.020 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.002..0.003 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=62.90..62.91 rows=1 width=32) (actual time=0.017..0.017 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..62.89 rows=3 width=6) (actual time=0.009..0.015 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..61.62 rows=17 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..60.00 rows=17 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.73 rows=17 width=10) (actual time=0.002..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.013..0.013 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.007 rows=25 loops=1)
 Planning Time: 1.929 ms
 Execution Time: 3941.944 ms
(53 rows)

query 3 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3175465.88..3175465.90 rows=10 width=44) (actual time=29107.650..29107.654 rows=10 loops=1)
   ->  Sort  (cost=3175465.88..3183181.49 rows=3086243 width=44) (actual time=29107.648..29107.652 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  HashAggregate  (cost=3034028.33..3108773.28 rows=3086243 width=44) (actual time=28996.440..29088.237 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               Planned Partitions: 32  Batches: 33  Memory Usage: 35089kB  Disk Usage: 2056kB
               ->  Hash Join  (cost=519142.49..2871759.46 rows=3086243 width=24) (actual time=9358.880..28805.740 rows=301530 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1874971.10 rows=32542783 width=16) (actual time=0.463..11321.096 rows=32534229 loops=1)
                           Filter: (l_shipdate > '1995-03-07'::date)
                           Rows Removed by Filter: 27451823
                     ->  Hash  (cost=494415.14..494415.14 rows=1422508 width=12) (actual time=9353.990..9353.992 rows=1451805 loops=1)
                           Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                           ->  Hash Join  (cost=123727.97..494415.14 rows=1422508 width=12) (actual time=1049.042..9011.972 rows=1451805 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=65343.93..417040.96 rows=7234322 width=16) (actual time=535.333..6756.938 rows=7239437 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                       Heap Blocks: exact=261268
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..63535.35 rows=7234322 width=0) (actual time=490.543..490.543 rows=7239437 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-07'::date)
                                 ->  Hash  (cost=54697.14..54697.14 rows=294952 width=4) (actual time=512.918..512.919 rows=300276 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                       ->  Seq Scan on customer  (cost=0.00..54697.14 rows=294952 width=4) (actual time=0.671..460.941 rows=300276 loops=1)
                                             Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                             Rows Removed by Filter: 1199724
 Planning Time: 20.296 ms
 Execution Time: 29109.933 ms
(28 rows)

SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3175465.88..3175465.90 rows=10 width=44) (actual time=22118.748..22118.753 rows=10 loops=1)
   ->  Sort  (cost=3175465.88..3183181.49 rows=3086243 width=44) (actual time=22118.747..22118.750 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  HashAggregate  (cost=3034028.33..3108773.28 rows=3086243 width=44) (actual time=22007.439..22099.364 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               Planned Partitions: 32  Batches: 33  Memory Usage: 35089kB  Disk Usage: 2056kB
               ->  Hash Join  (cost=519142.49..2871759.46 rows=3086243 width=24) (actual time=4565.468..21827.456 rows=301530 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1874971.10 rows=32542783 width=16) (actual time=0.027..9295.660 rows=32534229 loops=1)
                           Filter: (l_shipdate > '1995-03-07'::date)
                           Rows Removed by Filter: 27451823
                     ->  Hash  (cost=494415.14..494415.14 rows=1422508 width=12) (actual time=4563.553..4563.555 rows=1451805 loops=1)
                           Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                           ->  Hash Join  (cost=123727.97..494415.14 rows=1422508 width=12) (actual time=882.184..4303.055 rows=1451805 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=65343.93..417040.96 rows=7234322 width=16) (actual time=506.169..2407.473 rows=7239437 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                       Heap Blocks: exact=261268
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..63535.35 rows=7234322 width=0) (actual time=462.149..462.149 rows=7239437 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-07'::date)
                                 ->  Hash  (cost=54697.14..54697.14 rows=294952 width=4) (actual time=375.258..375.259 rows=300276 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                       ->  Seq Scan on customer  (cost=0.00..54697.14 rows=294952 width=4) (actual time=0.030..326.443 rows=300276 loops=1)
                                             Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                             Rows Removed by Filter: 1199724
 Planning Time: 1.229 ms
 Execution Time: 22120.155 ms
(28 rows)

query 4 run 1
SET
SET
SET
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2010418.30..2010418.30 rows=1 width=24) (actual time=20021.752..20021.755 rows=1 loops=1)
   ->  Sort  (cost=2010418.30..2010418.31 rows=5 width=24) (actual time=20021.751..20021.752 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2010418.22..2010418.27 rows=5 width=24) (actual time=20021.703..20021.707 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               Batches: 1  Memory Usage: 24kB
               ->  Nested Loop Semi Join  (cost=6271.76..2007700.11 rows=543623 width=16) (actual time=105.610..19729.085 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=6271.20..275695.19 rows=543733 width=20) (actual time=105.129..6659.683 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6135.27 rows=543733 width=0) (actual time=65.137..65.138 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.023..0.023 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning Time: 15.679 ms
 Execution Time: 20022.584 ms
(19 rows)

SET
SET
SET
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2010418.30..2010418.30 rows=1 width=24) (actual time=4570.494..4570.496 rows=1 loops=1)
   ->  Sort  (cost=2010418.30..2010418.31 rows=5 width=24) (actual time=4570.493..4570.494 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2010418.22..2010418.27 rows=5 width=24) (actual time=4570.473..4570.475 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               Batches: 1  Memory Usage: 24kB
               ->  Nested Loop Semi Join  (cost=6271.76..2007700.11 rows=543623 width=16) (actual time=103.674..4385.579 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=6271.20..275695.19 rows=543733 width=20) (actual time=103.644..1207.937 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6135.27 rows=543733 width=0) (actual time=64.503..64.504 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.005..0.005 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning Time: 1.130 ms
 Execution Time: 4570.562 ms
(19 rows)

query 5 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2044546.92..2044546.92 rows=1 width=58) (actual time=23283.353..23283.359 rows=1 loops=1)
   ->  Sort  (cost=2044546.92..2044546.98 rows=25 width=58) (actual time=23283.351..23283.357 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2043653.34..2044546.79 rows=25 width=58) (actual time=23258.918..23283.327 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2043653.34..2043831.97 rows=71451 width=38) (actual time=23252.793..23255.915 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=93803.81..2037892.72 rows=71451 width=38) (actual time=867.851..23205.529 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=89082.81..2023793.43 rows=1786340 width=50) (actual time=819.789..22726.002 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=89082.24..396692.79 rows=446675 width=38) (actual time=819.295..8592.657 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=25757.54..320526.18 rows=2233376 width=8) (actual time=218.598..7300.799 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25199.20 rows=2233376 width=0) (actual time=174.230..174.231 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59574.68..59574.68 rows=300002 width=38) (actual time=600.267..600.269 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.51..59574.68 rows=300002 width=38) (actual time=1.358..537.241 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=8) (actual time=0.665..372.106 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.680..0.682 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.675..0.680 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.336..0.337 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.331..0.332 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.326..0.327 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.028..0.030 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=43.957..43.958 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.281..28.395 rows=100000 loops=1)
 Planning Time: 23.855 ms
 Execution Time: 23284.085 ms
(41 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2044546.92..2044546.92 rows=1 width=58) (actual time=6036.172..6036.179 rows=1 loops=1)
   ->  Sort  (cost=2044546.92..2044546.98 rows=25 width=58) (actual time=6036.171..6036.177 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2043653.34..2044546.79 rows=25 width=58) (actual time=6011.563..6036.156 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2043653.34..2043831.97 rows=71451 width=38) (actual time=6005.397..6008.437 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=93803.81..2037892.72 rows=71451 width=38) (actual time=717.708..5972.762 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=89082.81..2023793.43 rows=1786340 width=50) (actual time=678.995..5549.564 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=89082.24..396692.79 rows=446675 width=38) (actual time=678.973..2591.253 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=25757.54..320526.18 rows=2233376 width=8) (actual time=208.624..1539.073 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25199.20 rows=2233376 width=0) (actual time=164.969..164.970 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59574.68..59574.68 rows=300002 width=38) (actual time=469.998..470.001 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.51..59574.68 rows=300002 width=38) (actual time=0.060..409.135 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=8) (actual time=0.020..251.545 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.033..0.035 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.027..0.033 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.008..0.009 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.015 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.010..0.011 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.005..0.006 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=38.468..38.468 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.019..21.646 rows=100000 loops=1)
 Planning Time: 3.392 ms
 Execution Time: 6036.410 ms
(41 rows)

query 6 run 1
SET
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1971410.72..1971410.73 rows=1 width=32) (actual time=100582.107..100582.108 rows=1 loops=1)
   ->  Aggregate  (cost=1971410.72..1971410.73 rows=1 width=32) (actual time=100582.106..100582.106 rows=1 loops=1)
         ->  Index Scan using idx_lineitem_shipdate on lineitem  (cost=0.56..1965529.92 rows=1176159 width=12) (actual time=1.454..99247.248 rows=1194558 loops=1)
               Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 10.897 ms
 Execution Time: 100583.562 ms
(6 rows)

SET
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1971410.72..1971410.73 rows=1 width=32) (actual time=4281.462..4281.463 rows=1 loops=1)
   ->  Aggregate  (cost=1971410.72..1971410.73 rows=1 width=32) (actual time=4281.460..4281.461 rows=1 loops=1)
         ->  Index Scan using idx_lineitem_shipdate on lineitem  (cost=0.56..1965529.92 rows=1176159 width=12) (actual time=0.067..3935.188 rows=1194558 loops=1)
               Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.697 ms
 Execution Time: 4281.504 ms
(6 rows)

query 7 run 1
SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2718498.03..2718498.16 rows=1 width=92) (actual time=19147.286..19147.293 rows=1 loops=1)
   ->  GroupAggregate  (cost=2718498.03..2719739.69 rows=10036 width=92) (actual time=19147.285..19147.291 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2718498.03..2718650.32 rows=60916 width=72) (actual time=19140.201..19140.940 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=563397.54..2713656.88 rows=60916 width=72) (actual time=5165.899..19111.738 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=3629.40..2111817.98 rows=1463769 width=46) (actual time=35.646..13166.112 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on lineitem  (cost=0.00..2024936.72 rows=18297113 width=24) (actual time=0.389..10960.803 rows=18230325 loops=1)
                                 Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Filter: 41755727
                           ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=35.225..35.227 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.484..33.836 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.271..24.021 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.203..0.204 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.194..0.198 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=536565.55..536565.55 rows=1199967 width=30) (actual time=5126.380..5126.382 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=57053.55..536565.55 rows=1199967 width=30) (actual time=545.292..4870.100 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411263.87 rows=14999587 width=8) (actual time=0.575..1716.324 rows=15000000 loops=1)
                                 ->  Hash  (cost=55553.54..55553.54 rows=120001 width=30) (actual time=544.622..544.623 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..55553.54 rows=120001 width=30) (actual time=0.521..518.841 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=8) (actual time=0.487..374.422 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.025..0.025 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.017..0.021 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning Time: 23.047 ms
 Execution Time: 19148.208 ms
(42 rows)

SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2718498.03..2718498.16 rows=1 width=92) (actual time=15685.827..15685.834 rows=1 loops=1)
   ->  GroupAggregate  (cost=2718498.03..2719739.69 rows=10036 width=92) (actual time=15685.826..15685.832 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2718498.03..2718650.32 rows=60916 width=72) (actual time=15678.780..15679.528 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=563397.54..2713656.88 rows=60916 width=72) (actual time=4178.709..15651.843 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=3629.40..2111817.98 rows=1463769 width=46) (actual time=19.214..10735.657 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on lineitem  (cost=0.00..2024936.72 rows=18297113 width=24) (actual time=0.034..8930.676 rows=18230325 loops=1)
                                 Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Filter: 41755727
                           ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=19.165..19.167 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.023..18.173 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.009..5.787 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.010..0.011 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.006..0.008 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=536565.55..536565.55 rows=1199967 width=30) (actual time=4157.333..4157.335 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=57053.55..536565.55 rows=1199967 width=30) (actual time=293.405..3910.857 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411263.87 rows=14999587 width=8) (actual time=0.030..1249.479 rows=15000000 loops=1)
                                 ->  Hash  (cost=55553.54..55553.54 rows=120001 width=30) (actual time=293.316..293.317 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..55553.54 rows=120001 width=30) (actual time=0.023..272.814 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=8) (actual time=0.002..86.655 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.012..0.012 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.007..0.009 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning Time: 2.132 ms
 Execution Time: 15686.203 ms
(42 rows)

query 8 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1220685.93..1220686.18 rows=1 width=40) (actual time=64018.211..64018.217 rows=1 loops=1)
   ->  GroupAggregate  (cost=1220685.93..1221286.59 rows=2406 width=40) (actual time=64018.209..64018.215 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1220685.93..1220746.66 rows=24290 width=46) (actual time=64012.930..64013.409 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=861268.36..1218916.64 rows=24290 width=46) (actual time=56043.984..63999.545 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 287513
                     ->  Hash Join  (cost=861268.36..1210021.59 rows=24290 width=20) (actual time=56043.209..63940.941 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=856797.36..1205486.83 rows=24290 width=20) (actual time=56000.279..63885.972 rows=23842 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=793472.65..1141463.79 rows=121449 width=24) (actual time=55416.591..63269.028 rows=118593 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                       ->  Bitmap Heap Scan on orders  (cost=52593.66..382268.58 rows=4560461 width=12) (actual time=365.158..7200.952 rows=4557513 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..51453.54 rows=4560461 width=0) (actual time=320.461..320.461 rows=4557513 loops=1)
                                                   Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                       ->  Hash  (cost=735885.86..735885.86 rows=399451 width=20) (actual time=55051.115..55051.116 rows=389521 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25019kB
                                             ->  Nested Loop  (cost=0.44..735885.86 rows=399451 width=20) (actual time=1.826..54610.911 rows=389521 loops=1)
                                                   ->  Seq Scan on part  (cost=0.00..65980.82 rows=13318 width=4) (actual time=1.224..614.084 rows=13011 loops=1)
                                                         Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                         Rows Removed by Filter: 1986989
                                                   ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.98 rows=32 width=24) (actual time=0.259..4.131 rows=30 loops=13011)
                                                         Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=59574.68..59574.68 rows=300002 width=4) (actual time=583.045..583.047 rows=299436 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                       ->  Hash Join  (cost=2.51..59574.68 rows=300002 width=4) (actual time=1.462..532.607 rows=299436 loops=1)
                                             Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=8) (actual time=0.796..372.089 rows=1500000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.656..0.658 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.651..0.656 rows=5 loops=1)
                                                         Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.319..0.320 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.326..0.326 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.321..0.322 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.881..42.882 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.282..28.140 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.014..0.019 rows=25 loops=1)
 Planning Time: 27.240 ms
 Execution Time: 64019.959 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1220685.93..1220686.18 rows=1 width=40) (actual time=5045.881..5045.889 rows=1 loops=1)
   ->  GroupAggregate  (cost=1220685.93..1221286.59 rows=2406 width=40) (actual time=5045.879..5045.886 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1220685.93..1220746.66 rows=24290 width=46) (actual time=5040.786..5041.255 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=861268.36..1218916.64 rows=24290 width=46) (actual time=2833.873..5033.015 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 287513
                     ->  Hash Join  (cost=861268.36..1210021.59 rows=24290 width=20) (actual time=2833.839..4992.273 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=856797.36..1205486.83 rows=24290 width=20) (actual time=2797.009..4945.722 rows=23842 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=793472.65..1141463.79 rows=121449 width=24) (actual time=2349.854..4470.795 rows=118593 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                       ->  Bitmap Heap Scan on orders  (cost=52593.66..382268.58 rows=4560461 width=12) (actual time=345.708..1601.912 rows=4557513 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..51453.54 rows=4560461 width=0) (actual time=301.548..301.549 rows=4557513 loops=1)
                                                   Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                       ->  Hash  (cost=735885.86..735885.86 rows=399451 width=20) (actual time=2003.835..2003.837 rows=389521 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25019kB
                                             ->  Nested Loop  (cost=0.44..735885.86 rows=399451 width=20) (actual time=0.099..1885.856 rows=389521 loops=1)
                                                   ->  Seq Scan on part  (cost=0.00..65980.82 rows=13318 width=4) (actual time=0.071..315.480 rows=13011 loops=1)
                                                         Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                         Rows Removed by Filter: 1986989
                                                   ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.98 rows=32 width=24) (actual time=0.009..0.115 rows=30 loops=13011)
                                                         Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=59574.68..59574.68 rows=300002 width=4) (actual time=446.443..446.446 rows=299436 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                       ->  Hash Join  (cost=2.51..59574.68 rows=300002 width=4) (actual time=0.072..398.153 rows=299436 loops=1)
                                             Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=8) (actual time=0.023..243.783 rows=1500000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.040..0.041 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.033..0.039 rows=5 loops=1)
                                                         Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.012..0.014 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.016..0.016 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=36.783..36.784 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.020..21.154 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.000 rows=13 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.008..0.010 rows=25 loops=1)
 Planning Time: 3.568 ms
 Execution Time: 5046.395 ms
(50 rows)

query 9 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1135147.13..1135147.17 rows=1 width=66) (actual time=176491.135..176491.139 rows=1 loops=1)
   ->  GroupAggregate  (cost=1135147.13..1135150.09 rows=79 width=66) (actual time=176491.133..176491.137 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1135147.13..1135147.33 rows=79 width=57) (actual time=176482.055..176484.147 rows=11401 loops=1)
               Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
               Sort Method: external merge  Disk: 239856kB
               ->  Nested Loop  (cost=1.60..1135144.64 rows=79 width=57) (actual time=2.677..172973.498 rows=3248192 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 39009119
                     ->  Nested Loop  (cost=1.60..1135114.34 rows=79 width=31) (actual time=2.403..165835.963 rows=3248192 loops=1)
                           ->  Nested Loop  (cost=1.17..1134843.96 rows=79 width=31) (actual time=1.676..120387.792 rows=3248192 loops=1)
                                 ->  Nested Loop  (cost=0.87..1134584.98 rows=79 width=35) (actual time=1.337..112184.923 rows=3248192 loops=1)
                                       ->  Nested Loop  (cost=0.43..300515.73 rows=242410 width=18) (actual time=0.998..2529.616 rows=433248 loops=1)
                                             ->  Seq Scan on part  (cost=0.00..65980.82 rows=60606 width=4) (actual time=0.492..675.796 rows=108312 loops=1)
                                                   Filter: ((p_name)::text ~~ '%navy%'::text)
                                                   Rows Removed by Filter: 1891688
                                             ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.70 rows=17 width=14) (actual time=0.014..0.016 rows=4 loops=108312)
                                                   Index Cond: (ps_partkey = part.p_partkey)
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.036..0.250 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                 ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.28 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=3248192)
                                       Index Cond: (s_suppkey = lineitem.l_suppkey)
                           ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.013..0.013 rows=1 loops=3248192)
                                 Index Cond: (o_orderkey = lineitem.l_orderkey)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=3248192)
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.261..0.264 rows=25 loops=1)
 Planning Time: 28.998 ms
 Execution Time: 176520.992 ms
(28 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1135147.13..1135147.17 rows=1 width=66) (actual time=78889.808..78889.812 rows=1 loops=1)
   ->  GroupAggregate  (cost=1135147.13..1135150.09 rows=79 width=66) (actual time=78889.807..78889.810 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1135147.13..1135147.33 rows=79 width=57) (actual time=78880.746..78882.830 rows=11401 loops=1)
               Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
               Sort Method: external merge  Disk: 239856kB
               ->  Nested Loop  (cost=1.60..1135144.64 rows=79 width=57) (actual time=0.493..75633.494 rows=3248192 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 39009119
                     ->  Nested Loop  (cost=1.60..1135114.34 rows=79 width=31) (actual time=0.476..69393.479 rows=3248192 loops=1)
                           ->  Nested Loop  (cost=1.17..1134843.96 rows=79 width=31) (actual time=0.458..48543.410 rows=3248192 loops=1)
                                 ->  Nested Loop  (cost=0.87..1134584.98 rows=79 width=35) (actual time=0.448..41872.488 rows=3248192 loops=1)
                                       ->  Nested Loop  (cost=0.43..300515.73 rows=242410 width=18) (actual time=0.433..1868.574 rows=433248 loops=1)
                                             ->  Seq Scan on part  (cost=0.00..65980.82 rows=60606 width=4) (actual time=0.259..605.430 rows=108312 loops=1)
                                                   Filter: ((p_name)::text ~~ '%navy%'::text)
                                                   Rows Removed by Filter: 1891688
                                             ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.70 rows=17 width=14) (actual time=0.009..0.010 rows=4 loops=108312)
                                                   Index Cond: (ps_partkey = part.p_partkey)
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.014..0.090 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                 ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.28 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=3248192)
                                       Index Cond: (s_suppkey = lineitem.l_suppkey)
                           ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.006..0.006 rows=1 loops=3248192)
                                 Index Cond: (o_orderkey = lineitem.l_orderkey)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=3248192)
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.003..0.007 rows=25 loops=1)
 Planning Time: 15.476 ms
 Execution Time: 78919.776 ms
(28 rows)

query 10 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2444232.75..2444232.80 rows=20 width=201) (actual time=23421.927..23421.935 rows=20 loops=1)
   ->  Sort  (cost=2444232.75..2445659.76 rows=570804 width=201) (actual time=23421.926..23421.931 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  HashAggregate  (cost=2392922.67..2429043.86 rows=570804 width=201) (actual time=22529.488..23303.643 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               Planned Partitions: 16  Batches: 17  Memory Usage: 33937kB  Disk Usage: 200712kB
               ->  Hash Join  (cost=2252212.77..2330892.33 rows=570804 width=181) (actual time=20368.167..21588.263 rows=1145402 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Merge Join  (cost=2252211.21..2329138.40 rows=570804 width=159) (actual time=20367.882..21374.289 rows=1145402 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Scan using customer_pkey on customer  (cost=0.43..64622.09 rows=1500011 width=147) (actual time=0.448..486.175 rows=1499997 loops=1)
                           ->  Sort  (cost=2252207.82..2253634.83 rows=570804 width=16) (actual time=20367.419..20495.103 rows=1145402 loops=1)
                                 Sort Key: orders.o_custkey
                                 Sort Method: external sort  Disk: 35288kB
                                 ->  Hash Join  (cost=283903.21..2197631.43 rows=570804 width=16) (actual time=7228.177..19790.321 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1874971.10 rows=14764615 width=16) (actual time=0.406..10790.554 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=276654.61..276654.61 rows=579888 width=8) (actual time=7226.030..7226.031 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=6688.29..276654.61 rows=579888 width=8) (actual time=105.922..7037.185 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6543.32 rows=579888 width=0) (actual time=66.272..66.272 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.279..0.279 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.271..0.273 rows=25 loops=1)
 Planning Time: 23.817 ms
 Execution Time: 23453.115 ms
(32 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2444232.75..2444232.80 rows=20 width=201) (actual time=15506.726..15506.734 rows=20 loops=1)
   ->  Sort  (cost=2444232.75..2445659.76 rows=570804 width=201) (actual time=15506.725..15506.730 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  HashAggregate  (cost=2392922.67..2429043.86 rows=570804 width=201) (actual time=14613.185..15388.587 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               Planned Partitions: 16  Batches: 17  Memory Usage: 33937kB  Disk Usage: 200712kB
               ->  Hash Join  (cost=2252212.77..2330892.33 rows=570804 width=181) (actual time=12603.389..13700.192 rows=1145402 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Merge Join  (cost=2252211.21..2329138.40 rows=570804 width=159) (actual time=12603.362..13484.357 rows=1145402 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Scan using customer_pkey on customer  (cost=0.43..64622.09 rows=1500011 width=147) (actual time=0.011..367.446 rows=1499997 loops=1)
                           ->  Sort  (cost=2252207.82..2253634.83 rows=570804 width=16) (actual time=12603.338..12728.122 rows=1145402 loops=1)
                                 Sort Key: orders.o_custkey
                                 Sort Method: external sort  Disk: 35288kB
                                 ->  Hash Join  (cost=283903.21..2197631.43 rows=570804 width=16) (actual time=1577.616..12037.113 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1874971.10 rows=14764615 width=16) (actual time=0.016..8751.221 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=276654.61..276654.61 rows=579888 width=8) (actual time=1576.243..1576.244 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=6688.29..276654.61 rows=579888 width=8) (actual time=104.088..1446.712 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6543.32 rows=579888 width=0) (actual time=64.939..64.939 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.021..0.021 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.013..0.015 rows=25 loops=1)
 Planning Time: 1.842 ms
 Execution Time: 15537.092 ms
(32 rows)

query 11 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=609796.62..609796.63 rows=1 width=36) (actual time=3844.240..3844.245 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293126.13..293126.14 rows=1 width=32) (actual time=1538.878..1538.881 rows=1 loops=1)
           ->  Hash Join  (cost=2311.46..290726.27 rows=319980 width=10) (actual time=2.659..1454.362 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255216.92 rows=7999492 width=14) (actual time=0.018..729.438 rows=8000000 loops=1)
                 ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=2.610..2.612 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.457..2.243 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.446..1.904 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.270..0.270 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=316670.49..316937.14 rows=106660 width=36) (actual time=3844.238..3844.240 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  HashAggregate  (cost=307412.73..316137.19 rows=106660 width=36) (actual time=3844.222..3844.224 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Planned Partitions: 8  Batches: 9  Memory Usage: 34897kB  Disk Usage: 9736kB
               Rows Removed by Filter: 301833
               ->  Hash Join  (cost=2311.46..290726.27 rows=319980 width=14) (actual time=60.031..1905.061 rows=320800 loops=1)
                     Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                     ->  Seq Scan on partsupp  (cost=0.00..255216.92 rows=7999492 width=18) (actual time=0.545..1063.025 rows=8000000 loops=1)
                     ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=59.426..59.427 rows=4010 loops=1)
                           Buckets: 4096  Batches: 1  Memory Usage: 173kB
                           ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=1.406..58.165 rows=4010 loops=1)
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.186..0.189 rows=1 loops=1)
                                       Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                       Rows Removed by Filter: 24
                                 ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=8) (actual time=1.214..57.180 rows=4010 loops=1)
                                       Recheck Cond: (s_nationkey = nation.n_nationkey)
                                       Heap Blocks: exact=1869
                                       ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.877..0.877 rows=4010 loops=1)
                                             Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 14.376 ms
 Execution Time: 3846.910 ms
(41 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=609796.62..609796.63 rows=1 width=36) (actual time=3432.983..3432.989 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293126.13..293126.14 rows=1 width=32) (actual time=1539.465..1539.468 rows=1 loops=1)
           ->  Hash Join  (cost=2311.46..290726.27 rows=319980 width=10) (actual time=2.657..1452.428 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255216.92 rows=7999492 width=14) (actual time=0.017..730.321 rows=8000000 loops=1)
                 ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=2.611..2.613 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.442..2.245 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.007 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.432..1.908 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.255..0.256 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=316670.49..316937.14 rows=106660 width=36) (actual time=3432.982..3432.985 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  HashAggregate  (cost=307412.73..316137.19 rows=106660 width=36) (actual time=3432.967..3432.969 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Planned Partitions: 8  Batches: 9  Memory Usage: 34897kB  Disk Usage: 9736kB
               Rows Removed by Filter: 301833
               ->  Hash Join  (cost=2311.46..290726.27 rows=319980 width=14) (actual time=3.492..1503.779 rows=320800 loops=1)
                     Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                     ->  Seq Scan on partsupp  (cost=0.00..255216.92 rows=7999492 width=18) (actual time=0.028..762.688 rows=8000000 loops=1)
                     ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=3.438..3.439 rows=4010 loops=1)
                           Buckets: 4096  Batches: 1  Memory Usage: 173kB
                           ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.438..3.061 rows=4010 loops=1)
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.008 rows=1 loops=1)
                                       Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                       Rows Removed by Filter: 24
                                 ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.429..2.703 rows=4010 loops=1)
                                       Recheck Cond: (s_nationkey = nation.n_nationkey)
                                       Heap Blocks: exact=1869
                                       ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.249..0.249 rows=4010 loops=1)
                                             Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 0.898 ms
 Execution Time: 3434.733 ms
(41 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3031574.43..3032406.43 rows=1 width=27) (actual time=19141.031..19141.034 rows=1 loops=1)
   ->  GroupAggregate  (cost=3031574.43..3037398.38 rows=7 width=27) (actual time=19141.030..19141.032 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3031574.43..3032302.42 rows=291194 width=27) (actual time=19097.497..19103.623 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Hash Join  (cost=2478473.50..3005146.22 rows=291194 width=27) (actual time=14814.618..19025.647 rows=311258 loops=1)
                     Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Seq Scan on orders  (cost=0.00..411263.87 rows=14999587 width=20) (actual time=0.550..1651.527 rows=15000000 loops=1)
                     ->  Hash  (cost=2474833.58..2474833.58 rows=291194 width=15) (actual time=14813.302..14813.303 rows=311258 loops=1)
                           Buckets: 524288  Batches: 1  Memory Usage: 18687kB
                           ->  Seq Scan on lineitem  (cost=0.00..2474833.58 rows=291194 width=15) (actual time=1.155..14724.677 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning Time: 15.436 ms
 Execution Time: 19142.165 ms
(16 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3031574.43..3032406.43 rows=1 width=27) (actual time=16513.532..16513.535 rows=1 loops=1)
   ->  GroupAggregate  (cost=3031574.43..3037398.38 rows=7 width=27) (actual time=16513.531..16513.533 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3031574.43..3032302.42 rows=291194 width=27) (actual time=16470.066..16476.170 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Hash Join  (cost=2478473.50..3005146.22 rows=291194 width=27) (actual time=12736.059..16400.886 rows=311258 loops=1)
                     Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Seq Scan on orders  (cost=0.00..411263.87 rows=14999587 width=20) (actual time=0.020..1241.971 rows=15000000 loops=1)
                     ->  Hash  (cost=2474833.58..2474833.58 rows=291194 width=15) (actual time=12735.355..12735.356 rows=311258 loops=1)
                           Buckets: 524288  Batches: 1  Memory Usage: 18687kB
                           ->  Seq Scan on lineitem  (cost=0.00..2474833.58 rows=291194 width=15) (actual time=0.111..12654.154 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning Time: 0.675 ms
 Execution Time: 16513.621 ms
(16 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369838.49..1369838.50 rows=1 width=16) (actual time=17760.849..17760.852 rows=1 loops=1)
   ->  Sort  (cost=1369838.49..1369838.99 rows=200 width=16) (actual time=17760.847..17760.850 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369835.49..1369837.49 rows=200 width=16) (actual time=17760.820..17760.828 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215162.66..1347335.33 rows=1500011 width=12) (actual time=15126.099..17593.409 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53284.73..664451.66 rows=14998087 width=8) (actual time=343.196..11273.635 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448762.84 rows=14998087 width=8) (actual time=0.578..5139.930 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.59..28674.59 rows=1500011 width=4) (actual time=341.226..341.227 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.59 rows=1500011 width=4) (actual time=0.019..157.648 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 14.639 ms
 Execution Time: 17814.273 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369838.49..1369838.50 rows=1 width=16) (actual time=17139.459..17139.462 rows=1 loops=1)
   ->  Sort  (cost=1369838.49..1369838.99 rows=200 width=16) (actual time=17139.458..17139.460 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369835.49..1369837.49 rows=200 width=16) (actual time=17139.432..17139.439 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215162.66..1347335.33 rows=1500011 width=12) (actual time=14562.382..16973.172 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53284.73..664451.66 rows=14998087 width=8) (actual time=305.949..10725.466 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448762.84 rows=14998087 width=8) (actual time=0.033..4672.412 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.59..28674.59 rows=1500011 width=4) (actual time=304.475..304.476 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.59 rows=1500011 width=4) (actual time=0.018..124.603 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.686 ms
 Execution Time: 17194.631 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1309262.45..1309262.47 rows=1 width=32) (actual time=68429.060..68429.062 rows=1 loops=1)
   ->  Aggregate  (cost=1309262.45..1309262.47 rows=1 width=32) (actual time=68429.058..68429.060 rows=1 loops=1)
         ->  Hash Join  (cost=99653.25..1295655.94 rows=777515 width=33) (actual time=864.944..67969.327 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Index Scan using idx_lineitem_shipdate on lineitem  (cost=0.56..1172696.28 rows=777515 width=16) (actual time=1.192..65933.822 rows=772942 loops=1)
                     Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60980.86..60980.86 rows=1999986 width=25) (actual time=858.837..858.837 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60980.86 rows=1999986 width=25) (actual time=0.366..531.773 rows=2000000 loops=1)
 Planning Time: 15.049 ms
 Execution Time: 68429.457 ms
(11 rows)

SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1309262.45..1309262.47 rows=1 width=32) (actual time=3527.116..3527.119 rows=1 loops=1)
   ->  Aggregate  (cost=1309262.45..1309262.47 rows=1 width=32) (actual time=3527.115..3527.117 rows=1 loops=1)
         ->  Hash Join  (cost=99653.25..1295655.94 rows=777515 width=33) (actual time=732.128..3223.882 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Index Scan using idx_lineitem_shipdate on lineitem  (cost=0.56..1172696.28 rows=777515 width=16) (actual time=0.053..1898.787 rows=772942 loops=1)
                     Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60980.86..60980.86 rows=1999986 width=25) (actual time=731.104..731.105 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60980.86 rows=1999986 width=25) (actual time=0.025..412.211 rows=2000000 loops=1)
 Planning Time: 0.922 ms
 Execution Time: 3527.193 ms
(11 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3867623.85..3869181.54 rows=1 width=103) (actual time=26956.443..26956.446 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1886205.62..1886205.63 rows=1 width=32) (actual time=6052.274..6052.275 rows=1 loops=1)
           ->  HashAggregate  (cost=1883733.79..1884969.70 rows=98873 width=36) (actual time=5983.637..6046.534 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=37161.69..1860557.57 rows=2317622 width=16) (actual time=355.203..4527.956 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36582.29 rows=2317622 width=0) (actual time=282.564..282.564 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1981418.23..2750915.83 rows=494 width=103) (actual time=26956.441..26956.442 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = revenue0.supplier_no)
         Rows Removed by Join Filter: 69997
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=71) (actual time=0.379..17.263 rows=69998 loops=1)
         ->  Materialize  (cost=1981417.94..2005788.65 rows=494 width=36) (actual time=0.384..0.385 rows=1 loops=69998)
               ->  Subquery Scan on revenue0  (cost=1981417.94..2005786.18 rows=494 width=36) (actual time=26869.271..26923.659 rows=1 loops=1)
                     ->  HashAggregate  (cost=1981417.94..2005781.24 rows=494 width=36) (actual time=26869.269..26923.656 rows=1 loops=1)
                           Group Key: lineitem.l_suppkey
                           Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
                           Planned Partitions: 4  Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                           Rows Removed by Filter: 99999
                           ->  Bitmap Heap Scan on lineitem  (cost=37161.69..1860557.57 rows=2317622 width=16) (actual time=416.522..18763.879 rows=2265714 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                 Rows Removed by Index Recheck: 13223651
                                 Heap Blocks: exact=401153 lossy=267105
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36582.29 rows=2317622 width=0) (actual time=342.653..342.653 rows=2265714 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning Time: 14.546 ms
 Execution Time: 26959.187 ms
(31 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3867623.85..3869181.54 rows=1 width=103) (actual time=12810.482..12810.485 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1886205.62..1886205.63 rows=1 width=32) (actual time=6100.020..6100.021 rows=1 loops=1)
           ->  HashAggregate  (cost=1883733.79..1884969.70 rows=98873 width=36) (actual time=6031.074..6094.279 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=37161.69..1860557.57 rows=2317622 width=16) (actual time=358.560..4562.192 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36582.29 rows=2317622 width=0) (actual time=285.997..285.998 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1981418.23..2750915.83 rows=494 width=103) (actual time=12810.481..12810.482 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = revenue0.supplier_no)
         Rows Removed by Join Filter: 69997
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=71) (actual time=0.044..12.488 rows=69998 loops=1)
         ->  Materialize  (cost=1981417.94..2005788.65 rows=494 width=36) (actual time=0.182..0.183 rows=1 loops=69998)
               ->  Subquery Scan on revenue0  (cost=1981417.94..2005786.18 rows=494 width=36) (actual time=12729.989..12783.035 rows=1 loops=1)
                     ->  HashAggregate  (cost=1981417.94..2005781.24 rows=494 width=36) (actual time=12729.988..12783.033 rows=1 loops=1)
                           Group Key: lineitem.l_suppkey
                           Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
                           Planned Partitions: 4  Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                           Rows Removed by Filter: 99999
                           ->  Bitmap Heap Scan on lineitem  (cost=37161.69..1860557.57 rows=2317622 width=16) (actual time=380.085..5133.986 rows=2265714 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                 Rows Removed by Index Recheck: 13223651
                                 Heap Blocks: exact=401153 lossy=267105
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36582.29 rows=2317622 width=0) (actual time=307.271..307.271 rows=2265714 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning Time: 1.163 ms
 Execution Time: 12812.644 ms
(31 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=357974.90..357974.90 rows=1 width=44) (actual time=6560.716..6560.719 rows=1 loops=1)
   ->  Sort  (cost=357974.90..358357.91 rows=153204 width=44) (actual time=6560.715..6560.717 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=348316.08..357208.88 rows=153204 width=44) (actual time=5907.767..6555.403 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=348316.08..349788.23 rows=588861 width=40) (actual time=5907.715..6263.725 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Hash Join  (cost=98132.69..281528.66 rows=588861 width=40) (actual time=823.240..3086.071 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176368.07 rows=3999746 width=8) (actual time=35.908..1477.973 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.929..35.602 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90980.65..90980.65 rows=294447 width=40) (actual time=786.657..786.658 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90980.65 rows=294447 width=40) (actual time=0.706..715.303 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning Time: 16.606 ms
 Execution Time: 6568.855 ms
(26 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=357974.90..357974.90 rows=1 width=44) (actual time=6071.185..6071.188 rows=1 loops=1)
   ->  Sort  (cost=357974.90..358357.91 rows=153204 width=44) (actual time=6071.184..6071.186 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=348316.08..357208.88 rows=153204 width=44) (actual time=5415.881..6065.912 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=348316.08..349788.23 rows=588861 width=40) (actual time=5415.829..5775.941 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Hash Join  (cost=98132.69..281528.66 rows=588861 width=40) (actual time=524.033..2595.972 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176368.07 rows=3999746 width=8) (actual time=20.586..1296.505 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.092..20.533 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90980.65..90980.65 rows=294447 width=40) (actual time=502.814..502.815 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90980.65 rows=294447 width=40) (actual time=0.017..440.292 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning Time: 1.199 ms
 Execution Time: 6079.303 ms
(26 rows)

query 17 run 1
SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4902133.28..4902133.29 rows=1 width=32) (actual time=54160.331..54160.334 rows=1 loops=1)
   ->  Aggregate  (cost=4902133.28..4902133.29 rows=1 width=32) (actual time=54160.330..54160.332 rows=1 loops=1)
         ->  Nested Loop  (cost=4174372.23..4902087.94 rows=18132 width=8) (actual time=32198.142..54158.318 rows=5319 loops=1)
               Join Filter: (part.p_partkey = lineitem.l_partkey)
               ->  Hash Join  (cost=4174371.79..4811273.05 rows=1814 width=40) (actual time=32197.374..52786.780 rows=1996 loops=1)
                     Hash Cond: (lineitem_1.l_partkey = part.p_partkey)
                     ->  HashAggregate  (cost=4103366.48..4716915.23 rows=1849703 width=36) (actual time=31667.078..52101.399 rows=2000000 loops=1)
                           Group Key: lineitem_1.l_partkey
                           Planned Partitions: 32  Batches: 33  Memory Usage: 33041kB  Disk Usage: 2080800kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1725005.48 rows=59986248 width=9) (actual time=0.512..7030.917 rows=59986052 loops=1)
                     ->  Hash  (cost=70980.79..70980.79 rows=1961 width=4) (actual time=529.077..529.078 rows=1996 loops=1)
                           Buckets: 2048  Batches: 1  Memory Usage: 87kB
                           ->  Seq Scan on part  (cost=0.00..70980.79 rows=1961 width=4) (actual time=0.923..528.074 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.93 rows=11 width=17) (actual time=0.539..0.685 rows=3 loops=1996)
                     Index Cond: (l_partkey = lineitem_1.l_partkey)
                     Filter: (l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
                     Rows Removed by Filter: 27
 Planning Time: 16.440 ms
 Execution Time: 54405.936 ms
(21 rows)

SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4902133.28..4902133.29 rows=1 width=32) (actual time=50053.113..50053.116 rows=1 loops=1)
   ->  Aggregate  (cost=4902133.28..4902133.29 rows=1 width=32) (actual time=50053.112..50053.114 rows=1 loops=1)
         ->  Nested Loop  (cost=4174372.23..4902087.94 rows=18132 width=8) (actual time=29509.720..50052.335 rows=5319 loops=1)
               Join Filter: (part.p_partkey = lineitem.l_partkey)
               ->  Hash Join  (cost=4174371.79..4811273.05 rows=1814 width=40) (actual time=29509.696..50007.932 rows=1996 loops=1)
                     Hash Cond: (lineitem_1.l_partkey = part.p_partkey)
                     ->  HashAggregate  (cost=4103366.48..4716915.23 rows=1849703 width=36) (actual time=29244.159..49599.983 rows=2000000 loops=1)
                           Group Key: lineitem_1.l_partkey
                           Planned Partitions: 32  Batches: 33  Memory Usage: 33041kB  Disk Usage: 2080800kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1725005.48 rows=59986248 width=9) (actual time=0.034..5232.427 rows=59986052 loops=1)
                     ->  Hash  (cost=70980.79..70980.79 rows=1961 width=4) (actual time=264.308..264.308 rows=1996 loops=1)
                           Buckets: 2048  Batches: 1  Memory Usage: 87kB
                           ->  Seq Scan on part  (cost=0.00..70980.79 rows=1961 width=4) (actual time=0.106..263.787 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.93 rows=11 width=17) (actual time=0.010..0.021 rows=3 loops=1996)
                     Index Cond: (l_partkey = lineitem_1.l_partkey)
                     Filter: (l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
                     Rows Removed by Filter: 27
 Planning Time: 0.785 ms
 Execution Time: 50304.894 ms
(21 rows)

query 18 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8775254.37..8775254.62 rows=100 width=71) (actual time=41037.815..41037.828 rows=99 loops=1)
   ->  Sort  (cost=8775254.37..8825232.82 rows=19991383 width=71) (actual time=41037.814..41037.821 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409894.77..8011198.08 rows=19991383 width=71) (actual time=41037.327..41037.732 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3121kB
               ->  Hash Join  (cost=78614.74..6333015.19 rows=19991383 width=44) (actual time=4284.572..41036.944 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=127.50..5919940.42 rows=19991383 width=25) (actual time=978.797..40252.977 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390285.88 rows=4998854 width=24) (actual time=749.109..29207.500 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547959.24 rows=14999587 width=20) (actual time=0.546..2980.470 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692353.45 rows=4998854 width=4) (actual time=640.807..25336.684 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167473.78 rows=59986248 width=9) (actual time=0.491..12054.949 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167473.78 rows=59986248 width=9) (actual time=0.014..7654.625 rows=59916431 loops=1)
                     ->  Hash  (cost=50947.11..50947.11 rows=1500011 width=23) (actual time=675.119..675.120 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=23) (actual time=0.826..420.420 rows=1500000 loops=1)
 Planning Time: 19.707 ms
 Execution Time: 41039.051 ms
(25 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8775254.37..8775254.62 rows=100 width=71) (actual time=37660.080..37660.094 rows=99 loops=1)
   ->  Sort  (cost=8775254.37..8825232.82 rows=19991383 width=71) (actual time=37660.079..37660.086 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409894.77..8011198.08 rows=19991383 width=71) (actual time=37659.591..37659.997 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3121kB
               ->  Hash Join  (cost=78614.74..6333015.19 rows=19991383 width=44) (actual time=3699.547..37659.229 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=127.50..5919940.42 rows=19991383 width=25) (actual time=845.443..37002.713 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390285.88 rows=4998854 width=24) (actual time=612.260..25924.992 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547959.24 rows=14999587 width=20) (actual time=0.023..2387.075 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692353.45 rows=4998854 width=4) (actual time=532.261..22669.900 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167473.78 rows=59986248 width=9) (actual time=0.015..9717.275 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167473.78 rows=59986248 width=9) (actual time=0.013..7688.817 rows=59916431 loops=1)
                     ->  Hash  (cost=50947.11..50947.11 rows=1500011 width=23) (actual time=547.768..547.768 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50947.11 rows=1500011 width=23) (actual time=0.029..297.789 rows=1500000 loops=1)
 Planning Time: 1.616 ms
 Execution Time: 37660.805 ms
(25 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=380009.35..380009.36 rows=1 width=32) (actual time=22680.736..22680.737 rows=1 loops=1)
   ->  Aggregate  (cost=380009.35..380009.36 rows=1 width=32) (actual time=22680.734..22680.735 rows=1 loops=1)
         ->  Nested Loop  (cost=0.44..380000.91 rows=1125 width=12) (actual time=58.228..22677.664 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125980.40 rows=4888 width=30) (actual time=1.553..815.565 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.96 rows=1 width=21) (actual time=4.125..4.571 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning Time: 17.563 ms
 Execution Time: 22681.929 ms
(12 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=380009.35..380009.36 rows=1 width=32) (actual time=630.288..630.290 rows=1 loops=1)
   ->  Aggregate  (cost=380009.35..380009.36 rows=1 width=32) (actual time=630.287..630.288 rows=1 loops=1)
         ->  Nested Loop  (cost=0.44..380000.91 rows=1125 width=12) (actual time=1.524..629.607 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125980.40 rows=4888 width=30) (actual time=0.222..466.391 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.96 rows=1 width=21) (actual time=0.030..0.034 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning Time: 1.000 ms
 Execution Time: 630.340 ms
(12 rows)

query 20 run 1
SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2778412.56..2778412.56 rows=1 width=51) (actual time=63091.948..63091.952 rows=1 loops=1)
   ->  Sort  (cost=2778412.56..2778412.56 rows=1 width=51) (actual time=63091.947..63091.950 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2525693.47..2778412.55 rows=1 width=51) (actual time=41628.230..63090.082 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 183372192
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=55) (actual time=0.574..23.505 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.291..0.293 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=59) (actual time=0.276..15.816 rows=100000 loops=1)
               ->  Materialize  (cost=2525693.47..2773760.24 rows=3 width=8) (actual time=9.822..12.947 rows=44780 loops=4095)
                     ->  Hash Join  (cost=2525693.47..2773760.23 rows=3 width=8) (actual time=40218.897..46903.216 rows=59002 loops=1)
                           Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  HashAggregate  (cost=2383285.80..2546203.39 rows=4865659 width=40) (actual time=35210.277..41104.468 rows=5448842 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 Planned Partitions: 64  Batches: 65  Memory Usage: 35345kB  Disk Usage: 388568kB
                                 ->  Bitmap Heap Scan on lineitem  (cost=147655.93..1995136.25 rows=9209109 width=13) (actual time=1264.242..30195.261 rows=9123688 loops=1)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                       Rows Removed by Index Recheck: 23164080
                                       Heap Blocks: exact=518099 lossy=530696
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145353.65 rows=9209109 width=0) (actual time=1158.727..1158.727 rows=9123688 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Hash  (cost=141195.62..141195.62 rows=80803 width=16) (actual time=5008.183..5008.184 rows=86872 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                                 ->  Nested Loop  (cost=0.43..141195.62 rows=80803 width=16) (actual time=0.791..4957.456 rows=86872 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65980.82 rows=20202 width=4) (actual time=0.450..735.186 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.55 rows=17 width=12) (actual time=0.177..0.192 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 21.047 ms
 Execution Time: 63136.748 ms
(38 rows)

SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2778412.56..2778412.56 rows=1 width=51) (actual time=36290.298..36290.303 rows=1 loops=1)
   ->  Sort  (cost=2778412.56..2778412.56 rows=1 width=51) (actual time=36290.297..36290.301 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2525693.47..2778412.55 rows=1 width=51) (actual time=15057.037..36288.519 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 183372192
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=55) (actual time=0.031..19.638 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=59) (actual time=0.006..12.238 rows=100000 loops=1)
               ->  Materialize  (cost=2525693.47..2773760.24 rows=3 width=8) (actual time=3.332..6.458 rows=44780 loops=4095)
                     ->  Hash Join  (cost=2525693.47..2773760.23 rows=3 width=8) (actual time=13646.027..20340.231 rows=59002 loops=1)
                           Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  HashAggregate  (cost=2383285.80..2546203.39 rows=4865659 width=40) (actual time=13066.906..18969.885 rows=5448842 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 Planned Partitions: 64  Batches: 65  Memory Usage: 35345kB  Disk Usage: 388568kB
                                 ->  Bitmap Heap Scan on lineitem  (cost=147655.93..1995136.25 rows=9209109 width=13) (actual time=1117.124..9004.304 rows=9123688 loops=1)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                       Rows Removed by Index Recheck: 23164080
                                       Heap Blocks: exact=518099 lossy=530696
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145353.65 rows=9209109 width=0) (actual time=1012.388..1012.388 rows=9123688 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Hash  (cost=141195.62..141195.62 rows=80803 width=16) (actual time=578.704..578.706 rows=86872 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                                 ->  Nested Loop  (cost=0.43..141195.62 rows=80803 width=16) (actual time=0.061..554.347 rows=86872 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65980.82 rows=20202 width=4) (actual time=0.042..335.403 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.55 rows=17 width=12) (actual time=0.008..0.009 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 1.974 ms
 Execution Time: 36348.821 ms
(38 rows)

query 21 run 1
SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3769636.81..3769636.82 rows=1 width=34) (actual time=25560.918..25560.933 rows=100 loops=1)
   ->  Sort  (cost=3769636.81..3769636.82 rows=1 width=34) (actual time=25560.917..25560.926 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=3769636.78..3769636.80 rows=1 width=34) (actual time=25553.925..25559.744 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=3769636.78..3769636.79 rows=1 width=26) (actual time=25553.913..25555.396 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=1976511.38..3769636.77 rows=1 width=26) (actual time=15205.269..25383.311 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 42025
                           ->  Nested Loop Anti Join  (cost=1976510.82..3769633.13 rows=1 width=38) (actual time=15203.871..25237.195 rows=65960 loops=1)
                                 ->  Hash Join  (cost=1976510.25..2519818.78 rows=389244 width=38) (actual time=15201.588..20027.784 rows=730985 loops=1)
                                       Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..448762.84 rows=7299799 width=4) (actual time=0.420..2480.841 rows=7309184 loops=1)
                                             Filter: (o_orderstatus = 'F'::bpchar)
                                             Rows Removed by Filter: 7690816
                                       ->  Hash  (cost=1960263.54..1960263.54 rows=799817 width=34) (actual time=15200.331..15200.334 rows=1514267 loops=1)
                                             Buckets: 524288  Batches: 4  Memory Usage: 29225kB
                                             ->  Hash Join  (cost=2311.46..1960263.54 rows=799817 width=34) (actual time=61.086..14819.372 rows=1514267 loops=1)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Seq Scan on lineitem l1  (cost=0.00..1874971.10 rows=19995416 width=8) (actual time=0.422..11459.426 rows=37929348 loops=1)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 22056704
                                                   ->  Hash  (cost=2261.46..2261.46 rows=4000 width=30) (actual time=60.554..60.555 rows=3991 loops=1)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=30) (actual time=1.684..59.180 rows=3991 loops=1)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.181..0.187 rows=1 loops=1)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=34) (actual time=1.495..58.150 rows=3991 loops=1)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=1.046..1.046 rows=3991 loops=1)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.007..0.007 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = l1.l_orderkey)
                                       Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.002..0.002 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 19.414 ms
 Execution Time: 25561.723 ms
(44 rows)

SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3769636.81..3769636.82 rows=1 width=34) (actual time=21461.598..21461.614 rows=100 loops=1)
   ->  Sort  (cost=3769636.81..3769636.82 rows=1 width=34) (actual time=21461.597..21461.607 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=3769636.78..3769636.80 rows=1 width=34) (actual time=21454.486..21460.425 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=3769636.78..3769636.79 rows=1 width=26) (actual time=21454.474..21456.052 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=1976511.38..3769636.77 rows=1 width=26) (actual time=12955.573..21284.322 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 42025
                           ->  Nested Loop Anti Join  (cost=1976510.82..3769633.13 rows=1 width=38) (actual time=12955.111..21144.304 rows=65960 loops=1)
                                 ->  Hash Join  (cost=1976510.25..2519818.78 rows=389244 width=38) (actual time=12954.638..17283.601 rows=730985 loops=1)
                                       Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..448762.84 rows=7299799 width=4) (actual time=0.022..2023.527 rows=7309184 loops=1)
                                             Filter: (o_orderstatus = 'F'::bpchar)
                                             Rows Removed by Filter: 7690816
                                       ->  Hash  (cost=1960263.54..1960263.54 rows=799817 width=34) (actual time=12953.588..12953.591 rows=1514267 loops=1)
                                             Buckets: 524288  Batches: 4  Memory Usage: 29225kB
                                             ->  Hash Join  (cost=2311.46..1960263.54 rows=799817 width=34) (actual time=15.200..12608.341 rows=1514267 loops=1)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Seq Scan on lineitem l1  (cost=0.00..1874971.10 rows=19995416 width=8) (actual time=0.030..9619.139 rows=37929348 loops=1)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 22056704
                                                   ->  Hash  (cost=2261.46..2261.46 rows=4000 width=30) (actual time=15.137..15.138 rows=3991 loops=1)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=30) (actual time=0.556..14.275 rows=3991 loops=1)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.015..0.018 rows=1 loops=1)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=34) (actual time=0.536..13.689 rows=3991 loops=1)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.344..0.344 rows=3991 loops=1)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.005..0.005 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = l1.l_orderkey)
                                       Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.002..0.002 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 2.286 ms
 Execution Time: 21461.776 ms
(44 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161751.60..161751.63 rows=1 width=72) (actual time=1978.315..1978.318 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75441.82..75441.83 rows=1 width=32) (actual time=977.573..977.574 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75322.29 rows=47812 width=6) (actual time=0.017..941.805 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86309.77..86509.72 rows=7271 width=72) (actual time=1978.314..1978.315 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86309.77..86327.95 rows=7271 width=38) (actual time=1976.553..1976.881 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85843.41 rows=7271 width=38) (actual time=978.141..1956.177 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75322.29 rows=17500 width=26) (actual time=978.124..1507.721 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.002..0.002 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning Time: 14.102 ms
 Execution Time: 1979.154 ms
(20 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161751.60..161751.63 rows=1 width=72) (actual time=1557.547..1557.549 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75441.82..75441.83 rows=1 width=32) (actual time=715.777..715.778 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75322.29 rows=47812 width=6) (actual time=0.007..683.754 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86309.77..86509.72 rows=7271 width=72) (actual time=1557.546..1557.546 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86309.77..86327.95 rows=7271 width=38) (actual time=1555.771..1556.103 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85843.41 rows=7271 width=38) (actual time=715.824..1537.031 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75322.29 rows=17500 width=26) (actual time=715.807..1218.888 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.001..0.001 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning Time: 0.708 ms
 Execution Time: 1557.603 ms
(20 rows)

