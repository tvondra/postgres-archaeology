query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832098.70..1832099.34 rows=1 width=236) (actual time=21302.414..21302.480 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832098.70..1832102.52 rows=6 width=236) (actual time=21302.412..21302.478 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832098.70..1832101.58 rows=24 width=236) (actual time=21302.392..21302.459 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831098.65..1831098.66 rows=6 width=236) (actual time=21294.095..21294.096 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1831098.43..1831098.57 rows=6 width=236) (actual time=21294.053..21294.059 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 32kB
                           Worker 0:  Batches: 1  Memory Usage: 32kB
                           Worker 1:  Batches: 1  Memory Usage: 32kB
                           Worker 2:  Batches: 1  Memory Usage: 32kB
                           Worker 3:  Batches: 1  Memory Usage: 32kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312611.16 rows=14813922 width=25) (actual time=1.046..4457.415 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 14.862 ms
 Execution Time: 21303.481 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832098.70..1832099.34 rows=1 width=236) (actual time=20792.925..20793.414 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832098.70..1832102.52 rows=6 width=236) (actual time=20792.924..20793.412 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832098.70..1832101.58 rows=24 width=236) (actual time=20792.898..20793.390 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831098.65..1831098.66 rows=6 width=236) (actual time=20788.261..20788.262 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1831098.43..1831098.57 rows=6 width=236) (actual time=20788.220..20788.227 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 32kB
                           Worker 0:  Batches: 1  Memory Usage: 32kB
                           Worker 1:  Batches: 1  Memory Usage: 32kB
                           Worker 2:  Batches: 1  Memory Usage: 32kB
                           Worker 3:  Batches: 1  Memory Usage: 32kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312611.16 rows=14813922 width=25) (actual time=0.029..2915.602 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.983 ms
 Execution Time: 20793.496 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1073670.68..1073670.69 rows=1 width=192) (actual time=4292.368..4292.478 rows=100 loops=1)
   ->  Sort  (cost=1073670.68..1073670.69 rows=1 width=192) (actual time=4292.366..4292.471 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=554183.37..1073670.67 rows=1 width=192) (actual time=3255.485..4289.430 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68718.40 rows=8445 width=30) (actual time=68.731..72.106 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.46 rows=2111 width=30) (actual time=2.066..288.253 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=553182.58..561044.50 rows=1572384 width=172) (actual time=3185.628..3635.103 rows=1603828 loops=1)
                     ->  Sort  (cost=553182.58..557113.54 rows=1572384 width=172) (actual time=3185.623..3459.449 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293512kB
                           ->  Hash Join  (cost=4048.51..304973.46 rows=1572384 width=172) (actual time=76.275..2538.069 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255206.81 rows=7998481 width=14) (actual time=1.373..1075.969 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=74.857..74.859 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=10.922..67.172 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=1.867..44.489 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=9.046..9.048 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=9.039..9.045 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=4.943..4.945 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=4.082..4.083 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=4.076..4.077 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.062..0.062 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.052..0.060 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.047..0.058 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.046..0.056 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.042..0.043 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 21.018 ms
 Execution Time: 4328.812 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1073670.68..1073670.69 rows=1 width=192) (actual time=3478.763..3478.881 rows=100 loops=1)
   ->  Sort  (cost=1073670.68..1073670.69 rows=1 width=192) (actual time=3478.762..3478.874 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=554183.37..1073670.67 rows=1 width=192) (actual time=2746.053..3476.371 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68718.40 rows=8445 width=30) (actual time=27.331..29.801 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.46 rows=2111 width=30) (actual time=0.161..122.961 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=553182.58..561044.50 rows=1572384 width=172) (actual time=2718.614..3156.686 rows=1603828 loops=1)
                     ->  Sort  (cost=553182.58..557113.54 rows=1572384 width=172) (actual time=2718.609..2980.861 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293512kB
                           ->  Hash Join  (cost=4048.51..304973.46 rows=1572384 width=172) (actual time=38.093..2083.211 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255206.81 rows=7998481 width=14) (actual time=0.034..755.447 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=38.033..38.036 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.044..32.019 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.010..15.897 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.031..0.033 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.025..0.031 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.005..0.007 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.017..0.017 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.009..0.015 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 2.127 ms
 Execution Time: 3514.312 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2270717.37..2270717.39 rows=10 width=44) (actual time=10210.575..10243.812 rows=10 loops=1)
   ->  Sort  (cost=2270717.37..2278519.56 rows=3120876 width=44) (actual time=10210.573..10243.810 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1743775.30..2203276.36 rows=3120876 width=44) (actual time=9979.597..10220.076 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1743775.30..2117452.27 rows=3120876 width=24) (actual time=9979.583..10056.022 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1742775.24..1744725.79 rows=780219 width=24) (actual time=9969.672..9972.465 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 5682kB
                           Worker 0:  Sort Method: quicksort  Memory: 5727kB
                           Worker 1:  Sort Method: quicksort  Memory: 5602kB
                           Worker 2:  Sort Method: quicksort  Memory: 5647kB
                           Worker 3:  Sort Method: quicksort  Memory: 5641kB
                           ->  Nested Loop  (cost=41558.45..1656130.09 rows=780219 width=24) (actual time=236.636..9947.915 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41557.88..354472.69 rows=358326 width=12) (actual time=234.992..1808.932 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308141.77 rows=1818298 width=16) (actual time=0.435..1124.817 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.20..40634.20 rows=73895 width=4) (actual time=233.877..233.878 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.20 rows=73895 width=4) (actual time=0.082..214.428 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.027..0.028 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 18.264 ms
 Execution Time: 10244.405 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2270717.37..2270717.39 rows=10 width=44) (actual time=3896.303..3929.148 rows=10 loops=1)
   ->  Sort  (cost=2270717.37..2278519.56 rows=3120876 width=44) (actual time=3896.302..3929.145 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1743775.30..2203276.36 rows=3120876 width=44) (actual time=3655.476..3904.159 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1743775.30..2117452.27 rows=3120876 width=24) (actual time=3655.455..3736.313 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1742775.24..1744725.79 rows=780219 width=24) (actual time=3647.280..3650.049 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 5967kB
                           Worker 0:  Sort Method: quicksort  Memory: 5720kB
                           Worker 1:  Sort Method: quicksort  Memory: 5849kB
                           Worker 2:  Sort Method: quicksort  Memory: 5233kB
                           Worker 3:  Sort Method: quicksort  Memory: 5531kB
                           ->  Nested Loop  (cost=41558.45..1656130.09 rows=780219 width=24) (actual time=133.486..3625.218 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41557.88..354472.69 rows=358326 width=12) (actual time=133.308..1223.710 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308141.77 rows=1818298 width=16) (actual time=0.036..571.500 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.20..40634.20 rows=73895 width=4) (actual time=132.502..132.502 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.20 rows=73895 width=4) (actual time=0.026..109.539 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.008..0.008 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.646 ms
 Execution Time: 3929.229 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282738.47..652505.16 rows=1 width=24) (actual time=30527.690..30552.977 rows=1 loops=1)
   ->  GroupAggregate  (cost=282738.47..2131571.90 rows=5 width=24) (actual time=30527.689..30552.975 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282738.47..2128779.53 rows=558463 width=16) (actual time=6436.954..30470.482 rows=103030 loops=1)
               ->  Gather Merge  (cost=282737.91..349614.85 rows=558543 width=20) (actual time=6434.859..6580.647 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281737.85..282086.94 rows=139636 width=20) (actual time=6420.075..6423.339 rows=23304 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 10078kB
                           Worker 0:  Sort Method: quicksort  Memory: 10046kB
                           Worker 1:  Sort Method: quicksort  Memory: 10090kB
                           Worker 2:  Sort Method: quicksort  Memory: 10074kB
                           Worker 3:  Sort Method: quicksort  Memory: 10102kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6442.50..269805.04 rows=139636 width=20) (actual time=131.022..6365.404 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46442
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6302.87 rows=558543 width=0) (actual time=87.147..87.147 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.211..0.211 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 15.459 ms
 Execution Time: 30553.416 ms
(25 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282738.47..652505.16 rows=1 width=24) (actual time=1680.358..1708.271 rows=1 loops=1)
   ->  GroupAggregate  (cost=282738.47..2131571.90 rows=5 width=24) (actual time=1680.357..1708.269 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282738.47..2128779.53 rows=558463 width=16) (actual time=714.259..1685.242 rows=103030 loops=1)
               ->  Gather Merge  (cost=282737.91..349614.85 rows=558543 width=20) (actual time=714.199..779.440 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281737.85..282086.94 rows=139636 width=20) (actual time=703.688..706.055 rows=23375 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 10959kB
                           Worker 0:  Sort Method: quicksort  Memory: 9300kB
                           Worker 1:  Sort Method: quicksort  Memory: 9772kB
                           Worker 2:  Sort Method: quicksort  Memory: 10081kB
                           Worker 3:  Sort Method: quicksort  Memory: 10277kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6442.50..269805.04 rows=139636 width=20) (actual time=128.950..663.889 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=52165
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6302.87 rows=558543 width=0) (actual time=83.698..83.699 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.272 ms
 Execution Time: 1708.625 ms
(25 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=776344.38..776344.39 rows=1 width=58) (actual time=22844.777..22890.301 rows=1 loops=1)
   ->  Sort  (cost=776344.38..776344.45 rows=25 width=58) (actual time=22844.776..22890.299 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=776097.71..776344.26 rows=25 width=58) (actual time=22836.148..22890.283 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=776097.71..776343.20 rows=100 width=58) (actual time=22834.560..22890.250 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=775097.65..775331.23 rows=25 width=58) (actual time=22817.805..22824.486 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=775097.65..775144.31 rows=18661 width=38) (actual time=22816.364..22817.062 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1525kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1510kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1498kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1507kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1510kB
                                 ->  Parallel Hash Join  (cost=73420.75..773773.87 rows=18661 width=38) (actual time=564.866..22800.925 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69729.15..767630.25 rows=467052 width=50) (actual time=546.313..22633.312 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69728.59..342236.63 rows=116780 width=38) (actual time=545.060..4105.135 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26935.77..296962.25 rows=583898 width=8) (actual time=259.788..3590.664 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52509
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..26351.88 rows=2335594 width=0) (actual time=202.996..202.996 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.38..41855.38 rows=74995 width=38) (actual time=284.689..284.692 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25312kB
                                                         ->  Hash Join  (cost=2.51..41855.38 rows=74995 width=38) (actual time=0.830..257.283 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.76 rows=374976 width=8) (actual time=0.237..217.594 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.585..0.587 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.578..0.585 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.180..0.182 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.390..0.391 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.386..0.387 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.192..0.202 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.778..15.779 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5088kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.088..9.387 rows=20000 loops=5)
 Planning Time: 28.137 ms
 Execution Time: 22890.801 ms
(50 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=776344.38..776344.39 rows=1 width=58) (actual time=2588.572..2627.412 rows=1 loops=1)
   ->  Sort  (cost=776344.38..776344.45 rows=25 width=58) (actual time=2588.570..2627.410 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=776097.71..776344.26 rows=25 width=58) (actual time=2575.480..2627.391 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=776097.71..776343.20 rows=100 width=58) (actual time=2573.862..2627.355 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=775097.65..775331.23 rows=25 width=58) (actual time=2558.050..2566.624 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=775097.65..775144.31 rows=18661 width=38) (actual time=2556.623..2557.362 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1599kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1561kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1417kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1425kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1549kB
                                 ->  Parallel Hash Join  (cost=73420.75..773773.87 rows=18661 width=38) (actual time=422.361..2547.351 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69729.15..767630.25 rows=467052 width=50) (actual time=405.005..2417.299 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69728.59..342236.63 rows=116780 width=38) (actual time=404.962..986.293 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26935.77..296962.25 rows=583898 width=8) (actual time=248.091..654.892 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=56375
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..26351.88 rows=2335594 width=0) (actual time=192.454..192.454 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.38..41855.38 rows=74995 width=38) (actual time=156.316..156.319 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25248kB
                                                         ->  Hash Join  (cost=2.51..41855.38 rows=74995 width=38) (actual time=0.081..125.108 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.76 rows=374976 width=8) (actual time=0.032..87.900 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.039..0.041 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.033..0.039 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.013..0.015 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.014..0.015 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=16.599..16.599 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5056kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.024..6.975 rows=20000 loops=5)
 Planning Time: 5.090 ms
 Execution Time: 2627.541 ms
(50 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1278864.04..1278864.05 rows=1 width=32) (actual time=17333.982..17377.865 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1278864.04..1278864.05 rows=1 width=32) (actual time=17333.979..17377.862 rows=1 loops=1)
         ->  Gather  (cost=1278863.61..1278864.02 rows=4 width=32) (actual time=17329.260..17377.843 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1277863.61..1277863.62 rows=1 width=32) (actual time=17321.202..17321.203 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=209803.42..1276385.58 rows=295606 width=12) (actual time=1364.580..17154.774 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=78860 lossy=52997
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..209507.81 rows=1182424 width=0) (actual time=1278.966..1278.966 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 12.440 ms
 Execution Time: 17379.019 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1278864.04..1278864.05 rows=1 width=32) (actual time=3133.168..3174.102 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1278864.04..1278864.05 rows=1 width=32) (actual time=3133.166..3174.099 rows=1 loops=1)
         ->  Gather  (cost=1278863.61..1278864.02 rows=4 width=32) (actual time=3128.233..3174.080 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1277863.61..1277863.62 rows=1 width=32) (actual time=3124.695..3124.696 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=209803.42..1276385.58 rows=295606 width=12) (actual time=1195.022..3018.715 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=76679 lossy=51976
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..209507.81 rows=1182424 width=0) (actual time=1105.749..1105.750 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.863 ms
 Execution Time: 3174.158 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420115.95..1421177.77 rows=1 width=116) (actual time=34470.842..34476.674 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420115.95..12068004.73 rows=10028 width=116) (actual time=34470.841..34476.673 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420115.95..12066936.68 rows=61175 width=96) (actual time=7111.048..34444.082 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349029
               ->  Nested Loop  (cost=1420115.52..6832089.20 rows=1529372 width=76) (actual time=7101.844..28858.929 rows=363450 loops=1)
                     ->  Gather Merge  (cost=1420115.09..1603233.90 rows=1529372 width=76) (actual time=7100.768..7607.917 rows=363450 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419115.03..1420070.89 rows=382343 width=76) (actual time=7077.458..7119.368 rows=73080 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26808kB
                                 Worker 0:  Sort Method: external merge  Disk: 27144kB
                                 Worker 1:  Sort Method: external merge  Disk: 26800kB
                                 Worker 2:  Sort Method: external merge  Disk: 26784kB
                                 Worker 3:  Sort Method: external merge  Disk: 26416kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372741.72 rows=382343 width=76) (actual time=16.818..6779.761 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350104.79 rows=4599170 width=24) (actual time=0.431..6171.701 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=16.033..16.035 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.367..14.782 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.261..12.293 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.096..0.098 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.090..0.096 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.079..0.080 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.006..0.008 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.058..0.058 rows=1 loops=363450)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.014..0.014 rows=1 loops=363450)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 25.853 ms
 Execution Time: 34480.802 ms
(45 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420115.95..1421177.77 rows=1 width=116) (actual time=5765.791..5774.598 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420115.95..12068004.73 rows=10028 width=116) (actual time=5765.790..5774.596 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420115.95..12066936.68 rows=61175 width=96) (actual time=3550.761..5760.213 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349029
               ->  Nested Loop  (cost=1420115.52..6832089.20 rows=1529372 width=76) (actual time=3549.334..4751.957 rows=363450 loops=1)
                     ->  Gather Merge  (cost=1420115.09..1603233.90 rows=1529372 width=76) (actual time=3549.279..3782.441 rows=363450 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419115.03..1420070.89 rows=382343 width=76) (actual time=3522.806..3550.409 rows=73088 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 24536kB
                                 Worker 0:  Sort Method: external merge  Disk: 28384kB
                                 Worker 1:  Sort Method: external merge  Disk: 27888kB
                                 Worker 2:  Sort Method: external merge  Disk: 26040kB
                                 Worker 3:  Sort Method: external merge  Disk: 27104kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372741.72 rows=382343 width=76) (actual time=12.153..3194.699 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350104.79 rows=4599170 width=24) (actual time=0.043..2536.146 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=10.810..10.813 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.063..9.936 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.029..6.299 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.028..0.030 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.021..0.028 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.013 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.003..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.006 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363450)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363450)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.511 ms
 Execution Time: 5778.045 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386386.96..393010.95 rows=1 width=64) (actual time=35173.636..35180.754 rows=1 loops=1)
   ->  GroupAggregate  (cost=386386.96..16323701.65 rows=2406 width=64) (actual time=35173.635..35180.752 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386386.96..16323169.91 rows=24181 width=70) (actual time=2269.292..35154.077 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142662
               ->  Nested Loop  (cost=386386.96..16314375.00 rows=24181 width=20) (actual time=2269.255..35112.229 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386386.67..16235178.24 rows=24209 width=20) (actual time=2269.069..34565.064 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386386.24..3810883.58 rows=3639409 width=24) (actual time=2249.046..23887.144 rows=1816422 loops=1)
                                 ->  Gather Merge  (cost=386385.68..495342.17 rows=909983 width=8) (actual time=2247.782..2522.702 rows=454484 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385385.62..385954.36 rows=227496 width=8) (actual time=2235.239..2243.501 rows=92020 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 16121kB
                                             Worker 0:  Sort Method: quicksort  Memory: 15882kB
                                             Worker 1:  Sort Method: quicksort  Memory: 15855kB
                                             Worker 2:  Sort Method: quicksort  Memory: 16266kB
                                             Worker 3:  Sort Method: quicksort  Memory: 16383kB
                                             ->  Parallel Hash Join  (cost=42792.81..365143.61 rows=227496 width=8) (actual time=291.454..2182.008 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317516.52 rows=1137478 width=12) (actual time=0.637..1619.059 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.38..41855.38 rows=74995 width=4) (actual time=290.065..290.068 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.38 rows=74995 width=4) (actual time=0.247..272.802 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.76 rows=374976 width=8) (actual time=0.129..233.978 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.111..0.113 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.106..0.111 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.046..0.047 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.054..0.055 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.048..0.049 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.043..0.046 rows=4 loops=454484)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.006..0.006 rows=0 loops=1816422)
                                 Index Cond: (p_partkey = lineitem.l_partkey)
                                 Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                 Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.045..0.045 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.009..0.021 rows=25 loops=1)
 Planning Time: 27.761 ms
 Execution Time: 35181.148 ms
(51 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386386.96..393010.95 rows=1 width=64) (actual time=9182.316..9189.133 rows=1 loops=1)
   ->  GroupAggregate  (cost=386386.96..16323701.65 rows=2406 width=64) (actual time=9182.315..9189.131 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386386.96..16323169.91 rows=24181 width=70) (actual time=1049.282..9175.106 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142666
               ->  Nested Loop  (cost=386386.96..16314375.00 rows=24181 width=20) (actual time=1049.268..9150.501 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386386.67..16235178.24 rows=24209 width=20) (actual time=1049.254..9107.514 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386386.24..3810883.58 rows=3639409 width=24) (actual time=1047.282..4007.300 rows=1816443 loops=1)
                                 ->  Gather Merge  (cost=386385.68..495342.17 rows=909983 width=8) (actual time=1047.227..1237.100 rows=454492 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385385.62..385954.36 rows=227496 width=8) (actual time=1037.573..1044.518 rows=92043 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 15803kB
                                             Worker 0:  Sort Method: quicksort  Memory: 16083kB
                                             Worker 1:  Sort Method: quicksort  Memory: 16383kB
                                             Worker 2:  Sort Method: quicksort  Memory: 17398kB
                                             Worker 3:  Sort Method: quicksort  Memory: 14840kB
                                             ->  Parallel Hash Join  (cost=42792.81..365143.61 rows=227496 width=8) (actual time=152.439..978.476 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317516.52 rows=1137478 width=12) (actual time=0.037..524.870 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.38..41855.38 rows=74995 width=4) (actual time=151.541..151.544 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.38 rows=74995 width=4) (actual time=0.073..130.812 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.76 rows=374976 width=8) (actual time=0.028..89.822 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.040..0.042 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.035..0.040 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.007..0.009 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.014..0.016 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.005 rows=4 loops=454492)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1816443)
                                 Index Cond: (p_partkey = lineitem.l_partkey)
                                 Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                 Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.006..0.010 rows=25 loops=1)
 Planning Time: 5.909 ms
 Execution Time: 9189.254 ms
(51 rows)

query 9 run 1
SET
SET
SET
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=37638.61..42845.33 rows=1 width=90) (actual time=1775962.797..1775964.447 rows=1 loops=1)
   ->  GroupAggregate  (cost=37638.61..709305.15 rows=129 width=90) (actual time=1775962.796..1775964.445 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=37638.61..709300.96 rows=129 width=81) (actual time=1775953.089..1775955.709 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 31kB  Peak Memory: 31kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 15860kB  Peak Memory: 15860kB
               ->  Nested Loop  (cost=9652.78..709295.83 rows=129 width=81) (actual time=1820.440..1775846.148 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12779641240
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=50.714..59.101 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=46.232..46.958 rows=2510 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 5372kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4733kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.326..24.579 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.158..15.276 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.100..0.101 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.090..0.093 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..494247.30 rows=130 width=35) (actual time=0.002..232.262 rows=3247718 loops=3935)
                           ->  Gather  (cost=1001.31..494246.65 rows=130 width=35) (actual time=1.380..16761.937 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..493233.65 rows=32 width=35) (actual time=1.387..17593.056 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..493124.13 rows=32 width=35) (actual time=1.344..11778.223 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..145644.01 rows=100990 width=18) (actual time=0.978..652.866 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47231.01 rows=25252 width=4) (actual time=0.274..164.393 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.019..0.021 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.020..0.126 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.970 ms
 Execution Time: 1775984.898 ms
(42 rows)

query 10 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=920919.80..920919.85 rows=20 width=201) (actual time=22316.933..22373.646 rows=20 loops=1)
   ->  Sort  (cost=920919.80..922276.44 rows=542653 width=201) (actual time=22316.932..22373.643 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=827939.32..906480.00 rows=542653 width=201) (actual time=21144.286..22233.522 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=827939.32..892913.68 rows=542653 width=181) (actual time=21144.265..21430.994 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=826939.26..827278.42 rows=135663 width=181) (actual time=21126.049..21151.792 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 45512kB
                           Worker 0:  Sort Method: external merge  Disk: 39760kB
                           Worker 1:  Sort Method: external merge  Disk: 45584kB
                           Worker 2:  Sort Method: external merge  Disk: 47744kB
                           Worker 3:  Sort Method: external merge  Disk: 39928kB
                           ->  Hash Join  (cost=772109.48..815374.21 rows=135663 width=181) (actual time=20632.015..20989.788 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=772107.92..814956.16 rows=135663 width=159) (actual time=20631.883..20940.873 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.76 rows=374976 width=147) (actual time=0.251..146.019 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=770412.13..770412.13 rows=135663 width=16) (actual time=20630.472..20630.473 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6377.00..770412.13 rows=135663 width=16) (actual time=137.034..20460.990 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6376.43..269717.54 rows=138207 width=8) (actual time=134.910..4536.452 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46782
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6238.23 rows=552829 width=0) (actual time=87.305..87.305 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.133..0.138 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.054..0.054 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.041..0.045 rows=25 loops=5)
 Planning Time: 21.374 ms
 Execution Time: 22380.466 ms
(38 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=920919.80..920919.85 rows=20 width=201) (actual time=3783.239..3842.497 rows=20 loops=1)
   ->  Sort  (cost=920919.80..922276.44 rows=542653 width=201) (actual time=3783.238..3842.494 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=827939.32..906480.00 rows=542653 width=201) (actual time=2631.964..3704.273 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=827939.32..892913.68 rows=542653 width=181) (actual time=2631.946..2912.666 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=826939.26..827278.42 rows=135663 width=181) (actual time=2617.234..2643.594 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 41288kB
                           Worker 0:  Sort Method: external merge  Disk: 39824kB
                           Worker 1:  Sort Method: external merge  Disk: 51424kB
                           Worker 2:  Sort Method: external merge  Disk: 49536kB
                           Worker 3:  Sort Method: external merge  Disk: 36456kB
                           ->  Hash Join  (cost=772109.48..815374.21 rows=135663 width=181) (actual time=2199.289..2468.699 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=772107.92..814956.16 rows=135663 width=159) (actual time=2199.185..2414.540 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.76 rows=374976 width=147) (actual time=0.026..59.694 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=770412.13..770412.13 rows=135663 width=16) (actual time=2197.563..2197.564 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85152kB
                                             ->  Nested Loop  (cost=6377.00..770412.13 rows=135663 width=16) (actual time=133.262..2073.337 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6376.43..269717.54 rows=138207 width=8) (actual time=133.177..475.970 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=45363
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6238.23 rows=552829 width=0) (actual time=84.555..84.555 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.012..0.013 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.025..0.025 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.012..0.015 rows=25 loops=5)
 Planning Time: 2.227 ms
 Execution Time: 3847.870 ms
(38 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=437289.88..437289.88 rows=1 width=36) (actual time=4033.650..4052.080 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=193202.06..193202.07 rows=1 width=32) (actual time=153.595..153.677 rows=1 loops=1)
           ->  Gather  (cost=193201.84..193202.05 rows=2 width=32) (actual time=153.038..153.661 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=192201.84..192201.85 rows=1 width=32) (actual time=150.751..150.752 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..191219.10 rows=131032 width=10) (actual time=0.116..119.399 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.101..16.574 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.034..6.643 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 39219  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 30719  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 29987  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..111.15 rows=79 width=14) (actual time=0.003..0.068 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=244087.80..244349.87 rows=104826 width=36) (actual time=4033.649..4051.995 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=203356.55..243563.67 rows=104826 width=36) (actual time=4033.639..4051.986 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=203356.55..236881.04 rows=262064 width=36) (actual time=3527.769..3701.398 rows=314789 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=202356.53..205632.33 rows=131032 width=36) (actual time=3521.622..3626.689 rows=104930 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=202356.53..202684.11 rows=131032 width=14) (actual time=3521.607..3531.154 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 8904kB
                                 Worker 0:  Sort Method: quicksort  Memory: 8918kB
                                 Worker 1:  Sort Method: quicksort  Memory: 8939kB
                                 ->  Nested Loop  (cost=0.87..191219.10 rows=131032 width=14) (actual time=1.138..3483.224 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.327..29.846 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.200..17.065 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 32549  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 34095  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 33281  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.004..0.004 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..111.15 rows=79 width=18) (actual time=0.068..2.566 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 15.267 ms
 Execution Time: 4052.523 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=437289.88..437289.88 rows=1 width=36) (actual time=663.868..679.822 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=193202.06..193202.07 rows=1 width=32) (actual time=148.427..148.515 rows=1 loops=1)
           ->  Gather  (cost=193201.84..193202.05 rows=2 width=32) (actual time=147.636..148.502 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=192201.84..192201.85 rows=1 width=32) (actual time=145.517..145.518 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..191219.10 rows=131032 width=10) (actual time=0.133..114.372 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.117..16.411 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.049..6.507 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 42513  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 29987  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 27425  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..111.15 rows=79 width=14) (actual time=0.003..0.064 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=244087.80..244349.87 rows=104826 width=36) (actual time=663.867..679.732 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=203356.55..243563.67 rows=104826 width=36) (actual time=663.860..679.725 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=203356.55..236881.04 rows=262064 width=36) (actual time=159.054..327.908 rows=313801 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=202356.53..205632.33 rows=131032 width=36) (actual time=155.997..260.096 rows=104600 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=202356.53..202684.11 rows=131032 width=14) (actual time=155.979..165.466 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 9009kB
                                 Worker 0:  Sort Method: quicksort  Memory: 8904kB
                                 Worker 1:  Sort Method: quicksort  Memory: 8848kB
                                 ->  Nested Loop  (cost=0.87..191219.10 rows=131032 width=14) (actual time=0.104..131.579 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.087..16.901 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.029..6.889 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 34013  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 33647  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 32265  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..111.15 rows=79 width=18) (actual time=0.004..0.077 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.031 ms
 Execution Time: 679.912 ms
(56 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469249.89..1612170.46 rows=1 width=27) (actual time=13953.709..13954.823 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469249.89..2469693.87 rows=7 width=27) (actual time=13953.708..13954.820 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469249.89..2464769.49 rows=281389 width=27) (actual time=6943.018..13858.452 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469249.46..1502941.47 rows=281389 width=15) (actual time=6941.854..7018.540 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468249.40..1468425.27 rows=70347 width=15) (actual time=6932.017..6934.793 rows=32234 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 5010kB
                           Worker 0:  Sort Method: quicksort  Memory: 4979kB
                           Worker 1:  Sort Method: quicksort  Memory: 4887kB
                           Worker 2:  Sort Method: quicksort  Memory: 4934kB
                           Worker 3:  Sort Method: quicksort  Memory: 4894kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462585.69 rows=70347 width=15) (actual time=1.072..6913.674 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.043..0.043 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.188 ms
 Execution Time: 13955.247 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469249.89..1612170.46 rows=1 width=27) (actual time=4056.428..4057.650 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469249.89..2469693.87 rows=7 width=27) (actual time=4056.427..4057.648 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469249.89..2464769.49 rows=281389 width=27) (actual time=3579.978..4006.828 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469249.46..1502941.47 rows=281389 width=15) (actual time=3579.929..3620.896 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468249.40..1468425.27 rows=70347 width=15) (actual time=3573.681..3575.696 rows=32229 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 4821kB
                           Worker 0:  Sort Method: quicksort  Memory: 5094kB
                           Worker 1:  Sort Method: quicksort  Memory: 4808kB
                           Worker 2:  Sort Method: quicksort  Memory: 4908kB
                           Worker 3:  Sort Method: quicksort  Memory: 5073kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462585.69 rows=70347 width=15) (actual time=0.098..3552.369 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.862 ms
 Execution Time: 4057.711 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369831.90..1369831.90 rows=1 width=16) (actual time=17133.827..17133.840 rows=1 loops=1)
   ->  Sort  (cost=1369831.90..1369832.40 rows=200 width=16) (actual time=17133.825..17133.827 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369828.90..1369830.90 rows=200 width=16) (actual time=17133.798..17133.806 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215158.63..1347330.35 rows=1499903 width=12) (actual time=14875.897..16960.982 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 216328kB
                     ->  Hash Right Join  (cost=53280.76..664446.96 rows=14998105 width=8) (actual time=365.330..10980.004 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448763.06 rows=14998105 width=8) (actual time=0.784..5122.315 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28672.97..28672.97 rows=1499903 width=4) (actual time=361.867..361.867 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28672.97 rows=1499903 width=4) (actual time=0.019..159.541 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 16.209 ms
 Execution Time: 17167.515 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369831.90..1369831.90 rows=1 width=16) (actual time=16475.815..16475.829 rows=1 loops=1)
   ->  Sort  (cost=1369831.90..1369832.40 rows=200 width=16) (actual time=16475.813..16475.816 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369828.90..1369830.90 rows=200 width=16) (actual time=16475.787..16475.795 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215158.63..1347330.35 rows=1499903 width=12) (actual time=14213.280..16307.799 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 216328kB
                     ->  Hash Right Join  (cost=53280.76..664446.96 rows=14998105 width=8) (actual time=329.989..10374.915 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448763.06 rows=14998105 width=8) (actual time=0.031..4655.565 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28672.97..28672.97 rows=1499903 width=4) (actual time=327.363..327.364 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28672.97 rows=1499903 width=4) (actual time=0.019..128.023 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.669 ms
 Execution Time: 16510.270 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=874583.86..874583.87 rows=1 width=32) (actual time=8840.794..8886.290 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=874583.86..874583.87 rows=1 width=32) (actual time=8840.792..8886.287 rows=1 loops=1)
         ->  Gather  (cost=874583.40..874583.81 rows=4 width=64) (actual time=8834.697..8886.264 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=873583.40..873583.41 rows=1 width=64) (actual time=8827.369..8827.372 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65225.89..870037.81 rows=202605 width=33) (actual time=663.232..8674.021 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12994.87..817274.95 rows=202605 width=16) (actual time=291.120..8142.982 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=83408
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12792.27 rows=810420 width=0) (actual time=192.463..192.463 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45981.01..45981.01 rows=500001 width=25) (actual time=370.008..370.008 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45981.01 rows=500001 width=25) (actual time=0.421..235.668 rows=400000 loops=5)
 Planning Time: 15.738 ms
 Execution Time: 8886.611 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=874583.86..874583.87 rows=1 width=32) (actual time=1696.121..1750.500 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=874583.86..874583.87 rows=1 width=32) (actual time=1696.120..1750.498 rows=1 loops=1)
         ->  Gather  (cost=874583.40..874583.81 rows=4 width=64) (actual time=1691.451..1750.476 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=873583.40..873583.41 rows=1 width=64) (actual time=1686.290..1686.293 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65225.89..870037.81 rows=202605 width=33) (actual time=554.004..1584.260 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12994.87..817274.95 rows=202605 width=16) (actual time=273.734..1171.713 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=88078
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12792.27 rows=810420 width=0) (actual time=175.145..175.145 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45981.01..45981.01 rows=500001 width=25) (actual time=278.139..278.139 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45981.01 rows=500001 width=25) (actual time=0.045..128.125 rows=400000 loops=5)
 Planning Time: 1.071 ms
 Execution Time: 1750.555 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2721534.25..2721641.41 rows=1 width=103) (actual time=20022.864..20080.139 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1379386.23..1379386.24 rows=1 width=32) (actual time=2902.956..2912.008 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1376883.26..1378134.75 rows=100119 width=36) (actual time=2859.014..2906.082 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 69649kB
                 ->  Gather  (cost=1332580.60..1373879.69 rows=400476 width=36) (actual time=2525.875..2607.130 rows=398563 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1331580.60..1332832.09 rows=100119 width=36) (actual time=2521.542..2569.126 rows=99641 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 44049kB
                             Worker 0:  Batches: 1  Memory Usage: 47121kB
                             Worker 1:  Batches: 1  Memory Usage: 44049kB
                             Worker 2:  Batches: 1  Memory Usage: 44049kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=35370.56..1326065.72 rows=551488 width=16) (actual time=437.979..2043.457 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=108645 lossy=72932
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34819.08 rows=2205951 width=0) (actual time=348.392..348.393 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1342148.00..1395835.23 rows=501 width=103) (actual time=20022.863..20071.085 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1342147.71..1394603.91 rows=501 width=36) (actual time=20022.280..20070.501 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1342147.71..1390098.56 rows=400476 width=36) (actual time=16911.895..17024.677 rows=346208 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1341147.65..1341397.95 rows=100119 width=36) (actual time=16878.185..16886.144 rows=69736 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 13898kB
                           Worker 0:  Sort Method: quicksort  Memory: 13889kB
                           Worker 1:  Sort Method: quicksort  Memory: 13890kB
                           Worker 2:  Sort Method: quicksort  Memory: 13892kB
                           Worker 3:  Sort Method: quicksort  Memory: 13889kB
                           ->  Partial HashAggregate  (cost=1331580.60..1332832.09 rows=100119 width=36) (actual time=16789.696..16850.763 rows=98917 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 44049kB
                                 Worker 0:  Batches: 1  Memory Usage: 47121kB
                                 Worker 1:  Batches: 1  Memory Usage: 44049kB
                                 Worker 2:  Batches: 1  Memory Usage: 44049kB
                                 Worker 3:  Batches: 1  Memory Usage: 44049kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=35370.56..1326065.72 rows=551488 width=16) (actual time=488.610..16268.319 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=80526 lossy=53596
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34819.08 rows=2205951 width=0) (actual time=404.248..404.249 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.577..0.577 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 13.033 ms
 Execution Time: 20083.058 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2721534.25..2721641.41 rows=1 width=103) (actual time=5917.228..5972.726 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1379386.23..1379386.24 rows=1 width=32) (actual time=2908.369..2917.363 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1376883.26..1378134.75 rows=100119 width=36) (actual time=2861.147..2910.468 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 69649kB
                 ->  Gather  (cost=1332580.60..1373879.69 rows=400476 width=36) (actual time=2527.788..2609.338 rows=398592 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1331580.60..1332832.09 rows=100119 width=36) (actual time=2523.277..2570.499 rows=99648 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 44049kB
                             Worker 0:  Batches: 1  Memory Usage: 44049kB
                             Worker 1:  Batches: 1  Memory Usage: 44049kB
                             Worker 2:  Batches: 1  Memory Usage: 44049kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=35370.56..1326065.72 rows=551488 width=16) (actual time=442.436..2045.572 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=107895 lossy=71864
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34819.08 rows=2205951 width=0) (actual time=352.568..352.568 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1342148.00..1395835.23 rows=501 width=103) (actual time=5917.227..5963.729 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1342147.71..1394603.91 rows=501 width=36) (actual time=5917.179..5963.681 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1342147.71..1390098.56 rows=400476 width=36) (actual time=2805.525..2915.545 rows=345922 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1341147.65..1341397.95 rows=100119 width=36) (actual time=2777.399..2785.250 rows=69652 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 13884kB
                           Worker 0:  Sort Method: quicksort  Memory: 13848kB
                           Worker 1:  Sort Method: quicksort  Memory: 13911kB
                           Worker 2:  Sort Method: quicksort  Memory: 13831kB
                           Worker 3:  Sort Method: quicksort  Memory: 13940kB
                           ->  Partial HashAggregate  (cost=1331580.60..1332832.09 rows=100119 width=36) (actual time=2689.599..2750.342 rows=98835 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 44049kB
                                 Worker 0:  Batches: 1  Memory Usage: 44049kB
                                 Worker 1:  Batches: 1  Memory Usage: 44049kB
                                 Worker 2:  Batches: 1  Memory Usage: 44049kB
                                 Worker 3:  Batches: 1  Memory Usage: 44049kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=35370.56..1326065.72 rows=551488 width=16) (actual time=450.353..2252.801 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=80112 lossy=53745
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34819.08 rows=2205951 width=0) (actual time=362.709..362.709 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.043..0.043 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.055 ms
 Execution Time: 5975.176 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=251286.76..251286.76 rows=1 width=44) (actual time=2599.251..2602.705 rows=1 loops=1)
   ->  Sort  (cost=251286.76..251670.76 rows=153599 width=44) (actual time=2599.249..2602.703 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172117.08..250518.77 rows=153599 width=44) (actual time=1959.208..2595.263 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172117.08..243057.94 rows=592484 width=40) (actual time=1959.158..2303.619 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171117.02..171487.32 rows=148121 width=40) (actual time=1868.513..1888.388 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 25216kB
                           Worker 0:  Sort Method: quicksort  Memory: 25324kB
                           Worker 1:  Sort Method: quicksort  Memory: 25789kB
                           Worker 2:  Sort Method: quicksort  Memory: 28897kB
                           Worker 3:  Sort Method: quicksort  Memory: 24403kB
                           ->  Parallel Hash Join  (cost=57878.42..158396.08 rows=148121 width=40) (actual time=383.131..1132.033 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101364.62 rows=999810 width=8) (actual time=46.863..602.143 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.734..45.992 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53481.03..53481.03 rows=74075 width=40) (actual time=335.556..335.557 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26336kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53481.03 rows=74075 width=40) (actual time=0.472..310.905 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 16.499 ms
 Execution Time: 2603.124 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=251286.76..251286.76 rows=1 width=44) (actual time=2292.846..2302.234 rows=1 loops=1)
   ->  Sort  (cost=251286.76..251670.76 rows=153599 width=44) (actual time=2292.845..2302.232 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172117.08..250518.77 rows=153599 width=44) (actual time=1646.987..2294.957 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172117.08..243057.94 rows=592484 width=40) (actual time=1646.938..2001.472 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171117.02..171487.32 rows=148121 width=40) (actual time=1529.722..1549.570 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 29564kB
                           Worker 0:  Sort Method: quicksort  Memory: 29430kB
                           Worker 1:  Sort Method: quicksort  Memory: 25331kB
                           Worker 2:  Sort Method: quicksort  Memory: 23939kB
                           Worker 3:  Sort Method: quicksort  Memory: 22474kB
                           ->  Parallel Hash Join  (cost=57878.42..158396.08 rows=148121 width=40) (actual time=187.301..809.354 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101364.62 rows=999810 width=8) (actual time=26.642..447.186 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.079..26.343 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53481.03..53481.03 rows=74075 width=40) (actual time=159.982..159.983 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53481.03 rows=74075 width=40) (actual time=0.015..126.728 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 0.846 ms
 Execution Time: 2302.310 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3349024.43..3349024.44 rows=1 width=32) (actual time=25248.433..25324.764 rows=1 loops=1)
   ->  Aggregate  (cost=3349024.43..3349024.44 rows=1 width=32) (actual time=25248.432..25324.762 rows=1 loops=1)
         ->  Merge Join  (cost=2264744.78..3348981.88 rows=17018 width=8) (actual time=18548.124..25323.810 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2263743.86..3226796.90 rows=1838103 width=36) (actual time=18517.181..25092.844 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2263743.86..3144082.26 rows=7352412 width=36) (actual time=18517.160..20580.842 rows=9972228 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2262743.80..2267339.06 rows=1838103 width=36) (actual time=18340.116..18638.496 rows=1994890 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150328kB
                                 Worker 0:  Sort Method: external merge  Disk: 150320kB
                                 Worker 1:  Sort Method: external merge  Disk: 150328kB
                                 Worker 2:  Sort Method: external merge  Disk: 150320kB
                                 Worker 3:  Sort Method: external merge  Disk: 150344kB
                                 ->  Partial HashAggregate  (cost=1869743.11..2039178.90 rows=1838103 width=36) (actual time=9922.727..17434.168 rows=1995112 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407736kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407656kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407704kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407656kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407792kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275117.53 rows=14997453 width=9) (actual time=0.563..3728.162 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..98431.66 rows=55550 width=21) (actual time=28.632..71.505 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..98292.78 rows=55550 width=21) (actual time=28.627..64.489 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..90676.18 rows=13888 width=21) (actual time=2.204..628.046 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.46 rows=463 width=4) (actual time=0.741..200.880 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.43 rows=33 width=17) (actual time=0.602..0.847 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 14.487 ms
 Execution Time: 25391.703 ms
(38 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3349024.43..3349024.44 rows=1 width=32) (actual time=23901.192..23989.796 rows=1 loops=1)
   ->  Aggregate  (cost=3349024.43..3349024.44 rows=1 width=32) (actual time=23901.191..23989.794 rows=1 loops=1)
         ->  Merge Join  (cost=2264744.78..3348981.88 rows=17018 width=8) (actual time=17204.334..23989.026 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2263743.86..3226796.90 rows=1838103 width=36) (actual time=17194.807..23803.025 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2263743.86..3144082.26 rows=7352412 width=36) (actual time=17194.787..19259.226 rows=9972053 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2262743.80..2267339.06 rows=1838103 width=36) (actual time=17026.004..17321.803 rows=1994883 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150360kB
                                 Worker 0:  Sort Method: external merge  Disk: 150272kB
                                 Worker 1:  Sort Method: external merge  Disk: 150296kB
                                 Worker 2:  Sort Method: external merge  Disk: 150352kB
                                 Worker 3:  Sort Method: external merge  Disk: 150344kB
                                 ->  Partial HashAggregate  (cost=1869743.11..2039178.90 rows=1838103 width=36) (actual time=8648.286..16131.377 rows=1995076 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 408208kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 393232kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 397328kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 408032kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407744kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275117.53 rows=14997453 width=9) (actual time=0.910..1605.076 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..98431.66 rows=55550 width=21) (actual time=7.338..28.771 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..98292.78 rows=55550 width=21) (actual time=7.332..22.012 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..90676.18 rows=13888 width=21) (actual time=0.210..124.127 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.46 rows=463 width=4) (actual time=0.191..105.146 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.43 rows=33 width=17) (actual time=0.005..0.033 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.974 ms
 Execution Time: 24058.454 ms
(38 rows)

query 18 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8775855.67..8775855.92 rows=100 width=71) (actual time=41913.769..41913.783 rows=99 loops=1)
   ->  Sort  (cost=8775855.67..8825840.01 rows=19993735 width=71) (actual time=41913.768..41913.775 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7410335.44..8011709.50 rows=19993735 width=71) (actual time=41912.904..41913.677 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 128  Batches: 1  Memory Usage: 6225kB
               ->  Hash Join  (cost=78611.99..6333329.16 rows=19993735 width=44) (actual time=3076.331..41912.439 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=128.17..5920220.65 rows=19993735 width=25) (actual time=997.908..41137.937 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390377.52 rows=4999151 width=24) (actual time=765.575..29965.529 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547959.51 rows=14999605 width=20) (actual time=0.521..2968.324 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692438.10 rows=4999151 width=4) (actual time=657.617..26100.913 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167527.25 rows=59989812 width=9) (actual time=0.448..12394.076 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167527.25 rows=59989812 width=9) (actual time=0.013..7684.012 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.03..50946.03 rows=1499903 width=23) (actual time=694.114..694.115 rows=1500000 loops=1)
                           Buckets: 1048576  Batches: 2  Memory Usage: 49242kB
                           ->  Seq Scan on customer  (cost=0.00..50946.03 rows=1499903 width=23) (actual time=0.518..421.212 rows=1500000 loops=1)
 Planning Time: 19.403 ms
 Execution Time: 41915.491 ms
(25 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8775855.67..8775855.92 rows=100 width=71) (actual time=38764.877..38764.891 rows=99 loops=1)
   ->  Sort  (cost=8775855.67..8825840.01 rows=19993735 width=71) (actual time=38764.875..38764.883 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7410335.44..8011709.50 rows=19993735 width=71) (actual time=38764.006..38764.783 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 128  Batches: 1  Memory Usage: 6225kB
               ->  Hash Join  (cost=78611.99..6333329.16 rows=19993735 width=44) (actual time=2649.741..38763.561 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=128.17..5920220.65 rows=19993735 width=25) (actual time=868.238..38121.918 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390377.52 rows=4999151 width=24) (actual time=629.886..26781.513 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547959.51 rows=14999605 width=20) (actual time=0.028..2372.124 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692438.10 rows=4999151 width=4) (actual time=550.682..23535.977 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167527.25 rows=59989812 width=9) (actual time=0.016..10045.021 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167527.25 rows=59989812 width=9) (actual time=0.013..7843.664 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.03..50946.03 rows=1499903 width=23) (actual time=561.292..561.293 rows=1500000 loops=1)
                           Buckets: 1048576  Batches: 2  Memory Usage: 49242kB
                           ->  Seq Scan on customer  (cost=0.00..50946.03 rows=1499903 width=23) (actual time=0.031..294.569 rows=1500000 loops=1)
 Planning Time: 1.858 ms
 Execution Time: 38766.102 ms
(25 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=127415.23..127415.24 rows=1 width=32) (actual time=4942.252..4956.701 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=127415.23..127415.24 rows=1 width=32) (actual time=4942.250..4956.698 rows=1 loops=1)
         ->  Gather  (cost=127414.80..127415.21 rows=4 width=32) (actual time=4936.678..4956.679 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=126414.80..126414.81 rows=1 width=32) (actual time=4929.159..4929.160 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..126412.68 rows=283 width=12) (actual time=50.683..4928.541 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62231.04 rows=1199 width=30) (actual time=0.829..180.127 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..53.52 rows=1 width=21) (actual time=4.483..4.964 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 17.469 ms
 Execution Time: 4957.050 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=127415.23..127415.24 rows=1 width=32) (actual time=218.325..241.466 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=127415.23..127415.24 rows=1 width=32) (actual time=218.323..241.463 rows=1 loops=1)
         ->  Gather  (cost=127414.80..127415.21 rows=4 width=32) (actual time=216.316..241.448 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=126414.80..126414.81 rows=1 width=32) (actual time=210.235..210.236 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..126412.68 rows=283 width=12) (actual time=1.001..210.033 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62231.04 rows=1199 width=30) (actual time=0.146..129.027 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..53.52 rows=1 width=21) (actual time=0.074..0.083 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.052 ms
 Execution Time: 241.524 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470292.20..2720754.52 rows=1 width=51) (actual time=36939.952..36941.195 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2470292.20..2720754.52 rows=1 width=51) (actual time=36939.951..36941.193 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13802
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=25.447..26.625 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=20.108..20.124 rows=392 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 330kB
                     Worker 0:  Sort Method: quicksort  Memory: 213kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.363..18.782 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.180..13.721 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.115..0.116 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.110..0.112 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2466169.27..2715995.71 rows=3 width=8) (actual time=35236.662..36913.389 rows=13803 loops=1)
               ->  Hash Join  (cost=2466169.27..2715995.70 rows=3 width=8) (actual time=35236.658..36909.575 rows=13803 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2389706.47..2553980.38 rows=4888707 width=40) (actual time=33807.802..35284.074 rows=1277698 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358200kB
                           ->  Bitmap Heap Scan on lineitem  (cost=149312.16..1997195.14 rows=9312595 width=13) (actual time=1265.067..28796.737 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..146984.02 rows=9312595 width=0) (actual time=1145.064..1145.065 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75250.93..75250.93 rows=80792 width=16) (actual time=1428.733..1428.795 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75250.93 rows=80792 width=16) (actual time=2.437..1408.408 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.73 rows=20198 width=16) (actual time=1.437..1409.599 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47231.01 rows=5050 width=4) (actual time=0.532..151.023 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.269..0.288 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 20.403 ms
 Execution Time: 36983.814 ms
(46 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470292.20..2720754.52 rows=1 width=51) (actual time=15018.569..15019.969 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2470292.20..2720754.52 rows=1 width=51) (actual time=15018.568..15019.967 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13802
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=17.633..18.965 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=15.591..15.608 rows=392 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 332kB
                     Worker 0:  Sort Method: quicksort  Memory: 211kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.098..14.268 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.019..9.335 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.017..0.018 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.014..0.015 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2466169.27..2715995.71 rows=3 width=8) (actual time=13332.087..14999.849 rows=13803 loops=1)
               ->  Hash Join  (cost=2466169.27..2715995.70 rows=3 width=8) (actual time=13332.082..14996.067 rows=13803 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2389706.47..2553980.38 rows=4888707 width=40) (actual time=13132.614..14601.808 rows=1277698 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358200kB
                           ->  Bitmap Heap Scan on lineitem  (cost=149312.16..1997195.14 rows=9312595 width=13) (actual time=1115.331..9034.077 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..146984.02 rows=9312595 width=0) (actual time=995.955..995.955 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75250.93..75250.93 rows=80792 width=16) (actual time=199.339..199.405 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75250.93 rows=80792 width=16) (actual time=0.353..178.957 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.73 rows=20198 width=16) (actual time=0.095..181.666 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47231.01 rows=5050 width=4) (actual time=0.043..111.989 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.014..0.015 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.235 ms
 Execution Time: 15067.645 ms
(46 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1968044.55..1968044.55 rows=1 width=34) (actual time=11101.132..11115.135 rows=100 loops=1)
   ->  Sort  (cost=1968044.55..1968044.55 rows=1 width=34) (actual time=11101.131..11115.127 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=1968041.32..1968044.54 rows=1 width=34) (actual time=10564.347..11112.514 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1968041.32..1968044.52 rows=1 width=26) (actual time=10564.150..11100.577 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1968040.75..1968040.88 rows=1 width=38) (actual time=10564.122..10613.234 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1967040.70..1967040.70 rows=1 width=38) (actual time=10539.632..10541.463 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1432kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1402kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1444kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1444kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1353kB
                                 ->  Nested Loop Anti Join  (cost=1338050.61..1967040.69 rows=1 width=38) (actual time=7018.638..10463.651 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338050.04..1653315.27 rows=97707 width=38) (actual time=7016.632..8771.413 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308141.77 rows=1834452 width=4) (actual time=0.397..1223.431 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335553.44..1335553.44 rows=199728 width=34) (actual time=7014.979..7015.292 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335553.44 rows=199728 width=34) (actual time=16.566..6843.066 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312611.16 rows=4999151 width=8) (actual time=0.383..6012.044 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=16.004..16.006 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.286..15.525 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.229..13.270 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.047..0.048 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.011..0.011 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 18.414 ms
 Execution Time: 11115.553 ms
(50 rows)

SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1968044.55..1968044.55 rows=1 width=34) (actual time=6783.144..6799.841 rows=100 loops=1)
   ->  Sort  (cost=1968044.55..1968044.55 rows=1 width=34) (actual time=6783.143..6799.833 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=1968041.32..1968044.54 rows=1 width=34) (actual time=6294.848..6797.276 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1968041.32..1968044.52 rows=1 width=26) (actual time=6294.718..6785.828 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1968040.75..1968040.88 rows=1 width=38) (actual time=6294.654..6346.075 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1967040.70..1967040.70 rows=1 width=38) (actual time=6270.507..6272.359 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1422kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1405kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1449kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1388kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1411kB
                                 ->  Nested Loop Anti Join  (cost=1338050.61..1967040.69 rows=1 width=38) (actual time=3840.004..6196.815 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338050.04..1653315.27 rows=97707 width=38) (actual time=3839.599..5024.734 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308141.77 rows=1834452 width=4) (actual time=0.080..606.847 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335553.44..1335553.44 rows=199728 width=34) (actual time=3837.742..3838.068 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335553.44 rows=199728 width=34) (actual time=14.757..3649.520 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312611.16 rows=4999151 width=8) (actual time=0.672..2748.985 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=13.341..13.344 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.055..13.034 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.024..10.859 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.019..0.020 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.014..0.017 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.099 ms
 Execution Time: 6799.947 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93875.60..93877.44 rows=1 width=72) (actual time=1779.682..1785.873 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.41..46820.42 rows=1 width=32) (actual time=320.764..320.858 rows=1 loops=1)
           ->  Gather  (cost=46819.98..46820.39 rows=4 width=32) (actual time=320.753..320.849 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45819.98..45819.99 rows=1 width=32) (actual time=312.289..312.290 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.11 rows=11944 width=6) (actual time=0.088..303.399 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.19..59920.01 rows=7027 width=72) (actual time=1779.681..1785.777 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.19..59744.34 rows=7027 width=38) (actual time=501.456..1778.563 rows=9006 loops=1)
               ->  Gather Merge  (cost=47054.75..49149.99 rows=17499 width=26) (actual time=500.143..525.674 rows=27129 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 3
                     ->  Sort  (cost=46054.69..46065.63 rows=4375 width=26) (actual time=173.550..174.535 rows=7536 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 5076kB
                           Worker 0:  Sort Method: quicksort  Memory: 4801kB
                           Worker 1:  Sort Method: quicksort  Memory: 4822kB
                           Worker 2:  Sort Method: quicksort  Memory: 4886kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.11 rows=4375 width=26) (actual time=0.025..157.881 rows=47782 loops=4)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.045..0.045 rows=1 loops=27129)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 15.877 ms
 Execution Time: 1785.947 ms
(31 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93875.60..93877.44 rows=1 width=72) (actual time=454.647..459.043 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.41..46820.42 rows=1 width=32) (actual time=216.040..216.126 rows=1 loops=1)
           ->  Gather  (cost=46819.98..46820.39 rows=4 width=32) (actual time=212.563..216.105 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45819.98..45819.99 rows=1 width=32) (actual time=207.627..207.627 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.11 rows=11944 width=6) (actual time=0.021..198.618 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.19..59920.01 rows=7027 width=72) (actual time=454.646..458.955 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.19..59744.34 rows=7027 width=38) (actual time=391.079..456.839 rows=9006 loops=1)
               ->  Gather Merge  (cost=47054.75..49149.99 rows=17499 width=26) (actual time=391.033..402.731 rows=27130 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 4
                     ->  Sort  (cost=46054.69..46065.63 rows=4375 width=26) (actual time=169.541..170.121 rows=6269 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 5166kB
                           Worker 0:  Sort Method: quicksort  Memory: 4830kB
                           Worker 1:  Sort Method: quicksort  Memory: 4797kB
                           Worker 2:  Sort Method: quicksort  Memory: 2391kB
                           Worker 3:  Sort Method: quicksort  Memory: 2401kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.11 rows=4375 width=26) (actual time=0.025..154.850 rows=38226 loops=5)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.002..0.002 rows=1 loops=27130)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 0.807 ms
 Execution Time: 459.104 ms
(32 rows)

