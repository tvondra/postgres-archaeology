query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832153.47..1832154.11 rows=1 width=236) (actual time=18556.142..18558.145 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832153.47..1832157.29 rows=6 width=236) (actual time=18556.141..18558.143 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832153.47..1832156.35 rows=24 width=236) (actual time=18556.121..18558.125 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831153.42..1831153.43 rows=6 width=236) (actual time=18546.187..18546.188 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831153.20..1831153.34 rows=6 width=236) (actual time=18546.155..18546.161 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312608.46 rows=14815564 width=25) (actual time=1.351..4163.220 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 13.574 ms
 Execution Time: 18558.523 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832153.47..1832154.11 rows=1 width=236) (actual time=17810.560..17811.146 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832153.47..1832157.29 rows=6 width=236) (actual time=17810.559..17811.145 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832153.47..1832156.35 rows=24 width=236) (actual time=17810.531..17811.118 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831153.42..1831153.43 rows=6 width=236) (actual time=17805.926..17805.927 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831153.20..1831153.34 rows=6 width=236) (actual time=17805.698..17805.703 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312608.46 rows=14815564 width=25) (actual time=0.030..2394.558 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.843 ms
 Execution Time: 17811.214 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1088651.65..1088651.66 rows=1 width=192) (actual time=4013.175..4013.292 rows=100 loops=1)
   ->  Sort  (cost=1088651.65..1088651.66 rows=1 width=192) (actual time=4013.173..4013.285 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=552746.68..1088651.64 rows=1 width=192) (actual time=3008.499..4010.568 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68760.80 rows=8805 width=30) (actual time=75.332..78.515 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.98 rows=2201 width=30) (actual time=2.049..298.017 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=551746.19..559567.48 rows=1564257 width=172) (actual time=2932.049..3382.240 rows=1603828 loops=1)
                     ->  Sort  (cost=551746.19..555656.83 rows=1564257 width=172) (actual time=2932.044..3211.171 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..304879.75 rows=1564257 width=172) (actual time=68.342..2320.026 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255197.76 rows=7997576 width=14) (actual time=6.898..944.341 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=61.404..61.407 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=12.074..55.335 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=11.213..42.796 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.848..0.850 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.842..0.847 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.458..0.459 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.376..0.377 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.373..0.374 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.057..0.057 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.047..0.055 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.042..0.053 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.041..0.051 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.037..0.038 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.013 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.007 rows=25 loops=1)
 Planning Time: 23.231 ms
 Execution Time: 4050.932 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1088651.65..1088651.66 rows=1 width=192) (actual time=3233.241..3233.366 rows=100 loops=1)
   ->  Sort  (cost=1088651.65..1088651.66 rows=1 width=192) (actual time=3233.239..3233.358 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=552746.68..1088651.64 rows=1 width=192) (actual time=2494.757..3231.121 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68760.80 rows=8805 width=30) (actual time=29.472..31.778 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.98 rows=2201 width=30) (actual time=0.210..131.513 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=551746.19..559567.48 rows=1564257 width=172) (actual time=2465.183..2906.459 rows=1603828 loops=1)
                     ->  Sort  (cost=551746.19..555656.83 rows=1564257 width=172) (actual time=2465.178..2735.817 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..304879.75 rows=1564257 width=172) (actual time=36.297..1867.711 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255197.76 rows=7997576 width=14) (actual time=0.048..632.182 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=36.222..36.224 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.255..30.310 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.226..7.409 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.025..0.027 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.020..0.025 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.007..0.009 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.018..0.018 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.010..0.016 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.006..0.014 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.006 rows=25 loops=1)
 Planning Time: 1.759 ms
 Execution Time: 3267.154 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2293766.78..2293766.80 rows=10 width=44) (actual time=10328.509..10360.956 rows=10 loops=1)
   ->  Sort  (cost=2293766.78..2301617.05 rows=3140109 width=44) (actual time=10328.509..10360.954 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1763577.33..2225910.15 rows=3140109 width=44) (actual time=10117.201..10338.743 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1763577.33..2139557.15 rows=3140109 width=24) (actual time=10117.187..10189.877 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1762577.27..1764539.84 rows=785027 width=24) (actual time=10095.113..10097.838 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4295kB
                           Worker 0:  Sort Method: quicksort  Memory: 4275kB
                           Worker 1:  Sort Method: quicksort  Memory: 4223kB
                           Worker 2:  Sort Method: quicksort  Memory: 4192kB
                           Worker 3:  Sort Method: quicksort  Memory: 4246kB
                           ->  Nested Loop  (cost=41574.23..1675363.78 rows=785027 width=24) (actual time=273.537..10077.044 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41573.66..354486.26 rows=363617 width=12) (actual time=271.723..1810.992 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308146.47 rows=1815660 width=16) (actual time=0.548..1093.663 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.84..40634.84 rows=75106 width=4) (actual time=270.471..270.472 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.84 rows=75106 width=4) (actual time=0.137..254.809 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.028..0.028 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 23.667 ms
 Execution Time: 10362.062 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2293766.78..2293766.80 rows=10 width=44) (actual time=3868.323..3897.074 rows=10 loops=1)
   ->  Sort  (cost=2293766.78..2301617.05 rows=3140109 width=44) (actual time=3868.322..3897.072 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1763577.33..2225910.15 rows=3140109 width=44) (actual time=3652.773..3874.777 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1763577.33..2139557.15 rows=3140109 width=24) (actual time=3652.760..3726.204 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1762577.27..1764539.84 rows=785027 width=24) (actual time=3644.721..3647.443 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4341kB
                           Worker 0:  Sort Method: quicksort  Memory: 4201kB
                           Worker 1:  Sort Method: quicksort  Memory: 4111kB
                           Worker 2:  Sort Method: quicksort  Memory: 4147kB
                           Worker 3:  Sort Method: quicksort  Memory: 4432kB
                           ->  Nested Loop  (cost=41574.23..1675363.78 rows=785027 width=24) (actual time=106.995..3624.726 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41573.66..354486.26 rows=363617 width=12) (actual time=106.809..1170.746 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308146.47 rows=1815660 width=16) (actual time=0.043..527.381 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.84..40634.84 rows=75106 width=4) (actual time=105.071..105.072 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.84 rows=75106 width=4) (actual time=0.037..81.077 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.008..0.008 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.620 ms
 Execution Time: 3897.152 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283531.81..666941.63 rows=1 width=24) (actual time=29590.381..29609.690 rows=1 loops=1)
   ->  GroupAggregate  (cost=283531.81..2200580.91 rows=5 width=24) (actual time=29590.381..29609.688 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283531.81..2197685.89 rows=578994 width=16) (actual time=6351.992..29527.575 rows=103030 loops=1)
               ->  Gather Merge  (cost=283531.25..352874.85 rows=579144 width=20) (actual time=6351.020..6481.863 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282531.19..282893.16 rows=144786 width=20) (actual time=6338.943..6341.933 rows=23400 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7484kB
                           Worker 0:  Sort Method: quicksort  Memory: 7452kB
                           Worker 1:  Sort Method: quicksort  Memory: 7462kB
                           Worker 2:  Sort Method: quicksort  Memory: 7417kB
                           Worker 3:  Sort Method: quicksort  Memory: 7439kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6680.66..270120.45 rows=144786 width=20) (actual time=130.830..6289.766 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46521
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6535.88 rows=579144 width=0) (actual time=86.552..86.552 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.204..0.204 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 15.065 ms
 Execution Time: 29610.517 ms
(25 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283531.81..666941.63 rows=1 width=24) (actual time=1724.481..1743.051 rows=1 loops=1)
   ->  GroupAggregate  (cost=283531.81..2200580.91 rows=5 width=24) (actual time=1724.480..1743.049 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283531.81..2197685.89 rows=578994 width=16) (actual time=711.346..1721.876 rows=103030 loops=1)
               ->  Gather Merge  (cost=283531.25..352874.85 rows=579144 width=20) (actual time=711.282..765.693 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282531.19..282893.16 rows=144786 width=20) (actual time=703.321..705.321 rows=23338 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 6788kB
                           Worker 0:  Sort Method: quicksort  Memory: 7293kB
                           Worker 1:  Sort Method: quicksort  Memory: 7484kB
                           Worker 2:  Sort Method: quicksort  Memory: 7889kB
                           Worker 3:  Sort Method: quicksort  Memory: 7800kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6680.66..270120.45 rows=144786 width=20) (actual time=127.494..668.488 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=39287
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6535.88 rows=579144 width=0) (actual time=81.730..81.730 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.082 ms
 Execution Time: 1743.114 ms
(25 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=752593.73..752593.73 rows=1 width=58) (actual time=23013.489..23059.018 rows=1 loops=1)
   ->  Sort  (cost=752593.73..752593.79 rows=25 width=58) (actual time=23013.488..23059.016 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=752358.66..752593.60 rows=25 width=58) (actual time=23005.512..23059.002 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=752358.66..752592.54 rows=100 width=58) (actual time=23004.185..23058.976 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=751358.61..751580.57 rows=25 width=58) (actual time=22982.007..22987.954 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=751358.61..751402.94 rows=17732 width=38) (actual time=22980.736..22981.388 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1175kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1171kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1170kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1168kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1178kB
                                 ->  Parallel Hash Join  (cost=72054.35..750107.25 rows=17732 width=38) (actual time=574.282..22967.444 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68362.76..744088.43 rows=443281 width=50) (actual time=554.115..22796.747 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68362.19..340299.39 rows=110849 width=38) (actual time=552.374..3990.969 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25568.44..295150.10 rows=554244 width=8) (actual time=260.448..3467.801 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52217
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25014.20 rows=2216976 width=0) (actual time=203.080..203.080 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41856.18..41856.18 rows=75006 width=38) (actual time=291.369..291.373 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41856.18 rows=75006 width=38) (actual time=0.999..265.559 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=8) (actual time=0.443..231.109 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.547..0.549 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.539..0.547 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.190..0.193 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.334..0.335 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.330..0.331 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.195..0.206 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=16.099..16.099 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.486..9.816 rows=20000 loops=5)
 Planning Time: 25.266 ms
 Execution Time: 23059.408 ms
(50 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=752593.73..752593.73 rows=1 width=58) (actual time=2522.178..2565.175 rows=1 loops=1)
   ->  Sort  (cost=752593.73..752593.79 rows=25 width=58) (actual time=2522.177..2565.173 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=752358.66..752593.60 rows=25 width=58) (actual time=2513.672..2565.154 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=752358.66..752592.54 rows=100 width=58) (actual time=2512.119..2565.119 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=751358.61..751580.57 rows=25 width=58) (actual time=2495.649..2502.247 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=751358.61..751402.94 rows=17732 width=38) (actual time=2494.377..2495.064 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1277kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1082kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1204kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1198kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1101kB
                                 ->  Parallel Hash Join  (cost=72054.35..750107.25 rows=17732 width=38) (actual time=391.960..2486.331 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68362.76..744088.43 rows=443281 width=50) (actual time=376.315..2357.966 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68362.19..340299.39 rows=110849 width=38) (actual time=376.274..947.131 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25568.44..295150.10 rows=554244 width=8) (actual time=246.289..645.076 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=58663
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25014.20 rows=2216976 width=0) (actual time=190.734..190.734 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41856.18..41856.18 rows=75006 width=38) (actual time=128.317..128.320 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25248kB
                                                         ->  Hash Join  (cost=2.51..41856.18 rows=75006 width=38) (actual time=0.103..97.075 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=8) (actual time=0.032..53.845 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.059..0.062 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.054..0.060 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.029..0.031 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.014..0.014 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=14.730..14.730 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.032..6.185 rows=20000 loops=5)
 Planning Time: 5.087 ms
 Execution Time: 2565.280 ms
(50 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1292083.33..1292083.34 rows=1 width=32) (actual time=17459.896..17492.858 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1292083.33..1292083.34 rows=1 width=32) (actual time=17459.894..17492.855 rows=1 loops=1)
         ->  Gather  (cost=1292082.89..1292083.30 rows=4 width=32) (actual time=17459.883..17492.846 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1291082.89..1291082.90 rows=1 width=32) (actual time=17448.406..17448.407 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=212404.22..1289574.51 rows=301676 width=12) (actual time=1341.775..17301.644 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79279 lossy=53117
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212102.54 rows=1206704 width=0) (actual time=1256.773..1256.773 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 16.630 ms
 Execution Time: 17494.466 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1292083.33..1292083.34 rows=1 width=32) (actual time=3104.080..3136.034 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1292083.33..1292083.34 rows=1 width=32) (actual time=3104.079..3136.032 rows=1 loops=1)
         ->  Gather  (cost=1292082.89..1292083.30 rows=4 width=32) (actual time=3101.666..3136.016 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1291082.89..1291082.90 rows=1 width=32) (actual time=3097.899..3097.900 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=212404.22..1289574.51 rows=301676 width=12) (actual time=1206.510..2995.250 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=84661 lossy=57022
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212102.54 rows=1206704 width=0) (actual time=1117.550..1117.550 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.659 ms
 Execution Time: 3136.081 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419065.41..1420109.64 rows=1 width=116) (actual time=33239.997..33246.150 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419065.41..11907263.44 rows=10044 width=116) (actual time=33239.996..33246.148 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419065.41..11906208.92 rows=60257 width=96) (actual time=7355.841..33214.581 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349096
               ->  Nested Loop  (cost=1419064.98..6749871.77 rows=1506435 width=76) (actual time=7331.734..27498.474 rows=363517 loops=1)
                     ->  Gather Merge  (cost=1419064.55..1599437.00 rows=1506435 width=76) (actual time=7330.614..7806.948 rows=363517 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418064.49..1419006.01 rows=376609 width=76) (actual time=7310.307..7354.083 rows=73086 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26848kB
                                 Worker 0:  Sort Method: external merge  Disk: 26504kB
                                 Worker 1:  Sort Method: external merge  Disk: 26352kB
                                 Worker 2:  Sort Method: external merge  Disk: 27112kB
                                 Worker 3:  Sort Method: external merge  Disk: 27144kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372425.90 rows=376609 width=76) (actual time=14.964..7028.672 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350101.55 rows=4524810 width=24) (actual time=0.501..6477.633 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=14.016..14.018 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 992kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=1.080..12.850 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.970..10.611 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.101..0.102 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.089..0.097 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.072..0.076 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.006..0.008 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.006..0.009 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.053..0.053 rows=1 loops=363517)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.015..0.015 rows=1 loops=363517)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 24.842 ms
 Execution Time: 33250.851 ms
(45 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419065.41..1420109.64 rows=1 width=116) (actual time=5499.522..5505.449 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419065.41..11907263.44 rows=10044 width=116) (actual time=5499.521..5505.447 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419065.41..11906208.92 rows=60257 width=96) (actual time=3209.571..5492.069 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349034
               ->  Nested Loop  (cost=1419064.98..6749871.77 rows=1506435 width=76) (actual time=3209.015..4441.062 rows=363455 loops=1)
                     ->  Gather Merge  (cost=1419064.55..1599437.00 rows=1506435 width=76) (actual time=3208.965..3425.904 rows=363455 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418064.49..1419006.01 rows=376609 width=76) (actual time=3197.400..3226.298 rows=73111 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26584kB
                                 Worker 0:  Sort Method: external merge  Disk: 27256kB
                                 Worker 1:  Sort Method: external merge  Disk: 26472kB
                                 Worker 2:  Sort Method: external merge  Disk: 25816kB
                                 Worker 3:  Sort Method: external merge  Disk: 27824kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372425.90 rows=376609 width=76) (actual time=13.393..2905.357 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350101.55 rows=4524810 width=24) (actual time=0.044..2288.255 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=11.082..11.084 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.084..10.051 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.045..7.478 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.033..0.035 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.025..0.030 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.012..0.013 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.005..0.006 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.007 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363455)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=363455)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.532 ms
 Execution Time: 5509.237 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386362.10..392219.90 rows=1 width=64) (actual time=34804.170..34809.592 rows=1 loops=1)
   ->  GroupAggregate  (cost=386362.10..14480220.71 rows=2406 width=64) (actual time=34804.169..34809.591 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386362.10..14479689.01 rows=24179 width=70) (actual time=2382.299..34783.543 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142650
               ->  Nested Loop  (cost=386362.10..14470894.85 rows=24179 width=20) (actual time=2382.273..34741.326 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386361.81..14391796.24 rows=24179 width=20) (actual time=2381.903..34156.450 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386361.37..3806828.14 rows=3634707 width=24) (actual time=2350.496..23723.860 rows=1816475 loops=1)
                                 ->  Gather Merge  (cost=386360.80..495189.06 rows=908912 width=8) (actual time=2349.165..2608.136 rows=454503 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385360.75..385928.82 rows=227228 width=8) (actual time=2331.174..2338.911 rows=92084 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 11719kB
                                             Worker 0:  Sort Method: quicksort  Memory: 11898kB
                                             Worker 1:  Sort Method: quicksort  Memory: 11753kB
                                             Worker 2:  Sort Method: quicksort  Memory: 11909kB
                                             Worker 3:  Sort Method: quicksort  Memory: 11893kB
                                             ->  Parallel Hash Join  (cost=42793.75..365144.52 rows=227228 width=8) (actual time=286.314..2290.458 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317522.17 rows=1136140 width=12) (actual time=0.452..1749.385 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41856.18..41856.18 rows=75006 width=4) (actual time=285.126..285.130 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41856.18 rows=75006 width=4) (actual time=0.249..268.436 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=8) (actual time=0.118..235.220 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.126..0.129 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.121..0.128 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.052..0.054 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.064..0.065 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.043..0.045 rows=4 loops=454503)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.005..0.005 rows=0 loops=1816475)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597334  Misses: 1219141  Evictions: 235613  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.007..0.007 rows=0 loops=1219141)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.049..0.049 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.009..0.011 rows=25 loops=1)
 Planning Time: 32.263 ms
 Execution Time: 34810.868 ms
(55 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386362.10..392219.90 rows=1 width=64) (actual time=8696.449..8702.641 rows=1 loops=1)
   ->  GroupAggregate  (cost=386362.10..14480220.71 rows=2406 width=64) (actual time=8696.448..8702.639 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386362.10..14479689.01 rows=24179 width=70) (actual time=930.402..8690.169 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142671
               ->  Nested Loop  (cost=386362.10..14470894.85 rows=24179 width=20) (actual time=930.384..8664.722 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386361.81..14391796.24 rows=24179 width=20) (actual time=930.372..8620.371 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386361.37..3806828.14 rows=3634707 width=24) (actual time=926.042..3998.305 rows=1816377 loops=1)
                                 ->  Gather Merge  (cost=386360.80..495189.06 rows=908912 width=8) (actual time=925.984..1109.481 rows=454475 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385360.75..385928.82 rows=227228 width=8) (actual time=917.352..923.366 rows=92008 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 11120kB
                                             Worker 0:  Sort Method: quicksort  Memory: 12237kB
                                             Worker 1:  Sort Method: quicksort  Memory: 11646kB
                                             Worker 2:  Sort Method: quicksort  Memory: 11167kB
                                             Worker 3:  Sort Method: quicksort  Memory: 13002kB
                                             ->  Parallel Hash Join  (cost=42793.75..365144.52 rows=227228 width=8) (actual time=126.024..874.643 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317522.17 rows=1136140 width=12) (actual time=0.042..457.841 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41856.18..41856.18 rows=75006 width=4) (actual time=124.821..124.824 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41856.18 rows=75006 width=4) (actual time=0.076..99.323 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=8) (actual time=0.040..58.520 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.031..0.033 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.026..0.032 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.007..0.009 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.006 rows=4 loops=454475)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=1816377)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 596953  Misses: 1219424  Evictions: 235911  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1219424)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.008..0.014 rows=25 loops=1)
 Planning Time: 5.507 ms
 Execution Time: 8703.070 ms
(55 rows)

query 9 run 1
SET
SET
SET
SET
SET
SET
query 10 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=936799.05..936799.10 rows=20 width=202) (actual time=22031.368..22086.347 rows=20 loops=1)
   ->  Sort  (cost=936799.05..938203.38 rows=561729 width=202) (actual time=22031.367..22086.344 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=840550.00..921851.65 rows=561729 width=202) (actual time=21001.060..21963.306 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=840550.00..907808.42 rows=561729 width=182) (actual time=21001.042..21270.725 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=839549.95..839901.03 rows=140432 width=182) (actual time=20988.834..21015.064 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 35632kB
                           Worker 0:  Sort Method: external merge  Disk: 46544kB
                           Worker 1:  Sort Method: external merge  Disk: 35144kB
                           Worker 2:  Sort Method: external merge  Disk: 47512kB
                           Worker 3:  Sort Method: external merge  Disk: 53696kB
                           ->  Hash Join  (cost=784251.18..827543.35 rows=140432 width=182) (actual time=20528.719..20846.222 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=784249.61..827110.67 rows=140432 width=160) (actual time=20528.593..20793.990 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=148) (actual time=0.447..111.813 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=782494.21..782494.21 rows=140432 width=16) (actual time=20527.002..20527.003 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6527.98..782494.21 rows=140432 width=16) (actual time=136.344..20362.083 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6527.41..269917.72 rows=141487 width=8) (actual time=135.149..4601.900 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46661
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6385.93 rows=565949 width=0) (actual time=87.009..87.009 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.131..0.136 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.057..0.057 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.049..0.052 rows=25 loops=5)
 Planning Time: 23.038 ms
 Execution Time: 22092.174 ms
(38 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=936799.05..936799.10 rows=20 width=202) (actual time=3610.579..3665.259 rows=20 loops=1)
   ->  Sort  (cost=936799.05..938203.38 rows=561729 width=202) (actual time=3610.577..3665.255 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=840550.00..921851.65 rows=561729 width=202) (actual time=2581.157..3543.475 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=840550.00..907808.42 rows=561729 width=182) (actual time=2581.137..2851.971 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=839549.95..839901.03 rows=140432 width=182) (actual time=2564.578..2590.947 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 51472kB
                           Worker 0:  Sort Method: external merge  Disk: 34112kB
                           Worker 1:  Sort Method: external merge  Disk: 37184kB
                           Worker 2:  Sort Method: external merge  Disk: 46816kB
                           Worker 3:  Sort Method: external merge  Disk: 48936kB
                           ->  Hash Join  (cost=784251.18..827543.35 rows=140432 width=182) (actual time=2167.152..2433.489 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=784249.61..827110.67 rows=140432 width=160) (actual time=2167.057..2374.701 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=148) (actual time=0.034..51.659 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=782494.21..782494.21 rows=140432 width=16) (actual time=2164.302..2164.304 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85216kB
                                             ->  Nested Loop  (cost=6527.98..782494.21 rows=140432 width=16) (actual time=133.476..2042.300 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6527.41..269917.72 rows=141487 width=8) (actual time=133.408..469.199 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=55078
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6385.93 rows=565949 width=0) (actual time=83.833..83.833 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.012..0.013 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.021..0.022 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.013..0.015 rows=25 loops=5)
 Planning Time: 2.461 ms
 Execution Time: 3672.168 ms
(38 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=432345.18..432345.18 rows=1 width=36) (actual time=3935.267..3951.720 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=190863.61..190863.62 rows=1 width=32) (actual time=146.192..146.274 rows=1 loops=1)
           ->  Gather  (cost=190863.39..190863.60 rows=2 width=32) (actual time=145.735..146.264 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=189863.39..189863.40 rows=1 width=32) (actual time=143.316..143.317 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..188885.72 rows=130355 width=10) (actual time=0.107..118.121 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.094..16.713 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.029..7.092 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 39951  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 30719  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 29255  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..109.76 rows=78 width=14) (actual time=0.003..0.066 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=241481.55..241742.26 rows=104284 width=36) (actual time=3935.266..3951.636 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=200960.76..240960.13 rows=104284 width=36) (actual time=3935.259..3951.628 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=200960.76..234312.04 rows=260710 width=36) (actual time=3479.984..3632.403 rows=314039 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=199960.74..203219.62 rows=130355 width=36) (actual time=3472.141..3562.600 rows=104680 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=199960.74..200286.63 rows=130355 width=14) (actual time=3472.130..3479.986 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 6335kB
                                 Worker 0:  Sort Method: quicksort  Memory: 6415kB
                                 Worker 1:  Sort Method: quicksort  Memory: 6493kB
                                 ->  Nested Loop  (cost=0.87..188885.72 rows=130355 width=14) (actual time=1.275..3436.709 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.365..26.722 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.223..14.306 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 32997  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 33281  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 33647  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.005..0.005 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..109.76 rows=78 width=18) (actual time=0.080..2.534 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 13.979 ms
 Execution Time: 3952.323 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=432345.18..432345.18 rows=1 width=36) (actual time=611.143..628.145 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=190863.61..190863.62 rows=1 width=32) (actual time=140.913..140.997 rows=1 loops=1)
           ->  Gather  (cost=190863.39..190863.60 rows=2 width=32) (actual time=140.329..140.988 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=189863.39..189863.40 rows=1 width=32) (actual time=138.050..138.051 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..188885.72 rows=130355 width=10) (actual time=0.113..113.043 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.101..16.267 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.034..6.675 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 42513  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 27425  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 29987  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..109.76 rows=78 width=14) (actual time=0.003..0.063 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=241481.55..241742.26 rows=104284 width=36) (actual time=611.142..628.060 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=200960.76..240960.13 rows=104284 width=36) (actual time=611.134..628.052 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=200960.76..234312.04 rows=260710 width=36) (actual time=157.033..311.998 rows=314658 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=199960.74..203219.62 rows=130355 width=36) (actual time=153.875..243.488 rows=104886 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=199960.74..200286.63 rows=130355 width=14) (actual time=153.859..161.439 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 6410kB
                                 Worker 0:  Sort Method: quicksort  Memory: 6420kB
                                 Worker 1:  Sort Method: quicksort  Memory: 6413kB
                                 ->  Nested Loop  (cost=0.87..188885.72 rows=130355 width=14) (actual time=0.106..130.566 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.093..16.774 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.029..7.050 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 34013  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 32915  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 32997  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..109.76 rows=78 width=18) (actual time=0.004..0.076 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.013 ms
 Execution Time: 628.229 ms
(56 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469558.06..1619713.15 rows=1 width=27) (actual time=13404.643..13407.952 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469558.06..2520643.71 rows=7 width=27) (actual time=13404.642..13407.950 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469558.06..2515470.07 rows=295633 width=27) (actual time=7216.914..13321.560 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469557.62..1504955.13 rows=295633 width=15) (actual time=7216.167..7286.333 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468557.57..1468742.34 rows=73908 width=15) (actual time=7205.061..7207.630 rows=32361 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3474kB
                           Worker 0:  Sort Method: quicksort  Memory: 3489kB
                           Worker 1:  Sort Method: quicksort  Memory: 3490kB
                           Worker 2:  Sort Method: quicksort  Memory: 3499kB
                           Worker 3:  Sort Method: quicksort  Memory: 3458kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462580.83 rows=73908 width=15) (actual time=3.080..7190.440 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.038..0.038 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.251 ms
 Execution Time: 13408.319 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469558.06..1619713.15 rows=1 width=27) (actual time=3979.088..3981.177 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469558.06..2520643.71 rows=7 width=27) (actual time=3979.087..3981.175 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469558.06..2515470.07 rows=295633 width=27) (actual time=3480.476..3931.414 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469557.62..1504955.13 rows=295633 width=15) (actual time=3480.432..3519.112 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468557.57..1468742.34 rows=73908 width=15) (actual time=3473.564..3475.683 rows=32208 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3528kB
                           Worker 0:  Sort Method: quicksort  Memory: 3413kB
                           Worker 1:  Sort Method: quicksort  Memory: 3552kB
                           Worker 2:  Sort Method: quicksort  Memory: 3577kB
                           Worker 3:  Sort Method: quicksort  Memory: 3339kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462580.83 rows=73908 width=15) (actual time=0.112..3459.339 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.848 ms
 Execution Time: 3981.234 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361699.90..1361699.90 rows=1 width=16) (actual time=16760.779..16760.782 rows=1 loops=1)
   ->  Sort  (cost=1361699.90..1361700.40 rows=200 width=16) (actual time=16760.778..16760.780 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361696.90..1361698.90 rows=200 width=16) (actual time=16760.752..16760.760 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208181.81..1339195.28 rows=1500108 width=12) (actual time=14623.886..16587.365 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53287.40..662923.57 rows=14849586 width=8) (actual time=372.847..10783.297 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448781.90 rows=14849586 width=8) (actual time=0.580..5013.607 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28676.05..28676.05 rows=1500108 width=4) (actual time=369.653..369.654 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28676.05 rows=1500108 width=4) (actual time=0.024..166.281 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 16.834 ms
 Execution Time: 16793.669 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361699.90..1361699.90 rows=1 width=16) (actual time=16154.601..16154.604 rows=1 loops=1)
   ->  Sort  (cost=1361699.90..1361700.40 rows=200 width=16) (actual time=16154.600..16154.603 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361696.90..1361698.90 rows=200 width=16) (actual time=16154.575..16154.582 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208181.81..1339195.28 rows=1500108 width=12) (actual time=14040.652..15982.283 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53287.40..662923.57 rows=14849586 width=8) (actual time=335.188..10235.103 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448781.90 rows=14849586 width=8) (actual time=0.037..4551.905 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28676.05..28676.05 rows=1500108 width=4) (actual time=332.596..332.597 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28676.05 rows=1500108 width=4) (actual time=0.021..133.575 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.709 ms
 Execution Time: 16188.456 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=893488.44..893488.45 rows=1 width=32) (actual time=8913.098..8949.575 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=893488.44..893488.45 rows=1 width=32) (actual time=8913.096..8949.573 rows=1 loops=1)
         ->  Gather  (cost=893487.98..893488.39 rows=4 width=64) (actual time=8906.859..8949.541 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=892487.98..892487.99 rows=1 width=64) (actual time=8898.730..8898.733 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65716.82..888808.25 rows=210270 width=33) (actual time=620.545..8756.472 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13486.11..836025.58 rows=210270 width=16) (actual time=287.729..8252.617 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=82820
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13275.85 rows=841078 width=0) (actual time=188.138..188.138 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.87..45980.87 rows=499987 width=25) (actual time=330.666..330.666 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.87 rows=499987 width=25) (actual time=0.440..168.314 rows=400000 loops=5)
 Planning Time: 17.069 ms
 Execution Time: 8950.317 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=893488.44..893488.45 rows=1 width=32) (actual time=1634.854..1682.674 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=893488.44..893488.45 rows=1 width=32) (actual time=1634.852..1682.671 rows=1 loops=1)
         ->  Gather  (cost=893487.98..893488.39 rows=4 width=64) (actual time=1628.917..1682.647 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=892487.98..892487.99 rows=1 width=64) (actual time=1623.943..1623.946 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65716.82..888808.25 rows=210270 width=33) (actual time=523.802..1517.508 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13486.11..836025.58 rows=210270 width=16) (actual time=269.964..1113.481 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=78039
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13275.85 rows=841078 width=0) (actual time=170.606..170.606 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.87..45980.87 rows=499987 width=25) (actual time=251.783..251.784 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.87 rows=499987 width=25) (actual time=0.058..79.719 rows=400000 loops=5)
 Planning Time: 1.040 ms
 Execution Time: 1682.944 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2738670.98..2738778.32 rows=1 width=103) (actual time=19772.701..19818.007 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1387913.20..1387913.21 rows=1 width=32) (actual time=2776.551..2785.585 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1385415.90..1386664.55 rows=99892 width=36) (actual time=2731.984..2779.596 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 56337kB
                 ->  Gather  (cost=1341213.69..1382419.14 rows=399568 width=36) (actual time=2422.510..2502.513 rows=398582 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1340213.69..1341462.34 rows=99892 width=36) (actual time=2418.334..2464.148 rows=99646 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 39953kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=35996.13..1334601.11 rows=561258 width=16) (actual time=427.906..1979.340 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=105825 lossy=70666
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35434.88 rows=2245031 width=0) (actual time=337.277..337.277 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1350757.77..1404322.42 rows=499 width=103) (actual time=19772.700..19808.970 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1350757.47..1403094.74 rows=499 width=36) (actual time=19771.893..19808.162 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1350757.47..1398599.60 rows=399568 width=36) (actual time=16803.465..16905.005 rows=346352 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1349757.42..1350007.15 rows=99892 width=36) (actual time=16774.864..16783.055 rows=69780 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11566kB
                           Worker 0:  Sort Method: quicksort  Memory: 11583kB
                           Worker 1:  Sort Method: quicksort  Memory: 11579kB
                           Worker 2:  Sort Method: quicksort  Memory: 11580kB
                           Worker 3:  Sort Method: quicksort  Memory: 11576kB
                           ->  Partial HashAggregate  (cost=1340213.69..1341462.34 rows=99892 width=36) (actual time=16690.623..16749.660 rows=98958 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 39953kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=35996.13..1334601.11 rows=561258 width=16) (actual time=476.841..16189.468 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79074 lossy=52737
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35434.88 rows=2245031 width=0) (actual time=390.226..390.226 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.801..0.801 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 17.619 ms
 Execution Time: 19820.835 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2738670.98..2738778.32 rows=1 width=103) (actual time=5680.654..5727.103 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1387913.20..1387913.21 rows=1 width=32) (actual time=2777.480..2786.513 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1385415.90..1386664.55 rows=99892 width=36) (actual time=2737.446..2780.651 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 57361kB
                 ->  Gather  (cost=1341213.69..1382419.14 rows=399568 width=36) (actual time=2426.791..2506.906 rows=398622 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1340213.69..1341462.34 rows=99892 width=36) (actual time=2422.603..2468.516 rows=99656 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 43025kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=35996.13..1334601.11 rows=561258 width=16) (actual time=429.043..1983.176 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=105461 lossy=70656
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35434.88 rows=2245031 width=0) (actual time=338.594..338.594 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1350757.77..1404322.42 rows=499 width=103) (actual time=5680.653..5718.067 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1350757.47..1403094.74 rows=499 width=36) (actual time=5680.600..5718.013 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1350757.47..1398599.60 rows=399568 width=36) (actual time=2714.598..2815.171 rows=346067 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1349757.42..1350007.15 rows=99892 width=36) (actual time=2688.149..2695.834 rows=69704 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11556kB
                           Worker 0:  Sort Method: quicksort  Memory: 11600kB
                           Worker 1:  Sort Method: quicksort  Memory: 11550kB
                           Worker 2:  Sort Method: quicksort  Memory: 11580kB
                           Worker 3:  Sort Method: quicksort  Memory: 11563kB
                           ->  Partial HashAggregate  (cost=1340213.69..1341462.34 rows=99892 width=36) (actual time=2603.261..2661.911 rows=98877 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=35996.13..1334601.11 rows=561258 width=16) (actual time=435.634..2166.436 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=77598 lossy=51356
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35434.88 rows=2245031 width=0) (actual time=347.425..347.425 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.048..0.049 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.074 ms
 Execution Time: 5729.303 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=251223.33..251223.33 rows=1 width=44) (actual time=2745.820..2753.603 rows=1 loops=1)
   ->  Sort  (cost=251223.33..251607.25 rows=153567 width=44) (actual time=2745.819..2753.602 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172100.31..250455.49 rows=153567 width=44) (actual time=2091.757..2748.218 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172100.31..242998.54 rows=592128 width=40) (actual time=2091.704..2586.307 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171100.25..171470.33 rows=148032 width=40) (actual time=1998.354..2014.118 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 18431kB
                           Worker 0:  Sort Method: quicksort  Memory: 20665kB
                           Worker 1:  Sort Method: quicksort  Memory: 20896kB
                           Worker 2:  Sort Method: quicksort  Memory: 20663kB
                           Worker 3:  Sort Method: quicksort  Memory: 20059kB
                           ->  Parallel Hash Join  (cost=57877.59..158387.60 rows=148032 width=40) (actual time=327.526..1066.110 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101357.26 rows=999697 width=8) (actual time=38.611..583.350 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.633..37.713 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.68..53480.68 rows=74036 width=40) (actual time=288.226..288.227 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26336kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.68 rows=74036 width=40) (actual time=0.644..260.414 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 16.881 ms
 Execution Time: 2753.962 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=251223.33..251223.33 rows=1 width=44) (actual time=2576.183..2580.278 rows=1 loops=1)
   ->  Sort  (cost=251223.33..251607.25 rows=153567 width=44) (actual time=2576.181..2580.276 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172100.31..250455.49 rows=153567 width=44) (actual time=1921.408..2574.821 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172100.31..242998.54 rows=592128 width=40) (actual time=1921.356..2410.630 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171100.25..171470.33 rows=148032 width=40) (actual time=1729.221..1744.994 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 17177kB
                           Worker 0:  Sort Method: quicksort  Memory: 25274kB
                           Worker 1:  Sort Method: quicksort  Memory: 25019kB
                           Worker 2:  Sort Method: quicksort  Memory: 16513kB
                           Worker 3:  Sort Method: quicksort  Memory: 26251kB
                           ->  Parallel Hash Join  (cost=57877.59..158387.60 rows=148032 width=40) (actual time=183.872..810.621 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101357.26 rows=999697 width=8) (actual time=26.161..448.700 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.088..26.049 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.68..53480.68 rows=74036 width=40) (actual time=156.693..156.693 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.68 rows=74036 width=40) (actual time=0.018..123.226 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 1.270 ms
 Execution Time: 2580.363 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3419213.13..3419213.14 rows=1 width=32) (actual time=24091.956..24169.827 rows=1 loops=1)
   ->  Aggregate  (cost=3419213.13..3419213.14 rows=1 width=32) (actual time=24091.955..24169.825 rows=1 loops=1)
         ->  Merge Join  (cost=2283224.51..3419162.32 rows=20324 width=8) (actual time=17881.939..24168.988 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2282223.59..3313709.29 rows=1968715 width=36) (actual time=17852.442..23974.628 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2282223.59..3225117.12 rows=7874860 width=36) (actual time=17852.422..19885.617 rows=9972287 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2281223.53..2286145.32 rows=1968715 width=36) (actual time=17575.714..17863.508 rows=1994951 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150344kB
                                 Worker 0:  Sort Method: external merge  Disk: 150368kB
                                 Worker 1:  Sort Method: external merge  Disk: 150360kB
                                 Worker 2:  Sort Method: external merge  Disk: 150336kB
                                 Worker 3:  Sort Method: external merge  Disk: 150360kB
                                 ->  Partial HashAggregate  (cost=1869732.38..2040798.71 rows=1968715 width=36) (actual time=9803.146..16738.549 rows=1995122 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 401416kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407672kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 403520kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 393240kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 402440kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275115.37 rows=14997237 width=9) (actual time=1.758..3845.971 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..99614.22 rows=61940 width=21) (actual time=27.375..72.689 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..99459.37 rows=61940 width=21) (actual time=27.369..66.220 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..91081.66 rows=15485 width=21) (actual time=0.978..492.756 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.98 rows=516 width=4) (actual time=0.770..202.369 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..46.93 rows=30 width=17) (actual time=0.341..0.571 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 16.430 ms
 Execution Time: 24240.727 ms
(38 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3419213.13..3419213.14 rows=1 width=32) (actual time=22696.793..22782.306 rows=1 loops=1)
   ->  Aggregate  (cost=3419213.13..3419213.14 rows=1 width=32) (actual time=22696.792..22782.304 rows=1 loops=1)
         ->  Merge Join  (cost=2283224.51..3419162.32 rows=20324 width=8) (actual time=16557.974..22781.590 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2282223.59..3313709.29 rows=1968715 width=36) (actual time=16548.613..22632.397 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2282223.59..3225117.12 rows=7874860 width=36) (actual time=16548.593..18597.830 rows=9971632 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2281223.53..2286145.32 rows=1968715 width=36) (actual time=16205.217..16493.607 rows=1994817 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150288kB
                                 Worker 0:  Sort Method: external merge  Disk: 150416kB
                                 Worker 1:  Sort Method: external merge  Disk: 150232kB
                                 Worker 2:  Sort Method: external merge  Disk: 150384kB
                                 Worker 3:  Sort Method: external merge  Disk: 150400kB
                                 ->  Partial HashAggregate  (cost=1869732.38..2040798.71 rows=1968715 width=36) (actual time=8405.385..15377.266 rows=1994990 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 391488kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 408592kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 376872kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407848kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 408048kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275115.37 rows=14997237 width=9) (actual time=0.059..1438.075 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..99614.22 rows=61940 width=21) (actual time=7.324..28.663 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..99459.37 rows=61940 width=21) (actual time=7.318..22.462 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..91081.66 rows=15485 width=21) (actual time=0.252..130.766 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.98 rows=516 width=4) (actual time=0.230..111.233 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..46.93 rows=30 width=17) (actual time=0.005..0.034 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.939 ms
 Execution Time: 22846.593 ms
(38 rows)

query 18 run 1
SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8579484.44..8579484.69 rows=100 width=71) (actual time=74024.325..74036.716 rows=99 loops=1)
   ->  Sort  (cost=8579484.44..8629462.32 rows=19991151 width=71) (actual time=74024.324..74036.708 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=830174.86..7815437.02 rows=19991151 width=71) (actual time=47285.450..74036.601 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=830174.86..7415614.00 rows=19991151 width=44) (actual time=47285.440..74036.327 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=830174.46..6690663.57 rows=19991151 width=44) (actual time=39738.028..74035.906 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829429.49..4161031.80 rows=4999079 width=43) (actual time=39441.411..62334.868 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828429.44..3564593.24 rows=1249770 width=43) (actual time=5326.287..37216.711 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828428.87..837804.57 rows=3750278 width=39) (actual time=3709.883..4044.306 rows=2996545 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 152704kB
                                             Worker 0:  Sort Method: external merge  Disk: 147200kB
                                             Worker 1:  Sort Method: external merge  Disk: 146896kB
                                             Worker 2:  Sort Method: external merge  Disk: 147160kB
                                             Worker 3:  Sort Method: external merge  Disk: 153936kB
                                             ->  Parallel Hash Join  (cost=44385.11..353000.40 rows=3750278 width=39) (actual time=302.432..2968.911 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298770.78 rows=3750278 width=20) (actual time=0.772..1147.541 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.27..39697.27 rows=375027 width=23) (actual time=299.444..299.445 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=23) (actual time=0.453..193.803 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692417.58 rows=4999079 width=4) (actual time=779.966..32960.224 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14996446
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167514.28 rows=59988948 width=9) (actual time=0.695..18731.972 rows=59972128 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167514.28 rows=59988948 width=9) (actual time=0.062..8363.085 rows=59916431 loops=1)
 Planning Time: 21.362 ms
 Execution Time: 74054.805 ms
(38 rows)

SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8579484.44..8579484.69 rows=100 width=71) (actual time=66096.288..66108.238 rows=99 loops=1)
   ->  Sort  (cost=8579484.44..8629462.32 rows=19991151 width=71) (actual time=66096.287..66108.230 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=830174.86..7815437.02 rows=19991151 width=71) (actual time=34733.581..66108.122 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=830174.86..7415614.00 rows=19991151 width=44) (actual time=34733.569..66107.846 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=830174.46..6690663.57 rows=19991151 width=44) (actual time=34186.457..66107.413 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829429.49..4161031.80 rows=4999079 width=43) (actual time=33881.688..54910.362 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828429.44..3564593.24 rows=1249770 width=43) (actual time=4706.265..32651.632 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828428.87..837804.57 rows=3750278 width=39) (actual time=3048.938..3388.501 rows=2996546 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 149000kB
                                             Worker 0:  Sort Method: external merge  Disk: 144448kB
                                             Worker 1:  Sort Method: external merge  Disk: 164616kB
                                             Worker 2:  Sort Method: external merge  Disk: 133072kB
                                             Worker 3:  Sort Method: external merge  Disk: 156792kB
                                             ->  Parallel Hash Join  (cost=44385.11..353000.40 rows=3750278 width=39) (actual time=197.276..2210.147 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298770.78 rows=3750278 width=20) (actual time=0.042..368.187 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.27..39697.27 rows=375027 width=23) (actual time=194.469..194.470 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.27 rows=375027 width=23) (actual time=0.037..62.552 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692417.58 rows=4999079 width=4) (actual time=639.799..29050.851 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167514.28 rows=59988948 width=9) (actual time=0.059..14566.085 rows=59986052 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167514.28 rows=59988948 width=9) (actual time=0.058..7872.518 rows=59916431 loops=1)
 Planning Time: 1.817 ms
 Execution Time: 66125.022 ms
(38 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=120820.67..120820.68 rows=1 width=32) (actual time=5075.659..5087.746 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=120820.67..120820.68 rows=1 width=32) (actual time=5075.658..5087.744 rows=1 loops=1)
         ->  Gather  (cost=120820.24..120820.65 rows=4 width=32) (actual time=5071.147..5087.730 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=119820.24..119820.25 rows=1 width=32) (actual time=5052.893..5052.895 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..119818.15 rows=278 width=12) (actual time=48.188..5052.277 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.46 rows=1179 width=30) (actual time=0.671..159.995 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.83 rows=1 width=21) (actual time=4.612..5.115 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 18.848 ms
 Execution Time: 5088.809 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=120820.67..120820.68 rows=1 width=32) (actual time=212.723..234.251 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=120820.67..120820.68 rows=1 width=32) (actual time=212.722..234.249 rows=1 loops=1)
         ->  Gather  (cost=120820.24..120820.65 rows=4 width=32) (actual time=209.406..234.234 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=119820.24..119820.25 rows=1 width=32) (actual time=202.727..202.728 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..119818.15 rows=278 width=12) (actual time=0.926..202.530 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.46 rows=1179 width=30) (actual time=0.116..128.707 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.83 rows=1 width=21) (actual time=0.069..0.076 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.084 ms
 Execution Time: 234.309 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2461143.59..2660530.98 rows=1 width=51) (actual time=38935.864..38937.163 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2461143.59..2660530.98 rows=1 width=51) (actual time=38935.862..38937.161 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=27.970..29.194 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=18.651..18.668 rows=392 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 304kB
                     Worker 0:  Sort Method: quicksort  Memory: 142kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.530..17.357 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.231..12.482 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.127..0.127 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.121..0.122 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2457020.66..2655772.17 rows=3 width=8) (actual time=37405.888..38906.921 rows=13474 loops=1)
               ->  Hash Join  (cost=2457020.66..2655772.16 rows=3 width=8) (actual time=37405.884..38903.394 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2380558.71..2542891.76 rows=4855776 width=40) (actual time=35972.342..37283.894 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146936.99..1994292.22 rows=9164432 width=13) (actual time=1219.258..30964.981 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144645.89 rows=9164432 width=0) (actual time=1095.033..1095.033 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75250.15..75250.15 rows=80786 width=16) (actual time=1433.246..1433.319 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75250.15 rows=80786 width=16) (actual time=1.662..1411.772 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.55 rows=20196 width=16) (actual time=1.375..1418.834 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.84 rows=5050 width=4) (actual time=0.352..119.494 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.278..0.297 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 32.956 ms
 Execution Time: 38979.327 ms
(46 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2461143.59..2660530.98 rows=1 width=51) (actual time=15461.937..15463.417 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2461143.59..2660530.98 rows=1 width=51) (actual time=15461.936..15463.415 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=16.700..18.117 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=14.450..14.467 rows=391 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 277kB
                     Worker 0:  Sort Method: quicksort  Memory: 170kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.254..13.112 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.022..8.253 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.026..0.027 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.020..0.022 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2457020.66..2655772.17 rows=3 width=8) (actual time=13945.991..15444.284 rows=13474 loops=1)
               ->  Hash Join  (cost=2457020.66..2655772.16 rows=3 width=8) (actual time=13945.986..15440.748 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2380558.71..2542891.76 rows=4855776 width=40) (actual time=13768.336..15077.621 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146936.99..1994292.22 rows=9164432 width=13) (actual time=1064.327..9660.455 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144645.89 rows=9164432 width=0) (actual time=941.211..941.211 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75250.15..75250.15 rows=80786 width=16) (actual time=177.348..177.409 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75250.15 rows=80786 width=16) (actual time=0.333..158.386 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.55 rows=20196 width=16) (actual time=0.129..159.306 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.84 rows=5050 width=4) (actual time=0.067..84.688 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.014..0.016 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.613 ms
 Execution Time: 15510.708 ms
(46 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1968200.84..1968200.85 rows=1 width=34) (actual time=11432.987..11444.946 rows=100 loops=1)
   ->  Sort  (cost=1968200.84..1968200.85 rows=1 width=34) (actual time=11432.986..11444.938 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1968197.62..1968200.83 rows=1 width=34) (actual time=10887.631..11442.510 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1968197.62..1968200.82 rows=1 width=26) (actual time=10887.465..11431.221 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1968197.05..1968197.17 rows=1 width=38) (actual time=10887.404..10932.496 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1967196.99..1967197.00 rows=1 width=38) (actual time=10860.024..10861.873 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1090kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1119kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1107kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1106kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1108kB
                                 ->  Nested Loop Anti Join  (cost=1338051.95..1967196.98 rows=1 width=38) (actual time=7221.880..10786.176 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338051.39..1653317.45 rows=97755 width=38) (actual time=7219.726..9308.049 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308146.47 rows=1833386 width=4) (actual time=0.556..1564.535 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335551.85..1335551.85 rows=199963 width=34) (actual time=7217.933..7218.235 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335551.85 rows=199963 width=34) (actual time=19.182..7055.456 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312608.46 rows=4999079 width=8) (actual time=0.513..6232.266 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=18.436..18.438 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 320kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.449..17.968 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.384..15.938 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.058..0.059 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.055..0.056 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.010..0.010 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 21.826 ms
 Execution Time: 11445.376 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1968200.84..1968200.85 rows=1 width=34) (actual time=6628.730..6645.344 rows=100 loops=1)
   ->  Sort  (cost=1968200.84..1968200.85 rows=1 width=34) (actual time=6628.729..6645.336 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1968197.62..1968200.83 rows=1 width=34) (actual time=6130.905..6642.929 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1968197.62..1968200.82 rows=1 width=26) (actual time=6130.749..6631.911 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1968197.05..1968197.17 rows=1 width=38) (actual time=6130.694..6180.202 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1967196.99..1967197.00 rows=1 width=38) (actual time=6107.629..6109.528 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1147kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1041kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1096kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1115kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1131kB
                                 ->  Nested Loop Anti Join  (cost=1338051.95..1967196.98 rows=1 width=38) (actual time=3669.596..6035.547 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338051.39..1653317.45 rows=97755 width=38) (actual time=3669.221..4835.168 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308146.47 rows=1833386 width=4) (actual time=0.039..561.873 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335551.85..1335551.85 rows=199963 width=34) (actual time=3667.315..3667.632 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335551.85 rows=199963 width=34) (actual time=10.952..3473.194 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312608.46 rows=4999079 width=8) (actual time=0.039..2563.519 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=9.874..9.876 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 384kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=1.677..9.459 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=1.641..6.116 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.019..0.021 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.055 ms
 Execution Time: 6645.436 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93878.31..93879.94 rows=1 width=72) (actual time=1896.028..1899.813 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46821.76..46821.77 rows=1 width=32) (actual time=311.634..311.739 rows=1 loops=1)
           ->  Gather  (cost=46821.33..46821.74 rows=4 width=32) (actual time=311.012..311.727 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45821.33..45821.34 rows=1 width=32) (actual time=295.554..295.554 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.46 rows=11948 width=6) (actual time=0.438..288.434 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.53..59719.22 rows=7752 width=72) (actual time=1896.027..1899.706 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.53..59525.42 rows=7752 width=38) (actual time=478.877..1891.707 rows=9006 loops=1)
               ->  Gather Merge  (cost=47056.10..49151.57 rows=17501 width=26) (actual time=478.229..501.289 rows=27128 loops=1)
                     Workers Planned: 4
                     Workers Launched: 3
                     ->  Sort  (cost=46056.04..46066.98 rows=4375 width=26) (actual time=160.657..161.647 rows=7651 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3873kB
                           Worker 0:  Sort Method: quicksort  Memory: 3645kB
                           Worker 1:  Sort Method: quicksort  Memory: 3790kB
                           Worker 2:  Sort Method: quicksort  Memory: 3798kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.46 rows=4375 width=26) (actual time=0.020..145.801 rows=47782 loops=4)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.050..0.050 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 17.228 ms
 Execution Time: 1900.604 ms
(30 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93878.31..93879.94 rows=1 width=72) (actual time=435.530..439.119 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46821.76..46821.77 rows=1 width=32) (actual time=202.316..202.421 rows=1 loops=1)
           ->  Gather  (cost=46821.33..46821.74 rows=4 width=32) (actual time=199.866..202.392 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45821.33..45821.34 rows=1 width=32) (actual time=195.862..195.865 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.46 rows=11948 width=6) (actual time=0.018..188.519 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.53..59719.22 rows=7752 width=72) (actual time=435.529..439.013 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.53..59525.42 rows=7752 width=38) (actual time=367.016..436.497 rows=9006 loops=1)
               ->  Gather Merge  (cost=47056.10..49151.57 rows=17501 width=26) (actual time=366.966..377.979 rows=27128 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=46056.04..46066.98 rows=4375 width=26) (actual time=159.012..159.583 rows=6286 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3878kB
                           Worker 0:  Sort Method: quicksort  Memory: 1848kB
                           Worker 1:  Sort Method: quicksort  Memory: 1859kB
                           Worker 2:  Sort Method: quicksort  Memory: 3759kB
                           Worker 3:  Sort Method: quicksort  Memory: 3762kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.46 rows=4375 width=26) (actual time=0.020..145.951 rows=38226 loops=5)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 1.016 ms
 Execution Time: 439.426 ms
(31 rows)

