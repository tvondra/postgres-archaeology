query 1 run 1
SET
SET
SET
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4245031.06..4245031.06 rows=1 width=236) (actual time=71050.192..71050.193 rows=1 loops=1)
   ->  Sort  (cost=4245031.06..4245031.07 rows=6 width=236) (actual time=71050.190..71050.191 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4245030.86..4245031.03 rows=6 width=236) (actual time=71050.153..71050.161 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               ->  Seq Scan on lineitem  (cost=0.00..1874941.10 rows=59252244 width=25) (actual time=0.487..11455.051 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning time: 12.676 ms
 Execution time: 71051.717 ms
(11 rows)

SET
SET
SET
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4245031.06..4245031.06 rows=1 width=236) (actual time=70204.954..70204.955 rows=1 loops=1)
   ->  Sort  (cost=4245031.06..4245031.07 rows=6 width=236) (actual time=70204.953..70204.953 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4245030.86..4245031.03 rows=6 width=236) (actual time=70204.925..70204.933 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               ->  Seq Scan on lineitem  (cost=0.00..1874941.10 rows=59252244 width=25) (actual time=0.022..9787.889 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning time: 0.474 ms
 Execution time: 70205.011 ms
(11 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1092813.09..1092813.09 rows=1 width=192) (actual time=5695.139..5695.154 rows=100 loops=1)
   ->  Sort  (cost=1092813.09..1092813.09 rows=1 width=192) (actual time=5695.138..5695.147 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=558116.95..1092813.08 rows=1 width=192) (actual time=3687.000..5691.941 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89212.57 rows=8175 width=30) (actual time=0.012..768.844 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=558115.95..566117.50 rows=1600310 width=172) (actual time=3685.864..4074.104 rows=1603828 loops=1)
                     ->  Sort  (cost=558115.95..562116.72 rows=1600310 width=172) (actual time=3685.861..3932.674 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293440kB
                           ->  Hash Join  (cost=4048.51..305294.89 rows=1600310 width=172) (actual time=41.553..2476.296 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255237.48 rows=8001548 width=14) (actual time=0.009..1093.926 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=41.524..41.526 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.017..36.462 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.002..24.675 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.012..0.013 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.007..0.012 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.002 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.004..0.004 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.002..0.003 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.104..0.104 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.092..0.101 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.087..0.099 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.086..0.097 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.082..0.083 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.010..0.011 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 21.917 ms
 Execution time: 5732.832 ms
(53 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1092813.09..1092813.09 rows=1 width=192) (actual time=4382.936..4382.951 rows=100 loops=1)
   ->  Sort  (cost=1092813.09..1092813.09 rows=1 width=192) (actual time=4382.935..4382.944 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=558116.95..1092813.08 rows=1 width=192) (actual time=3260.748..4380.768 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89212.57 rows=8175 width=30) (actual time=0.015..466.196 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=558115.95..566117.50 rows=1600310 width=172) (actual time=3260.635..3636.453 rows=1603828 loops=1)
                     ->  Sort  (cost=558115.95..562116.72 rows=1600310 width=172) (actual time=3260.632..3499.427 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293440kB
                           ->  Hash Join  (cost=4048.51..305294.89 rows=1600310 width=172) (actual time=24.749..2094.892 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255237.48 rows=8001548 width=14) (actual time=0.036..797.274 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=24.691..24.692 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.019..20.106 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.002..5.645 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.014..0.016 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.009..0.014 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.002..0.003 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.003..0.004 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.015..0.016 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.009..0.014 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.004..0.011 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.002..0.003 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.010..0.010 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 1.873 ms
 Execution time: 4419.547 ms
(53 rows)

query 3 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3443383.06..3443383.08 rows=10 width=44) (actual time=25597.323..25597.327 rows=10 loops=1)
   ->  Sort  (cost=3443383.06..3451326.16 rows=3177239 width=44) (actual time=25597.322..25597.325 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=3279406.90..3374724.07 rows=3177239 width=44) (actual time=25417.742..25578.601 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Sort  (cost=3279406.90..3287349.99 rows=3177239 width=24) (actual time=25417.728..25430.353 rows=301530 loops=1)
                     Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                     Sort Method: quicksort  Memory: 31119kB
                     ->  Hash Join  (cost=540146.47..2894387.29 rows=3177239 width=24) (actual time=7315.964..25328.122 rows=301530 loops=1)
                           Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                           ->  Seq Scan on lineitem  (cost=0.00..1874941.10 rows=32583287 width=16) (actual time=0.011..11652.011 rows=32534229 loops=1)
                                 Filter: (l_shipdate > '1995-03-07'::date)
                                 Rows Removed by Filter: 27451823
                           ->  Hash  (cost=514722.22..514722.22 rows=1462580 width=12) (actual time=7312.422..7312.423 rows=1451805 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                                 ->  Hash Join  (cost=144194.04..514722.22 rows=1462580 width=12) (actual time=1242.983..7034.532 rows=1451805 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=85699.96..437265.59 rows=7223810 width=16) (actual time=736.894..4943.506 rows=7239437 loops=1)
                                             Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..83894.01 rows=7223810 width=0) (actual time=692.990..692.990 rows=7239437 loops=1)
                                                   Index Cond: (o_orderdate < '1995-03-07'::date)
                                       ->  Hash  (cost=54697.69..54697.69 rows=303711 width=4) (actual time=505.235..505.235 rows=300276 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                             ->  Seq Scan on customer  (cost=0.00..54697.69 rows=303711 width=4) (actual time=0.012..454.554 rows=300276 loops=1)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 1199724
 Planning time: 22.135 ms
 Execution time: 25598.360 ms
(30 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3443383.06..3443383.08 rows=10 width=44) (actual time=20768.405..20768.408 rows=10 loops=1)
   ->  Sort  (cost=3443383.06..3451326.16 rows=3177239 width=44) (actual time=20768.404..20768.406 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=3279406.90..3374724.07 rows=3177239 width=44) (actual time=20589.044..20749.663 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Sort  (cost=3279406.90..3287349.99 rows=3177239 width=24) (actual time=20589.030..20601.564 rows=301530 loops=1)
                     Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                     Sort Method: quicksort  Memory: 31119kB
                     ->  Hash Join  (cost=540146.47..2894387.29 rows=3177239 width=24) (actual time=4559.839..20501.270 rows=301530 loops=1)
                           Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                           ->  Seq Scan on lineitem  (cost=0.00..1874941.10 rows=32583287 width=16) (actual time=0.008..9714.049 rows=32534229 loops=1)
                                 Filter: (l_shipdate > '1995-03-07'::date)
                                 Rows Removed by Filter: 27451823
                           ->  Hash  (cost=514722.22..514722.22 rows=1462580 width=12) (actual time=4557.983..4557.984 rows=1451805 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                                 ->  Hash Join  (cost=144194.04..514722.22 rows=1462580 width=12) (actual time=1027.716..4323.509 rows=1451805 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=85699.96..437265.59 rows=7223810 width=16) (actual time=656.709..2475.876 rows=7239437 loops=1)
                                             Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..83894.01 rows=7223810 width=0) (actual time=612.860..612.860 rows=7239437 loops=1)
                                                   Index Cond: (o_orderdate < '1995-03-07'::date)
                                       ->  Hash  (cost=54697.69..54697.69 rows=303711 width=4) (actual time=370.349..370.349 rows=300276 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                             ->  Seq Scan on customer  (cost=0.00..54697.69 rows=303711 width=4) (actual time=0.014..322.036 rows=300276 loops=1)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 1199724
 Planning time: 1.332 ms
 Execution time: 20769.020 ms
(30 rows)

query 4 run 1
SET
SET
SET
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2040553.76..2040553.76 rows=1 width=24) (actual time=19172.182..19172.184 rows=1 loops=1)
   ->  Sort  (cost=2040553.76..2040553.77 rows=5 width=24) (actual time=19172.182..19172.183 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2040553.68..2040553.73 rows=5 width=24) (actual time=19172.160..19172.162 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               ->  Nested Loop Semi Join  (cost=7935.57..2037792.27 rows=552282 width=16) (actual time=124.756..18920.824 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=7935.00..277488.96 rows=552397 width=20) (actual time=124.657..5120.839 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..7796.91 rows=552397 width=0) (actual time=85.409..85.410 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.024..0.024 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning time: 17.033 ms
 Execution time: 19172.773 ms
(18 rows)

SET
SET
SET
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2040553.76..2040553.76 rows=1 width=24) (actual time=4791.729..4791.730 rows=1 loops=1)
   ->  Sort  (cost=2040553.76..2040553.77 rows=5 width=24) (actual time=4791.727..4791.728 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2040553.68..2040553.73 rows=5 width=24) (actual time=4791.707..4791.709 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               ->  Nested Loop Semi Join  (cost=7935.57..2037792.27 rows=552282 width=16) (actual time=120.869..4624.407 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=7935.00..277488.96 rows=552397 width=20) (actual time=120.830..1231.469 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..7796.91 rows=552397 width=0) (actual time=81.301..81.301 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.006..0.006 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning time: 1.007 ms
 Execution time: 4791.791 ms
(18 rows)

query 5 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2072483.28..2072483.28 rows=1 width=58) (actual time=22265.072..22265.077 rows=1 loops=1)
   ->  Sort  (cost=2072483.28..2072483.34 rows=25 width=58) (actual time=22265.071..22265.075 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2071584.27..2072483.15 rows=25 width=58) (actual time=22241.525..22265.056 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2071584.27..2071763.98 rows=71886 width=38) (actual time=22235.619..22238.613 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=100518.95..2065785.43 rows=71886 width=38) (actual time=936.708..22190.710 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=95797.95..2051571.76 rows=1808126 width=50) (actual time=892.151..21734.316 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=95797.38..403973.42 rows=452126 width=38) (actual time=889.851..7042.529 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=32471.87..327649.29 rows=2260628 width=8) (actual time=297.415..5802.163 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..31906.72 rows=2260628 width=0) (actual time=253.855..253.855 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59575.38..59575.38 rows=300011 width=38) (actual time=591.981..591.983 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.51..59575.38 rows=300011 width=38) (actual time=0.037..533.937 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=8) (actual time=0.010..368.569 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.019..0.020 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.014..0.019 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.002..0.003 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.029..0.031 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=43.762..43.762 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.004..29.074 rows=100000 loops=1)
 Planning time: 25.087 ms
 Execution time: 22266.067 ms
(41 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2072483.28..2072483.28 rows=1 width=58) (actual time=6237.952..6237.957 rows=1 loops=1)
   ->  Sort  (cost=2072483.28..2072483.34 rows=25 width=58) (actual time=6237.951..6237.955 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2071584.27..2072483.15 rows=25 width=58) (actual time=6214.815..6237.934 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2071584.27..2071763.98 rows=71886 width=38) (actual time=6209.060..6211.982 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=100518.95..2065785.43 rows=71886 width=38) (actual time=784.472..6177.650 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=95797.95..2051571.76 rows=1808126 width=50) (actual time=746.077..5775.648 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=95797.38..403973.42 rows=452126 width=38) (actual time=746.051..2593.660 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=32471.87..327649.29 rows=2260628 width=8) (actual time=271.082..1576.469 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..31906.72 rows=2260628 width=0) (actual time=227.544..227.544 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59575.38..59575.38 rows=300011 width=38) (actual time=474.602..474.604 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.51..59575.38 rows=300011 width=38) (actual time=0.037..418.417 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=8) (actual time=0.009..259.147 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.020..0.021 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.014..0.019 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.002..0.004 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.006..0.006 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=38.077..38.078 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.005..21.879 rows=100000 loops=1)
 Planning time: 3.457 ms
 Execution time: 6238.204 ms
(41 rows)

query 6 run 1
SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1078278.15..1078278.16 rows=1 width=32) (actual time=12979.492..12979.493 rows=1 loops=1)
   ->  Aggregate  (cost=1078278.15..1078278.16 rows=1 width=32) (actual time=12979.491..12979.492 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=212400.81..1072459.93 rows=1163644 width=12) (actual time=1310.071..12378.031 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 13724091
               Heap Blocks: exact=395900 lossy=267068
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212109.90 rows=1163644 width=0) (actual time=1238.110..1238.111 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 12.077 ms
 Execution time: 12980.417 ms
(10 rows)

SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1078278.15..1078278.16 rows=1 width=32) (actual time=6595.803..6595.804 rows=1 loops=1)
   ->  Aggregate  (cost=1078278.15..1078278.16 rows=1 width=32) (actual time=6595.802..6595.802 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=212400.81..1072459.93 rows=1163644 width=12) (actual time=1173.882..6198.852 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 13724091
               Heap Blocks: exact=395900 lossy=267068
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212109.90 rows=1163644 width=0) (actual time=1102.813..1102.813 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 0.571 ms
 Execution time: 6595.996 ms
(10 rows)

query 7 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2380752.13..2380752.25 rows=1 width=92) (actual time=32250.473..32250.478 rows=1 loops=1)
   ->  GroupAggregate  (cost=2380752.13..2381979.21 rows=10032 width=92) (actual time=32250.472..32250.477 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2380752.13..2380902.34 rows=60087 width=72) (actual time=32243.492..32244.203 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=854361.78..2375982.79 rows=60087 width=72) (actual time=7062.788..32216.712 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=294600.91..1774611.90 rows=1443850 width=46) (actual time=2047.788..26373.263 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Bitmap Heap Scan on lineitem  (cost=290971.51..1688458.10 rows=18156239 width=24) (actual time=2012.266..23835.478 rows=18230325 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Index Recheck: 28836540
                                 Heap Blocks: exact=326879 lossy=793187
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..286432.46 rows=18156239 width=0) (actual time=1949.362..1949.362 rows=18230325 loops=1)
                                       Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                           ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=35.466..35.467 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.015..34.146 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.003..24.579 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.009..0.009 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=536558.77..536558.77 rows=1199927 width=30) (actual time=5010.750..5010.751 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=57054.17..536558.77 rows=1199927 width=30) (actual time=530.880..4771.232 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411258.82 rows=14999082 width=8) (actual time=0.021..1667.276 rows=15000000 loops=1)
                                 ->  Hash  (cost=55554.12..55554.12 rows=120004 width=30) (actual time=530.770..530.771 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..55554.12 rows=120004 width=30) (actual time=0.018..507.014 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=8) (actual time=0.003..363.955 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.011..0.011 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.007..0.009 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning time: 24.513 ms
 Execution time: 32250.918 ms
(45 rows)

SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2380752.13..2380752.25 rows=1 width=92) (actual time=18787.483..18787.488 rows=1 loops=1)
   ->  GroupAggregate  (cost=2380752.13..2381979.21 rows=10032 width=92) (actual time=18787.482..18787.487 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2380752.13..2380902.34 rows=60087 width=72) (actual time=18780.464..18781.171 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=854361.78..2375982.79 rows=60087 width=72) (actual time=5941.714..18756.598 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=294600.91..1774611.90 rows=1443850 width=46) (actual time=1746.201..13895.139 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Bitmap Heap Scan on lineitem  (cost=290971.51..1688458.10 rows=18156239 width=24) (actual time=1719.448..11688.040 rows=18230325 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Index Recheck: 28836540
                                 Heap Blocks: exact=326879 lossy=793187
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..286432.46 rows=18156239 width=0) (actual time=1656.491..1656.492 rows=18230325 loops=1)
                                       Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                           ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=26.725..26.726 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.015..25.415 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.003..15.861 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.008..0.009 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=536558.77..536558.77 rows=1199927 width=30) (actual time=4193.400..4193.401 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=57054.17..536558.77 rows=1199927 width=30) (actual time=400.811..3970.674 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411258.82 rows=14999082 width=8) (actual time=0.017..1238.119 rows=15000000 loops=1)
                                 ->  Hash  (cost=55554.12..55554.12 rows=120004 width=30) (actual time=400.705..400.706 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..55554.12 rows=120004 width=30) (actual time=0.018..378.553 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=8) (actual time=0.003..239.130 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.010..0.011 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.007..0.008 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning time: 2.682 ms
 Execution time: 18787.903 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1263420.66..1263420.91 rows=1 width=40) (actual time=60948.098..60948.104 rows=1 loops=1)
   ->  GroupAggregate  (cost=1263420.66..1264018.38 rows=2406 width=40) (actual time=60948.097..60948.102 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1263420.66..1263481.06 rows=24159 width=46) (actual time=60942.839..60943.292 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=504066.53..1261661.85 rows=24159 width=46) (actual time=7707.883..60930.880 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 287513
                     ->  Hash Join  (cost=504066.53..1252814.51 rows=24159 width=20) (actual time=7707.115..60865.235 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=499595.53..1248279.71 rows=24303 width=20) (actual time=7664.547..60811.047 rows=23842 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Nested Loop  (cost=0.56..738693.16 rows=399881 width=20) (actual time=1.306..52761.187 rows=389521 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65981.09 rows=13333 width=4) (actual time=0.776..462.333 rows=13011 loops=1)
                                             Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                             Rows Removed by Filter: 1986989
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.13 rows=32 width=24) (actual time=0.300..4.002 rows=30 loops=13011)
                                             Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=484639.08..484639.08 rows=911591 width=8) (actual time=7651.470..7651.472 rows=910360 loops=1)
                                       Buckets: 1048576  Batches: 2  Memory Usage: 25982kB
                                       ->  Hash Join  (cost=128793.50..484639.08 rows=911591 width=8) (actual time=1096.904..7409.115 rows=910360 loops=1)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Bitmap Heap Scan on orders  (cost=65467.98..395105.32 rows=4557956 width=12) (actual time=519.907..5549.697 rows=4557513 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                   Heap Blocks: exact=261268
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..64328.49 rows=4557956 width=0) (actual time=475.853..475.854 rows=4557513 loops=1)
                                                         Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             ->  Hash  (cost=59575.38..59575.38 rows=300011 width=4) (actual time=576.256..576.258 rows=299436 loops=1)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                   ->  Hash Join  (cost=2.51..59575.38 rows=300011 width=4) (actual time=0.042..526.154 rows=299436 loops=1)
                                                         Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=8) (actual time=0.013..367.435 rows=1500000 loops=1)
                                                         ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.021..0.022 rows=5 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.016..0.020 rows=5 loops=1)
                                                                     Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                     ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.004 rows=25 loops=1)
                                                                     ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                                                                                 Filter: (r_name = 'AMERICA'::bpchar)
                                                                                 Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.523..42.523 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.004..28.607 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.005..0.007 rows=25 loops=1)
 Planning time: 26.568 ms
 Execution time: 60949.122 ms
(50 rows)

SET
SET
SET
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1263420.66..1263420.91 rows=1 width=40) (actual time=5574.579..5574.584 rows=1 loops=1)
   ->  GroupAggregate  (cost=1263420.66..1264018.38 rows=2406 width=40) (actual time=5574.578..5574.583 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1263420.66..1263481.06 rows=24159 width=46) (actual time=5569.287..5569.742 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=504066.53..1261661.85 rows=24159 width=46) (actual time=3744.046..5563.976 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 287513
                     ->  Hash Join  (cost=504066.53..1252814.51 rows=24159 width=20) (actual time=3744.025..5523.736 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=499595.53..1248279.71 rows=24303 width=20) (actual time=3707.947..5479.120 rows=23842 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Nested Loop  (cost=0.56..738693.16 rows=399881 width=20) (actual time=0.080..1601.410 rows=389521 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65981.09 rows=13333 width=4) (actual time=0.052..259.711 rows=13011 loops=1)
                                             Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                             Rows Removed by Filter: 1986989
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.13 rows=32 width=24) (actual time=0.009..0.097 rows=30 loops=13011)
                                             Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=484639.08..484639.08 rows=911591 width=8) (actual time=3706.101..3706.104 rows=910360 loops=1)
                                       Buckets: 1048576  Batches: 2  Memory Usage: 25982kB
                                       ->  Hash Join  (cost=128793.50..484639.08 rows=911591 width=8) (actual time=915.408..3540.474 rows=910360 loops=1)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Bitmap Heap Scan on orders  (cost=65467.98..395105.32 rows=4557956 width=12) (actual time=471.937..2139.178 rows=4557513 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                   Heap Blocks: exact=261268
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..64328.49 rows=4557956 width=0) (actual time=427.686..427.686 rows=4557513 loops=1)
                                                         Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             ->  Hash  (cost=59575.38..59575.38 rows=300011 width=4) (actual time=442.760..442.762 rows=299436 loops=1)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                   ->  Hash Join  (cost=2.51..59575.38 rows=300011 width=4) (actual time=0.040..395.992 rows=299436 loops=1)
                                                         Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=8) (actual time=0.010..241.156 rows=1500000 loops=1)
                                                         ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.021..0.022 rows=5 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.016..0.021 rows=5 loops=1)
                                                                     Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                     ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.004 rows=25 loops=1)
                                                                     ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.006..0.007 rows=1 loops=1)
                                                                                 Filter: (r_name = 'AMERICA'::bpchar)
                                                                                 Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=36.031..36.032 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.006..21.345 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.004..0.006 rows=25 loops=1)
 Planning time: 3.696 ms
 Execution time: 5574.856 ms
(50 rows)

query 9 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1497223.37..1497223.41 rows=1 width=66) (actual time=183920.709..183920.713 rows=1 loops=1)
   ->  GroupAggregate  (cost=1497223.37..1497227.23 rows=103 width=66) (actual time=183920.707..183920.711 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1497223.37..1497223.63 rows=103 width=57) (actual time=183911.533..183913.531 rows=11401 loops=1)
               Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
               Sort Method: external merge  Disk: 239856kB
               ->  Nested Loop  (cost=66992.48..1497219.93 rows=103 width=57) (actual time=668.409..180411.767 rows=3248192 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 39009119
                     ->  Nested Loop  (cost=66992.48..1497180.86 rows=103 width=31) (actual time=668.378..173128.509 rows=3248192 loops=1)
                           ->  Nested Loop  (cost=66992.04..1496828.33 rows=103 width=31) (actual time=667.622..126173.856 rows=3248192 loops=1)
                                 ->  Nested Loop  (cost=66991.75..1496490.68 rows=103 width=35) (actual time=667.605..118482.750 rows=3248192 loops=1)
                                       ->  Hash Join  (cost=66991.19..343232.78 rows=323293 width=18) (actual time=667.329..3127.020 rows=433248 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..255237.48 rows=8001548 width=14) (actual time=0.010..1350.465 rows=8000000 loops=1)
                                             ->  Hash  (cost=65981.09..65981.09 rows=80808 width=4) (actual time=667.203..667.204 rows=108312 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4832kB
                                                   ->  Seq Scan on part  (cost=0.00..65981.09 rows=80808 width=4) (actual time=0.007..645.357 rows=108312 loops=1)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 1891688
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.039..0.263 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                 ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.28 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=3248192)
                                       Index Cond: (s_suppkey = lineitem.l_suppkey)
                           ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.014..0.014 rows=1 loops=3248192)
                                 Index Cond: (o_orderkey = lineitem.l_orderkey)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=3248192)
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.009..0.014 rows=25 loops=1)
 Planning time: 30.381 ms
 Execution time: 183950.236 ms
(30 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1497223.37..1497223.41 rows=1 width=66) (actual time=73561.954..73561.958 rows=1 loops=1)
   ->  GroupAggregate  (cost=1497223.37..1497227.23 rows=103 width=66) (actual time=73561.953..73561.957 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1497223.37..1497223.63 rows=103 width=57) (actual time=73552.775..73554.776 rows=11401 loops=1)
               Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
               Sort Method: external merge  Disk: 239856kB
               ->  Nested Loop  (cost=66992.48..1497219.93 rows=103 width=57) (actual time=624.791..70377.523 rows=3248192 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 39009119
                     ->  Nested Loop  (cost=66992.48..1497180.86 rows=103 width=31) (actual time=624.776..64288.993 rows=3248192 loops=1)
                           ->  Nested Loop  (cost=66992.04..1496828.33 rows=103 width=31) (actual time=624.754..43605.864 rows=3248192 loops=1)
                                 ->  Nested Loop  (cost=66991.75..1496490.68 rows=103 width=35) (actual time=624.748..37815.142 rows=3248192 loops=1)
                                       ->  Hash Join  (cost=66991.19..343232.78 rows=323293 width=18) (actual time=624.717..2841.296 rows=433248 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..255237.48 rows=8001548 width=14) (actual time=0.012..1206.961 rows=8000000 loops=1)
                                             ->  Hash  (cost=65981.09..65981.09 rows=80808 width=4) (actual time=624.563..624.563 rows=108312 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4832kB
                                                   ->  Seq Scan on part  (cost=0.00..65981.09 rows=80808 width=4) (actual time=0.009..603.695 rows=108312 loops=1)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 1891688
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.014..0.078 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                 ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.28 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=3248192)
                                       Index Cond: (s_suppkey = lineitem.l_suppkey)
                           ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.006..0.006 rows=1 loops=3248192)
                                 Index Cond: (o_orderkey = lineitem.l_orderkey)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=3248192)
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 16.355 ms
 Execution time: 73590.641 ms
(30 rows)

query 10 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2460251.85..2460251.90 rows=20 width=202) (actual time=21098.061..21098.066 rows=20 loops=1)
   ->  Sort  (cost=2460251.85..2461678.06 rows=570484 width=202) (actual time=21098.060..21098.064 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=2429383.16..2445071.47 rows=570484 width=202) (actual time=20184.151..20993.777 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Sort  (cost=2429383.16..2430809.37 rows=570484 width=182) (actual time=20184.134..20370.999 rows=1145402 loops=1)
                     Sort Key: customer.c_custkey, nation.n_name
                     Sort Method: external merge  Disk: 218520kB
                     ->  Hash Join  (cost=387387.38..2342248.43 rows=570484 width=182) (actual time=5863.254..19422.975 rows=1145402 loops=1)
                           Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                           ->  Hash Join  (cost=387385.82..2340495.49 rows=570484 width=160) (actual time=5863.238..19205.822 rows=1145402 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=285459.58..2199271.73 rows=570484 width=16) (actual time=4898.927..17401.431 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1874941.10 rows=14808013 width=16) (actual time=0.012..10663.932 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=278236.52..278236.52 rows=577845 width=8) (actual time=4896.892..4896.893 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=8300.85..278236.52 rows=577845 width=8) (actual time=122.829..4731.335 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8156.39 rows=577845 width=0) (actual time=83.975..83.975 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                 ->  Hash  (cost=50947.55..50947.55 rows=1500055 width=148) (actual time=963.731..963.731 rows=1500000 loops=1)
                                       Buckets: 262144  Batches: 16  Memory Usage: 18791kB
                                       ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=148) (actual time=0.005..512.452 rows=1500000 loops=1)
                           ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.011..0.012 rows=25 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.004..0.007 rows=25 loops=1)
 Planning time: 21.830 ms
 Execution time: 21134.565 ms
(33 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2460251.85..2460251.90 rows=20 width=202) (actual time=15508.233..15508.239 rows=20 loops=1)
   ->  Sort  (cost=2460251.85..2461678.06 rows=570484 width=202) (actual time=15508.232..15508.236 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=2429383.16..2445071.47 rows=570484 width=202) (actual time=14580.441..15400.039 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Sort  (cost=2429383.16..2430809.37 rows=570484 width=182) (actual time=14580.425..14768.153 rows=1145402 loops=1)
                     Sort Key: customer.c_custkey, nation.n_name
                     Sort Method: external merge  Disk: 218520kB
                     ->  Hash Join  (cost=387387.38..2342248.43 rows=570484 width=182) (actual time=2413.640..13821.493 rows=1145402 loops=1)
                           Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                           ->  Hash Join  (cost=387385.82..2340495.49 rows=570484 width=160) (actual time=2413.623..13605.762 rows=1145402 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=285459.58..2199271.73 rows=570484 width=16) (actual time=1565.660..11940.091 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1874941.10 rows=14808013 width=16) (actual time=0.010..8607.871 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=278236.52..278236.52 rows=577845 width=8) (actual time=1564.338..1564.339 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=8300.85..278236.52 rows=577845 width=8) (actual time=111.743..1435.855 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8156.39 rows=577845 width=0) (actual time=72.951..72.951 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                 ->  Hash  (cost=50947.55..50947.55 rows=1500055 width=148) (actual time=847.406..847.407 rows=1500000 loops=1)
                                       Buckets: 262144  Batches: 16  Memory Usage: 18791kB
                                       ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=148) (actual time=0.004..389.916 rows=1500000 loops=1)
                           ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.012..0.013 rows=25 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.004..0.008 rows=25 loops=1)
 Planning time: 1.922 ms
 Execution time: 15544.622 ms
(33 rows)

query 11 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=626004.14..626004.15 rows=1 width=36) (actual time=3577.296..3577.300 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293167.83..293167.84 rows=1 width=32) (actual time=1512.998..1513.000 rows=1 loops=1)
           ->  Hash Join  (cost=2323.46..290767.36 rows=320062 width=10) (actual time=2.765..1418.563 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255237.48 rows=8001548 width=14) (actual time=0.034..728.703 rows=8000000 loops=1)
                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=2.699..2.700 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.481..2.353 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.007 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.471..1.947 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.296..0.296 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=332836.30..333636.46 rows=320062 width=36) (actual time=3577.295..3577.297 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=320033.82..331235.99 rows=320062 width=36) (actual time=3577.283..3577.284 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=320033.82..320833.98 rows=320062 width=14) (actual time=1868.399..1880.552 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Hash Join  (cost=2323.46..290767.36 rows=320062 width=14) (actual time=24.187..1820.719 rows=320800 loops=1)
                           Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on partsupp  (cost=0.00..255237.48 rows=8001548 width=18) (actual time=0.333..1055.192 rows=8000000 loops=1)
                           ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=23.773..23.774 rows=4010 loops=1)
                                 Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                 ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=1.991..23.030 rows=4010 loops=1)
                                       ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.012..0.015 rows=1 loops=1)
                                             Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                             Rows Removed by Filter: 24
                                       ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=1.975..22.458 rows=4010 loops=1)
                                             Recheck Cond: (s_nationkey = nation.n_nationkey)
                                             Heap Blocks: exact=1869
                                             ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=1.740..1.740 rows=4010 loops=1)
                                                   Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 16.349 ms
 Execution time: 3578.118 ms
(43 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=626004.14..626004.15 rows=1 width=36) (actual time=3162.132..3162.137 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293167.83..293167.84 rows=1 width=32) (actual time=1504.310..1504.312 rows=1 loops=1)
           ->  Hash Join  (cost=2323.46..290767.36 rows=320062 width=10) (actual time=2.801..1410.019 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255237.48 rows=8001548 width=14) (actual time=0.035..727.532 rows=8000000 loops=1)
                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=2.729..2.730 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.484..2.382 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.473..1.961 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.296..0.296 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=332836.30..333636.46 rows=320062 width=36) (actual time=3162.132..3162.134 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=320033.82..331235.99 rows=320062 width=36) (actual time=3162.110..3162.112 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=320033.82..320833.98 rows=320062 width=14) (actual time=1460.416..1472.529 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Hash Join  (cost=2323.46..290767.36 rows=320062 width=14) (actual time=3.522..1416.141 rows=320800 loops=1)
                           Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on partsupp  (cost=0.00..255237.48 rows=8001548 width=18) (actual time=0.026..727.511 rows=8000000 loops=1)
                           ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=3.473..3.474 rows=4010 loops=1)
                                 Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                 ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.495..3.122 rows=4010 loops=1)
                                       ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                             Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                             Rows Removed by Filter: 24
                                       ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.484..2.716 rows=4010 loops=1)
                                             Recheck Cond: (s_nationkey = nation.n_nationkey)
                                             Heap Blocks: exact=1869
                                             ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.301..0.301 rows=4010 loops=1)
                                                   Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 1.056 ms
 Execution time: 3162.289 ms
(43 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3117508.96..3118341.71 rows=1 width=27) (actual time=20084.927..20084.929 rows=1 loops=1)
   ->  GroupAggregate  (cost=3117508.96..3123338.19 rows=7 width=27) (actual time=20084.926..20084.928 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3117508.96..3118237.61 rows=291458 width=27) (actual time=20042.523..20048.573 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Merge Join  (cost=2501242.80..3091054.88 rows=291458 width=27) (actual time=14688.908..19968.012 rows=311258 loops=1)
                     Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..547951.67 rows=14999082 width=20) (actual time=0.004..4077.679 rows=14999967 loops=1)
                     ->  Sort  (cost=2501233.66..2501962.31 rows=291458 width=15) (actual time=14688.807..14718.206 rows=311258 loops=1)
                           Sort Key: lineitem.l_orderkey
                           Sort Method: quicksort  Memory: 25513kB
                           ->  Seq Scan on lineitem  (cost=0.00..2474779.58 rows=291458 width=15) (actual time=0.741..14620.705 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning time: 15.882 ms
 Execution time: 20085.732 ms
(17 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3117508.96..3118341.71 rows=1 width=27) (actual time=16999.311..16999.312 rows=1 loops=1)
   ->  GroupAggregate  (cost=3117508.96..3123338.19 rows=7 width=27) (actual time=16999.309..16999.310 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3117508.96..3118237.61 rows=291458 width=27) (actual time=16957.156..16963.174 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Merge Join  (cost=2501242.80..3091054.88 rows=291458 width=27) (actual time=12671.195..16889.790 rows=311258 loops=1)
                     Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..547951.67 rows=14999082 width=20) (actual time=0.004..3057.022 rows=14999967 loops=1)
                     ->  Sort  (cost=2501233.66..2501962.31 rows=291458 width=15) (actual time=12671.146..12697.569 rows=311258 loops=1)
                           Sort Key: lineitem.l_orderkey
                           Sort Method: quicksort  Memory: 25513kB
                           ->  Seq Scan on lineitem  (cost=0.00..2474779.58 rows=291458 width=15) (actual time=0.090..12607.701 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning time: 0.865 ms
 Execution time: 16999.428 ms
(17 rows)

query 13 run 1
SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2687696.32..2687696.32 rows=1 width=16) (actual time=19435.018..19435.020 rows=1 loops=1)
   ->  Sort  (cost=2687696.32..2687696.82 rows=200 width=16) (actual time=19435.017..19435.019 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2687693.32..2687695.32 rows=200 width=16) (actual time=19434.996..19435.002 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2539970.36..2665192.50 rows=1500055 width=12) (actual time=15870.652..19250.377 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Sort  (cost=2539970.36..2576710.89 rows=14696212 width=8) (actual time=15870.643..17687.528 rows=15337604 loops=1)
                           Sort Key: customer.c_custkey
                           Sort Method: external merge  Disk: 268424kB
                           ->  Hash Right Join  (cost=53285.94..661296.13 rows=14696212 width=8) (actual time=338.464..11260.486 rows=15337604 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..448756.53 rows=14696212 width=8) (actual time=0.449..5413.227 rows=14837583 loops=1)
                                       Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                       Rows Removed by Filter: 162417
                                 ->  Hash  (cost=28675.25..28675.25 rows=1500055 width=4) (actual time=336.629..336.629 rows=1500000 loops=1)
                                       Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                       ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28675.25 rows=1500055 width=4) (actual time=0.501..160.184 rows=1500000 loops=1)
                                             Heap Fetches: 0
 Planning time: 15.371 ms
 Execution time: 19476.288 ms
(22 rows)

SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2687696.32..2687696.32 rows=1 width=16) (actual time=18839.282..18839.284 rows=1 loops=1)
   ->  Sort  (cost=2687696.32..2687696.82 rows=200 width=16) (actual time=18839.281..18839.283 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2687693.32..2687695.32 rows=200 width=16) (actual time=18839.262..18839.269 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2539970.36..2665192.50 rows=1500055 width=12) (actual time=15296.338..18660.086 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Sort  (cost=2539970.36..2576710.89 rows=14696212 width=8) (actual time=15296.328..17105.256 rows=15337604 loops=1)
                           Sort Key: customer.c_custkey
                           Sort Method: external merge  Disk: 268424kB
                           ->  Hash Right Join  (cost=53285.94..661296.13 rows=14696212 width=8) (actual time=302.335..10689.854 rows=15337604 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..448756.53 rows=14696212 width=8) (actual time=0.034..4923.161 rows=14837583 loops=1)
                                       Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                       Rows Removed by Filter: 162417
                                 ->  Hash  (cost=28675.25..28675.25 rows=1500055 width=4) (actual time=300.969..300.970 rows=1500000 loops=1)
                                       Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                       ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28675.25 rows=1500055 width=4) (actual time=0.044..127.768 rows=1500000 loops=1)
                                             Heap Fetches: 0
 Planning time: 0.519 ms
 Execution time: 18880.279 ms
(22 rows)

query 14 run 1
SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=828664.85..828664.86 rows=1 width=32) (actual time=7844.964..7844.966 rows=1 loops=1)
   ->  Aggregate  (cost=828664.85..828664.86 rows=1 width=32) (actual time=7844.963..7844.964 rows=1 loops=1)
         ->  Hash Join  (cost=112338.80..814813.24 rows=791520 width=33) (actual time=1065.263..7471.863 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Bitmap Heap Scan on lineitem  (cost=12685.65..691680.34 rows=791520 width=16) (actual time=219.003..5966.851 rows=772942 loops=1)
                     Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                     Heap Blocks: exact=416569
                     ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12487.77 rows=791520 width=0) (actual time=142.791..142.791 rows=772942 loops=1)
                           Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60981.07..60981.07 rows=2000007 width=25) (actual time=845.151..845.151 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60981.07 rows=2000007 width=25) (actual time=0.009..539.673 rows=2000000 loops=1)
 Planning time: 17.657 ms
 Execution time: 7845.898 ms
(14 rows)

SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=828664.85..828664.86 rows=1 width=32) (actual time=3950.703..3950.705 rows=1 loops=1)
   ->  Aggregate  (cost=828664.85..828664.86 rows=1 width=32) (actual time=3950.702..3950.703 rows=1 loops=1)
         ->  Hash Join  (cost=112338.80..814813.24 rows=791520 width=33) (actual time=896.766..3609.252 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Bitmap Heap Scan on lineitem  (cost=12685.65..691680.34 rows=791520 width=16) (actual time=208.833..2348.742 rows=772942 loops=1)
                     Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                     Heap Blocks: exact=416569
                     ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12487.77 rows=791520 width=0) (actual time=132.791..132.791 rows=772942 loops=1)
                           Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60981.07..60981.07 rows=2000007 width=25) (actual time=687.496..687.497 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60981.07 rows=2000007 width=25) (actual time=0.008..389.785 rows=2000000 loops=1)
 Planning time: 0.836 ms
 Execution time: 3951.006 ms
(14 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2684188.64..2684189.18 rows=1 width=103) (actual time=19322.232..19322.235 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1221466.89..1221466.90 rows=1 width=32) (actual time=6207.459..6207.461 rows=1 loops=1)
           ->  HashAggregate  (cost=1218951.92..1220209.40 rows=100599 width=36) (actual time=6163.809..6200.616 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36645.19..1196086.43 rows=2286549 width=16) (actual time=346.921..4683.519 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36073.56 rows=2286549 width=0) (actual time=274.495..274.496 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1462721.74..1516610.68 rows=100599 width=103) (actual time=19322.231..19322.232 rows=1 loops=1)
         Merge Cond: (supplier.s_suppkey = lineitem.l_suppkey)
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=71) (actual time=0.720..19.388 rows=69998 loops=1)
         ->  GroupAggregate  (cost=1462721.45..1509961.41 rows=100599 width=36) (actual time=19298.861..19298.862 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1462721.45..1468437.82 rows=2286549 width=16) (actual time=12394.605..12548.504 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60920kB
                     ->  Bitmap Heap Scan on lineitem  (cost=36645.19..1196086.43 rows=2286549 width=16) (actual time=408.239..11503.586 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 13223651
                           Heap Blocks: exact=401153 lossy=267105
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36073.56 rows=2286549 width=0) (actual time=334.984..334.984 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning time: 12.710 ms
 Execution time: 19330.739 ms
(29 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2684188.64..2684189.18 rows=1 width=103) (actual time=12960.739..12960.742 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1221466.89..1221466.90 rows=1 width=32) (actual time=6238.173..6238.174 rows=1 loops=1)
           ->  HashAggregate  (cost=1218951.92..1220209.40 rows=100599 width=36) (actual time=6194.100..6231.264 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36645.19..1196086.43 rows=2286549 width=16) (actual time=348.304..4713.994 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36073.56 rows=2286549 width=0) (actual time=275.733..275.733 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1462721.74..1516610.68 rows=100599 width=103) (actual time=12960.738..12960.739 rows=1 loops=1)
         Merge Cond: (supplier.s_suppkey = lineitem.l_suppkey)
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=71) (actual time=0.041..10.772 rows=69998 loops=1)
         ->  GroupAggregate  (cost=1462721.45..1509961.41 rows=100599 width=36) (actual time=12946.187..12946.188 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1462721.45..1468437.82 rows=2286549 width=16) (actual time=6007.945..6162.121 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60920kB
                     ->  Bitmap Heap Scan on lineitem  (cost=36645.19..1196086.43 rows=2286549 width=16) (actual time=372.487..5224.196 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 13223651
                           Heap Blocks: exact=401153 lossy=267105
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36073.56 rows=2286549 width=0) (actual time=299.965..299.965 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning time: 0.874 ms
 Execution time: 12969.660 ms
(29 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=358828.39..358828.39 rows=1 width=44) (actual time=6468.085..6468.087 rows=1 loops=1)
   ->  Sort  (cost=358828.39..359212.90 rows=153804 width=44) (actual time=6468.084..6468.085 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=349088.24..358059.37 rows=153804 width=44) (actual time=5816.418..6462.647 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=349088.24..350574.86 rows=594647 width=40) (actual time=5816.367..6161.392 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Hash Join  (cost=98168.47..281603.11 rows=594647 width=40) (actual time=812.649..3079.863 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176404.05 rows=4000774 width=8) (actual time=36.703..1507.626 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.227..36.160 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90981.18..90981.18 rows=297267 width=40) (actual time=775.337..775.337 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90981.18 rows=297267 width=40) (actual time=0.014..709.048 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning time: 15.497 ms
 Execution time: 6476.656 ms
(26 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=358828.39..358828.39 rows=1 width=44) (actual time=5958.894..5958.896 rows=1 loops=1)
   ->  Sort  (cost=358828.39..359212.90 rows=153804 width=44) (actual time=5958.893..5958.895 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=349088.24..358059.37 rows=153804 width=44) (actual time=5306.211..5953.481 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=349088.24..350574.86 rows=594647 width=40) (actual time=5306.161..5651.278 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Hash Join  (cost=98168.47..281603.11 rows=594647 width=40) (actual time=501.605..2574.447 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176404.05 rows=4000774 width=8) (actual time=20.190..1315.273 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.083..20.143 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90981.18..90981.18 rows=297267 width=40) (actual time=480.802..480.802 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90981.18 rows=297267 width=40) (actual time=0.015..424.017 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning time: 0.716 ms
 Execution time: 5966.634 ms
(26 rows)

query 17 run 1
SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10827423.29..10827423.30 rows=1 width=32) (actual time=49198.835..49198.836 rows=1 loops=1)
   ->  Aggregate  (cost=10827423.29..10827423.30 rows=1 width=32) (actual time=49198.834..49198.835 rows=1 loops=1)
         ->  Merge Join  (cost=10133319.51..10827375.67 rows=19046 width=8) (actual time=27959.403..49197.008 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  GroupAggregate  (cost=10133318.52..10611352.80 rows=1877028 width=36) (actual time=27952.336..47178.783 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Sort  (cost=10133318.52..10283278.14 rows=59983848 width=9) (actual time=27952.294..38124.621 rows=59965994 loops=1)
                           Sort Key: lineitem_1.l_partkey
                           Sort Method: external merge  Disk: 1115736kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1724981.48 rows=59983848 width=9) (actual time=0.304..9221.466 rows=59986052 loops=1)
               ->  Materialize  (cost=0.99..191693.58 rows=60883 width=21) (actual time=1.139..1904.029 rows=59951 loops=1)
                     ->  Nested Loop  (cost=0.99..191541.37 rows=60883 width=21) (actual time=1.136..1885.317 rows=59951 loops=1)
                           ->  Index Scan using part_pkey on part  (cost=0.43..89212.57 rows=2030 width=4) (actual time=0.793..632.281 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.09 rows=32 width=17) (actual time=0.383..0.619 rows=30 loops=1996)
                                 Index Cond: (l_partkey = part.p_partkey)
 Planning time: 16.918 ms
 Execution time: 49344.173 ms
(21 rows)

SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10827423.29..10827423.30 rows=1 width=32) (actual time=45461.995..45461.997 rows=1 loops=1)
   ->  Aggregate  (cost=10827423.29..10827423.30 rows=1 width=32) (actual time=45461.994..45461.995 rows=1 loops=1)
         ->  Merge Join  (cost=10133319.51..10827375.67 rows=19046 width=8) (actual time=25952.948..45461.036 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  GroupAggregate  (cost=10133318.52..10611352.80 rows=1877028 width=36) (actual time=25946.977..44933.291 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Sort  (cost=10133318.52..10283278.14 rows=59983848 width=9) (actual time=25946.956..35989.714 rows=59965994 loops=1)
                           Sort Key: lineitem_1.l_partkey
                           Sort Method: external merge  Disk: 1115736kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1724981.48 rows=59983848 width=9) (actual time=0.032..7315.964 rows=59986052 loops=1)
               ->  Materialize  (cost=0.99..191693.58 rows=60883 width=21) (actual time=0.141..422.044 rows=59951 loops=1)
                     ->  Nested Loop  (cost=0.99..191541.37 rows=60883 width=21) (actual time=0.138..412.749 rows=59951 loops=1)
                           ->  Index Scan using part_pkey on part  (cost=0.43..89212.57 rows=2030 width=4) (actual time=0.127..360.534 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.09 rows=32 width=17) (actual time=0.004..0.021 rows=30 loops=1996)
                                 Index Cond: (l_partkey = part.p_partkey)
 Planning time: 0.893 ms
 Execution time: 45608.720 ms
(21 rows)

query 18 run 1
SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=21566197.59..21566197.84 rows=100 width=71) (actual time=44638.201..44638.213 rows=99 loops=1)
   ->  Sort  (cost=21566197.59..21716126.02 rows=59971371 width=71) (actual time=44638.200..44638.206 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  GroupAggregate  (cost=17924779.06..19274134.91 rows=59971371 width=71) (actual time=44637.961..44638.130 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Sort  (cost=17924779.06..18074707.49 rows=59971371 width=44) (actual time=44637.943..44637.971 rows=693 loops=1)
                     Sort Key: customer.c_custkey, orders.o_orderkey
                     Sort Method: quicksort  Memory: 79kB
                     ->  Hash Join  (cost=78545.11..7805227.93 rows=59971371 width=44) (actual time=4579.012..44637.709 rows=693 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Merge Join  (cost=56.87..6740602.39 rows=59971371 width=25) (actual time=1058.535..43871.761 rows=693 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Merge Join  (cost=1.00..3681849.06 rows=14995962 width=24) (actual time=775.903..30163.603 rows=99 loops=1)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..547951.67 rows=14999082 width=20) (actual time=0.004..3189.441 rows=14982724 loops=1)
                                       ->  GroupAggregate  (cost=0.56..2758990.55 rows=14995962 width=4) (actual time=660.270..25923.686 rows=99 loops=1)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271621.78 rows=59983848 width=9) (actual time=0.003..12044.138 rows=59986052 loops=1)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2271621.78 rows=59983848 width=9) (actual time=0.010..9540.720 rows=59916431 loops=1)
                           ->  Hash  (cost=50947.55..50947.55 rows=1500055 width=23) (actual time=661.369..661.369 rows=1500000 loops=1)
                                 Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                 ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=23) (actual time=0.010..418.872 rows=1500000 loops=1)
 Planning time: 22.110 ms
 Execution time: 44639.071 ms
(27 rows)

SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=21566197.59..21566197.84 rows=100 width=71) (actual time=41224.753..41224.766 rows=99 loops=1)
   ->  Sort  (cost=21566197.59..21716126.02 rows=59971371 width=71) (actual time=41224.752..41224.759 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  GroupAggregate  (cost=17924779.06..19274134.91 rows=59971371 width=71) (actual time=41224.513..41224.682 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Sort  (cost=17924779.06..18074707.49 rows=59971371 width=44) (actual time=41224.495..41224.523 rows=693 loops=1)
                     Sort Key: customer.c_custkey, orders.o_orderkey
                     Sort Method: quicksort  Memory: 79kB
                     ->  Hash Join  (cost=78545.11..7805227.93 rows=59971371 width=44) (actual time=3974.808..41224.280 rows=693 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Merge Join  (cost=56.87..6740602.39 rows=59971371 width=25) (actual time=925.522..40589.127 rows=693 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Merge Join  (cost=1.00..3681849.06 rows=14995962 width=24) (actual time=635.289..26785.278 rows=99 loops=1)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..547951.67 rows=14999082 width=20) (actual time=0.004..2609.549 rows=14982724 loops=1)
                                       ->  GroupAggregate  (cost=0.56..2758990.55 rows=14995962 width=4) (actual time=547.530..23158.162 rows=99 loops=1)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271621.78 rows=59983848 width=9) (actual time=0.004..9648.695 rows=59986052 loops=1)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2271621.78 rows=59983848 width=9) (actual time=0.010..9635.016 rows=59916431 loops=1)
                           ->  Hash  (cost=50947.55..50947.55 rows=1500055 width=23) (actual time=529.991..529.991 rows=1500000 loops=1)
                                 Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                 ->  Seq Scan on customer  (cost=0.00..50947.55 rows=1500055 width=23) (actual time=0.011..294.265 rows=1500000 loops=1)
 Planning time: 1.755 ms
 Execution time: 41224.877 ms
(27 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=375409.60..375409.61 rows=1 width=32) (actual time=23777.994..23777.996 rows=1 loops=1)
   ->  Aggregate  (cost=375409.60..375409.61 rows=1 width=32) (actual time=23777.993..23777.994 rows=1 loops=1)
         ->  Nested Loop  (cost=0.56..375401.06 rows=1138 width=12) (actual time=61.902..23774.607 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125981.30 rows=4784 width=30) (actual time=0.785..798.224 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..52.13 rows=1 width=21) (actual time=4.337..4.804 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning time: 17.971 ms
 Execution time: 23778.685 ms
(12 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=375409.60..375409.61 rows=1 width=32) (actual time=580.651..580.652 rows=1 loops=1)
   ->  Aggregate  (cost=375409.60..375409.61 rows=1 width=32) (actual time=580.650..580.650 rows=1 loops=1)
         ->  Nested Loop  (cost=0.56..375401.06 rows=1138 width=12) (actual time=1.410..579.855 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125981.30 rows=4784 width=30) (actual time=0.195..420.924 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..52.13 rows=1 width=21) (actual time=0.030..0.033 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning time: 0.902 ms
 Execution time: 580.696 ms
(12 rows)

query 20 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2990402.08..2990402.09 rows=1 width=51) (actual time=52688.002..52688.006 rows=1 loops=1)
   ->  Sort  (cost=2990402.08..2990402.09 rows=1 width=51) (actual time=52688.001..52688.004 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2579947.74..2990402.07 rows=1 width=51) (actual time=28063.283..52686.264 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=55) (actual time=0.362..23.532 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.008 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=59) (actual time=0.352..15.952 rows=100000 loops=1)
               ->  Materialize  (cost=2579947.74..2985749.77 rows=3 width=8) (actual time=6.371..10.417 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2579947.74..2985749.75 rows=3 width=8) (actual time=26089.743..36587.915 rows=59002 loops=1)
                           Merge Cond: (lineitem.l_partkey = partsupp.ps_partkey)
                           Join Filter: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity)))))
                           Rows Removed by Join Filter: 177498
                           ->  GroupAggregate  (cost=2579946.88..2745236.28 rows=4869138 width=40) (actual time=26089.029..31591.415 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2579946.88..2603009.96 rows=9225233 width=13) (actual time=26089.016..27748.636 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205344kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=147843.70..1411365.20 rows=9225233 width=13) (actual time=1234.288..22570.339 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 23164080
                                             Heap Blocks: exact=518099 lossy=530696
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145537.40 rows=9225233 width=0) (actual time=1129.200..1129.200 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Materialize  (cost=0.86..160339.46 rows=80823 width=16) (actual time=0.338..4636.583 rows=237286 loops=1)
                                 ->  Nested Loop  (cost=0.86..160137.40 rows=80823 width=16) (actual time=0.335..4596.386 rows=86872 loops=1)
                                       ->  Index Scan using part_pkey on part  (cost=0.43..84212.55 rows=20202 width=4) (actual time=0.102..457.502 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.58 rows=18 width=12) (actual time=0.175..0.189 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 21.406 ms
 Execution time: 52712.030 ms
(39 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2990402.08..2990402.09 rows=1 width=51) (actual time=34369.138..34369.141 rows=1 loops=1)
   ->  Sort  (cost=2990402.08..2990402.09 rows=1 width=51) (actual time=34369.137..34369.140 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2579947.74..2990402.07 rows=1 width=51) (actual time=13599.189..34367.432 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=55) (actual time=0.016..19.824 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.008 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=59) (actual time=0.008..12.198 rows=100000 loops=1)
               ->  Materialize  (cost=2579947.74..2985749.77 rows=3 width=8) (actual time=3.057..5.946 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2579947.74..2985749.75 rows=3 width=8) (actual time=12516.973..18281.401 rows=59002 loops=1)
                           Merge Cond: (lineitem.l_partkey = partsupp.ps_partkey)
                           Join Filter: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity)))))
                           Rows Removed by Join Filter: 177498
                           ->  GroupAggregate  (cost=2579946.88..2745236.28 rows=4869138 width=40) (actual time=12516.582..17436.778 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2579946.88..2603009.96 rows=9225233 width=13) (actual time=12516.569..14009.388 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205344kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=147843.70..1411365.20 rows=9225233 width=13) (actual time=1089.211..9300.807 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 23164080
                                             Heap Blocks: exact=518099 lossy=530696
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145537.40 rows=9225233 width=0) (actual time=984.698..984.698 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Materialize  (cost=0.86..160339.46 rows=80823 width=16) (actual time=0.075..552.722 rows=237286 loops=1)
                                 ->  Nested Loop  (cost=0.86..160137.40 rows=80823 width=16) (actual time=0.073..530.981 rows=86872 loops=1)
                                       ->  Index Scan using part_pkey on part  (cost=0.43..84212.55 rows=20202 width=4) (actual time=0.050..356.484 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.58 rows=18 width=12) (actual time=0.006..0.007 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 1.849 ms
 Execution time: 34396.322 ms
(39 rows)

query 21 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3991645.84..3991645.85 rows=1 width=34) (actual time=31748.730..31748.743 rows=100 loops=1)
   ->  Sort  (cost=3991645.84..3991645.85 rows=1 width=34) (actual time=31748.729..31748.736 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=3991645.81..3991645.83 rows=1 width=34) (actual time=31741.684..31747.570 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=3991645.81..3991645.82 rows=1 width=26) (actual time=31741.676..31743.118 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=570774.54..3991645.80 rows=1 width=26) (actual time=3313.559..31575.046 rows=39281 loops=1)
                           ->  Nested Loop Semi Join  (cost=570773.97..3991642.15 rows=1 width=34) (actual time=3297.354..29973.517 rows=704306 loops=1)
                                 Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Join Filter: 183320
                                 ->  Hash Join  (cost=570773.41..2571654.47 rows=386699 width=38) (actual time=3294.112..20152.320 rows=730985 loops=1)
                                       Hash Cond: (l1.l_orderkey = orders.o_orderkey)
                                       ->  Hash Join  (cost=2323.46..1960194.59 rows=795022 width=34) (actual time=40.574..15427.521 rows=1514267 loops=1)
                                             Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                             ->  Seq Scan on lineitem l1  (cost=0.00..1874941.10 rows=19994616 width=8) (actual time=0.011..12011.175 rows=37929348 loops=1)
                                                   Filter: (l_receiptdate > l_commitdate)
                                                   Rows Removed by Filter: 22056704
                                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=40.499..40.500 rows=3991 loops=1)
                                                   Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=1.879..39.438 rows=3991 loops=1)
                                                         ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.007 rows=1 loops=1)
                                                               Filter: (n_name = 'PERU'::bpchar)
                                                               Rows Removed by Filter: 24
                                                         ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=1.873..38.657 rows=3991 loops=1)
                                                               Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                               Heap Blocks: exact=1865
                                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=1.688..1.688 rows=3991 loops=1)
                                                                     Index Cond: (s_nationkey = nation.n_nationkey)
                                       ->  Hash  (cost=448756.53..448756.53 rows=7295554 width=4) (actual time=3248.586..3248.586 rows=7309184 loops=1)
                                             Buckets: 1048576  Batches: 16  Memory Usage: 24248kB
                                             ->  Seq Scan on orders  (cost=0.00..448756.53 rows=7295554 width=4) (actual time=0.013..2374.924 rows=7309184 loops=1)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 7690816
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.013..0.013 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 22.077 ms
 Execution time: 31749.441 ms
(44 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3991645.84..3991645.85 rows=1 width=34) (actual time=22995.085..22995.099 rows=100 loops=1)
   ->  Sort  (cost=3991645.84..3991645.85 rows=1 width=34) (actual time=22995.084..22995.092 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=3991645.81..3991645.83 rows=1 width=34) (actual time=22987.967..22993.924 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=3991645.81..3991645.82 rows=1 width=26) (actual time=22987.959..22989.438 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=570774.54..3991645.80 rows=1 width=26) (actual time=2768.220..22823.090 rows=39281 loops=1)
                           ->  Nested Loop Semi Join  (cost=570773.97..3991642.15 rows=1 width=34) (actual time=2755.997..21341.166 rows=704306 loops=1)
                                 Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Join Filter: 183320
                                 ->  Hash Join  (cost=570773.41..2571654.47 rows=386699 width=38) (actual time=2755.975..17069.658 rows=730985 loops=1)
                                       Hash Cond: (l1.l_orderkey = orders.o_orderkey)
                                       ->  Hash Join  (cost=2323.46..1960194.59 rows=795022 width=34) (actual time=15.074..12919.280 rows=1514267 loops=1)
                                             Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                             ->  Seq Scan on lineitem l1  (cost=0.00..1874941.10 rows=19994616 width=8) (actual time=0.009..10001.471 rows=37929348 loops=1)
                                                   Filter: (l_receiptdate > l_commitdate)
                                                   Rows Removed by Filter: 22056704
                                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=15.030..15.031 rows=3991 loops=1)
                                                   Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=0.622..14.209 rows=3991 loops=1)
                                                         ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.003..0.006 rows=1 loops=1)
                                                               Filter: (n_name = 'PERU'::bpchar)
                                                               Rows Removed by Filter: 24
                                                         ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=0.616..13.606 rows=3991 loops=1)
                                                               Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                               Heap Blocks: exact=1865
                                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.412..0.412 rows=3991 loops=1)
                                                                     Index Cond: (s_nationkey = nation.n_nationkey)
                                       ->  Hash  (cost=448756.53..448756.53 rows=7295554 width=4) (actual time=2737.511..2737.512 rows=7309184 loops=1)
                                             Buckets: 1048576  Batches: 16  Memory Usage: 24248kB
                                             ->  Seq Scan on orders  (cost=0.00..448756.53 rows=7295554 width=4) (actual time=0.012..1899.505 rows=7309184 loops=1)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 7690816
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.005..0.005 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 2.256 ms
 Execution time: 22995.239 ms
(44 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161737.29..161737.32 rows=1 width=72) (actual time=2249.051..2249.053 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75442.83..75442.84 rows=1 width=32) (actual time=980.669..980.669 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75323.44 rows=47754 width=6) (actual time=0.841..938.107 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86294.45..86498.06 rows=7404 width=72) (actual time=2249.050..2249.051 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86294.45..86312.96 rows=7404 width=38) (actual time=2247.291..2247.623 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85818.59 rows=7404 width=38) (actual time=980.716..2225.802 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75323.44 rows=17501 width=26) (actual time=980.692..1520.270 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.003..0.003 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 16.415 ms
 Execution time: 2249.693 ms
(20 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161737.29..161737.32 rows=1 width=72) (actual time=1595.118..1595.120 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75442.83..75442.84 rows=1 width=32) (actual time=711.769..711.770 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75323.44 rows=47754 width=6) (actual time=0.012..674.428 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86294.45..86498.06 rows=7404 width=72) (actual time=1595.117..1595.118 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86294.45..86312.96 rows=7404 width=38) (actual time=1593.353..1593.682 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85818.59 rows=7404 width=38) (actual time=711.804..1575.366 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75323.44 rows=17501 width=26) (actual time=711.791..1211.670 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.002..0.002 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 0.586 ms
 Execution time: 1595.166 ms
(20 rows)

