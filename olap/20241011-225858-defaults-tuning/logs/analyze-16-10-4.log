query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832004.27..1832004.90 rows=1 width=236) (actual time=19820.866..19823.698 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832004.27..1832008.08 rows=6 width=236) (actual time=19820.864..19823.696 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832004.27..1832007.14 rows=24 width=236) (actual time=19820.841..19823.675 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831004.21..1831004.22 rows=6 width=236) (actual time=19812.269..19812.270 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1831003.99..1831004.13 rows=6 width=236) (actual time=19812.233..19812.239 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312586.90 rows=14811917 width=25) (actual time=1.208..4311.152 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 14.022 ms
 Execution Time: 19824.046 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832004.27..1832004.90 rows=1 width=236) (actual time=19094.576..19094.656 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832004.27..1832008.08 rows=6 width=236) (actual time=19094.575..19094.655 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832004.27..1832007.14 rows=24 width=236) (actual time=19094.542..19094.629 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831004.21..1831004.22 rows=6 width=236) (actual time=19090.134..19090.135 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1831003.99..1831004.13 rows=6 width=236) (actual time=19090.104..19090.109 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312586.90 rows=14811917 width=25) (actual time=0.027..2681.267 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.814 ms
 Execution Time: 19094.728 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1032118.29..1032118.29 rows=1 width=192) (actual time=4243.523..4243.641 rows=100 loops=1)
   ->  Sort  (cost=1032118.29..1032118.29 rows=1 width=192) (actual time=4243.521..4243.633 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=554147.46..1032118.28 rows=1 width=192) (actual time=3219.581..4240.718 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68624.00 rows=7651 width=30) (actual time=65.704..68.922 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.64 rows=1913 width=30) (actual time=2.026..290.961 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=553146.97..561006.84 rows=1571974 width=172) (actual time=3152.708..3631.009 rows=1603828 loops=1)
                     ->  Sort  (cost=553146.97..557076.91 rows=1571974 width=172) (actual time=3152.703..3441.807 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293488kB
                           ->  Hash Join  (cost=4048.51..305005.51 rows=1571974 width=172) (actual time=81.573..2515.663 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255233.10 rows=8001110 width=14) (actual time=2.417..1090.530 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=79.115..79.117 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=22.338..72.584 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=10.388..48.211 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=11.934..11.936 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=11.927..11.933 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=6.505..6.506 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=5.394..5.395 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=5.387..5.388 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.056..0.056 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.046..0.054 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.041..0.052 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.040..0.050 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.037..0.038 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.006 rows=25 loops=1)
 Planning Time: 22.661 ms
 Execution Time: 4281.229 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1032118.29..1032118.29 rows=1 width=192) (actual time=3452.614..3452.846 rows=100 loops=1)
   ->  Sort  (cost=1032118.29..1032118.29 rows=1 width=192) (actual time=3452.613..3452.839 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=554147.46..1032118.28 rows=1 width=192) (actual time=2698.708..3450.452 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68624.00 rows=7651 width=30) (actual time=27.325..29.700 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.64 rows=1913 width=30) (actual time=0.166..118.471 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=553146.97..561006.84 rows=1571974 width=172) (actual time=2671.286..3139.288 rows=1603828 loops=1)
                     ->  Sort  (cost=553146.97..557076.91 rows=1571974 width=172) (actual time=2671.281..2950.735 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293488kB
                           ->  Hash Join  (cost=4048.51..305005.51 rows=1571974 width=172) (actual time=51.695..2051.535 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255233.10 rows=8001110 width=14) (actual time=0.034..769.473 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=51.634..51.637 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.048..37.314 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.012..14.566 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.032..0.034 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.027..0.032 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.009..0.011 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.016..0.016 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.009..0.015 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 2.159 ms
 Execution Time: 3490.363 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2241083.08..2241083.11 rows=10 width=44) (actual time=10411.661..10442.712 rows=10 loops=1)
   ->  Sort  (cost=2241083.08..2248748.07 rows=3065996 width=44) (actual time=10411.660..10442.710 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1723407.19..2174828.01 rows=3065996 width=44) (actual time=10196.155..10421.257 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1723407.19..2090513.12 rows=3065996 width=24) (actual time=10196.143..10267.788 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1722407.14..1724323.38 rows=766499 width=24) (actual time=10183.863..10186.651 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4729kB
                           Worker 0:  Sort Method: quicksort  Memory: 4631kB
                           Worker 1:  Sort Method: quicksort  Memory: 4765kB
                           Worker 2:  Sort Method: quicksort  Memory: 4682kB
                           Worker 3:  Sort Method: quicksort  Memory: 4781kB
                           ->  Nested Loop  (cost=41552.07..1637382.81 rows=766499 width=24) (actual time=273.421..10164.551 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41551.51..354433.30 rows=353176 width=12) (actual time=271.919..2094.395 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308142.88 rows=1805294 width=16) (actual time=0.529..1378.629 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.48..40634.48 rows=73362 width=4) (actual time=270.610..270.611 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.48 rows=73362 width=4) (actual time=0.560..253.723 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.027..0.027 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 21.062 ms
 Execution Time: 10443.145 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2241083.08..2241083.11 rows=10 width=44) (actual time=3746.327..3775.433 rows=10 loops=1)
   ->  Sort  (cost=2241083.08..2248748.07 rows=3065996 width=44) (actual time=3746.325..3775.429 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1723407.19..2174828.01 rows=3065996 width=44) (actual time=3525.972..3753.986 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1723407.19..2090513.12 rows=3065996 width=24) (actual time=3525.959..3600.057 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1722407.14..1724323.38 rows=766499 width=24) (actual time=3519.008..3521.795 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4583kB
                           Worker 0:  Sort Method: quicksort  Memory: 4657kB
                           Worker 1:  Sort Method: quicksort  Memory: 4790kB
                           Worker 2:  Sort Method: quicksort  Memory: 4710kB
                           Worker 3:  Sort Method: quicksort  Memory: 4848kB
                           ->  Nested Loop  (cost=41552.07..1637382.81 rows=766499 width=24) (actual time=121.314..3496.990 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41551.51..354433.30 rows=353176 width=12) (actual time=121.135..1224.463 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308142.88 rows=1805294 width=16) (actual time=0.042..577.102 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.48..40634.48 rows=73362 width=4) (actual time=119.590..119.591 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.48 rows=73362 width=4) (actual time=0.026..94.696 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.007..0.007 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.562 ms
 Execution Time: 3775.513 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283173.40..660423.87 rows=1 width=24) (actual time=30682.740..30702.437 rows=1 loops=1)
   ->  GroupAggregate  (cost=283173.40..2169425.76 rows=5 width=24) (actual time=30682.739..30702.435 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283173.40..2166577.37 rows=569668 width=16) (actual time=6354.999..30619.644 rows=103030 loops=1)
               ->  Gather Merge  (cost=283172.83..351402.06 rows=569837 width=20) (actual time=6353.901..6482.877 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282172.78..282528.92 rows=142459 width=20) (actual time=6338.400..6341.352 rows=23414 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 8316kB
                           Worker 0:  Sort Method: quicksort  Memory: 8291kB
                           Worker 1:  Sort Method: quicksort  Memory: 8343kB
                           Worker 2:  Sort Method: quicksort  Memory: 8320kB
                           Worker 3:  Sort Method: quicksort  Memory: 8363kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6573.26..269978.15 rows=142459 width=20) (actual time=129.899..6290.524 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46312
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6430.81 rows=569837 width=0) (actual time=87.125..87.125 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.214..0.214 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 18.163 ms
 Execution Time: 30704.405 ms
(25 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283173.40..660423.87 rows=1 width=24) (actual time=1671.231..1689.224 rows=1 loops=1)
   ->  GroupAggregate  (cost=283173.40..2169425.76 rows=5 width=24) (actual time=1671.230..1689.222 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283173.40..2166577.37 rows=569668 width=16) (actual time=707.630..1667.555 rows=103030 loops=1)
               ->  Gather Merge  (cost=283172.83..351402.06 rows=569837 width=20) (actual time=707.576..760.089 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282172.78..282528.92 rows=142459 width=20) (actual time=698.581..700.751 rows=23405 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 8086kB
                           Worker 0:  Sort Method: quicksort  Memory: 8410kB
                           Worker 1:  Sort Method: quicksort  Memory: 8308kB
                           Worker 2:  Sort Method: quicksort  Memory: 8457kB
                           Worker 3:  Sort Method: quicksort  Memory: 8371kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6573.26..269978.15 rows=142459 width=20) (actual time=127.813..663.922 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=44407
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6430.81 rows=569837 width=0) (actual time=81.761..81.761 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.081 ms
 Execution Time: 1689.301 ms
(25 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=764138.88..764138.89 rows=1 width=58) (actual time=22545.953..22589.736 rows=1 loops=1)
   ->  Sort  (cost=764138.88..764138.95 rows=25 width=58) (actual time=22545.951..22589.734 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=763898.10..764138.76 rows=25 width=58) (actual time=22541.687..22589.718 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=763898.10..764137.70 rows=100 width=58) (actual time=22540.267..22589.688 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=762898.04..763125.73 rows=25 width=58) (actual time=22520.757..22526.196 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=762898.04..762943.52 rows=18190 width=38) (actual time=22519.433..22520.095 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1292kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1286kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1291kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1275kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1280kB
                                 ->  Parallel Hash Join  (cost=72718.38..761611.02 rows=18190 width=38) (actual time=555.741..22505.969 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69026.78..755531.76 rows=454793 width=50) (actual time=534.570..22334.590 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69026.22..341240.91 rows=113732 width=38) (actual time=534.236..3879.333 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26232.97..296030.87 rows=568660 width=8) (actual time=258.867..3370.421 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52304
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25664.32 rows=2274638 width=0) (actual time=202.185..202.186 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.74..41855.74 rows=75000 width=38) (actual time=274.733..274.736 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.74 rows=75000 width=38) (actual time=0.996..245.786 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.99 rows=374999 width=8) (actual time=0.479..208.677 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.506..0.508 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.497..0.506 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.230..0.234 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.259..0.260 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.254..0.256 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.191..0.202 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=17.984..17.985 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.116..9.516 rows=20000 loops=5)
 Planning Time: 23.924 ms
 Execution Time: 22590.389 ms
(50 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=764138.88..764138.89 rows=1 width=58) (actual time=2509.812..2551.150 rows=1 loops=1)
   ->  Sort  (cost=764138.88..764138.95 rows=25 width=58) (actual time=2509.810..2551.147 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=763898.10..764138.76 rows=25 width=58) (actual time=2505.692..2551.132 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=763898.10..764137.70 rows=100 width=58) (actual time=2504.187..2551.101 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=762898.04..763125.73 rows=25 width=58) (actual time=2488.475..2494.022 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=762898.04..762943.52 rows=18190 width=38) (actual time=2486.358..2487.050 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1273kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1318kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1331kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1295kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1207kB
                                 ->  Parallel Hash Join  (cost=72718.38..761611.02 rows=18190 width=38) (actual time=409.190..2477.649 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69026.78..755531.76 rows=454793 width=50) (actual time=393.622..2349.792 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69026.22..341240.91 rows=113732 width=38) (actual time=393.582..958.946 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26232.97..296030.87 rows=568660 width=8) (actual time=247.198..638.111 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=51066
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25664.32 rows=2274638 width=0) (actual time=191.102..191.102 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.74..41855.74 rows=75000 width=38) (actual time=145.826..145.829 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.74 rows=75000 width=38) (actual time=0.076..111.385 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.99 rows=374999 width=8) (actual time=0.029..67.840 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.037..0.039 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.031..0.037 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.013..0.015 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.010..0.011 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.013..0.014 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=14.850..14.851 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.022..6.719 rows=20000 loops=5)
 Planning Time: 4.658 ms
 Execution Time: 2551.483 ms
(50 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1292768.15..1292768.16 rows=1 width=32) (actual time=17267.843..17302.712 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1292768.15..1292768.16 rows=1 width=32) (actual time=17267.842..17302.710 rows=1 loops=1)
         ->  Gather  (cost=1292767.72..1292768.13 rows=4 width=32) (actual time=17265.706..17302.696 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1291767.72..1291767.73 rows=1 width=32) (actual time=17257.290..17257.291 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=214388.95..1290263.01 rows=300941 width=12) (actual time=1333.188..17104.240 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79410 lossy=53948
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..214088.01 rows=1203763 width=0) (actual time=1247.369..1247.369 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 12.324 ms
 Execution Time: 17303.930 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1292768.15..1292768.16 rows=1 width=32) (actual time=3106.573..3144.875 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1292768.15..1292768.16 rows=1 width=32) (actual time=3106.571..3144.872 rows=1 loops=1)
         ->  Gather  (cost=1292767.72..1292768.13 rows=4 width=32) (actual time=3106.559..3144.863 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1291767.72..1291767.73 rows=1 width=32) (actual time=3100.649..3100.650 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=214388.95..1290263.01 rows=300941 width=12) (actual time=1208.269..3001.440 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79070 lossy=53047
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..214088.01 rows=1203763 width=0) (actual time=1119.556..1119.556 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.649 ms
 Execution Time: 3144.934 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419426.30..1420476.10 rows=1 width=116) (actual time=32400.427..32405.746 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419426.30..11967847.01 rows=10048 width=116) (actual time=32400.426..32405.744 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419426.30..11966787.25 rows=60603 width=96) (actual time=7298.842..32373.976 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349072
               ->  Nested Loop  (cost=1419425.87..6780842.33 rows=1515085 width=76) (actual time=7294.698..26547.906 rows=363493 loops=1)
                     ->  Gather Merge  (cost=1419425.44..1600833.60 rows=1515085 width=76) (actual time=7293.411..7770.425 rows=363493 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418425.38..1419372.31 rows=378771 width=76) (actual time=7274.029..7318.492 rows=73102 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 27096kB
                                 Worker 0:  Sort Method: external merge  Disk: 26464kB
                                 Worker 1:  Sort Method: external merge  Disk: 26760kB
                                 Worker 2:  Sort Method: external merge  Disk: 27224kB
                                 Worker 3:  Sort Method: external merge  Disk: 26400kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372510.17 rows=378771 width=76) (actual time=16.665..6990.090 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350075.68 rows=4550790 width=24) (actual time=0.464..6399.126 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=15.835..15.839 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.357..14.606 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.275..12.189 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.071..0.074 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.065..0.070 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.055..0.056 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.003..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.006 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.051..0.051 rows=1 loops=363493)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.015..0.015 rows=1 loops=363493)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 25.438 ms
 Execution Time: 32409.641 ms
(45 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419426.30..1420476.10 rows=1 width=116) (actual time=5689.339..5695.014 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419426.30..11967847.01 rows=10048 width=116) (actual time=5689.338..5695.012 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419426.30..11966787.25 rows=60603 width=96) (actual time=3548.843..5681.506 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349054
               ->  Nested Loop  (cost=1419425.87..6780842.33 rows=1515085 width=76) (actual time=3548.250..4705.692 rows=363475 loops=1)
                     ->  Gather Merge  (cost=1419425.44..1600833.60 rows=1515085 width=76) (actual time=3548.198..3762.862 rows=363475 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418425.38..1419372.31 rows=378771 width=76) (actual time=3535.403..3564.947 rows=73100 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 27160kB
                                 Worker 0:  Sort Method: external merge  Disk: 26968kB
                                 Worker 1:  Sort Method: external merge  Disk: 26456kB
                                 Worker 2:  Sort Method: external merge  Disk: 27088kB
                                 Worker 3:  Sort Method: external merge  Disk: 26272kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372510.17 rows=378771 width=76) (actual time=13.764..3179.684 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350075.68 rows=4550790 width=24) (actual time=0.045..2542.578 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=11.567..11.569 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.061..9.870 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.028..6.306 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.027..0.029 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.021..0.027 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.012 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.003..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.006 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363475)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363475)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.511 ms
 Execution Time: 5698.910 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386264.05..392030.56 rows=1 width=64) (actual time=34024.152..34029.431 rows=1 loops=1)
   ->  GroupAggregate  (cost=386264.05..14260497.27 rows=2406 width=64) (actual time=34024.151..34029.429 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386264.05..14259966.25 rows=24145 width=70) (actual time=2311.457..34003.930 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142647
               ->  Nested Loop  (cost=386264.05..14251184.58 rows=24145 width=20) (actual time=2311.434..33963.202 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386263.76..14172197.19 rows=24145 width=20) (actual time=2311.000..33425.302 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386263.32..3794778.24 rows=3621871 width=24) (actual time=2241.381..23422.098 rows=1816498 loops=1)
                                 ->  Gather Merge  (cost=386262.75..494710.73 rows=905736 width=8) (actual time=2240.161..2521.235 rows=454505 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385262.70..385828.78 rows=226434 width=8) (actual time=2224.787..2232.591 rows=92112 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 13262kB
                                             Worker 0:  Sort Method: quicksort  Memory: 13306kB
                                             Worker 1:  Sort Method: quicksort  Memory: 13205kB
                                             Worker 2:  Sort Method: quicksort  Memory: 13260kB
                                             Worker 3:  Sort Method: quicksort  Memory: 13249kB
                                             ->  Parallel Hash Join  (cost=42793.24..365122.83 rows=226434 width=8) (actual time=278.627..2178.266 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317517.86 rows=1132170 width=12) (actual time=0.473..1633.659 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.74..41855.74 rows=75000 width=4) (actual time=277.448..277.451 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.74 rows=75000 width=4) (actual time=0.501..259.655 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.99 rows=374999 width=8) (actual time=0.390..224.006 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.104..0.106 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.099..0.104 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.041..0.043 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.053..0.054 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.048..0.049 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.042..0.045 rows=4 loops=454505)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.005..0.005 rows=0 loops=1816498)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597238  Misses: 1219260  Evictions: 235713  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.007..0.007 rows=0 loops=1219260)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.045..0.045 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.007..0.011 rows=25 loops=1)
 Planning Time: 30.641 ms
 Execution Time: 34034.069 ms
(55 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386264.05..392030.56 rows=1 width=64) (actual time=8508.313..8514.485 rows=1 loops=1)
   ->  GroupAggregate  (cost=386264.05..14260497.27 rows=2406 width=64) (actual time=8508.312..8514.483 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386264.05..14259966.25 rows=24145 width=70) (actual time=1034.037..8501.281 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142658
               ->  Nested Loop  (cost=386264.05..14251184.58 rows=24145 width=20) (actual time=1034.021..8476.027 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386263.76..14172197.19 rows=24145 width=20) (actual time=1034.010..8434.181 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386263.32..3794778.24 rows=3621871 width=24) (actual time=1032.185..4010.065 rows=1816419 loops=1)
                                 ->  Gather Merge  (cost=386262.75..494710.73 rows=905736 width=8) (actual time=1032.093..1225.759 rows=454484 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385262.70..385828.78 rows=226434 width=8) (actual time=1020.750..1027.341 rows=92050 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 13492kB
                                             Worker 0:  Sort Method: quicksort  Memory: 12872kB
                                             Worker 1:  Sort Method: quicksort  Memory: 14129kB
                                             Worker 2:  Sort Method: quicksort  Memory: 12127kB
                                             Worker 3:  Sort Method: quicksort  Memory: 13664kB
                                             ->  Parallel Hash Join  (cost=42793.24..365122.83 rows=226434 width=8) (actual time=142.319..969.257 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317517.86 rows=1132170 width=12) (actual time=0.044..525.471 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.74..41855.74 rows=75000 width=4) (actual time=140.890..140.893 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                                         ->  Hash Join  (cost=2.51..41855.74 rows=75000 width=4) (actual time=0.068..116.586 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.99 rows=374999 width=8) (actual time=0.027..72.053 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.036..0.038 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.031..0.036 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.006..0.008 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.020..0.021 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.017..0.018 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.005 rows=4 loops=454484)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=1816419)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597384  Misses: 1219035  Evictions: 235515  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1219035)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.005..0.010 rows=25 loops=1)
 Planning Time: 5.609 ms
 Execution Time: 8518.907 ms
(55 rows)

query 9 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=42472.49..47688.92 rows=1 width=90) (actual time=1795220.114..1795221.326 rows=1 loops=1)
   ->  GroupAggregate  (cost=42472.49..830152.94 rows=151 width=90) (actual time=1795220.113..1795221.324 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=42472.49..830148.03 rows=151 width=81) (actual time=1795211.197..1795213.280 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 13853kB  Peak Memory: 13853kB
               ->  Nested Loop  (cost=9652.78..830143.68 rows=151 width=81) (actual time=20609.906..1795112.170 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778596889
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=52.393..60.821 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=45.379..46.108 rows=2552 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4529kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4013kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.392..22.558 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.243..13.501 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.091..0.092 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.080..0.083 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..583595.15 rows=151 width=35) (actual time=0.002..240.491 rows=3247452 loops=3935)
                           ->  Gather  (cost=1001.31..583594.40 rows=151 width=35) (actual time=3.005..38294.894 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..582579.30 rows=38 width=35) (actual time=2.098..39107.708 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..582449.24 rows=38 width=35) (actual time=1.463..28158.955 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..165332.02 rows=121229 width=18) (actual time=0.891..1116.105 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47231.07 rows=30304 width=4) (actual time=0.422..192.558 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.038..0.041 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.045..0.310 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.016..0.016 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 32.147 ms
 Execution Time: 1795241.848 ms
(42 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=42472.49..47688.92 rows=1 width=90) (actual time=1779628.883..1779630.377 rows=1 loops=1)
   ->  GroupAggregate  (cost=42472.49..830152.94 rows=151 width=90) (actual time=1779628.882..1779630.375 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=42472.49..830148.03 rows=151 width=81) (actual time=1779619.933..1779622.316 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 13853kB  Peak Memory: 13853kB
               ->  Nested Loop  (cost=9652.78..830143.68 rows=151 width=81) (actual time=2987.211..1779520.457 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12779414610
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=54.666..63.138 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=49.550..50.286 rows=2414 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4556kB
                                 Worker 0:  Sort Method: quicksort  Memory: 3986kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.346..27.186 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.168..17.855 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.090..0.091 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.080..0.082 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..583595.15 rows=151 width=35) (actual time=0.002..236.301 rows=3247660 loops=3935)
                           ->  Gather  (cost=1001.31..583594.40 rows=151 width=35) (actual time=1.791..16184.846 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..582579.30 rows=38 width=35) (actual time=1.837..16970.962 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..582449.24 rows=38 width=35) (actual time=1.785..11217.905 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..165332.02 rows=121229 width=18) (actual time=1.316..689.547 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47231.07 rows=30304 width=4) (actual time=0.316..169.895 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.020..0.022 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.019..0.119 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 18.307 ms
 Execution Time: 1779650.944 ms
(42 rows)

query 10 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=962653.80..962653.85 rows=20 width=202) (actual time=21969.281..22025.303 rows=20 loops=1)
   ->  Sort  (cost=962653.80..964106.21 rows=580964 width=202) (actual time=21969.279..22025.299 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=863108.94..947194.56 rows=580964 width=202) (actual time=20887.250..21900.548 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=863108.94..932670.46 rows=580964 width=182) (actual time=20887.230..21163.929 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=862108.88..862471.98 rows=145241 width=182) (actual time=20874.158..20900.236 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 48000kB
                           Worker 0:  Sort Method: external merge  Disk: 37832kB
                           Worker 1:  Sort Method: external merge  Disk: 31960kB
                           Worker 2:  Sort Method: external merge  Disk: 51160kB
                           Worker 3:  Sort Method: external merge  Disk: 49576kB
                           ->  Hash Join  (cost=806337.38..849655.85 rows=145241 width=182) (actual time=20411.699..20733.174 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=806335.82..849208.40 rows=145241 width=160) (actual time=20411.574..20689.332 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.99 rows=374999 width=148) (actual time=0.429..117.652 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=804520.31..804520.31 rows=145241 width=16) (actual time=20409.953..20409.954 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6804.63..804520.31 rows=145241 width=16) (actual time=135.909..20245.189 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6804.06..270284.06 rows=147466 width=8) (actual time=135.346..4679.324 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46619
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6656.60 rows=589866 width=0) (actual time=87.173..87.173 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.130..0.135 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.046..0.046 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.038..0.041 rows=25 loops=5)
 Planning Time: 21.982 ms
 Execution Time: 22032.459 ms
(38 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=962653.80..962653.85 rows=20 width=202) (actual time=3592.214..3645.451 rows=20 loops=1)
   ->  Sort  (cost=962653.80..964106.21 rows=580964 width=202) (actual time=3592.212..3645.447 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=863108.94..947194.56 rows=580964 width=202) (actual time=2527.295..3521.248 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=863108.94..932670.46 rows=580964 width=182) (actual time=2527.276..2792.938 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=862108.88..862471.98 rows=145241 width=182) (actual time=2511.695..2536.948 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 37928kB
                           Worker 0:  Sort Method: external merge  Disk: 46808kB
                           Worker 1:  Sort Method: external merge  Disk: 44248kB
                           Worker 2:  Sort Method: external merge  Disk: 42944kB
                           Worker 3:  Sort Method: external merge  Disk: 46592kB
                           ->  Hash Join  (cost=806337.38..849655.85 rows=145241 width=182) (actual time=2102.455..2368.159 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=806335.82..849208.40 rows=145241 width=160) (actual time=2102.359..2319.200 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.99 rows=374999 width=148) (actual time=0.030..60.631 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=804520.31..804520.31 rows=145241 width=16) (actual time=2100.343..2100.345 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6804.63..804520.31 rows=145241 width=16) (actual time=132.847..1987.475 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6804.06..270284.06 rows=147466 width=8) (actual time=132.760..463.168 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=50768
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6656.60 rows=589866 width=0) (actual time=84.255..84.255 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.012..0.013 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.020..0.021 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.012..0.014 rows=25 loops=5)
 Planning Time: 2.305 ms
 Execution Time: 3650.503 ms
(38 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=437199.27..437199.27 rows=1 width=36) (actual time=3947.980..3963.741 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=193163.49..193163.50 rows=1 width=32) (actual time=152.415..152.505 rows=1 loops=1)
           ->  Gather  (cost=193163.26..193163.47 rows=2 width=32) (actual time=151.854..152.491 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=192163.26..192163.27 rows=1 width=32) (actual time=149.705..149.706 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..191180.78 rows=130998 width=10) (actual time=0.103..121.342 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.091..16.644 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.033..6.601 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 38771  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 30801  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 30353  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..111.13 rows=79 width=14) (actual time=0.003..0.068 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=244035.77..244297.77 rows=104798 width=36) (actual time=3947.979..3963.650 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=203315.10..243511.78 rows=104798 width=36) (actual time=3947.970..3963.641 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=203315.10..236830.89 rows=261996 width=36) (actual time=3459.153..3616.777 rows=314415 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=202315.07..205590.02 rows=130998 width=36) (actual time=3449.644..3547.885 rows=104805 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=202315.07..202642.57 rows=130998 width=14) (actual time=3449.628..3457.919 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 7207kB
                                 Worker 0:  Sort Method: quicksort  Memory: 7379kB
                                 Worker 1:  Sort Method: quicksort  Memory: 7163kB
                                 ->  Nested Loop  (cost=0.87..191180.78 rows=130998 width=14) (actual time=0.779..3414.034 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.401..26.676 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.272..13.891 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 33281  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 33281  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 33363  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.004..0.004 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..111.13 rows=79 width=18) (actual time=0.091..2.517 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 16.852 ms
 Execution Time: 3964.162 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=437199.27..437199.27 rows=1 width=36) (actual time=642.864..659.584 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=193163.49..193163.50 rows=1 width=32) (actual time=146.978..147.068 rows=1 loops=1)
           ->  Gather  (cost=193163.26..193163.47 rows=2 width=32) (actual time=146.010..147.055 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=192163.26..192163.27 rows=1 width=32) (actual time=143.896..143.897 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..191180.78 rows=130998 width=10) (actual time=0.110..115.850 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.098..16.433 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.038..6.447 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 42513  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 28523  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 28889  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..111.13 rows=79 width=14) (actual time=0.003..0.065 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=244035.77..244297.77 rows=104798 width=36) (actual time=642.863..659.492 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=203315.10..243511.78 rows=104798 width=36) (actual time=642.855..659.484 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=203315.10..236830.89 rows=261996 width=36) (actual time=157.673..316.787 rows=314414 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=202315.07..205590.02 rows=130998 width=36) (actual time=154.649..252.649 rows=104805 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=202315.07..202642.57 rows=130998 width=14) (actual time=154.634..162.971 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 7260kB
                                 Worker 0:  Sort Method: quicksort  Memory: 7251kB
                                 Worker 1:  Sort Method: quicksort  Memory: 7238kB
                                 ->  Nested Loop  (cost=0.87..191180.78 rows=130998 width=14) (actual time=0.104..131.374 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.090..16.955 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.027..6.780 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 34379  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 32997  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 32549  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..111.13 rows=79 width=18) (actual time=0.004..0.076 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.011 ms
 Execution Time: 659.676 ms
(56 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469279.86..1613904.95 rows=1 width=27) (actual time=13648.001..13651.528 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469279.86..2481655.48 rows=7 width=27) (actual time=13648.000..13651.526 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469279.86..2476672.37 rows=284745 width=27) (actual time=7152.721..13559.310 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469279.42..1503373.26 rows=284745 width=15) (actual time=7151.471..7221.939 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468279.36..1468457.33 rows=71186 width=15) (actual time=7139.014..7141.698 rows=32347 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3959kB
                           Worker 0:  Sort Method: quicksort  Memory: 3981kB
                           Worker 1:  Sort Method: quicksort  Memory: 3991kB
                           Worker 2:  Sort Method: quicksort  Memory: 3952kB
                           Worker 3:  Sort Method: quicksort  Memory: 3958kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462542.02 rows=71186 width=15) (actual time=1.819..7123.269 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.040..0.040 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.854 ms
 Execution Time: 13651.929 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469279.86..1613904.95 rows=1 width=27) (actual time=4086.042..4087.417 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469279.86..2481655.48 rows=7 width=27) (actual time=4086.041..4087.415 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469279.86..2476672.37 rows=284745 width=27) (actual time=3636.266..4042.884 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469279.42..1503373.26 rows=284745 width=15) (actual time=3636.218..3670.780 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468279.36..1468457.33 rows=71186 width=15) (actual time=3630.580..3632.540 rows=32253 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3879kB
                           Worker 0:  Sort Method: quicksort  Memory: 4084kB
                           Worker 1:  Sort Method: quicksort  Memory: 3979kB
                           Worker 2:  Sort Method: quicksort  Memory: 3882kB
                           Worker 3:  Sort Method: quicksort  Memory: 4017kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462542.02 rows=71186 width=15) (actual time=1.288..3610.617 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.852 ms
 Execution Time: 4087.479 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361615.88..1361615.88 rows=1 width=16) (actual time=17146.345..17146.347 rows=1 loops=1)
   ->  Sort  (cost=1361615.88..1361616.38 rows=200 width=16) (actual time=17146.343..17146.345 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361612.88..1361614.88 rows=200 width=16) (actual time=17146.316..17146.324 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208109.51..1339112.96 rows=1499995 width=12) (actual time=14956.211..16977.791 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53284.29..662893.10 rows=14848447 width=8) (actual time=367.007..11091.379 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448767.53 rows=14848447 width=8) (actual time=0.650..5260.714 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.35..28674.35 rows=1499995 width=4) (actual time=363.739..363.740 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.35 rows=1499995 width=4) (actual time=0.020..159.903 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 13.958 ms
 Execution Time: 17179.176 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361615.88..1361615.88 rows=1 width=16) (actual time=16518.361..16518.364 rows=1 loops=1)
   ->  Sort  (cost=1361615.88..1361616.38 rows=200 width=16) (actual time=16518.359..16518.361 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361612.88..1361614.88 rows=200 width=16) (actual time=16518.334..16518.341 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208109.51..1339112.96 rows=1499995 width=12) (actual time=14369.841..16345.710 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53284.29..662893.10 rows=14848447 width=8) (actual time=331.212..10530.580 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448767.53 rows=14848447 width=8) (actual time=0.032..4798.873 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.35..28674.35 rows=1499995 width=4) (actual time=328.666..328.667 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.35 rows=1499995 width=4) (actual time=0.020..129.002 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.696 ms
 Execution Time: 16552.157 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=839523.90..839523.91 rows=1 width=32) (actual time=8784.829..8817.178 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=839523.90..839523.91 rows=1 width=32) (actual time=8784.828..8817.176 rows=1 loops=1)
         ->  Gather  (cost=839523.44..839523.85 rows=4 width=64) (actual time=8777.990..8817.144 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=838523.44..838523.45 rows=1 width=64) (actual time=8769.142..8769.145 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64356.99..835214.96 rows=189056 width=33) (actual time=630.040..8608.957 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12125.85..782487.55 rows=189056 width=16) (actual time=289.262..8098.470 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=82847
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11936.80 rows=756223 width=0) (actual time=189.711..189.712 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45981.06..45981.06 rows=500006 width=25) (actual time=338.577..338.578 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45981.06 rows=500006 width=25) (actual time=0.469..171.950 rows=400000 loops=5)
 Planning Time: 17.298 ms
 Execution Time: 8817.554 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=839523.90..839523.91 rows=1 width=32) (actual time=1642.632..1675.100 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=839523.90..839523.91 rows=1 width=32) (actual time=1642.630..1675.097 rows=1 loops=1)
         ->  Gather  (cost=839523.44..839523.85 rows=4 width=64) (actual time=1638.049..1675.074 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=838523.44..838523.45 rows=1 width=64) (actual time=1632.947..1632.950 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64356.99..835214.96 rows=189056 width=33) (actual time=541.674..1526.652 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12125.85..782487.55 rows=189056 width=16) (actual time=272.470..1110.366 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=80003
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11936.80 rows=756223 width=0) (actual time=173.312..173.312 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45981.06..45981.06 rows=500006 width=25) (actual time=267.164..267.164 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137344kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45981.06 rows=500006 width=25) (actual time=0.042..103.076 rows=400000 loops=5)
 Planning Time: 1.024 ms
 Execution Time: 1675.155 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2744167.81..2744275.07 rows=1 width=103) (actual time=20001.170..20050.790 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1390390.94..1390390.95 rows=1 width=32) (actual time=2819.775..2828.771 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1387930.74..1389160.84 rows=98408 width=36) (actual time=2776.795..2823.097 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 56337kB
                 ->  Gather  (cost=1344385.20..1384978.50 rows=393632 width=36) (actual time=2447.890..2529.559 rows=398620 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1343385.20..1344615.30 rows=98408 width=36) (actual time=2443.557..2492.878 rows=99655 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 43025kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=37769.14..1337496.40 rows=588880 width=16) (actual time=437.305..1987.873 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=104951 lossy=70091
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37180.26 rows=2355520 width=0) (actual time=347.087..347.088 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1353776.86..1406549.75 rows=492 width=103) (actual time=20001.169..20041.792 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1353776.57..1405336.31 rows=492 width=36) (actual time=20000.398..20041.019 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1353776.57..1400907.95 rows=393632 width=36) (actual time=16973.011..17078.397 rows=346146 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1352776.51..1353022.53 rows=98408 width=36) (actual time=16942.850..16950.776 rows=69691 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 12344kB
                           Worker 0:  Sort Method: quicksort  Memory: 12344kB
                           Worker 1:  Sort Method: quicksort  Memory: 12346kB
                           Worker 2:  Sort Method: quicksort  Memory: 12343kB
                           Worker 3:  Sort Method: quicksort  Memory: 12346kB
                           ->  Partial HashAggregate  (cost=1343385.20..1344615.30 rows=98408 width=36) (actual time=16856.778..16920.506 rows=98901 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 39953kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=37769.14..1337496.40 rows=588880 width=16) (actual time=485.723..16336.123 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79639 lossy=53187
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37180.26 rows=2355520 width=0) (actual time=399.134..399.135 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.46 rows=1 width=71) (actual time=0.765..0.765 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 15.817 ms
 Execution Time: 20053.150 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2744167.81..2744275.07 rows=1 width=103) (actual time=5755.438..5800.982 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1390390.94..1390390.95 rows=1 width=32) (actual time=2823.680..2832.664 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1387930.74..1389160.84 rows=98408 width=36) (actual time=2780.886..2827.032 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 54289kB
                 ->  Gather  (cost=1344385.20..1384978.50 rows=393632 width=36) (actual time=2450.322..2533.453 rows=398579 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1343385.20..1344615.30 rows=98408 width=36) (actual time=2445.112..2494.257 rows=99645 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 39953kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=37769.14..1337496.40 rows=588880 width=16) (actual time=436.858..1988.179 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=106010 lossy=70374
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37180.26 rows=2355520 width=0) (actual time=347.149..347.150 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1353776.86..1406549.75 rows=492 width=103) (actual time=5755.437..5791.995 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1353776.57..1405336.31 rows=492 width=36) (actual time=5755.393..5791.950 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1353776.57..1400907.95 rows=393632 width=36) (actual time=2726.971..2826.943 rows=346168 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1352776.51..1353022.53 rows=98408 width=36) (actual time=2700.570..2708.294 rows=69686 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 12341kB
                           Worker 0:  Sort Method: quicksort  Memory: 12325kB
                           Worker 1:  Sort Method: quicksort  Memory: 12360kB
                           Worker 2:  Sort Method: quicksort  Memory: 12367kB
                           Worker 3:  Sort Method: quicksort  Memory: 12331kB
                           ->  Partial HashAggregate  (cost=1343385.20..1344615.30 rows=98408 width=36) (actual time=2614.045..2674.778 rows=98907 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=37769.14..1337496.40 rows=588880 width=16) (actual time=447.062..2169.002 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79396 lossy=52701
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37180.26 rows=2355520 width=0) (actual time=358.296..358.296 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.46 rows=1 width=71) (actual time=0.039..0.039 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.059 ms
 Execution Time: 5803.231 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=250540.80..250540.81 rows=1 width=44) (actual time=2833.328..2839.457 rows=1 loops=1)
   ->  Sort  (cost=250540.80..250923.44 rows=153053 width=44) (actual time=2833.327..2839.454 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172017.09..249775.54 rows=153053 width=44) (actual time=2141.235..2833.838 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172017.09..242369.33 rows=587568 width=40) (actual time=2141.193..2638.110 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171017.03..171384.26 rows=146892 width=40) (actual time=2107.055..2123.984 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 22406kB
                           Worker 0:  Sort Method: quicksort  Memory: 21444kB
                           Worker 1:  Sort Method: quicksort  Memory: 21826kB
                           Worker 2:  Sort Method: quicksort  Memory: 21958kB
                           Worker 3:  Sort Method: quicksort  Memory: 22349kB
                           ->  Parallel Hash Join  (cost=57870.57..158410.46 rows=146892 width=40) (actual time=365.614..1125.028 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101385.98 rows=1000139 width=8) (actual time=48.262..590.243 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.618..47.412 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53481.15..53481.15 rows=73437 width=40) (actual time=316.691..316.691 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53481.15 rows=73437 width=40) (actual time=0.450..289.260 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 18.697 ms
 Execution Time: 2840.219 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=250540.80..250540.81 rows=1 width=44) (actual time=2625.956..2631.936 rows=1 loops=1)
   ->  Sort  (cost=250540.80..250923.44 rows=153053 width=44) (actual time=2625.955..2631.934 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172017.09..249775.54 rows=153053 width=44) (actual time=1928.829..2626.288 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172017.09..242369.33 rows=587568 width=40) (actual time=1928.785..2431.558 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171017.03..171384.26 rows=146892 width=40) (actual time=1783.885..1800.638 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 23202kB
                           Worker 0:  Sort Method: quicksort  Memory: 19776kB
                           Worker 1:  Sort Method: quicksort  Memory: 20151kB
                           Worker 2:  Sort Method: quicksort  Memory: 22660kB
                           Worker 3:  Sort Method: quicksort  Memory: 26558kB
                           ->  Parallel Hash Join  (cost=57870.57..158410.46 rows=146892 width=40) (actual time=189.572..830.814 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101385.98 rows=1000139 width=8) (actual time=27.500..443.466 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.084..26.335 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53481.15..53481.15 rows=73437 width=40) (actual time=161.386..161.387 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53481.15 rows=73437 width=40) (actual time=0.019..131.455 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 1.190 ms
 Execution Time: 2632.018 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3367416.91..3367416.92 rows=1 width=32) (actual time=24940.362..25035.702 rows=1 loops=1)
   ->  Aggregate  (cost=3367416.91..3367416.92 rows=1 width=32) (actual time=24940.361..25035.700 rows=1 loops=1)
         ->  Merge Join  (cost=2271836.32..3367368.13 rows=19508 width=8) (actual time=18267.080..25034.847 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2270835.40..3260585.73 rows=1889058 width=36) (actual time=18238.694..24844.926 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2270835.40..3175578.12 rows=7556232 width=36) (actual time=18238.674..20275.276 rows=9972035 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2269835.34..2274557.98 rows=1889058 width=36) (actual time=18032.623..18322.927 rows=1994904 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150288kB
                                 Worker 0:  Sort Method: external merge  Disk: 150336kB
                                 Worker 1:  Sort Method: external merge  Disk: 150352kB
                                 Worker 2:  Sort Method: external merge  Disk: 150328kB
                                 Worker 3:  Sort Method: external merge  Disk: 150312kB
                                 ->  Partial HashAggregate  (cost=1869646.74..2039700.51 rows=1889058 width=36) (actual time=10031.691..17175.986 rows=1995072 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 391888kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407568kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407784kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 400400kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 400392kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275098.12 rows=14995512 width=9) (actual time=0.282..3940.819 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..101173.32 rows=61961 width=21) (actual time=26.178..69.474 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..101018.42 rows=61961 width=21) (actual time=26.172..62.560 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..92638.21 rows=15490 width=21) (actual time=1.694..487.912 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.64 rows=516 width=4) (actual time=0.807..193.680 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.92 rows=32 width=17) (actual time=0.359..0.580 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 14.905 ms
 Execution Time: 25102.880 ms
(38 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3367416.91..3367416.92 rows=1 width=32) (actual time=23628.620..23713.792 rows=1 loops=1)
   ->  Aggregate  (cost=3367416.91..3367416.92 rows=1 width=32) (actual time=23628.619..23713.790 rows=1 loops=1)
         ->  Merge Join  (cost=2271836.32..3367368.13 rows=19508 width=8) (actual time=17082.514..23713.020 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2270835.40..3260585.73 rows=1889058 width=36) (actual time=17072.248..23562.988 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2270835.40..3175578.12 rows=7556232 width=36) (actual time=17072.226..19097.596 rows=9971402 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2269835.34..2274557.98 rows=1889058 width=36) (actual time=16599.872..16888.074 rows=1994771 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150328kB
                                 Worker 0:  Sort Method: external merge  Disk: 150296kB
                                 Worker 1:  Sort Method: external merge  Disk: 150136kB
                                 Worker 2:  Sort Method: external merge  Disk: 150440kB
                                 Worker 3:  Sort Method: external merge  Disk: 150368kB
                                 ->  Partial HashAggregate  (cost=1869646.74..2039700.51 rows=1889058 width=36) (actual time=8613.706..15703.215 rows=1994944 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 406552kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 391760kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 375040kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 424376kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407944kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275098.12 rows=14995512 width=9) (actual time=0.066..1644.828 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..101173.32 rows=61961 width=21) (actual time=8.109..30.103 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..101018.42 rows=61961 width=21) (actual time=8.103..23.375 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..92638.21 rows=15490 width=21) (actual time=0.241..125.759 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.64 rows=516 width=4) (actual time=0.221..106.760 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.92 rows=32 width=17) (actual time=0.005..0.033 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.934 ms
 Execution Time: 23779.965 ms
(38 rows)

query 18 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8724705.44..8724705.69 rows=100 width=71) (actual time=41214.679..41214.692 rows=99 loops=1)
   ->  Sort  (cost=8724705.44..8774675.65 rows=19988084 width=71) (actual time=41214.677..41214.685 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  HashAggregate  (cost=7359571.16..7960775.25 rows=19988084 width=71) (actual time=41213.814..41214.583 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 128  Batches: 1  Memory Usage: 6225kB
               ->  Hash Join  (cost=78782.31..6282869.29 rows=19988084 width=44) (actual time=2989.760..41213.333 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=295.42..5869847.53 rows=19988084 width=25) (actual time=969.474..40456.929 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3340199.77 rows=4998504 width=24) (actual time=749.501..29760.562 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547964.86 rows=14999962 width=20) (actual time=0.552..2993.563 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692253.70 rows=4998504 width=4) (actual time=644.041..25903.683 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167410.78 rows=59982048 width=9) (actual time=0.452..12413.492 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167410.78 rows=59982048 width=9) (actual time=0.014..7386.851 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.95..50946.95 rows=1499995 width=23) (actual time=672.245..672.246 rows=1500000 loops=1)
                           Buckets: 1048576  Batches: 2  Memory Usage: 49242kB
                           ->  Seq Scan on customer  (cost=0.00..50946.95 rows=1499995 width=23) (actual time=0.763..402.261 rows=1500000 loops=1)
 Planning Time: 20.593 ms
 Execution Time: 41216.248 ms
(25 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8724705.44..8724705.69 rows=100 width=71) (actual time=37916.042..37916.056 rows=99 loops=1)
   ->  Sort  (cost=8724705.44..8774675.65 rows=19988084 width=71) (actual time=37916.041..37916.048 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  HashAggregate  (cost=7359571.16..7960775.25 rows=19988084 width=71) (actual time=37915.187..37915.949 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 128  Batches: 1  Memory Usage: 6225kB
               ->  Hash Join  (cost=78782.31..6282869.29 rows=19988084 width=44) (actual time=2573.635..37914.731 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=295.42..5869847.53 rows=19988084 width=25) (actual time=843.112..37286.251 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3340199.77 rows=4998504 width=24) (actual time=616.730..26501.528 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547964.86 rows=14999962 width=20) (actual time=0.029..2410.723 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692253.70 rows=4998504 width=4) (actual time=539.172..23250.493 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167410.78 rows=59982048 width=9) (actual time=0.016..10048.947 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167410.78 rows=59982048 width=9) (actual time=0.012..7479.134 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.95..50946.95 rows=1499995 width=23) (actual time=543.709..543.710 rows=1500000 loops=1)
                           Buckets: 1048576  Batches: 2  Memory Usage: 49242kB
                           ->  Seq Scan on customer  (cost=0.00..50946.95 rows=1499995 width=23) (actual time=0.029..279.873 rows=1500000 loops=1)
 Planning Time: 1.797 ms
 Execution Time: 37917.437 ms
(25 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=127155.08..127155.09 rows=1 width=32) (actual time=5081.236..5092.163 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=127155.08..127155.09 rows=1 width=32) (actual time=5081.235..5092.160 rows=1 loops=1)
         ->  Gather  (cost=127154.65..127155.06 rows=4 width=32) (actual time=5075.101..5092.138 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=126154.65..126154.66 rows=1 width=32) (actual time=5067.352..5067.353 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..126152.43 rows=295 width=12) (actual time=43.050..5066.728 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62231.26 rows=1230 width=30) (actual time=0.916..177.748 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.96 rows=1 width=21) (actual time=4.615..5.111 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 18.549 ms
 Execution Time: 5093.078 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=127155.08..127155.09 rows=1 width=32) (actual time=225.342..244.746 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=127155.08..127155.09 rows=1 width=32) (actual time=225.341..244.744 rows=1 loops=1)
         ->  Gather  (cost=127154.65..127155.06 rows=4 width=32) (actual time=219.060..244.726 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=126154.65..126154.66 rows=1 width=32) (actual time=214.145..214.146 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..126152.43 rows=295 width=12) (actual time=2.485..213.944 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62231.26 rows=1230 width=30) (actual time=0.113..136.199 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.96 rows=1 width=21) (actual time=0.074..0.081 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.145 ms
 Execution Time: 244.809 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2458701.08..2657510.03 rows=1 width=51) (actual time=36835.833..36837.056 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2458701.08..2657510.03 rows=1 width=51) (actual time=36835.832..36837.054 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=27.518..28.677 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=19.286..19.303 rows=392 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 313kB
                     Worker 0:  Sort Method: quicksort  Memory: 166kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.388..17.991 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.250..13.146 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.087..0.087 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.081..0.083 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2454578.15..2652751.22 rows=3 width=8) (actual time=35231.421..36807.218 rows=13474 loops=1)
               ->  Hash Join  (cost=2454578.15..2652751.21 rows=3 width=8) (actual time=35231.417..36804.217 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2378112.29..2539934.43 rows=4846771 width=40) (actual time=33822.557..35202.619 rows=1251652 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146326.52..1993467.88 rows=9125947 width=13) (actual time=1252.195..28859.670 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144045.04 rows=9125947 width=0) (actual time=1127.716..1127.716 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75253.59..75253.59 rows=80818 width=16) (actual time=1408.580..1408.641 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75253.59 rows=80818 width=16) (actual time=2.071..1388.767 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.79 rows=20204 width=16) (actual time=0.981..1394.617 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47231.07 rows=5050 width=4) (actual time=0.372..142.603 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.270..0.287 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 23.632 ms
 Execution Time: 36881.521 ms
(46 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2458701.08..2657510.03 rows=1 width=51) (actual time=14952.521..14953.983 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2458701.08..2657510.03 rows=1 width=51) (actual time=14952.519..14953.980 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=16.774..18.174 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=14.673..14.690 rows=392 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 285kB
                     Worker 0:  Sort Method: quicksort  Memory: 194kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.101..13.379 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.021..8.510 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.015 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2454578.15..2652751.22 rows=3 width=8) (actual time=13371.974..14934.613 rows=13474 loops=1)
               ->  Hash Join  (cost=2454578.15..2652751.21 rows=3 width=8) (actual time=13371.970..14931.855 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2378112.29..2539934.43 rows=4846771 width=40) (actual time=13186.783..14555.727 rows=1251652 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146326.52..1993467.88 rows=9125947 width=13) (actual time=1099.594..9123.053 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144045.04 rows=9125947 width=0) (actual time=975.605..975.605 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75253.59..75253.59 rows=80818 width=16) (actual time=184.889..184.949 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75253.59 rows=80818 width=16) (actual time=0.325..167.447 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.79 rows=20204 width=16) (actual time=0.103..165.863 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47231.07 rows=5050 width=4) (actual time=0.051..100.139 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.012..0.014 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.209 ms
 Execution Time: 15001.939 ms
(46 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1966541.33..1966541.34 rows=1 width=34) (actual time=11399.962..11412.276 rows=100 loops=1)
   ->  Sort  (cost=1966541.33..1966541.34 rows=1 width=34) (actual time=11399.960..11412.268 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1966538.10..1966541.32 rows=1 width=34) (actual time=10869.641..11409.834 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1966538.10..1966541.31 rows=1 width=26) (actual time=10869.480..11398.152 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1966537.54..1966537.66 rows=1 width=38) (actual time=10869.430..10914.703 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1965537.48..1965537.49 rows=1 width=38) (actual time=10843.133..10844.994 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1250kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1204kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1191kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1207kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1193kB
                                 ->  Nested Loop Anti Join  (cost=1338027.82..1965537.47 rows=1 width=38) (actual time=7286.582..10768.965 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338027.25..1653253.72 rows=97258 width=38) (actual time=7284.688..9237.666 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308142.88 rows=1824120 width=4) (actual time=0.516..1415.647 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335528.00..1335528.00 rows=199940 width=34) (actual time=7282.843..7283.147 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131328kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335528.00 rows=199940 width=34) (actual time=19.701..7113.570 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312586.90 rows=4998504 width=8) (actual time=0.547..6284.830 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=18.965..18.967 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.171..18.099 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.111..16.026 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.053..0.054 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.050..0.051 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.010..0.010 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 18.303 ms
 Execution Time: 11412.591 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1966541.33..1966541.34 rows=1 width=34) (actual time=6799.646..6818.754 rows=100 loops=1)
   ->  Sort  (cost=1966541.33..1966541.34 rows=1 width=34) (actual time=6799.645..6818.746 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1966538.10..1966541.32 rows=1 width=34) (actual time=6318.538..6816.395 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1966538.10..1966541.31 rows=1 width=26) (actual time=6318.399..6805.192 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1966537.54..1966537.66 rows=1 width=38) (actual time=6318.363..6370.101 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1965537.48..1965537.49 rows=1 width=38) (actual time=6291.796..6293.385 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1276kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1201kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1193kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1180kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1195kB
                                 ->  Nested Loop Anti Join  (cost=1338027.82..1965537.47 rows=1 width=38) (actual time=3862.234..6216.765 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338027.25..1653253.72 rows=97258 width=38) (actual time=3861.874..5075.708 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308142.88 rows=1824120 width=4) (actual time=0.072..627.081 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335528.00..1335528.00 rows=199940 width=34) (actual time=3859.744..3859.748 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335528.00 rows=199940 width=34) (actual time=12.917..3675.088 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312586.90 rows=4998504 width=8) (actual time=0.043..2739.438 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=10.875..10.877 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.047..10.594 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.023..8.631 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.018..0.019 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.007..0.007 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.006 ms
 Execution Time: 6819.088 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93876.78..93878.50 rows=1 width=72) (actual time=1513.357..1519.903 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.98..46820.99 rows=1 width=32) (actual time=332.532..332.625 rows=1 loops=1)
           ->  Gather  (cost=46820.55..46820.96 rows=4 width=32) (actual time=332.270..332.613 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.55..45820.56 rows=1 width=32) (actual time=321.699..321.699 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.72 rows=11932 width=6) (actual time=0.127..312.144 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.79..59814.62 rows=7414 width=72) (actual time=1513.355..1519.808 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.79..59629.27 rows=7414 width=38) (actual time=514.894..1512.926 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.35..49150.71 rows=17500 width=26) (actual time=513.638..537.117 rows=27128 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 3
                     ->  Sort  (cost=46055.30..46066.23 rows=4375 width=26) (actual time=176.577..177.573 rows=7500 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 4254kB
                           Worker 0:  Sort Method: quicksort  Memory: 4118kB
                           Worker 1:  Sort Method: quicksort  Memory: 4111kB
                           Worker 2:  Sort Method: quicksort  Memory: 4115kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.72 rows=4375 width=26) (actual time=0.021..161.262 rows=47782 loops=4)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.035..0.035 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 14.648 ms
 Execution Time: 1520.293 ms
(31 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93876.78..93878.50 rows=1 width=72) (actual time=458.012..463.775 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.98..46820.99 rows=1 width=32) (actual time=218.996..219.095 rows=1 loops=1)
           ->  Gather  (cost=46820.55..46820.96 rows=4 width=32) (actual time=215.373..219.079 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.55..45820.56 rows=1 width=32) (actual time=212.208..212.208 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.72 rows=11932 width=6) (actual time=0.020..202.432 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.79..59814.62 rows=7414 width=72) (actual time=458.011..463.673 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.79..59629.27 rows=7414 width=38) (actual time=394.737..461.255 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.35..49150.71 rows=17500 width=26) (actual time=394.676..407.593 rows=27129 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 3
                     ->  Sort  (cost=46055.30..46066.23 rows=4375 width=26) (actual time=170.436..171.139 rows=7530 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 4400kB
                           Worker 0:  Sort Method: quicksort  Memory: 4058kB
                           Worker 1:  Sort Method: quicksort  Memory: 4069kB
                           Worker 2:  Sort Method: quicksort  Memory: 4071kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.72 rows=4375 width=26) (actual time=0.023..154.989 rows=47782 loops=4)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.002..0.002 rows=1 loops=27129)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 0.834 ms
 Execution Time: 463.836 ms
(31 rows)

