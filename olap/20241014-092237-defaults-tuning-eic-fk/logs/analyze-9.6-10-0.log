query 1 run 1
SET
SET
SET
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4245781.20..4245781.20 rows=1 width=236) (actual time=96517.143..96517.143 rows=1 loops=1)
   ->  Sort  (cost=4245781.20..4245781.21 rows=6 width=236) (actual time=96517.142..96517.142 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4245781.00..4245781.17 rows=6 width=236) (actual time=96517.116..96517.122 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               ->  Seq Scan on lineitem  (cost=0.00..1875068.60 rows=59267810 width=25) (actual time=0.442..13457.463 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning time: 14.680 ms
 Execution time: 96517.989 ms
(11 rows)

SET
SET
SET
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4245781.20..4245781.20 rows=1 width=236) (actual time=95004.545..95004.545 rows=1 loops=1)
   ->  Sort  (cost=4245781.20..4245781.21 rows=6 width=236) (actual time=95004.545..95004.545 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4245781.00..4245781.17 rows=6 width=236) (actual time=95004.505..95004.511 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               ->  Seq Scan on lineitem  (cost=0.00..1875068.60 rows=59267810 width=25) (actual time=0.027..11674.563 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning time: 0.512 ms
 Execution time: 95004.656 ms
(11 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1091673.32..1091673.32 rows=1 width=193) (actual time=5677.270..5677.283 rows=100 loops=1)
   ->  Sort  (cost=1091673.32..1091673.32 rows=1 width=193) (actual time=5677.269..5677.278 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 51kB
         ->  Merge Join  (cost=558030.59..1091673.31 rows=1 width=193) (actual time=3628.872..5674.293 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89213.93 rows=8112 width=30) (actual time=0.014..790.273 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=558029.81..566029.62 rows=1599961 width=173) (actual time=3627.910..4084.123 rows=1603828 loops=1)
                     ->  Sort  (cost=558029.81..562029.71 rows=1599961 width=173) (actual time=3627.909..3951.144 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293160kB
                           ->  Hash Join  (cost=4048.53..305267.49 rows=1599961 width=173) (actual time=41.266..2427.592 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255220.07 rows=7999807 width=14) (actual time=0.009..1070.728 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.53..3798.53 rows=20000 width=167) (actual time=41.235..41.235 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.53..3798.53 rows=20000 width=167) (actual time=0.017..35.826 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.002..24.139 rows=100000 loops=1)
                                             ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.013..0.013 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.008..0.012 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.003 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.004..0.004 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.003..0.003 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.61..66.62 rows=1 width=32) (actual time=0.096..0.096 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.60 rows=4 width=6) (actual time=0.085..0.094 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..65.32 rows=18 width=10) (actual time=0.079..0.092 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.51 rows=18 width=10) (actual time=0.078..0.090 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.074..0.076 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.010..0.010 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 20.679 ms
 Execution time: 5714.268 ms
(53 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1091673.32..1091673.32 rows=1 width=193) (actual time=4423.192..4423.209 rows=100 loops=1)
   ->  Sort  (cost=1091673.32..1091673.32 rows=1 width=193) (actual time=4423.191..4423.205 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 51kB
         ->  Merge Join  (cost=558030.59..1091673.31 rows=1 width=193) (actual time=3199.793..4421.059 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89213.93 rows=8112 width=30) (actual time=0.014..494.269 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=558029.81..566029.62 rows=1599961 width=173) (actual time=3199.680..3647.499 rows=1603828 loops=1)
                     ->  Sort  (cost=558029.81..562029.71 rows=1599961 width=173) (actual time=3199.678..3514.139 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293160kB
                           ->  Hash Join  (cost=4048.53..305267.49 rows=1599961 width=173) (actual time=24.902..2033.238 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255220.07 rows=7999807 width=14) (actual time=0.009..777.156 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.53..3798.53 rows=20000 width=167) (actual time=24.869..24.869 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.53..3798.53 rows=20000 width=167) (actual time=0.044..20.025 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.001..5.384 rows=100000 loops=1)
                                             ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.039..0.039 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.026..0.038 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.001 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.002..0.004 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.61..66.62 rows=1 width=32) (actual time=0.016..0.016 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.60 rows=4 width=6) (actual time=0.008..0.014 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..65.32 rows=18 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.51 rows=18 width=10) (actual time=0.004..0.011 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.002..0.003 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.011 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.005 rows=25 loops=1)
 Planning time: 1.935 ms
 Execution time: 4460.341 ms
(53 rows)

query 3 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3455305.36..3455305.38 rows=10 width=44) (actual time=26785.698..26785.699 rows=10 loops=1)
   ->  Sort  (cost=3455305.36..3463140.78 rows=3134171 width=44) (actual time=26785.698..26785.698 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=3293551.92..3387577.05 rows=3134171 width=44) (actual time=26580.523..26765.949 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Sort  (cost=3293551.92..3301387.34 rows=3134171 width=24) (actual time=26580.505..26601.807 rows=301530 loops=1)
                     Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                     Sort Method: quicksort  Memory: 31119kB
                     ->  Hash Join  (cost=562221.24..2914059.06 rows=3134171 width=24) (actual time=7910.708..26489.141 rows=301530 loops=1)
                           Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                           ->  Seq Scan on lineitem  (cost=0.00..1875068.60 rows=32432670 width=16) (actual time=0.011..12314.282 rows=32534229 loops=1)
                                 Filter: (l_shipdate > '1995-03-07'::date)
                                 Rows Removed by Filter: 27451823
                           ->  Hash  (cost=537021.40..537021.40 rows=1449667 width=12) (actual time=7907.659..7907.660 rows=1451805 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                                 ->  Hash Join  (cost=144037.71..537021.40 rows=1449667 width=12) (actual time=1911.000..7639.771 rows=1451805 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=85573.39..437009.86 rows=7213478 width=16) (actual time=1389.744..5509.205 rows=7239437 loops=1)
                                             Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..83770.02 rows=7213478 width=0) (actual time=1333.545..1333.545 rows=7239437 loops=1)
                                                   Index Cond: (o_orderdate < '1995-03-07'::date)
                                       ->  Hash  (cost=54696.34..54696.34 rows=301439 width=4) (actual time=520.545..520.545 rows=300276 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                             ->  Seq Scan on customer  (cost=0.00..54696.34 rows=301439 width=4) (actual time=0.013..470.321 rows=300276 loops=1)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 1199724
 Planning time: 20.239 ms
 Execution time: 26785.856 ms
(30 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3455305.36..3455305.38 rows=10 width=44) (actual time=21992.357..21992.358 rows=10 loops=1)
   ->  Sort  (cost=3455305.36..3463140.78 rows=3134171 width=44) (actual time=21992.356..21992.357 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=3293551.92..3387577.05 rows=3134171 width=44) (actual time=21785.152..21972.364 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Sort  (cost=3293551.92..3301387.34 rows=3134171 width=24) (actual time=21785.136..21806.461 rows=301530 loops=1)
                     Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                     Sort Method: quicksort  Memory: 31119kB
                     ->  Hash Join  (cost=562221.24..2914059.06 rows=3134171 width=24) (actual time=5228.197..21695.135 rows=301530 loops=1)
                           Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                           ->  Seq Scan on lineitem  (cost=0.00..1875068.60 rows=32432670 width=16) (actual time=0.009..10370.425 rows=32534229 loops=1)
                                 Filter: (l_shipdate > '1995-03-07'::date)
                                 Rows Removed by Filter: 27451823
                           ->  Hash  (cost=537021.40..537021.40 rows=1449667 width=12) (actual time=5226.350..5226.350 rows=1451805 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                                 ->  Hash Join  (cost=144037.71..537021.40 rows=1449667 width=12) (actual time=1690.314..4990.742 rows=1451805 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=85573.39..437009.86 rows=7213478 width=16) (actual time=1301.435..3084.342 rows=7239437 loops=1)
                                             Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..83770.02 rows=7213478 width=0) (actual time=1245.028..1245.028 rows=7239437 loops=1)
                                                   Index Cond: (o_orderdate < '1995-03-07'::date)
                                       ->  Hash  (cost=54696.34..54696.34 rows=301439 width=4) (actual time=388.163..388.163 rows=300276 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                             ->  Seq Scan on customer  (cost=0.00..54696.34 rows=301439 width=4) (actual time=0.015..341.567 rows=300276 loops=1)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 1199724
 Planning time: 1.093 ms
 Execution time: 21992.482 ms
(30 rows)

query 4 run 1
SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2044764.43..2044764.44 rows=1 width=24) (actual time=19184.243..19184.243 rows=1 loops=1)
   ->  Sort  (cost=2044764.43..2044764.45 rows=5 width=24) (actual time=19184.242..19184.242 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2044764.36..2044764.41 rows=5 width=24) (actual time=19184.219..19184.219 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               ->  Nested Loop Semi Join  (cost=7954.99..2041996.34 rows=553604 width=16) (actual time=162.759..18942.988 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=7954.42..277528.01 rows=553706 width=20) (actual time=162.662..5138.395 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..7816.00 rows=553706 width=0) (actual time=113.731..113.731 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.024..0.024 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning time: 15.370 ms
 Execution time: 19184.501 ms
(18 rows)

SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2044764.43..2044764.44 rows=1 width=24) (actual time=4777.136..4777.136 rows=1 loops=1)
   ->  Sort  (cost=2044764.43..2044764.45 rows=5 width=24) (actual time=4777.135..4777.135 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2044764.36..2044764.41 rows=5 width=24) (actual time=4777.114..4777.115 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               ->  Nested Loop Semi Join  (cost=7954.99..2041996.34 rows=553604 width=16) (actual time=160.412..4611.194 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=7954.42..277528.01 rows=553706 width=20) (actual time=160.374..1242.841 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..7816.00 rows=553706 width=0) (actual time=111.562..111.562 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.006..0.006 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning time: 1.014 ms
 Execution time: 4777.206 ms
(18 rows)

query 5 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2102414.46..2102414.46 rows=1 width=58) (actual time=22544.029..22544.030 rows=1 loops=1)
   ->  Sort  (cost=2102414.46..2102414.52 rows=25 width=58) (actual time=22544.027..22544.027 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2101497.00..2102414.33 rows=25 width=58) (actual time=22512.860..22544.009 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2101497.00..2101680.40 rows=73362 width=38) (actual time=22505.165..22510.411 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=100981.60..2095568.34 rows=73362 width=38) (actual time=1129.567..22461.708 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=96260.60..2076357.79 rows=1834124 width=50) (actual time=1085.758..22011.344 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=96260.04..405109.40 rows=458616 width=38) (actual time=1084.176..7244.211 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=32936.48..328600.65 rows=2293078 width=8) (actual time=495.436..6040.670 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..32363.22 rows=2293078 width=0) (actual time=440.070..440.070 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59573.69..59573.69 rows=299989 width=38) (actual time=587.987..587.987 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.53..59573.69 rows=299989 width=38) (actual time=0.039..526.653 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=8) (actual time=0.008..362.823 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.022..0.022 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.016..0.020 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.003..0.003 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.010..0.010 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.029..0.032 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=43.165..43.165 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.004..28.802 rows=100000 loops=1)
 Planning time: 24.686 ms
 Execution time: 22544.233 ms
(41 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2102414.46..2102414.46 rows=1 width=58) (actual time=6301.719..6301.720 rows=1 loops=1)
   ->  Sort  (cost=2102414.46..2102414.52 rows=25 width=58) (actual time=6301.718..6301.718 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2101497.00..2102414.33 rows=25 width=58) (actual time=6270.578..6301.473 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2101497.00..2101680.40 rows=73362 width=38) (actual time=6262.912..6267.854 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=100981.60..2095568.34 rows=73362 width=38) (actual time=980.829..6229.405 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=96260.60..2076357.79 rows=1834124 width=50) (actual time=942.304..5832.051 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=96260.04..405109.40 rows=458616 width=38) (actual time=942.283..2730.088 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=32936.48..328600.65 rows=2293078 width=8) (actual time=465.490..1722.607 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..32363.22 rows=2293078 width=0) (actual time=409.907..409.907 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59573.69..59573.69 rows=299989 width=38) (actual time=476.119..476.119 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.53..59573.69 rows=299989 width=38) (actual time=0.039..419.335 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=8) (actual time=0.008..259.968 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.022..0.022 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.015..0.020 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.002..0.002 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.005..0.006 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=38.243..38.244 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.005..22.181 rows=100000 loops=1)
 Planning time: 2.999 ms
 Execution time: 6301.964 ms
(41 rows)

query 6 run 1
SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1105416.11..1105416.12 rows=1 width=32) (actual time=17457.468..17457.468 rows=1 loops=1)
   ->  Aggregate  (cost=1105416.11..1105416.12 rows=1 width=32) (actual time=17457.466..17457.466 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=213768.19..1099276.36 rows=1227949 width=12) (actual time=1435.451..16583.973 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 21866393
               Heap Blocks: exact=238202 lossy=424766
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..213461.20 rows=1227949 width=0) (actual time=1383.532..1383.532 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 10.376 ms
 Execution time: 17457.555 ms
(10 rows)

SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1105416.11..1105416.12 rows=1 width=32) (actual time=8867.064..8867.064 rows=1 loops=1)
   ->  Aggregate  (cost=1105416.11..1105416.12 rows=1 width=32) (actual time=8867.062..8867.062 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=213768.19..1099276.36 rows=1227949 width=12) (actual time=1291.149..8393.039 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 21866393
               Heap Blocks: exact=238202 lossy=424766
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..213461.20 rows=1227949 width=0) (actual time=1240.249..1240.249 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 0.600 ms
 Execution time: 8867.106 ms
(10 rows)

query 7 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2393027.94..2393028.07 rows=1 width=92) (actual time=33737.109..33737.109 rows=1 loops=1)
   ->  GroupAggregate  (cost=2393027.94..2394276.60 rows=10060 width=92) (actual time=33737.109..33737.109 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2393027.94..2393181.17 rows=61292 width=72) (actual time=33727.684..33729.010 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=860813.22..2388154.18 rows=61292 width=72) (actual time=8159.638..33698.749 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=298798.76..1783859.72 rows=1472810 width=46) (actual time=3195.173..27887.154 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Bitmap Heap Scan on lineitem  (cost=295021.36..1696316.25 rows=18410126 width=24) (actual time=3160.743..25272.725 rows=18230325 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Index Recheck: 30957726
                                 Heap Blocks: exact=274040 lossy=846026
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..290418.83 rows=18410126 width=0) (actual time=3101.364..3101.364 rows=18230325 loops=1)
                                       Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                           ->  Hash  (cost=3677.40..3677.40 rows=8000 width=30) (actual time=34.373..34.373 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3677.40 rows=8000 width=30) (actual time=0.016..33.100 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.004..23.770 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.011..0.011 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.007..0.009 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=538809.19..538809.19 rows=1200102 width=30) (actual time=4960.506..4960.506 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=59272.58..538809.19 rows=1200102 width=30) (actual time=526.722..4712.305 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411280.77 rows=15001277 width=8) (actual time=0.017..1652.031 rows=15000000 loops=1)
                                 ->  Hash  (cost=57772.63..57772.63 rows=119996 width=30) (actual time=526.646..526.646 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..57772.63 rows=119996 width=30) (actual time=0.020..501.898 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=8) (actual time=0.002..361.040 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.013..0.013 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.009..0.011 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning time: 24.209 ms
 Execution time: 33737.494 ms
(45 rows)

SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2393027.94..2393028.07 rows=1 width=92) (actual time=21025.112..21025.112 rows=1 loops=1)
   ->  GroupAggregate  (cost=2393027.94..2394276.60 rows=10060 width=92) (actual time=21025.111..21025.111 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2393027.94..2393181.17 rows=61292 width=72) (actual time=21015.720..21017.096 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=860813.22..2388154.18 rows=61292 width=72) (actual time=7013.369..20990.163 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=298798.76..1783859.72 rows=1472810 width=46) (actual time=2830.225..16129.504 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Bitmap Heap Scan on lineitem  (cost=295021.36..1696316.25 rows=18410126 width=24) (actual time=2803.421..14051.791 rows=18230325 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Index Recheck: 30957726
                                 Heap Blocks: exact=274040 lossy=846026
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..290418.83 rows=18410126 width=0) (actual time=2743.934..2743.934 rows=18230325 loops=1)
                                       Index Cond: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                           ->  Hash  (cost=3677.40..3677.40 rows=8000 width=30) (actual time=26.775..26.775 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3677.40 rows=8000 width=30) (actual time=0.015..25.317 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.003..16.011 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.009..0.009 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.006..0.008 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=538809.19..538809.19 rows=1200102 width=30) (actual time=4180.565..4180.565 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=59272.58..538809.19 rows=1200102 width=30) (actual time=397.028..3946.589 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411280.77 rows=15001277 width=8) (actual time=0.016..1222.533 rows=15000000 loops=1)
                                 ->  Hash  (cost=57772.63..57772.63 rows=119996 width=30) (actual time=396.941..396.941 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..57772.63 rows=119996 width=30) (actual time=0.021..375.242 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=8) (actual time=0.003..239.060 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.013..0.013 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.009..0.011 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning time: 2.517 ms
 Execution time: 21025.261 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1266882.94..1266883.19 rows=1 width=40) (actual time=60244.773..60244.773 rows=1 loops=1)
   ->  GroupAggregate  (cost=1266882.94..1267491.88 rows=2406 width=40) (actual time=60244.771..60244.771 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1266882.94..1266944.58 rows=24658 width=46) (actual time=60236.994..60237.806 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=506603.76..1265084.16 rows=24658 width=46) (actual time=7303.267..60224.568 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 572208
                     ->  Hash Join  (cost=506603.76..1255712.81 rows=24658 width=20) (actual time=7303.240..60110.837 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=502132.76..1250902.76 rows=24658 width=20) (actual time=7261.585..60056.894 rows=23842 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Nested Loop  (cost=0.56..738723.12 rows=399965 width=20) (actual time=1.304..52407.745 rows=389521 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65981.94 rows=13334 width=4) (actual time=0.852..525.865 rows=13011 loops=1)
                                             Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                             Rows Removed by Filter: 1986989
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.13 rows=32 width=24) (actual time=0.298..3.967 rows=30 loops=13011)
                                             Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=486958.85..486958.85 rows=924828 width=8) (actual time=7248.073..7248.073 rows=910360 loops=1)
                                       Buckets: 1048576  Batches: 2  Memory Usage: 25982kB
                                       ->  Hash Join  (cost=129739.94..486958.85 rows=924828 width=8) (actual time=1500.815..7048.794 rows=910360 loops=1)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Bitmap Heap Scan on orders  (cost=66416.38..397046.50 rows=4624141 width=12) (actual time=927.238..5446.318 rows=4557513 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                   Heap Blocks: exact=261268
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..65260.35 rows=4624141 width=0) (actual time=871.646..871.646 rows=4557513 loops=1)
                                                         Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             ->  Hash  (cost=59573.69..59573.69 rows=299989 width=4) (actual time=572.957..572.958 rows=299436 loops=1)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                   ->  Hash Join  (cost=2.53..59573.69 rows=299989 width=4) (actual time=0.268..524.755 rows=299436 loops=1)
                                                         Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=8) (actual time=0.010..363.989 rows=1500000 loops=1)
                                                         ->  Hash  (cost=2.47..2.47 rows=5 width=4) (actual time=0.252..0.252 rows=5 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Hash Join  (cost=1.07..2.47 rows=5 width=4) (actual time=0.245..0.250 rows=5 loops=1)
                                                                     Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                     ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.003 rows=25 loops=1)
                                                                     ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.238..0.238 rows=1 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.007..0.009 rows=1 loops=1)
                                                                                 Filter: (r_name = 'AMERICA'::bpchar)
                                                                                 Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=41.364..41.364 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.005..28.423 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=25 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.004..0.009 rows=25 loops=1)
 Planning time: 30.411 ms
 Execution time: 60244.935 ms
(50 rows)

SET
SET
SET
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1266882.94..1266883.19 rows=1 width=40) (actual time=5982.257..5982.258 rows=1 loops=1)
   ->  GroupAggregate  (cost=1266882.94..1267491.88 rows=2406 width=40) (actual time=5982.255..5982.255 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1266882.94..1266944.58 rows=24658 width=46) (actual time=5974.486..5975.257 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=506603.76..1265084.16 rows=24658 width=46) (actual time=4111.493..5968.921 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 572208
                     ->  Hash Join  (cost=506603.76..1255712.81 rows=24658 width=20) (actual time=4111.475..5895.281 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=502132.76..1250902.76 rows=24658 width=20) (actual time=4075.519..5850.337 rows=23842 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Nested Loop  (cost=0.56..738723.12 rows=399965 width=20) (actual time=0.082..1603.799 rows=389521 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65981.94 rows=13334 width=4) (actual time=0.057..286.357 rows=13011 loops=1)
                                             Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                             Rows Removed by Filter: 1986989
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.13 rows=32 width=24) (actual time=0.009..0.095 rows=30 loops=13011)
                                             Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=486958.85..486958.85 rows=924828 width=8) (actual time=4073.659..4073.659 rows=910360 loops=1)
                                       Buckets: 1048576  Batches: 2  Memory Usage: 25982kB
                                       ->  Hash Join  (cost=129739.94..486958.85 rows=924828 width=8) (actual time=1313.734..3909.654 rows=910360 loops=1)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Bitmap Heap Scan on orders  (cost=66416.38..397046.50 rows=4624141 width=12) (actual time=872.767..2501.701 rows=4557513 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                   Heap Blocks: exact=261268
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..65260.35 rows=4624141 width=0) (actual time=817.210..817.210 rows=4557513 loops=1)
                                                         Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             ->  Hash  (cost=59573.69..59573.69 rows=299989 width=4) (actual time=440.257..440.257 rows=299436 loops=1)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                   ->  Hash Join  (cost=2.53..59573.69 rows=299989 width=4) (actual time=0.269..394.569 rows=299436 loops=1)
                                                         Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=8) (actual time=0.009..239.670 rows=1500000 loops=1)
                                                         ->  Hash  (cost=2.47..2.47 rows=5 width=4) (actual time=0.251..0.251 rows=5 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Hash Join  (cost=1.07..2.47 rows=5 width=4) (actual time=0.017..0.022 rows=5 loops=1)
                                                                     Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                     ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.002..0.004 rows=25 loops=1)
                                                                     ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.010..0.010 rows=1 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                                                                 Filter: (r_name = 'AMERICA'::bpchar)
                                                                                 Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=35.633..35.633 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.006..21.425 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=25 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.003..0.005 rows=25 loops=1)
 Planning time: 3.569 ms
 Execution time: 5982.425 ms
(50 rows)

query 9 run 1
SET
SET
SET
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2417606.81..2417606.81 rows=1 width=66) (actual time=126754.161..126754.161 rows=1 loops=1)
   ->  Sort  (cost=2417606.81..2417757.18 rows=60150 width=66) (actual time=126754.159..126754.159 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2416253.43..2417306.06 rows=60150 width=66) (actual time=126753.983..126754.082 rows=175 loops=1)
               Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
               ->  Hash Join  (cost=728860.94..2373833.45 rows=2423999 width=57) (actual time=5135.445..123618.525 rows=3248192 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Nested Loop  (cost=71465.20..1522624.75 rows=2423999 width=53) (actual time=723.566..114153.715 rows=3248192 loops=1)
                           Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                           ->  Hash Join  (cost=71464.64..368804.88 rows=323224 width=48) (actual time=723.255..3397.896 rows=433248 loops=1)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Hash Join  (cost=71463.07..364358.99 rows=323224 width=26) (actual time=723.235..3258.273 rows=433248 loops=1)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=66992.07..355443.66 rows=323224 width=18) (actual time=680.994..3012.094 rows=433248 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..255220.07 rows=7999807 width=14) (actual time=0.011..1341.802 rows=8000000 loops=1)
                                             ->  Hash  (cost=65981.94..65981.94 rows=80811 width=4) (actual time=680.623..680.623 rows=108312 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4832kB
                                                   ->  Seq Scan on part  (cost=0.00..65981.94 rows=80811 width=4) (actual time=0.011..659.285 rows=108312 loops=1)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 1891688
                                       ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.197..42.197 rows=100000 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.002..28.258 rows=100000 loops=1)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.012..0.012 rows=25 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.005..0.009 rows=25 loops=1)
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.038..0.252 rows=7 loops=433248)
                                 Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                     ->  Hash  (cost=411280.77..411280.77 rows=15001277 width=8) (actual time=4394.029..4394.029 rows=15000000 loops=1)
                           Buckets: 1048576  Batches: 32  Memory Usage: 26512kB
                           ->  Seq Scan on orders  (cost=0.00..411280.77 rows=15001277 width=8) (actual time=0.015..2431.884 rows=15000000 loops=1)
 Planning time: 29.671 ms
 Execution time: 126754.559 ms
(35 rows)

SET
SET
SET
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2417606.81..2417606.81 rows=1 width=66) (actual time=62665.634..62665.634 rows=1 loops=1)
   ->  Sort  (cost=2417606.81..2417757.18 rows=60150 width=66) (actual time=62665.633..62665.633 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2416253.43..2417306.06 rows=60150 width=66) (actual time=62665.456..62665.548 rows=175 loops=1)
               Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
               ->  Hash Join  (cost=728860.94..2373833.45 rows=2423999 width=57) (actual time=5189.125..59582.542 rows=3248192 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Nested Loop  (cost=71465.20..1522624.75 rows=2423999 width=53) (actual time=681.820..50516.787 rows=3248192 loops=1)
                           Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                           ->  Hash Join  (cost=71464.64..368804.88 rows=323224 width=48) (actual time=681.791..3086.713 rows=433248 loops=1)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Hash Join  (cost=71463.07..364358.99 rows=323224 width=26) (actual time=681.770..2965.215 rows=433248 loops=1)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=66992.07..355443.66 rows=323224 width=18) (actual time=639.764..2741.025 rows=433248 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             ->  Seq Scan on partsupp  (cost=0.00..255220.07 rows=7999807 width=14) (actual time=0.009..1197.374 rows=8000000 loops=1)
                                             ->  Hash  (cost=65981.94..65981.94 rows=80811 width=4) (actual time=639.387..639.387 rows=108312 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4832kB
                                                   ->  Seq Scan on part  (cost=0.00..65981.94 rows=80811 width=4) (actual time=0.012..619.212 rows=108312 loops=1)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 1891688
                                       ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=41.961..41.961 rows=100000 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.004..27.722 rows=100000 loops=1)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.015..0.015 rows=25 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.006..0.008 rows=25 loops=1)
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.018..0.107 rows=7 loops=433248)
                                 Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                     ->  Hash  (cost=411280.77..411280.77 rows=15001277 width=8) (actual time=4493.281..4493.281 rows=15000000 loops=1)
                           Buckets: 1048576  Batches: 32  Memory Usage: 26512kB
                           ->  Seq Scan on orders  (cost=0.00..411280.77 rows=15001277 width=8) (actual time=0.012..2515.884 rows=15000000 loops=1)
 Planning time: 18.325 ms
 Execution time: 62666.079 ms
(35 rows)

query 10 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2500258.14..2500258.19 rows=20 width=202) (actual time=21651.170..21651.174 rows=20 loops=1)
   ->  Sort  (cost=2500258.14..2501724.75 rows=586643 width=202) (actual time=21651.168..21651.170 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  GroupAggregate  (cost=2468515.10..2484647.79 rows=586643 width=202) (actual time=20536.045..21548.721 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Sort  (cost=2468515.10..2469981.71 rows=586643 width=182) (actual time=20536.024..20856.275 rows=1145402 loops=1)
                     Sort Key: customer.c_custkey, nation.n_name
                     Sort Method: external merge  Disk: 218216kB
                     ->  Hash Join  (cost=387936.80..2378792.48 rows=586643 width=182) (actual time=5851.646..19831.057 rows=1145402 loops=1)
                           Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                           ->  Hash Join  (cost=387935.24..2370724.57 rows=586643 width=160) (actual time=5851.631..19646.003 rows=1145402 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=286013.43..2222780.42 rows=586643 width=16) (actual time=4872.093..17843.789 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1875068.60 rows=14888523 width=16) (actual time=0.017..11252.758 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=278624.86..278624.86 rows=591086 width=8) (actual time=4870.348..4870.348 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=8490.57..278624.86 rows=591086 width=8) (actual time=165.528..4719.734 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8342.80 rows=591086 width=0) (actual time=114.659..114.660 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                 ->  Hash  (cost=50946.47..50946.47 rows=1499947 width=148) (actual time=978.965..978.965 rows=1500000 loops=1)
                                       Buckets: 262144  Batches: 16  Memory Usage: 18791kB
                                       ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=148) (actual time=0.004..513.043 rows=1500000 loops=1)
                           ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.011..0.011 rows=25 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.004..0.007 rows=25 loops=1)
 Planning time: 20.624 ms
 Execution time: 21687.712 ms
(33 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2500258.14..2500258.19 rows=20 width=202) (actual time=16023.781..16023.783 rows=20 loops=1)
   ->  Sort  (cost=2500258.14..2501724.75 rows=586643 width=202) (actual time=16023.780..16023.782 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  GroupAggregate  (cost=2468515.10..2484647.79 rows=586643 width=202) (actual time=14908.080..15922.643 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Sort  (cost=2468515.10..2469981.71 rows=586643 width=182) (actual time=14908.059..15229.457 rows=1145402 loops=1)
                     Sort Key: customer.c_custkey, nation.n_name
                     Sort Method: external merge  Disk: 218216kB
                     ->  Hash Join  (cost=387936.80..2378792.48 rows=586643 width=182) (actual time=2428.918..14206.258 rows=1145402 loops=1)
                           Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                           ->  Hash Join  (cost=387935.24..2370724.57 rows=586643 width=160) (actual time=2428.901..14022.500 rows=1145402 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=286013.43..2222780.42 rows=586643 width=16) (actual time=1588.344..12372.867 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1875068.60 rows=14888523 width=16) (actual time=0.015..9138.939 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=278624.86..278624.86 rows=591086 width=8) (actual time=1587.003..1587.003 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=8490.57..278624.86 rows=591086 width=8) (actual time=154.653..1468.596 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8342.80 rows=591086 width=0) (actual time=103.636..103.636 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                 ->  Hash  (cost=50946.47..50946.47 rows=1499947 width=148) (actual time=840.009..840.009 rows=1500000 loops=1)
                                       Buckets: 262144  Batches: 16  Memory Usage: 18791kB
                                       ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=148) (actual time=0.004..384.552 rows=1500000 loops=1)
                           ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.011..0.011 rows=25 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.004..0.008 rows=25 loops=1)
 Planning time: 1.909 ms
 Execution time: 16060.190 ms
(33 rows)

query 11 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=625944.64..625944.64 rows=1 width=36) (actual time=3548.665..3548.665 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293142.67..293142.68 rows=1 width=32) (actual time=1531.857..1531.857 rows=1 loops=1)
           ->  Hash Join  (cost=2323.46..290742.73 rows=319992 width=10) (actual time=2.841..1401.288 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255220.07 rows=7999807 width=14) (actual time=0.036..729.966 rows=8000000 loops=1)
                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=2.775..2.776 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.486..2.401 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.007 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.475..1.969 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.298..0.298 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=332801.96..333601.94 rows=319992 width=36) (actual time=3548.664..3548.664 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=320002.28..331202.00 rows=319992 width=36) (actual time=3548.656..3548.656 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=320002.28..320802.26 rows=319992 width=14) (actual time=1817.490..1836.942 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Hash Join  (cost=2323.46..290742.73 rows=319992 width=14) (actual time=22.877..1772.350 rows=320800 loops=1)
                           Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on partsupp  (cost=0.00..255220.07 rows=7999807 width=18) (actual time=0.311..1030.469 rows=8000000 loops=1)
                           ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=22.483..22.483 rows=4010 loops=1)
                                 Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                 ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=1.882..21.742 rows=4010 loops=1)
                                       ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.017 rows=1 loops=1)
                                             Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                             Rows Removed by Filter: 24
                                       ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=1.864..21.139 rows=4010 loops=1)
                                             Recheck Cond: (s_nationkey = nation.n_nationkey)
                                             Heap Blocks: exact=1869
                                             ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=1.644..1.644 rows=4010 loops=1)
                                                   Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 14.681 ms
 Execution time: 3548.727 ms
(43 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=625944.64..625944.64 rows=1 width=36) (actual time=3138.896..3138.896 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293142.67..293142.68 rows=1 width=32) (actual time=1528.556..1528.556 rows=1 loops=1)
           ->  Hash Join  (cost=2323.46..290742.73 rows=319992 width=10) (actual time=2.843..1397.648 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255220.07 rows=7999807 width=14) (actual time=0.035..705.796 rows=8000000 loops=1)
                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=2.779..2.779 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.491..2.431 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.481..1.977 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.306..0.306 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=332801.96..333601.94 rows=319992 width=36) (actual time=3138.895..3138.895 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=320002.28..331202.00 rows=319992 width=36) (actual time=3138.887..3138.887 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=320002.28..320802.26 rows=319992 width=14) (actual time=1411.261..1430.517 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Hash Join  (cost=2323.46..290742.73 rows=319992 width=14) (actual time=3.552..1369.038 rows=320800 loops=1)
                           Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on partsupp  (cost=0.00..255220.07 rows=7999807 width=18) (actual time=0.034..701.559 rows=8000000 loops=1)
                           ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=3.493..3.493 rows=4010 loops=1)
                                 Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                 ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.495..3.139 rows=4010 loops=1)
                                       ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                                             Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                             Rows Removed by Filter: 24
                                       ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.487..2.701 rows=4010 loops=1)
                                             Recheck Cond: (s_nationkey = nation.n_nationkey)
                                             Heap Blocks: exact=1869
                                             ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.307..0.307 rows=4010 loops=1)
                                                   Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 0.828 ms
 Execution time: 3138.964 ms
(43 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3117756.35..3118588.82 rows=1 width=27) (actual time=20428.573..20428.573 rows=1 loops=1)
   ->  GroupAggregate  (cost=3117756.35..3123583.64 rows=7 width=27) (actual time=20428.573..20428.573 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3117756.35..3118484.75 rows=291361 width=27) (actual time=20368.050..20377.808 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Merge Join  (cost=2501496.40..3091311.77 rows=291361 width=27) (actual time=15714.151..20297.898 rows=311258 loops=1)
                     Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..547984.59 rows=15001277 width=20) (actual time=0.004..3605.297 rows=14999967 loops=1)
                     ->  Sort  (cost=2501453.66..2502182.06 rows=291361 width=15) (actual time=15714.053..15753.774 rows=311258 loops=1)
                           Sort Key: lineitem.l_orderkey
                           Sort Method: quicksort  Memory: 25513kB
                           ->  Seq Scan on lineitem  (cost=0.00..2475009.08 rows=291361 width=15) (actual time=0.561..15649.841 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning time: 15.868 ms
 Execution time: 20428.719 ms
(17 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3117756.35..3118588.82 rows=1 width=27) (actual time=17538.441..17538.441 rows=1 loops=1)
   ->  GroupAggregate  (cost=3117756.35..3123583.64 rows=7 width=27) (actual time=17538.441..17538.441 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3117756.35..3118484.75 rows=291361 width=27) (actual time=17478.091..17487.604 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Merge Join  (cost=2501496.40..3091311.77 rows=291361 width=27) (actual time=13830.291..17412.448 rows=311258 loops=1)
                     Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..547984.59 rows=15001277 width=20) (actual time=0.004..2636.246 rows=14999967 loops=1)
                     ->  Sort  (cost=2501453.66..2502182.06 rows=291361 width=15) (actual time=13830.244..13866.929 rows=311258 loops=1)
                           Sort Key: lineitem.l_orderkey
                           Sort Method: quicksort  Memory: 25513kB
                           ->  Seq Scan on lineitem  (cost=0.00..2475009.08 rows=291361 width=15) (actual time=0.092..13770.829 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning time: 1.156 ms
 Execution time: 17538.552 ms
(17 rows)

query 13 run 1
SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2752258.81..2752258.81 rows=1 width=16) (actual time=18509.535..18509.536 rows=1 loops=1)
   ->  Sort  (cost=2752258.81..2752259.31 rows=200 width=16) (actual time=18509.534..18509.534 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2752255.81..2752257.81 rows=200 width=16) (actual time=18509.515..18509.523 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2348217.89..2729756.61 rows=1499947 width=12) (actual time=9633.935..18303.681 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Merge Left Join  (cost=2348217.89..2640507.89 rows=14849850 width=8) (actual time=9633.918..16979.447 rows=15337604 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.63 rows=1499947 width=4) (actual time=0.250..195.250 rows=1500000 loops=1)
                                 Heap Fetches: 0
                           ->  Materialize  (cost=2348212.01..2422461.26 rows=14849850 width=8) (actual time=9633.663..14882.111 rows=14837583 loops=1)
                                 ->  Sort  (cost=2348212.01..2385336.64 rows=14849850 width=8) (actual time=9633.660..13754.648 rows=14837583 loops=1)
                                       Sort Key: orders.o_custkey
                                       Sort Method: external merge  Disk: 260704kB
                                       ->  Seq Scan on orders  (cost=0.00..448783.96 rows=14849850 width=8) (actual time=0.374..5149.267 rows=14837583 loops=1)
                                             Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                             Rows Removed by Filter: 162417
 Planning time: 13.688 ms
 Execution time: 18544.579 ms
(21 rows)

SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2752258.81..2752258.81 rows=1 width=16) (actual time=17950.583..17950.583 rows=1 loops=1)
   ->  Sort  (cost=2752258.81..2752259.31 rows=200 width=16) (actual time=17950.582..17950.582 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2752255.81..2752257.81 rows=200 width=16) (actual time=17950.563..17950.570 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2348217.89..2729756.61 rows=1499947 width=12) (actual time=9127.197..17749.821 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Merge Left Join  (cost=2348217.89..2640507.89 rows=14849850 width=8) (actual time=9127.181..16427.927 rows=15337604 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.63 rows=1499947 width=4) (actual time=0.016..155.135 rows=1500000 loops=1)
                                 Heap Fetches: 0
                           ->  Materialize  (cost=2348212.01..2422461.26 rows=14849850 width=8) (actual time=9127.160..14371.715 rows=14837583 loops=1)
                                 ->  Sort  (cost=2348212.01..2385336.64 rows=14849850 width=8) (actual time=9127.157..13243.443 rows=14837583 loops=1)
                                       Sort Key: orders.o_custkey
                                       Sort Method: external merge  Disk: 260704kB
                                       ->  Seq Scan on orders  (cost=0.00..448783.96 rows=14849850 width=8) (actual time=0.033..4667.196 rows=14837583 loops=1)
                                             Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                             Rows Removed by Filter: 162417
 Planning time: 0.585 ms
 Execution time: 17986.128 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=790675.75..790675.77 rows=1 width=32) (actual time=8074.445..8074.446 rows=1 loops=1)
   ->  Aggregate  (cost=790675.75..790675.77 rows=1 width=32) (actual time=8074.443..8074.443 rows=1 loops=1)
         ->  Hash Join  (cost=111101.13..778178.40 rows=714134 width=33) (actual time=1134.384..7567.003 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Bitmap Heap Scan on lineitem  (cost=11445.44..647163.71 rows=714134 width=16) (actual time=282.857..6046.410 rows=772942 loops=1)
                     Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                     Heap Blocks: exact=416569
                     ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11266.91 rows=714134 width=0) (actual time=186.341..186.341 rows=772942 loops=1)
                           Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60981.75..60981.75 rows=2000075 width=25) (actual time=850.228..850.228 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60981.75 rows=2000075 width=25) (actual time=0.011..541.329 rows=2000000 loops=1)
 Planning time: 15.600 ms
 Execution time: 8074.555 ms
(14 rows)

SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=790675.75..790675.77 rows=1 width=32) (actual time=4129.872..4129.872 rows=1 loops=1)
   ->  Aggregate  (cost=790675.75..790675.77 rows=1 width=32) (actual time=4129.872..4129.872 rows=1 loops=1)
         ->  Hash Join  (cost=111101.13..778178.40 rows=714134 width=33) (actual time=968.017..3661.078 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Bitmap Heap Scan on lineitem  (cost=11445.44..647163.71 rows=714134 width=16) (actual time=271.138..2364.379 rows=772942 loops=1)
                     Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                     Heap Blocks: exact=416569
                     ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11266.91 rows=714134 width=0) (actual time=175.185..175.185 rows=772942 loops=1)
                           Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60981.75..60981.75 rows=2000075 width=25) (actual time=696.149..696.149 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60981.75 rows=2000075 width=25) (actual time=0.008..395.565 rows=2000000 loops=1)
 Planning time: 0.851 ms
 Execution time: 4129.949 ms
(14 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2687534.83..2687535.37 rows=1 width=104) (actual time=22754.345..22754.345 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1222153.09..1222153.10 rows=1 width=32) (actual time=8261.889..8261.889 rows=1 loops=1)
           ->  HashAggregate  (cost=1219655.19..1220904.14 rows=99916 width=36) (actual time=8221.610..8255.147 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36918.84..1196617.85 rows=2303734 width=16) (actual time=546.469..6314.081 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 21153354
                       Heap Blocks: exact=243444 lossy=424814
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36342.90 rows=2303734 width=0) (actual time=492.700..492.700 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1465381.73..1519588.76 rows=99916 width=104) (actual time=22754.344..22754.344 rows=1 loops=1)
         Merge Cond: (lineitem.l_suppkey = supplier.s_suppkey)
         ->  GroupAggregate  (cost=1465381.44..1512954.86 rows=99916 width=36) (actual time=22732.833..22732.833 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1465381.44..1471140.78 rows=2303734 width=16) (actual time=13480.300..13779.414 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60808kB
                     ->  Bitmap Heap Scan on lineitem  (cost=36918.84..1196617.85 rows=2303734 width=16) (actual time=604.868..12563.669 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 21153354
                           Heap Blocks: exact=243444 lossy=424814
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36342.90 rows=2303734 width=0) (actual time=551.530..551.530 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=72) (actual time=0.354..17.586 rows=69998 loops=1)
 Planning time: 11.956 ms
 Execution time: 22763.365 ms
(29 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2687534.83..2687535.37 rows=1 width=104) (actual time=16898.568..16898.569 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1222153.09..1222153.10 rows=1 width=32) (actual time=8261.558..8261.558 rows=1 loops=1)
           ->  HashAggregate  (cost=1219655.19..1220904.14 rows=99916 width=36) (actual time=8221.764..8254.938 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36918.84..1196617.85 rows=2303734 width=16) (actual time=541.724..6319.471 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 21153354
                       Heap Blocks: exact=243444 lossy=424814
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36342.90 rows=2303734 width=0) (actual time=487.897..487.897 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1465381.73..1519588.76 rows=99916 width=104) (actual time=16898.567..16898.567 rows=1 loops=1)
         Merge Cond: (lineitem.l_suppkey = supplier.s_suppkey)
         ->  GroupAggregate  (cost=1465381.44..1512954.86 rows=99916 width=36) (actual time=16883.867..16883.867 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1465381.44..1471140.78 rows=2303734 width=16) (actual time=7634.323..7933.456 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60808kB
                     ->  Bitmap Heap Scan on lineitem  (cost=36918.84..1196617.85 rows=2303734 width=16) (actual time=565.122..6835.158 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 21153354
                           Heap Blocks: exact=243444 lossy=424814
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36342.90 rows=2303734 width=0) (actual time=511.901..511.901 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=72) (actual time=0.029..10.963 rows=69998 loops=1)
 Planning time: 0.937 ms
 Execution time: 16907.406 ms
(29 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=371077.42..371077.42 rows=1 width=44) (actual time=6838.048..6838.049 rows=1 loops=1)
   ->  Sort  (cost=371077.42..371465.11 rows=155077 width=44) (actual time=6838.047..6838.047 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=361166.60..370302.04 rows=155077 width=44) (actual time=5837.681..6833.183 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=361166.60..362683.54 rows=606773 width=40) (actual time=5837.615..6508.207 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60496kB
                     ->  Hash Join  (cost=98246.90..292216.39 rows=606773 width=40) (actual time=945.086..3101.956 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176373.58 rows=3999904 width=8) (actual time=37.881..1401.686 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.920..37.229 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90982.88..90982.88 rows=303405 width=40) (actual time=906.616..906.616 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90982.88 rows=303405 width=40) (actual time=0.016..839.759 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning time: 13.860 ms
 Execution time: 6846.403 ms
(26 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=371077.42..371077.42 rows=1 width=44) (actual time=6349.506..6349.507 rows=1 loops=1)
   ->  Sort  (cost=371077.42..371465.11 rows=155077 width=44) (actual time=6349.504..6349.504 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=361166.60..370302.04 rows=155077 width=44) (actual time=5345.783..6344.597 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=361166.60..362683.54 rows=606773 width=40) (actual time=5345.718..6019.141 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60496kB
                     ->  Hash Join  (cost=98246.90..292216.39 rows=606773 width=40) (actual time=646.138..2615.437 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176373.58 rows=3999904 width=8) (actual time=21.791..1215.793 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.092..21.743 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90982.88..90982.88 rows=303405 width=40) (actual time=623.729..623.729 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90982.88 rows=303405 width=40) (actual time=0.017..565.247 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning time: 0.676 ms
 Execution time: 6357.715 ms
(26 rows)

query 17 run 1
SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10826563.90..10826563.91 rows=1 width=32) (actual time=61254.719..61254.720 rows=1 loops=1)
   ->  Aggregate  (cost=10826563.90..10826563.91 rows=1 width=32) (actual time=61254.719..61254.719 rows=1 loops=1)
         ->  Merge Join  (cost=10134925.34..10826517.44 rows=18580 width=8) (actual time=31936.246..61252.345 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  GroupAggregate  (cost=10134924.34..10613036.22 rows=1877101 width=36) (actual time=31928.490..58646.086 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Sort  (cost=10134924.34..10284909.46 rows=59994048 width=9) (actual time=31928.464..48315.493 rows=59965994 loops=1)
                           Sort Key: lineitem_1.l_partkey
                           Sort Method: external merge  Disk: 1112904kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1725083.48 rows=59994048 width=9) (actual time=0.261..9316.173 rows=59986052 loops=1)
               ->  Materialize  (cost=0.99..189172.23 rows=59392 width=21) (actual time=1.359..2471.472 rows=59951 loops=1)
                     ->  Nested Loop  (cost=0.99..189023.75 rows=59392 width=21) (actual time=1.357..2451.825 rows=59951 loops=1)
                           ->  Index Scan using part_pkey on part  (cost=0.43..89213.93 rows=1980 width=4) (actual time=1.021..641.448 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.09 rows=32 width=17) (actual time=0.635..0.898 rows=30 loops=1996)
                                 Index Cond: (l_partkey = part.p_partkey)
 Planning time: 16.163 ms
 Execution time: 61377.583 ms
(21 rows)

SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10826563.90..10826563.91 rows=1 width=32) (actual time=56881.522..56881.522 rows=1 loops=1)
   ->  Aggregate  (cost=10826563.90..10826563.91 rows=1 width=32) (actual time=56881.521..56881.521 rows=1 loops=1)
         ->  Merge Join  (cost=10134925.34..10826517.44 rows=18580 width=8) (actual time=29884.681..56879.996 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  GroupAggregate  (cost=10134924.34..10613036.22 rows=1877101 width=36) (actual time=29878.163..56318.318 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Sort  (cost=10134924.34..10284909.46 rows=59994048 width=9) (actual time=29878.137..46053.585 rows=59965994 loops=1)
                           Sort Key: lineitem_1.l_partkey
                           Sort Method: external merge  Disk: 1112904kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1725083.48 rows=59994048 width=9) (actual time=0.039..7421.427 rows=59986052 loops=1)
               ->  Materialize  (cost=0.99..189172.23 rows=59392 width=21) (actual time=0.150..437.208 rows=59951 loops=1)
                     ->  Nested Loop  (cost=0.99..189023.75 rows=59392 width=21) (actual time=0.148..427.970 rows=59951 loops=1)
                           ->  Index Scan using part_pkey on part  (cost=0.43..89213.93 rows=1980 width=4) (actual time=0.136..366.066 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.09 rows=32 width=17) (actual time=0.005..0.026 rows=30 loops=1996)
                                 Index Cond: (l_partkey = part.p_partkey)
 Planning time: 0.733 ms
 Execution time: 57006.243 ms
(21 rows)

query 18 run 1
SET
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=13509854.41..13509854.66 rows=100 width=71) (actual time=40325.498..40325.511 rows=99 loops=1)
   ->  Sort  (cost=13509854.41..13584846.97 rows=29997024 width=71) (actual time=40325.496..40325.504 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  GroupAggregate  (cost=11688456.69..12363389.73 rows=29997024 width=71) (actual time=40325.230..40325.424 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Sort  (cost=11688456.69..11763449.25 rows=29997024 width=44) (actual time=40325.212..40325.257 rows=693 loops=1)
                     Sort Key: customer.c_custkey, orders.o_orderkey
                     Sort Method: quicksort  Memory: 79kB
                     ->  Hash Join  (cost=78756.51..7369875.37 rows=29997024 width=44) (actual time=4234.682..40324.975 rows=693 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Merge Join  (cost=271.71..6460026.49 rows=29997024 width=25) (actual time=967.250..39559.545 rows=693 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Merge Semi Join  (cost=1.00..3719677.01 rows=7500638 width=24) (actual time=754.730..29212.464 rows=99 loops=1)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..547984.59 rows=15001277 width=20) (actual time=0.004..2785.770 rows=14982724 loops=1)
                                       ->  Materialize  (cost=0.56..2946707.82 rows=14998512 width=4) (actual time=651.420..25594.298 rows=99 loops=1)
                                             ->  GroupAggregate  (cost=0.56..2759226.42 rows=14998512 width=4) (actual time=651.417..25594.129 rows=99 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                   Rows Removed by Filter: 14999901
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271774.78 rows=59994048 width=9) (actual time=0.003..11717.739 rows=59986052 loops=1)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2271774.78 rows=59994048 width=9) (actual time=0.008..7071.098 rows=59916431 loops=1)
                           ->  Hash  (cost=50946.47..50946.47 rows=1499947 width=23) (actual time=660.236..660.236 rows=1500000 loops=1)
                                 Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                 ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=23) (actual time=0.010..418.904 rows=1500000 loops=1)
 Planning time: 16.519 ms
 Execution time: 40325.633 ms
(28 rows)

SET
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=13509854.41..13509854.66 rows=100 width=71) (actual time=37062.071..37062.084 rows=99 loops=1)
   ->  Sort  (cost=13509854.41..13584846.97 rows=29997024 width=71) (actual time=37062.069..37062.075 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  GroupAggregate  (cost=11688456.69..12363389.73 rows=29997024 width=71) (actual time=37061.804..37061.999 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Sort  (cost=11688456.69..11763449.25 rows=29997024 width=44) (actual time=37061.786..37061.822 rows=693 loops=1)
                     Sort Key: customer.c_custkey, orders.o_orderkey
                     Sort Method: quicksort  Memory: 79kB
                     ->  Hash Join  (cost=78756.51..7369875.37 rows=29997024 width=44) (actual time=3649.712..37061.580 rows=693 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Merge Join  (cost=271.71..6460026.49 rows=29997024 width=25) (actual time=837.624..36423.721 rows=693 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Merge Semi Join  (cost=1.00..3719677.01 rows=7500638 width=24) (actual time=618.145..25980.705 rows=99 loops=1)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..547984.59 rows=15001277 width=20) (actual time=0.004..2187.256 rows=14982724 loops=1)
                                       ->  Materialize  (cost=0.56..2946707.82 rows=14998512 width=4) (actual time=543.921..22994.554 rows=99 loops=1)
                                             ->  GroupAggregate  (cost=0.56..2759226.42 rows=14998512 width=4) (actual time=543.918..22994.406 rows=99 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                   Rows Removed by Filter: 14999901
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271774.78 rows=59994048 width=9) (actual time=0.003..9324.992 rows=59986052 loops=1)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2271774.78 rows=59994048 width=9) (actual time=0.007..7194.896 rows=59916431 loops=1)
                           ->  Hash  (cost=50946.47..50946.47 rows=1499947 width=23) (actual time=532.253..532.253 rows=1500000 loops=1)
                                 Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                 ->  Seq Scan on customer  (cost=0.00..50946.47 rows=1499947 width=23) (actual time=0.010..296.051 rows=1500000 loops=1)
 Planning time: 1.580 ms
 Execution time: 37062.197 ms
(28 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=381762.48..381762.49 rows=1 width=32) (actual time=23062.365..23062.365 rows=1 loops=1)
   ->  Aggregate  (cost=381762.48..381762.49 rows=1 width=32) (actual time=23062.363..23062.363 rows=1 loops=1)
         ->  Nested Loop  (cost=0.56..381753.63 rows=1179 width=12) (actual time=57.362..23058.687 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125984.19 rows=4906 width=30) (actual time=1.019..914.615 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..52.12 rows=1 width=21) (actual time=4.180..4.630 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning time: 16.425 ms
 Execution time: 23062.818 ms
(12 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=381762.48..381762.49 rows=1 width=32) (actual time=718.111..718.112 rows=1 loops=1)
   ->  Aggregate  (cost=381762.48..381762.49 rows=1 width=32) (actual time=718.110..718.110 rows=1 loops=1)
         ->  Nested Loop  (cost=0.56..381753.63 rows=1179 width=12) (actual time=1.743..717.232 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125984.19 rows=4906 width=30) (actual time=0.251..553.793 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..52.12 rows=1 width=21) (actual time=0.031..0.034 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning time: 0.855 ms
 Execution time: 718.151 ms
(12 rows)

query 20 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2947680.23..2947680.23 rows=1 width=52) (actual time=55652.301..55652.301 rows=1 loops=1)
   ->  Sort  (cost=2947680.23..2947685.23 rows=2000 width=52) (actual time=55652.301..55652.301 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2706318.87..2947670.23 rows=2000 width=52) (actual time=33076.391..55650.550 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.261..24.282 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.008 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.253..15.782 rows=100000 loops=1)
               ->  Materialize  (cost=2706318.87..2943017.93 rows=3 width=8) (actual time=7.807..10.790 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2706318.87..2943017.91 rows=3 width=8) (actual time=31970.183..38330.015 rows=59002 loops=1)
                           Merge Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  GroupAggregate  (cost=2557821.50..2721323.29 rows=4839404 width=40) (actual time=27281.288..33299.562 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2557821.50..2580549.18 rows=9091073 width=13) (actual time=27281.273..29975.491 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205064kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=145685.56..1407194.66 rows=9091073 width=13) (actual time=1890.111..23750.068 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 27869248
                                             Heap Blocks: exact=412819 lossy=635976
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..143412.79 rows=9091073 width=0) (actual time=1796.308..1796.308 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Sort  (cost=148497.38..148699.39 rows=80807 width=16) (actual time=4688.544..4698.703 rows=86872 loops=1)
                                 Sort Key: partsupp.ps_partkey, partsupp.ps_suppkey
                                 Sort Method: quicksort  Memory: 7145kB
                                 ->  Nested Loop  (cost=0.43..141910.72 rows=80807 width=16) (actual time=0.439..4649.857 rows=86872 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65981.94 rows=20203 width=4) (actual time=0.104..511.681 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.58 rows=18 width=12) (actual time=0.174..0.189 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 18.769 ms
 Execution time: 55675.563 ms
(41 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2947680.23..2947680.23 rows=1 width=52) (actual time=38487.598..38487.599 rows=1 loops=1)
   ->  Sort  (cost=2947680.23..2947685.23 rows=2000 width=52) (actual time=38487.597..38487.597 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2706318.87..2947670.23 rows=2000 width=52) (actual time=15870.201..38485.886 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.018..20.438 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.008 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.009..12.074 rows=100000 loops=1)
               ->  Materialize  (cost=2706318.87..2943017.93 rows=3 width=8) (actual time=3.607..6.591 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2706318.87..2943017.91 rows=3 width=8) (actual time=14769.894..21137.977 rows=59002 loops=1)
                           Merge Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  GroupAggregate  (cost=2557821.50..2721323.29 rows=4839404 width=40) (actual time=14331.504..20346.240 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2557821.50..2580549.18 rows=9091073 width=13) (actual time=14331.488..17011.040 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205064kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=145685.56..1407194.66 rows=9091073 width=13) (actual time=1702.093..11101.484 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 27869248
                                             Heap Blocks: exact=412819 lossy=635976
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..143412.79 rows=9091073 width=0) (actual time=1609.000..1609.000 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Sort  (cost=148497.38..148699.39 rows=80807 width=16) (actual time=438.040..448.193 rows=86872 loops=1)
                                 Sort Key: partsupp.ps_partkey, partsupp.ps_suppkey
                                 Sort Method: quicksort  Memory: 7145kB
                                 ->  Nested Loop  (cost=0.43..141910.72 rows=80807 width=16) (actual time=0.059..416.758 rows=86872 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65981.94 rows=20203 width=4) (actual time=0.032..264.322 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.58 rows=18 width=12) (actual time=0.006..0.006 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 1.996 ms
 Execution time: 38512.353 ms
(41 rows)

query 21 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4010214.65..4010214.65 rows=1 width=34) (actual time=32492.927..32492.938 rows=100 loops=1)
   ->  Sort  (cost=4010214.65..4010214.65 rows=1 width=34) (actual time=32492.925..32492.933 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  GroupAggregate  (cost=4010214.62..4010214.64 rows=1 width=34) (actual time=32484.876..32491.623 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=4010214.62..4010214.62 rows=1 width=26) (actual time=32484.869..32487.137 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=570720.31..4010214.61 rows=1 width=26) (actual time=3497.931..32321.419 rows=39281 loops=1)
                           ->  Nested Loop Semi Join  (cost=570719.75..4010207.88 rows=1 width=34) (actual time=3480.984..30704.171 rows=704306 loops=1)
                                 Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Join Filter: 183320
                                 ->  Hash Join  (cost=570719.18..2582645.29 rows=388761 width=38) (actual time=3477.118..21001.534 rows=730985 loops=1)
                                       Hash Cond: (l1.l_orderkey = orders.o_orderkey)
                                       ->  Hash Join  (cost=2323.46..1960383.83 rows=799921 width=34) (actual time=39.457..16118.287 rows=1514267 loops=1)
                                             Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                             ->  Seq Scan on lineitem l1  (cost=0.00..1875068.60 rows=19998016 width=8) (actual time=0.011..12798.955 rows=37929348 loops=1)
                                                   Filter: (l_receiptdate > l_commitdate)
                                                   Rows Removed by Filter: 22056704
                                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=39.377..39.377 rows=3991 loops=1)
                                                   Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=1.873..38.332 rows=3991 loops=1)
                                                         ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.004..0.008 rows=1 loops=1)
                                                               Filter: (n_name = 'PERU'::bpchar)
                                                               Rows Removed by Filter: 24
                                                         ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=1.866..37.507 rows=3991 loops=1)
                                                               Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                               Heap Blocks: exact=1865
                                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=1.688..1.688 rows=3991 loops=1)
                                                                     Index Cond: (s_nationkey = nation.n_nationkey)
                                       ->  Hash  (cost=448783.96..448783.96 rows=7290621 width=4) (actual time=3432.749..3432.749 rows=7309184 loops=1)
                                             Buckets: 1048576  Batches: 16  Memory Usage: 24248kB
                                             ->  Seq Scan on orders  (cost=0.00..448783.96 rows=7290621 width=4) (actual time=0.015..2558.389 rows=7309184 loops=1)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 7690816
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.013..0.013 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 19.318 ms
 Execution time: 32493.069 ms
(44 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4010214.65..4010214.65 rows=1 width=34) (actual time=23779.226..23779.238 rows=100 loops=1)
   ->  Sort  (cost=4010214.65..4010214.65 rows=1 width=34) (actual time=23779.225..23779.232 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  GroupAggregate  (cost=4010214.62..4010214.64 rows=1 width=34) (actual time=23771.088..23777.906 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=4010214.62..4010214.62 rows=1 width=26) (actual time=23771.080..23773.312 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=570720.31..4010214.61 rows=1 width=26) (actual time=2946.454..23608.581 rows=39281 loops=1)
                           ->  Nested Loop Semi Join  (cost=570719.75..4010207.88 rows=1 width=34) (actual time=2933.631..22111.828 rows=704306 loops=1)
                                 Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                                 Rows Removed by Join Filter: 183320
                                 ->  Hash Join  (cost=570719.18..2582645.29 rows=388761 width=38) (actual time=2933.608..17918.056 rows=730985 loops=1)
                                       Hash Cond: (l1.l_orderkey = orders.o_orderkey)
                                       ->  Hash Join  (cost=2323.46..1960383.83 rows=799921 width=34) (actual time=14.837..13616.045 rows=1514267 loops=1)
                                             Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                             ->  Seq Scan on lineitem l1  (cost=0.00..1875068.60 rows=19998016 width=8) (actual time=0.009..10776.217 rows=37929348 loops=1)
                                                   Filter: (l_receiptdate > l_commitdate)
                                                   Rows Removed by Filter: 22056704
                                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=14.790..14.790 rows=3991 loops=1)
                                                   Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=0.588..14.012 rows=3991 loops=1)
                                                         ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.004..0.008 rows=1 loops=1)
                                                               Filter: (n_name = 'PERU'::bpchar)
                                                               Rows Removed by Filter: 24
                                                         ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=0.583..13.335 rows=3991 loops=1)
                                                               Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                               Heap Blocks: exact=1865
                                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.397..0.397 rows=3991 loops=1)
                                                                     Index Cond: (s_nationkey = nation.n_nationkey)
                                       ->  Hash  (cost=448783.96..448783.96 rows=7290621 width=4) (actual time=2915.275..2915.275 rows=7309184 loops=1)
                                             Buckets: 1048576  Batches: 16  Memory Usage: 24248kB
                                             ->  Seq Scan on orders  (cost=0.00..448783.96 rows=7290621 width=4) (actual time=0.015..2077.635 rows=7309184 loops=1)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 7690816
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.005..0.005 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 2.226 ms
 Execution time: 23779.377 ms
(44 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161693.68..161693.71 rows=1 width=72) (actual time=2343.645..2343.646 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75440.20..75440.21 rows=1 width=32) (actual time=1056.363..1056.363 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75320.61 rows=47837 width=6) (actual time=0.008..995.410 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86253.47..86460.85 rows=7541 width=72) (actual time=2343.644..2343.644 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86253.47..86272.32 rows=7541 width=38) (actual time=2341.410..2341.863 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85767.81 rows=7541 width=38) (actual time=1056.411..2320.633 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75320.61 rows=17499 width=26) (actual time=1056.391..1633.451 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.18 rows=18 width=4) (actual time=0.003..0.003 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 13.837 ms
 Execution time: 2344.269 ms
(20 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161693.68..161693.71 rows=1 width=72) (actual time=1710.394..1710.395 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75440.20..75440.21 rows=1 width=32) (actual time=795.550..795.550 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75320.61 rows=47837 width=6) (actual time=0.008..740.499 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86253.47..86460.85 rows=7541 width=72) (actual time=1710.392..1710.392 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86253.47..86272.32 rows=7541 width=38) (actual time=1708.163..1708.607 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85767.81 rows=7541 width=38) (actual time=795.589..1690.780 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75320.61 rows=17499 width=26) (actual time=795.576..1336.920 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.18 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 0.666 ms
 Execution time: 1710.443 ms
(20 rows)

