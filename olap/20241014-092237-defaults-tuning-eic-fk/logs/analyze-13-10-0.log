query 1 run 1
SET
SET
SET
                                                                 QUERY PLAN                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4244438.15..4244438.15 rows=1 width=236) (actual time=70362.116..70362.117 rows=1 loops=1)
   ->  Sort  (cost=4244438.15..4244438.16 rows=6 width=236) (actual time=70362.115..70362.116 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4244437.95..4244438.12 rows=6 width=236) (actual time=70362.087..70362.095 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               Batches: 1  Memory Usage: 24kB
               ->  Seq Scan on lineitem  (cost=0.00..1874935.95 rows=59237550 width=25) (actual time=0.399..11256.319 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning Time: 13.563 ms
 Execution Time: 70362.812 ms
(12 rows)

SET
SET
SET
                                                                 QUERY PLAN                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4244438.15..4244438.15 rows=1 width=236) (actual time=68568.741..68568.742 rows=1 loops=1)
   ->  Sort  (cost=4244438.15..4244438.16 rows=6 width=236) (actual time=68568.740..68568.741 rows=1 loops=1)
         Sort Key: l_returnflag, l_linestatus
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=4244437.95..4244438.12 rows=6 width=236) (actual time=68568.714..68568.722 rows=4 loops=1)
               Group Key: l_returnflag, l_linestatus
               Batches: 1  Memory Usage: 24kB
               ->  Seq Scan on lineitem  (cost=0.00..1874935.95 rows=59237550 width=25) (actual time=0.023..9493.570 rows=59284448 loops=1)
                     Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                     Rows Removed by Filter: 701604
 Planning Time: 0.544 ms
 Execution Time: 68568.797 ms
(12 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1158979.08..1158979.08 rows=1 width=193) (actual time=4931.097..4931.114 rows=100 loops=1)
   ->  Sort  (cost=1158979.08..1158979.08 rows=1 width=193) (actual time=4931.095..4931.106 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=557795.85..1158979.07 rows=1 width=193) (actual time=3118.235..4928.182 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89212.07 rows=8975 width=30) (actual time=0.580..786.498 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=557795.42..565797.51 rows=1600417 width=173) (actual time=3116.412..3578.293 rows=1603828 loops=1)
                     ->  Sort  (cost=557795.42..561796.46 rows=1600417 width=173) (actual time=3116.408..3396.388 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..304958.07 rows=1600417 width=173) (actual time=43.788..2448.389 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255242.85 rows=8002085 width=14) (actual time=0.521..1072.705 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=167) (actual time=43.240..43.242 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=167) (actual time=0.830..37.571 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.451..25.567 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.374..0.375 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.362..0.372 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.170..0.173 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.183..0.184 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.178..0.180 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.59..69.60 rows=1 width=32) (actual time=0.059..0.059 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.58 rows=4 width=6) (actual time=0.048..0.057 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.28 rows=19 width=10) (actual time=0.042..0.055 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.66 rows=19 width=10) (actual time=0.042..0.053 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.038..0.039 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.026..0.027 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.021 rows=25 loops=1)
 Planning Time: 21.734 ms
 Execution Time: 4968.796 ms
(53 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1158979.08..1158979.08 rows=1 width=193) (actual time=3884.217..3884.234 rows=100 loops=1)
   ->  Sort  (cost=1158979.08..1158979.08 rows=1 width=193) (actual time=3884.216..3884.226 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=557795.85..1158979.07 rows=1 width=193) (actual time=2687.800..3881.886 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89212.07 rows=8975 width=30) (actual time=0.016..474.692 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=557795.42..565797.51 rows=1600417 width=173) (actual time=2687.687..3122.986 rows=1603828 loops=1)
                     ->  Sort  (cost=557795.42..561796.46 rows=1600417 width=173) (actual time=2687.685..2945.884 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..304958.07 rows=1600417 width=173) (actual time=25.535..2035.640 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255242.85 rows=8002085 width=14) (actual time=0.037..771.618 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=167) (actual time=25.482..25.485 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=167) (actual time=0.037..20.309 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.010..5.839 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.025..0.027 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.019..0.025 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.003 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.014 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.59..69.60 rows=1 width=32) (actual time=0.017..0.017 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.58 rows=4 width=6) (actual time=0.009..0.015 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.28 rows=19 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.66 rows=19 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.002..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.011 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 1.769 ms
 Execution Time: 3921.081 ms
(53 rows)

query 3 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3178067.38..3178067.41 rows=10 width=44) (actual time=27099.543..27099.548 rows=10 loops=1)
   ->  Sort  (cost=3178067.38..3185863.61 rows=3118490 width=44) (actual time=27099.542..27099.546 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  HashAggregate  (cost=3035152.00..3110677.93 rows=3118490 width=44) (actual time=26988.284..27080.406 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               Planned Partitions: 32  Batches: 33  Memory Usage: 35089kB  Disk Usage: 2056kB
               ->  Hash Join  (cost=519132.62..2871187.65 rows=3118490 width=24) (actual time=7296.612..26797.966 rows=301530 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1874935.95 rows=32473380 width=16) (actual time=0.457..11313.334 rows=32534229 loops=1)
                           Filter: (l_shipdate > '1995-03-07'::date)
                           Rows Removed by Filter: 27451823
                     ->  Hash  (cost=494090.04..494090.04 rows=1440607 width=12) (actual time=7293.204..7293.206 rows=1451805 loops=1)
                           Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                           ->  Hash Join  (cost=123639.37..494090.04 rows=1440607 width=12) (actual time=1052.436..6973.633 rows=1451805 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=65201.74..416703.31 rows=7218685 width=16) (actual time=539.111..4808.849 rows=7239437 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                       Heap Blocks: exact=261268
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..63397.07 rows=7218685 width=0) (actual time=494.508..494.508 rows=7239437 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-07'::date)
                                 ->  Hash  (cost=54695.96..54695.96 rows=299333 width=4) (actual time=512.581..512.582 rows=300276 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                       ->  Seq Scan on customer  (cost=0.00..54695.96 rows=299333 width=4) (actual time=0.480..459.778 rows=300276 loops=1)
                                             Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                             Rows Removed by Filter: 1199724
 Planning Time: 20.144 ms
 Execution Time: 27101.129 ms
(28 rows)

SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3178067.38..3178067.41 rows=10 width=44) (actual time=22309.721..22309.726 rows=10 loops=1)
   ->  Sort  (cost=3178067.38..3185863.61 rows=3118490 width=44) (actual time=22309.720..22309.724 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  HashAggregate  (cost=3035152.00..3110677.93 rows=3118490 width=44) (actual time=22198.231..22290.176 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               Planned Partitions: 32  Batches: 33  Memory Usage: 35089kB  Disk Usage: 2056kB
               ->  Hash Join  (cost=519132.62..2871187.65 rows=3118490 width=24) (actual time=4642.957..22017.782 rows=301530 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     ->  Seq Scan on lineitem  (cost=0.00..1874935.95 rows=32473380 width=16) (actual time=0.029..9354.479 rows=32534229 loops=1)
                           Filter: (l_shipdate > '1995-03-07'::date)
                           Rows Removed by Filter: 27451823
                     ->  Hash  (cost=494090.04..494090.04 rows=1440607 width=12) (actual time=4641.118..4641.120 rows=1451805 loops=1)
                           Buckets: 1048576  Batches: 4  Memory Usage: 23817kB
                           ->  Hash Join  (cost=123639.37..494090.04 rows=1440607 width=12) (actual time=887.234..4363.777 rows=1451805 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Bitmap Heap Scan on orders  (cost=65201.74..416703.31 rows=7218685 width=16) (actual time=508.675..2434.884 rows=7239437 loops=1)
                                       Recheck Cond: (o_orderdate < '1995-03-07'::date)
                                       Heap Blocks: exact=261268
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..63397.07 rows=7218685 width=0) (actual time=464.794..464.794 rows=7239437 loops=1)
                                             Index Cond: (o_orderdate < '1995-03-07'::date)
                                 ->  Hash  (cost=54695.96..54695.96 rows=299333 width=4) (actual time=377.793..377.794 rows=300276 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                       ->  Seq Scan on customer  (cost=0.00..54695.96 rows=299333 width=4) (actual time=0.028..327.948 rows=300276 loops=1)
                                             Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                             Rows Removed by Filter: 1199724
 Planning Time: 1.227 ms
 Execution Time: 22311.137 ms
(28 rows)

query 4 run 1
SET
SET
SET
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2080065.33..2080065.33 rows=1 width=24) (actual time=18582.201..18582.203 rows=1 loops=1)
   ->  Sort  (cost=2080065.33..2080065.34 rows=5 width=24) (actual time=18582.199..18582.200 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2080065.25..2080065.30 rows=5 width=24) (actual time=18582.170..18582.172 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               Batches: 1  Memory Usage: 24kB
               ->  Nested Loop Semi Join  (cost=6522.06..2077239.42 rows=565167 width=16) (actual time=105.506..18310.219 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=6521.50..276270.08 rows=565372 width=20) (actual time=104.932..4957.103 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6380.16 rows=565372 width=0) (actual time=65.044..65.044 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.023..0.023 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning Time: 15.523 ms
 Execution Time: 18582.531 ms
(19 rows)

SET
SET
SET
                                                                             QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2080065.33..2080065.33 rows=1 width=24) (actual time=4562.875..4562.877 rows=1 loops=1)
   ->  Sort  (cost=2080065.33..2080065.34 rows=5 width=24) (actual time=4562.874..4562.875 rows=1 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2080065.25..2080065.30 rows=5 width=24) (actual time=4562.853..4562.855 rows=5 loops=1)
               Group Key: orders.o_orderpriority
               Batches: 1  Memory Usage: 24kB
               ->  Nested Loop Semi Join  (cost=6522.06..2077239.42 rows=565167 width=16) (actual time=104.216..4384.653 rows=513822 loops=1)
                     ->  Bitmap Heap Scan on orders  (cost=6521.50..276270.08 rows=565372 width=20) (actual time=104.187..1219.903 rows=560424 loops=1)
                           Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                           Heap Blocks: exact=231887
                           ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6380.16 rows=565372 width=0) (actual time=64.741..64.741 rows=560424 loops=1)
                                 Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                     ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.005..0.005 rows=1 loops=560424)
                           Index Cond: (l_orderkey = orders.o_orderkey)
                           Filter: (l_commitdate < l_receiptdate)
                           Rows Removed by Filter: 1
 Planning Time: 1.130 ms
 Execution Time: 4562.936 ms
(19 rows)

query 5 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2037766.39..2037766.39 rows=1 width=58) (actual time=21800.294..21800.301 rows=1 loops=1)
   ->  Sort  (cost=2037766.39..2037766.45 rows=25 width=58) (actual time=21800.293..21800.299 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2036876.45..2037766.26 rows=25 width=58) (actual time=21774.576..21800.279 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2036876.45..2037054.35 rows=71160 width=38) (actual time=21768.096..21771.538 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=93699.69..2031141.39 rows=71160 width=38) (actual time=879.474..21721.496 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=88978.69..2017080.62 rows=1779001 width=50) (actual time=830.148..21203.651 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=88978.13..396405.68 rows=444911 width=38) (actual time=829.459..6868.242 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=25655.14..320291.50 rows=2224557 width=8) (actual time=219.286..5560.006 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25099.01 rows=2224557 width=0) (actual time=174.889..174.889 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59573.20..59573.20 rows=299983 width=38) (actual time=609.720..609.723 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.51..59573.20 rows=299983 width=38) (actual time=1.332..546.101 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=8) (actual time=0.669..378.696 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.655..0.658 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.650..0.655 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.317..0.318 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.327..0.327 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.322..0.323 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.028..0.030 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=44.313..44.314 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.399..29.276 rows=100000 loops=1)
 Planning Time: 25.047 ms
 Execution Time: 21801.680 ms
(41 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2037766.39..2037766.39 rows=1 width=58) (actual time=6152.543..6152.549 rows=1 loops=1)
   ->  Sort  (cost=2037766.39..2037766.45 rows=25 width=58) (actual time=6152.541..6152.547 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2036876.45..2037766.26 rows=25 width=58) (actual time=6127.051..6152.529 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=2036876.45..2037054.35 rows=71160 width=38) (actual time=6120.577..6124.013 rows=72033 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 8700kB
                     ->  Hash Join  (cost=93699.69..2031141.39 rows=71160 width=38) (actual time=725.708..6087.538 rows=72033 loops=1)
                           Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                           ->  Nested Loop  (cost=88978.69..2017080.62 rows=1779001 width=50) (actual time=686.678..5626.133 rows=1815327 loops=1)
                                 ->  Hash Join  (cost=88978.13..396405.68 rows=444911 width=38) (actual time=686.655..2628.603 rows=453399 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Bitmap Heap Scan on orders  (cost=25655.14..320291.50 rows=2224557 width=8) (actual time=208.380..1549.601 rows=2276638 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                             Heap Blocks: exact=261246
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25099.01 rows=2224557 width=0) (actual time=164.696..164.696 rows=2276638 loops=1)
                                                   Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                       ->  Hash  (cost=59573.20..59573.20 rows=299983 width=38) (actual time=477.925..477.928 rows=299436 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                             ->  Hash Join  (cost=2.51..59573.20 rows=299983 width=38) (actual time=0.056..417.131 rows=299436 loops=1)
                                                   Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                   ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=8) (actual time=0.018..256.031 rows=1500000 loops=1)
                                                   ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.033..0.035 rows=5 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.027..0.033 rows=5 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.008..0.009 rows=25 loops=1)
                                                               ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.015..0.015 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=1)
                                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                                           Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.005..0.006 rows=4 loops=453399)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=38.482..38.482 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.021..21.752 rows=100000 loops=1)
 Planning Time: 3.468 ms
 Execution Time: 6152.750 ms
(41 rows)

query 6 run 1
SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1975660.00..1975660.01 rows=1 width=32) (actual time=14902.433..14902.434 rows=1 loops=1)
   ->  Aggregate  (cost=1975660.00..1975660.01 rows=1 width=32) (actual time=14902.432..14902.432 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=213293.98..1969642.73 rows=1203452 width=12) (actual time=1346.583..14180.002 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 13724091
               Heap Blocks: exact=395900 lossy=267068
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212993.12 rows=1203452 width=0) (actual time=1274.366..1274.366 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 11.398 ms
 Execution Time: 14903.553 ms
(10 rows)

SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1975660.00..1975660.01 rows=1 width=32) (actual time=6424.238..6424.239 rows=1 loops=1)
   ->  Aggregate  (cost=1975660.00..1975660.01 rows=1 width=32) (actual time=6424.236..6424.237 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=213293.98..1969642.73 rows=1203452 width=12) (actual time=1214.794..6089.124 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 13724091
               Heap Blocks: exact=395900 lossy=267068
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212993.12 rows=1203452 width=0) (actual time=1143.546..1143.546 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.625 ms
 Execution Time: 6424.437 ms
(10 rows)

query 7 run 1
SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2718197.37..2718197.49 rows=1 width=92) (actual time=19191.252..19191.258 rows=1 loops=1)
   ->  GroupAggregate  (cost=2718197.37..2719436.12 rows=10012 width=92) (actual time=19191.251..19191.256 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2718197.37..2718349.30 rows=60774 width=72) (actual time=19183.370..19184.105 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=563423.72..2713368.52 rows=60774 width=72) (actual time=5191.848..19154.913 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=3629.40..2111581.44 rows=1460352 width=46) (actual time=36.800..13195.646 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on lineitem  (cost=0.00..2024894.54 rows=18254396 width=24) (actual time=0.367..10905.258 rows=18230325 loops=1)
                                 Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Filter: 41755727
                           ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=36.204..36.206 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.484..34.819 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.284..24.865 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.192..0.193 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.184..0.188 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=536589.02..536589.02 rows=1200104 width=30) (actual time=5151.105..5151.107 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=57052.23..536589.02 rows=1200104 width=30) (actual time=542.237..4895.728 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411280.94 rows=15001294 width=8) (actual time=0.618..1712.656 rows=15000000 loops=1)
                                 ->  Hash  (cost=55552.32..55552.32 rows=119993 width=30) (actual time=541.521..541.522 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..55552.32 rows=119993 width=30) (actual time=0.534..515.961 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=8) (actual time=0.484..370.874 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.029..0.030 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.020..0.024 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning Time: 25.177 ms
 Execution Time: 19192.038 ms
(42 rows)

SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2718197.37..2718197.49 rows=1 width=92) (actual time=15992.261..15992.268 rows=1 loops=1)
   ->  GroupAggregate  (cost=2718197.37..2719436.12 rows=10012 width=92) (actual time=15992.260..15992.266 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=2718197.37..2718349.30 rows=60774 width=72) (actual time=15984.336..15985.072 rows=14421 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 9664kB
               ->  Hash Join  (cost=563423.72..2713368.52 rows=60774 width=72) (actual time=4260.817..15957.405 rows=57794 loops=1)
                     Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                     Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                     Rows Removed by Join Filter: 58158
                     ->  Hash Join  (cost=3629.40..2111581.44 rows=1460352 width=46) (actual time=19.272..10973.123 rows=1455694 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Seq Scan on lineitem  (cost=0.00..2024894.54 rows=18254396 width=24) (actual time=0.031..9057.526 rows=18230325 loops=1)
                                 Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                 Rows Removed by Filter: 41755727
                           ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=19.223..19.225 rows=7981 loops=1)
                                 Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                 ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.242..18.175 rows=7981 loops=1)
                                       Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                       ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.009..5.697 rows=100000 loops=1)
                                       ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.011..0.012 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.006..0.008 rows=2 loops=1)
                                                   Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                   Rows Removed by Filter: 23
                     ->  Hash  (cost=536589.02..536589.02 rows=1200104 width=30) (actual time=4239.341..4239.344 rows=1191175 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 22152kB
                           ->  Hash Join  (cost=57052.23..536589.02 rows=1200104 width=30) (actual time=290.938..4000.515 rows=1191175 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..411280.94 rows=15001294 width=8) (actual time=0.031..1277.020 rows=15000000 loops=1)
                                 ->  Hash  (cost=55552.32..55552.32 rows=119993 width=30) (actual time=290.841..290.842 rows=119622 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                       ->  Hash Join  (cost=1.40..55552.32 rows=119993 width=30) (actual time=0.025..270.358 rows=119622 loops=1)
                                             Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=8) (actual time=0.003..85.891 rows=1500000 loops=1)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.012..0.013 rows=2 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.008..0.009 rows=2 loops=1)
                                                         Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning Time: 2.223 ms
 Execution Time: 15992.410 ms
(42 rows)

query 8 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1238481.56..1238481.81 rows=1 width=40) (actual time=59955.545..59955.552 rows=1 loops=1)
   ->  GroupAggregate  (cost=1238481.56..1239075.07 rows=2406 width=40) (actual time=59955.544..59955.550 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1238481.56..1238541.49 rows=23972 width=46) (actual time=59950.393..59950.864 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=880280.30..1236737.71 rows=23972 width=46) (actual time=54510.552..59939.135 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 287513
                     ->  Hash Join  (cost=880280.30..1227959.00 rows=23972 width=20) (actual time=54510.510..59887.990 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=875809.30..1223425.07 rows=23972 width=20) (actual time=54466.308..59832.890 rows=23842 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=812486.31..1159412.90 rows=119859 width=24) (actual time=53880.146..59215.629 rows=118593 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                       ->  Bitmap Heap Scan on orders  (cost=51948.40..380784.39 rows=4504533 width=12) (actual time=363.482..4748.307 rows=4557513 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..50822.26 rows=4504533 width=0) (actual time=318.701..318.701 rows=4557513 loops=1)
                                                   Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                       ->  Hash  (cost=755548.38..755548.38 rows=399163 width=20) (actual time=53516.340..53516.341 rows=389521 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25019kB
                                             ->  Nested Loop  (cost=0.44..755548.38 rows=399163 width=20) (actual time=2.063..53062.066 rows=389521 loops=1)
                                                   ->  Seq Scan on part  (cost=0.00..65980.77 rows=13309 width=4) (actual time=1.424..604.243 rows=13011 loops=1)
                                                         Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                         Rows Removed by Filter: 1986989
                                                   ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.48 rows=33 width=24) (actual time=0.251..4.011 rows=30 loops=13011)
                                                         Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=59573.20..59573.20 rows=299983 width=4) (actual time=585.569..585.572 rows=299436 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                       ->  Hash Join  (cost=2.51..59573.20 rows=299983 width=4) (actual time=1.424..535.308 rows=299436 loops=1)
                                             Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=8) (actual time=0.685..374.094 rows=1500000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.732..0.733 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.727..0.732 rows=5 loops=1)
                                                         Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.421..0.423 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.299..0.299 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.295..0.296 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=44.156..44.156 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.434..29.416 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.013..0.018 rows=25 loops=1)
 Planning Time: 30.671 ms
 Execution Time: 59956.482 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1238481.56..1238481.81 rows=1 width=40) (actual time=5069.902..5069.908 rows=1 loops=1)
   ->  GroupAggregate  (cost=1238481.56..1239075.07 rows=2406 width=40) (actual time=5069.901..5069.907 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=1238481.56..1238541.49 rows=23972 width=46) (actual time=5064.859..5065.325 rows=11818 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 2631kB
               ->  Nested Loop  (cost=880280.30..1236737.71 rows=23972 width=46) (actual time=2847.053..5057.487 rows=23842 loops=1)
                     Join Filter: (supplier.s_nationkey = n2.n_nationkey)
                     Rows Removed by Join Filter: 287513
                     ->  Hash Join  (cost=880280.30..1227959.00 rows=23972 width=20) (actual time=2847.031..5016.415 rows=23842 loops=1)
                           Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                           ->  Hash Join  (cost=875809.30..1223425.07 rows=23972 width=20) (actual time=2810.075..4969.628 rows=23842 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Hash Join  (cost=812486.31..1159412.90 rows=119859 width=24) (actual time=2362.114..4493.513 rows=118593 loops=1)
                                       Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                       ->  Bitmap Heap Scan on orders  (cost=51948.40..380784.39 rows=4504533 width=12) (actual time=344.403..1611.505 rows=4557513 loops=1)
                                             Recheck Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                             Heap Blocks: exact=261268
                                             ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..50822.26 rows=4504533 width=0) (actual time=300.248..300.249 rows=4557513 loops=1)
                                                   Index Cond: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                       ->  Hash  (cost=755548.38..755548.38 rows=399163 width=20) (actual time=2017.380..2017.382 rows=389521 loops=1)
                                             Buckets: 524288  Batches: 1  Memory Usage: 25019kB
                                             ->  Nested Loop  (cost=0.44..755548.38 rows=399163 width=20) (actual time=0.101..1898.112 rows=389521 loops=1)
                                                   ->  Seq Scan on part  (cost=0.00..65980.77 rows=13309 width=4) (actual time=0.073..315.086 rows=13011 loops=1)
                                                         Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                         Rows Removed by Filter: 1986989
                                                   ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.48 rows=33 width=24) (actual time=0.009..0.116 rows=30 loops=13011)
                                                         Index Cond: (l_partkey = part.p_partkey)
                                 ->  Hash  (cost=59573.20..59573.20 rows=299983 width=4) (actual time=447.304..447.306 rows=299436 loops=1)
                                       Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                       ->  Hash Join  (cost=2.51..59573.20 rows=299983 width=4) (actual time=0.069..398.744 rows=299436 loops=1)
                                             Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                             ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=8) (actual time=0.021..244.366 rows=1500000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.040..0.041 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.034..0.040 rows=5 loops=1)
                                                         Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.013..0.014 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.016..0.016 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
                           ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=36.908..36.908 rows=100000 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                 ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.019..21.246 rows=100000 loops=1)
                     ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.000 rows=13 loops=23842)
                           ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.007..0.010 rows=25 loops=1)
 Planning Time: 3.935 ms
 Execution Time: 5070.223 ms
(50 rows)

query 9 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2551229.23..2551229.23 rows=1 width=66) (actual time=123216.070..123216.075 rows=1 loops=1)
   ->  Sort  (cost=2551229.23..2551379.60 rows=60150 width=66) (actual time=123216.068..123216.073 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2549875.85..2550928.48 rows=60150 width=66) (actual time=123215.539..123215.985 rows=175 loops=1)
               Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
               Batches: 1  Memory Usage: 3217kB
               ->  Hash Join  (cost=1799170.90..2496860.28 rows=3029461 width=57) (actual time=111931.098..120745.647 rows=3248192 loops=1)
                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=1799169.34..2472410.98 rows=3029461 width=31) (actual time=111929.879..119808.259 rows=3248192 loops=1)
                           Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Seq Scan on orders  (cost=0.00..411280.94 rows=15001294 width=8) (actual time=0.467..2430.974 rows=15000000 loops=1)
                           ->  Hash  (cost=1740591.08..1740591.08 rows=3029461 width=31) (actual time=111928.477..111928.480 rows=3248192 loops=1)
                                 Buckets: 524288  Batches: 8  Memory Usage: 30530kB
                                 ->  Nested Loop  (cost=71714.83..1740591.08 rows=3029461 width=31) (actual time=732.624..109894.329 rows=3248192 loops=1)
                                       Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                                       ->  Hash Join  (cost=71714.39..349023.68 rows=404145 width=26) (actual time=731.749..3431.592 rows=433248 loops=1)
                                             Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                             ->  Hash Join  (cost=67243.39..343491.76 rows=404145 width=18) (actual time=687.711..3170.481 rows=433248 loops=1)
                                                   Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                                   ->  Seq Scan on partsupp  (cost=0.00..255242.85 rows=8002085 width=14) (actual time=0.546..1345.124 rows=8000000 loops=1)
                                                   ->  Hash  (cost=65980.77..65980.77 rows=101009 width=4) (actual time=686.749..686.750 rows=108312 loops=1)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4832kB
                                                         ->  Seq Scan on part  (cost=0.00..65980.77 rows=101009 width=4) (actual time=0.598..662.843 rows=108312 loops=1)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 1891688
                                             ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=43.945..43.946 rows=100000 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.366..29.165 rows=100000 loops=1)
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.035..0.242 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.311..0.311 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.293..0.298 rows=25 loops=1)
 Planning Time: 30.198 ms
 Execution Time: 123217.769 ms
(36 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2551229.23..2551229.23 rows=1 width=66) (actual time=35193.270..35193.275 rows=1 loops=1)
   ->  Sort  (cost=2551229.23..2551379.60 rows=60150 width=66) (actual time=35193.268..35193.273 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2549875.85..2550928.48 rows=60150 width=66) (actual time=35192.733..35193.182 rows=175 loops=1)
               Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
               Batches: 1  Memory Usage: 3217kB
               ->  Hash Join  (cost=1799170.90..2496860.28 rows=3029461 width=57) (actual time=24412.983..32739.730 rows=3248192 loops=1)
                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                     ->  Hash Join  (cost=1799169.34..2472410.98 rows=3029461 width=31) (actual time=24412.606..31804.777 rows=3248192 loops=1)
                           Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Seq Scan on orders  (cost=0.00..411280.94 rows=15001294 width=8) (actual time=0.299..1986.467 rows=15000000 loops=1)
                           ->  Hash  (cost=1740591.08..1740591.08 rows=3029461 width=31) (actual time=24411.421..24411.425 rows=3248192 loops=1)
                                 Buckets: 524288  Batches: 8  Memory Usage: 30530kB
                                 ->  Nested Loop  (cost=71714.83..1740591.08 rows=3029461 width=31) (actual time=682.371..23018.540 rows=3248192 loops=1)
                                       Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                                       ->  Hash Join  (cost=71714.39..349023.68 rows=404145 width=26) (actual time=681.666..2822.249 rows=433248 loops=1)
                                             Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                             ->  Hash Join  (cost=67243.39..343491.76 rows=404145 width=18) (actual time=638.748..2596.680 rows=433248 loops=1)
                                                   Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                                   ->  Seq Scan on partsupp  (cost=0.00..255242.85 rows=8002085 width=14) (actual time=0.442..951.603 rows=8000000 loops=1)
                                                   ->  Hash  (cost=65980.77..65980.77 rows=101009 width=4) (actual time=637.922..637.923 rows=108312 loops=1)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4832kB
                                                         ->  Seq Scan on part  (cost=0.00..65980.77 rows=101009 width=4) (actual time=0.413..614.651 rows=108312 loops=1)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 1891688
                                             ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.829..42.830 rows=100000 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.404..27.672 rows=100000 loops=1)
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.008..0.044 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.354..0.354 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.343..0.346 rows=25 loops=1)
 Planning Time: 19.411 ms
 Execution Time: 35194.104 ms
(36 rows)

query 10 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2453161.97..2453162.02 rows=20 width=201) (actual time=21094.477..21094.485 rows=20 loops=1)
   ->  Sort  (cost=2453161.97..2454651.13 rows=595662 width=201) (actual time=21094.476..21094.482 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  HashAggregate  (cost=2399617.39..2437311.62 rows=595662 width=201) (actual time=20206.917..20986.461 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               Planned Partitions: 16  Batches: 17  Memory Usage: 33937kB  Disk Usage: 200712kB
               ->  Hash Join  (cost=2255753.83..2334885.68 rows=595662 width=181) (actual time=18085.098..19285.362 rows=1145402 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Merge Join  (cost=2255752.26..2333055.44 rows=595662 width=159) (actual time=18084.772..19077.128 rows=1145402 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Scan using customer_pkey on customer  (cost=0.43..64620.68 rows=1499917 width=147) (actual time=0.479..489.830 rows=1499997 loops=1)
                           ->  Sort  (cost=2255751.68..2257240.83 rows=595662 width=16) (actual time=18084.272..18198.386 rows=1145402 loops=1)
                                 Sort Key: orders.o_custkey
                                 Sort Method: external sort  Disk: 35288kB
                                 ->  Hash Join  (cost=284845.39..2198615.38 rows=595662 width=16) (actual time=4879.734..17519.842 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1874935.95 rows=14793915 width=16) (actual time=0.456..10837.734 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=277295.24..277295.24 rows=604012 width=8) (actual time=4877.309..4877.310 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=6967.06..277295.24 rows=604012 width=8) (actual time=105.182..4701.534 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6816.06 rows=604012 width=0) (actual time=65.455..65.455 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.320..0.320 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.311..0.314 rows=25 loops=1)
 Planning Time: 23.891 ms
 Execution Time: 21126.435 ms
(32 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2453161.97..2453162.02 rows=20 width=201) (actual time=15514.996..15515.004 rows=20 loops=1)
   ->  Sort  (cost=2453161.97..2454651.13 rows=595662 width=201) (actual time=15514.995..15515.000 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  HashAggregate  (cost=2399617.39..2437311.62 rows=595662 width=201) (actual time=14627.195..15407.974 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               Planned Partitions: 16  Batches: 17  Memory Usage: 33937kB  Disk Usage: 200712kB
               ->  Hash Join  (cost=2255753.83..2334885.68 rows=595662 width=181) (actual time=12649.889..13718.197 rows=1145402 loops=1)
                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                     ->  Merge Join  (cost=2255752.26..2333055.44 rows=595662 width=159) (actual time=12649.859..13513.735 rows=1145402 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Scan using customer_pkey on customer  (cost=0.43..64620.68 rows=1499917 width=147) (actual time=0.012..368.417 rows=1499997 loops=1)
                           ->  Sort  (cost=2255751.68..2257240.83 rows=595662 width=16) (actual time=12649.834..12762.896 rows=1145402 loops=1)
                                 Sort Key: orders.o_custkey
                                 Sort Method: external sort  Disk: 35288kB
                                 ->  Hash Join  (cost=284845.39..2198615.38 rows=595662 width=16) (actual time=1584.086..12092.259 rows=1145402 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Seq Scan on lineitem  (cost=0.00..1874935.95 rows=14793915 width=16) (actual time=0.014..8787.517 rows=14808183 loops=1)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 45177869
                                       ->  Hash  (cost=277295.24..277295.24 rows=604012 width=8) (actual time=1582.692..1582.693 rows=573160 loops=1)
                                             Buckets: 1048576  Batches: 1  Memory Usage: 30582kB
                                             ->  Bitmap Heap Scan on orders  (cost=6967.06..277295.24 rows=604012 width=8) (actual time=104.157..1454.683 rows=573160 loops=1)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=233346
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6816.06 rows=604012 width=0) (actual time=65.014..65.014 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                     ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.023..0.024 rows=25 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.015..0.018 rows=25 loops=1)
 Planning Time: 1.692 ms
 Execution Time: 15545.602 ms
(32 rows)

query 11 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=609741.01..609741.02 rows=1 width=36) (actual time=3860.198..3860.203 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293094.53..293094.55 rows=1 width=32) (actual time=1537.854..1537.857 rows=1 loops=1)
           ->  Hash Join  (cost=2311.46..290693.91 rows=320083 width=10) (actual time=2.673..1454.629 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255242.85 rows=8002085 width=14) (actual time=0.018..730.441 rows=8000000 loops=1)
                 ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=2.625..2.626 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.445..2.265 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.434..1.928 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.256..0.257 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=316646.47..316913.20 rows=106694 width=36) (actual time=3860.196..3860.199 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  HashAggregate  (cost=307385.74..316113.00 rows=106694 width=36) (actual time=3860.179..3860.181 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Planned Partitions: 8  Batches: 9  Memory Usage: 34897kB  Disk Usage: 9736kB
               Rows Removed by Filter: 301833
               ->  Hash Join  (cost=2311.46..290693.91 rows=320083 width=14) (actual time=43.282..1919.054 rows=320800 loops=1)
                     Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                     ->  Seq Scan on partsupp  (cost=0.00..255242.85 rows=8002085 width=18) (actual time=0.541..1068.201 rows=8000000 loops=1)
                     ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=42.670..42.671 rows=4010 loops=1)
                           Buckets: 4096  Batches: 1  Memory Usage: 173kB
                           ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=1.705..41.225 rows=4010 loops=1)
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.375..0.379 rows=1 loops=1)
                                       Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                       Rows Removed by Filter: 24
                                 ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=8) (actual time=1.322..39.980 rows=4010 loops=1)
                                       Recheck Cond: (s_nationkey = nation.n_nationkey)
                                       Heap Blocks: exact=1869
                                       ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.926..0.926 rows=4010 loops=1)
                                             Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 14.350 ms
 Execution Time: 3863.313 ms
(41 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=609741.01..609741.02 rows=1 width=36) (actual time=3408.777..3408.783 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=293094.53..293094.55 rows=1 width=32) (actual time=1538.801..1538.804 rows=1 loops=1)
           ->  Hash Join  (cost=2311.46..290693.91 rows=320083 width=10) (actual time=2.670..1454.948 rows=320800 loops=1)
                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..255242.85 rows=8002085 width=14) (actual time=0.018..729.900 rows=8000000 loops=1)
                 ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=2.623..2.625 rows=4010 loops=1)
                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                       ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.440..2.250 rows=4010 loops=1)
                             ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.007 rows=1 loops=1)
                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                   Rows Removed by Filter: 24
                             ->  Bitmap Heap Scan on supplier supplier_1  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.431..1.913 rows=4010 loops=1)
                                   Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                   Heap Blocks: exact=1869
                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.254..0.254 rows=4010 loops=1)
                                         Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=316646.47..316913.20 rows=106694 width=36) (actual time=3408.776..3408.779 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  HashAggregate  (cost=307385.74..316113.00 rows=106694 width=36) (actual time=3408.762..3408.765 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Planned Partitions: 8  Batches: 9  Memory Usage: 34897kB  Disk Usage: 9736kB
               Rows Removed by Filter: 301833
               ->  Hash Join  (cost=2311.46..290693.91 rows=320083 width=14) (actual time=3.498..1476.812 rows=320800 loops=1)
                     Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                     ->  Seq Scan on partsupp  (cost=0.00..255242.85 rows=8002085 width=18) (actual time=0.024..743.419 rows=8000000 loops=1)
                     ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=3.449..3.450 rows=4010 loops=1)
                           Buckets: 4096  Batches: 1  Memory Usage: 173kB
                           ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.436..3.068 rows=4010 loops=1)
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.008 rows=1 loops=1)
                                       Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                       Rows Removed by Filter: 24
                                 ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.426..2.709 rows=4010 loops=1)
                                       Recheck Cond: (s_nationkey = nation.n_nationkey)
                                       Heap Blocks: exact=1869
                                       ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.243..0.244 rows=4010 loops=1)
                                             Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 0.951 ms
 Execution Time: 3410.463 ms
(41 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3031899.67..3032740.16 rows=1 width=27) (actual time=18984.598..18984.601 rows=1 loops=1)
   ->  GroupAggregate  (cost=3031899.67..3037783.14 rows=7 width=27) (actual time=18984.597..18984.599 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3031899.67..3032635.09 rows=294170 width=27) (actual time=18940.928..18947.091 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Hash Join  (cost=2478447.44..3005179.78 rows=294170 width=27) (actual time=14773.418..18870.182 rows=311258 loops=1)
                     Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Seq Scan on orders  (cost=0.00..411280.94 rows=15001294 width=20) (actual time=0.508..1649.032 rows=15000000 loops=1)
                     ->  Hash  (cost=2474770.31..2474770.31 rows=294170 width=15) (actual time=14772.123..14772.124 rows=311258 loops=1)
                           Buckets: 524288  Batches: 1  Memory Usage: 18687kB
                           ->  Seq Scan on lineitem  (cost=0.00..2474770.31 rows=294170 width=15) (actual time=1.348..14687.875 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning Time: 16.558 ms
 Execution Time: 18985.637 ms
(16 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3031899.67..3032740.16 rows=1 width=27) (actual time=16303.968..16303.971 rows=1 loops=1)
   ->  GroupAggregate  (cost=3031899.67..3037783.14 rows=7 width=27) (actual time=16303.967..16303.969 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=3031899.67..3032635.09 rows=294170 width=27) (actual time=16260.394..16266.528 rows=155572 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 31879kB
               ->  Hash Join  (cost=2478447.44..3005179.78 rows=294170 width=27) (actual time=12658.723..16193.151 rows=311258 loops=1)
                     Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                     ->  Seq Scan on orders  (cost=0.00..411280.94 rows=15001294 width=20) (actual time=0.021..1225.578 rows=15000000 loops=1)
                     ->  Hash  (cost=2474770.31..2474770.31 rows=294170 width=15) (actual time=12658.018..12658.018 rows=311258 loops=1)
                           Buckets: 524288  Batches: 1  Memory Usage: 18687kB
                           ->  Seq Scan on lineitem  (cost=0.00..2474770.31 rows=294170 width=15) (actual time=0.113..12580.640 rows=311258 loops=1)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 59674794
 Planning Time: 0.748 ms
 Execution Time: 16304.056 ms
(16 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369947.39..1369947.39 rows=1 width=16) (actual time=17651.795..17651.798 rows=1 loops=1)
   ->  Sort  (cost=1369947.39..1369947.89 rows=200 width=16) (actual time=17651.794..17651.796 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369944.39..1369946.39 rows=200 width=16) (actual time=17651.767..17651.775 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215260.58..1347445.64 rows=1499917 width=12) (actual time=15080.860..17486.964 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53282.15..664486.89 rows=14999794 width=8) (actual time=341.724..11260.519 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448784.18 rows=14999794 width=8) (actual time=0.544..5150.715 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28673.18..28673.18 rows=1499917 width=4) (actual time=339.741..339.742 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.18 rows=1499917 width=4) (actual time=0.019..156.596 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 13.083 ms
 Execution Time: 17705.022 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369947.39..1369947.39 rows=1 width=16) (actual time=17117.265..17117.268 rows=1 loops=1)
   ->  Sort  (cost=1369947.39..1369947.89 rows=200 width=16) (actual time=17117.264..17117.266 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369944.39..1369946.39 rows=200 width=16) (actual time=17117.238..17117.245 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215260.58..1347445.64 rows=1499917 width=12) (actual time=14531.068..16948.645 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53282.15..664486.89 rows=14999794 width=8) (actual time=305.032..10719.232 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448784.18 rows=14999794 width=8) (actual time=0.033..4692.507 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28673.18..28673.18 rows=1499917 width=4) (actual time=303.650..303.650 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.18 rows=1499917 width=4) (actual time=0.019..124.380 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.686 ms
 Execution Time: 17172.460 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1325450.60..1325450.62 rows=1 width=32) (actual time=70925.422..70925.424 rows=1 loops=1)
   ->  Aggregate  (cost=1325450.60..1325450.62 rows=1 width=32) (actual time=70925.420..70925.422 rows=1 loops=1)
         ->  Hash Join  (cost=99653.16..1311660.63 rows=787998 width=33) (actual time=873.239..70473.360 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Index Scan using idx_lineitem_shipdate on lineitem  (cost=0.56..1188571.55 rows=787998 width=16) (actual time=1.402..68446.350 rows=772942 loops=1)
                     Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60980.82..60980.82 rows=1999982 width=25) (actual time=864.983..864.983 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60980.82 rows=1999982 width=25) (actual time=0.471..537.283 rows=2000000 loops=1)
 Planning Time: 15.614 ms
 Execution Time: 70925.794 ms
(11 rows)

SET
SET
SET
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1325450.60..1325450.62 rows=1 width=32) (actual time=3540.328..3540.331 rows=1 loops=1)
   ->  Aggregate  (cost=1325450.60..1325450.62 rows=1 width=32) (actual time=3540.327..3540.329 rows=1 loops=1)
         ->  Hash Join  (cost=99653.16..1311660.63 rows=787998 width=33) (actual time=737.998..3242.846 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Index Scan using idx_lineitem_shipdate on lineitem  (cost=0.56..1188571.55 rows=787998 width=16) (actual time=0.049..1910.780 rows=772942 loops=1)
                     Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60980.82..60980.82 rows=1999982 width=25) (actual time=736.721..736.721 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60980.82 rows=1999982 width=25) (actual time=0.028..416.294 rows=2000000 loops=1)
 Planning Time: 1.008 ms
 Execution Time: 3540.405 ms
(11 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3865153.13..3866710.02 rows=1 width=104) (actual time=18790.042..18790.045 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1885479.89..1885479.90 rows=1 width=32) (actual time=6134.412..6134.413 rows=1 loops=1)
           ->  HashAggregate  (cost=1882996.02..1884237.95 rows=99355 width=36) (actual time=6064.542..6128.452 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36778.75..1860058.77 rows=2293725 width=16) (actual time=355.039..4589.088 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36205.32 rows=2293725 width=0) (actual time=282.269..282.269 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1979673.23..2753445.89 rows=497 width=104) (actual time=18790.040..18790.042 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = revenue0.supplier_no)
         Rows Removed by Join Filter: 69997
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=72) (actual time=0.888..18.169 rows=69998 loops=1)
         ->  Materialize  (cost=1979672.94..2003818.77 rows=497 width=36) (actual time=0.267..0.268 rows=1 loops=69998)
               ->  Subquery Scan on revenue0  (cost=1979672.94..2003816.28 rows=497 width=36) (actual time=18703.524..18756.404 rows=1 loops=1)
                     ->  HashAggregate  (cost=1979672.94..2003811.31 rows=497 width=36) (actual time=18703.523..18756.401 rows=1 loops=1)
                           Group Key: lineitem.l_suppkey
                           Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
                           Planned Partitions: 4  Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                           Rows Removed by Filter: 99999
                           ->  Bitmap Heap Scan on lineitem  (cost=36778.75..1860058.77 rows=2293725 width=16) (actual time=414.534..10726.720 rows=2265714 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                 Rows Removed by Index Recheck: 13223651
                                 Heap Blocks: exact=401153 lossy=267105
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36205.32 rows=2293725 width=0) (actual time=340.264..340.264 rows=2265714 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning Time: 14.069 ms
 Execution Time: 18792.400 ms
(31 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3865153.13..3866710.02 rows=1 width=104) (actual time=12825.192..12825.195 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1885479.89..1885479.90 rows=1 width=32) (actual time=6106.632..6106.633 rows=1 loops=1)
           ->  HashAggregate  (cost=1882996.02..1884237.95 rows=99355 width=36) (actual time=6037.120..6100.821 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36778.75..1860058.77 rows=2293725 width=16) (actual time=355.446..4570.670 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36205.32 rows=2293725 width=0) (actual time=282.618..282.618 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1979673.23..2753445.89 rows=497 width=104) (actual time=12825.190..12825.191 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = revenue0.supplier_no)
         Rows Removed by Join Filter: 69997
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=72) (actual time=0.043..12.424 rows=69998 loops=1)
         ->  Materialize  (cost=1979672.94..2003818.77 rows=497 width=36) (actual time=0.182..0.183 rows=1 loops=69998)
               ->  Subquery Scan on revenue0  (cost=1979672.94..2003816.28 rows=497 width=36) (actual time=12744.872..12797.782 rows=1 loops=1)
                     ->  HashAggregate  (cost=1979672.94..2003811.31 rows=497 width=36) (actual time=12744.871..12797.780 rows=1 loops=1)
                           Group Key: lineitem.l_suppkey
                           Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
                           Planned Partitions: 4  Batches: 5  Memory Usage: 34865kB  Disk Usage: 3488kB
                           Rows Removed by Filter: 99999
                           ->  Bitmap Heap Scan on lineitem  (cost=36778.75..1860058.77 rows=2293725 width=16) (actual time=380.226..5133.850 rows=2265714 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                 Rows Removed by Index Recheck: 13223651
                                 Heap Blocks: exact=401153 lossy=267105
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36205.32 rows=2293725 width=0) (actual time=306.836..306.836 rows=2265714 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning Time: 0.997 ms
 Execution Time: 12827.352 ms
(31 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=356772.65..356772.65 rows=1 width=44) (actual time=6343.910..6343.913 rows=1 loops=1)
   ->  Sort  (cost=356772.65..357153.20 rows=152218 width=44) (actual time=6343.908..6343.910 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=347239.73..356011.56 rows=152218 width=44) (actual time=5695.023..6338.612 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=347239.73..348689.66 rows=579972 width=40) (actual time=5694.972..6051.710 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Hash Join  (cost=98078.36..281523.10 rows=579972 width=40) (actual time=823.729..2882.289 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3473.96..176415.94 rows=4001042 width=8) (actual time=37.544..1292.060 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=1010 width=4) (actual time=1.056..37.175 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90980.55..90980.55 rows=289908 width=40) (actual time=785.572..785.573 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90980.55 rows=289908 width=40) (actual time=0.660..715.256 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning Time: 15.490 ms
 Execution Time: 6352.041 ms
(26 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=356772.65..356772.65 rows=1 width=44) (actual time=5839.709..5839.712 rows=1 loops=1)
   ->  Sort  (cost=356772.65..357153.20 rows=152218 width=44) (actual time=5839.708..5839.710 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=347239.73..356011.56 rows=152218 width=44) (actual time=5189.523..5834.481 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=347239.73..348689.66 rows=579972 width=40) (actual time=5189.471..5546.142 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Hash Join  (cost=98078.36..281523.10 rows=579972 width=40) (actual time=523.052..2383.508 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3473.96..176415.94 rows=4001042 width=8) (actual time=21.154..1095.435 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=1010 width=4) (actual time=0.093..21.108 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=90980.55..90980.55 rows=289908 width=40) (actual time=501.304..501.304 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Seq Scan on part  (cost=0.00..90980.55 rows=289908 width=40) (actual time=0.015..439.271 rows=296733 loops=1)
                                       Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                       Rows Removed by Filter: 1703267
 Planning Time: 0.814 ms
 Execution Time: 5848.091 ms
(26 rows)

query 17 run 1
SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4895240.51..4895240.52 rows=1 width=32) (actual time=54054.229..54054.232 rows=1 loops=1)
   ->  Aggregate  (cost=4895240.51..4895240.52 rows=1 width=32) (actual time=54054.228..54054.230 rows=1 loops=1)
         ->  Nested Loop  (cost=4174231.19..4895199.00 rows=16604 width=8) (actual time=32303.297..54052.393 rows=5319 loops=1)
               Join Filter: (part.p_partkey = lineitem.l_partkey)
               ->  Hash Join  (cost=4174230.75..4809552.11 rows=1661 width=40) (actual time=32290.715..53198.880 rows=1996 loops=1)
                     Hash Cond: (lineitem_1.l_partkey = part.p_partkey)
                     ->  HashAggregate  (cost=4103226.87..4715905.21 rows=1793506 width=36) (actual time=31757.761..52517.433 rows=2000000 loops=1)
                           Group Key: lineitem_1.l_partkey
                           Planned Partitions: 32  Batches: 33  Memory Usage: 33041kB  Disk Usage: 2080800kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1724977.36 rows=59983436 width=9) (actual time=0.571..7074.400 rows=59986052 loops=1)
                     ->  Hash  (cost=70980.73..70980.73 rows=1852 width=4) (actual time=531.669..531.670 rows=1996 loops=1)
                           Buckets: 2048  Batches: 1  Memory Usage: 87kB
                           ->  Seq Scan on part  (cost=0.00..70980.73 rows=1852 width=4) (actual time=1.196..530.666 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.43 rows=11 width=17) (actual time=0.286..0.426 rows=3 loops=1996)
                     Index Cond: (l_partkey = lineitem_1.l_partkey)
                     Filter: (l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
                     Rows Removed by Filter: 27
 Planning Time: 16.506 ms
 Execution Time: 54314.547 ms
(21 rows)

SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4895240.51..4895240.52 rows=1 width=32) (actual time=50357.738..50357.741 rows=1 loops=1)
   ->  Aggregate  (cost=4895240.51..4895240.52 rows=1 width=32) (actual time=50357.737..50357.739 rows=1 loops=1)
         ->  Nested Loop  (cost=4174231.19..4895199.00 rows=16604 width=8) (actual time=29642.952..50356.911 rows=5319 loops=1)
               Join Filter: (part.p_partkey = lineitem.l_partkey)
               ->  Hash Join  (cost=4174230.75..4809552.11 rows=1661 width=40) (actual time=29642.927..50312.114 rows=1996 loops=1)
                     Hash Cond: (lineitem_1.l_partkey = part.p_partkey)
                     ->  HashAggregate  (cost=4103226.87..4715905.21 rows=1793506 width=36) (actual time=29377.035..49903.048 rows=2000000 loops=1)
                           Group Key: lineitem_1.l_partkey
                           Planned Partitions: 32  Batches: 33  Memory Usage: 33041kB  Disk Usage: 2080800kB
                           ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1724977.36 rows=59983436 width=9) (actual time=0.035..5290.508 rows=59986052 loops=1)
                     ->  Hash  (cost=70980.73..70980.73 rows=1852 width=4) (actual time=264.652..264.652 rows=1996 loops=1)
                           Buckets: 2048  Batches: 1  Memory Usage: 87kB
                           ->  Seq Scan on part  (cost=0.00..70980.73 rows=1852 width=4) (actual time=0.106..264.158 rows=1996 loops=1)
                                 Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                 Rows Removed by Filter: 1998004
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.43 rows=11 width=17) (actual time=0.010..0.022 rows=3 loops=1996)
                     Index Cond: (l_partkey = lineitem_1.l_partkey)
                     Filter: (l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
                     Rows Removed by Filter: 27
 Planning Time: 0.829 ms
 Execution Time: 50587.094 ms
(21 rows)

query 18 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8774722.80..8774723.05 rows=100 width=71) (actual time=40834.243..40834.256 rows=99 loops=1)
   ->  Sort  (cost=8774722.80..8824690.89 rows=19987236 width=71) (actual time=40834.242..40834.249 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409646.43..8010825.01 rows=19987236 width=71) (actual time=40833.749..40834.159 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3121kB
               ->  Hash Join  (cost=78717.58..6332990.24 rows=19987236 width=44) (actual time=4263.186..40833.365 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=233.45..5919986.47 rows=19987236 width=25) (actual time=971.088..40047.029 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390243.70 rows=4998620 width=24) (actual time=742.412..29058.843 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547984.84 rows=15001294 width=20) (actual time=0.558..2964.653 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692286.67 rows=4998620 width=4) (actual time=634.329..25207.388 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167431.60 rows=59983436 width=9) (actual time=0.520..11961.824 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167431.60 rows=59983436 width=9) (actual time=0.014..7588.445 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.17..50946.17 rows=1499917 width=23) (actual time=677.975..677.976 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=23) (actual time=0.704..423.070 rows=1500000 loops=1)
 Planning Time: 21.095 ms
 Execution Time: 40835.361 ms
(25 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8774722.80..8774723.05 rows=100 width=71) (actual time=37553.409..37553.422 rows=99 loops=1)
   ->  Sort  (cost=8774722.80..8824690.89 rows=19987236 width=71) (actual time=37553.408..37553.415 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409646.43..8010825.01 rows=19987236 width=71) (actual time=37552.911..37553.323 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3121kB
               ->  Hash Join  (cost=78717.58..6332990.24 rows=19987236 width=44) (actual time=3684.979..37552.538 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=233.45..5919986.47 rows=19987236 width=25) (actual time=843.627..36902.779 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390243.70 rows=4998620 width=24) (actual time=610.943..25867.178 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547984.84 rows=15001294 width=20) (actual time=0.023..2366.429 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692286.67 rows=4998620 width=4) (actual time=531.652..22638.709 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167431.60 rows=59983436 width=9) (actual time=0.014..9672.093 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167431.60 rows=59983436 width=9) (actual time=0.012..7651.168 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.17..50946.17 rows=1499917 width=23) (actual time=541.063..541.063 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50946.17 rows=1499917 width=23) (actual time=0.029..291.993 rows=1500000 loops=1)
 Planning Time: 1.612 ms
 Execution Time: 37554.150 ms
(25 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387541.40..387541.41 rows=1 width=32) (actual time=22739.133..22739.134 rows=1 loops=1)
   ->  Aggregate  (cost=387541.40..387541.41 rows=1 width=32) (actual time=22739.131..22739.132 rows=1 loops=1)
         ->  Nested Loop  (cost=0.44..387532.77 rows=1150 width=12) (actual time=60.430..22735.998 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125980.24 rows=4886 width=30) (actual time=1.290..814.768 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..53.52 rows=1 width=21) (actual time=4.134..4.584 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning Time: 17.033 ms
 Execution Time: 22739.922 ms
(12 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387541.40..387541.41 rows=1 width=32) (actual time=621.492..621.493 rows=1 loops=1)
   ->  Aggregate  (cost=387541.40..387541.41 rows=1 width=32) (actual time=621.491..621.492 rows=1 loops=1)
         ->  Nested Loop  (cost=0.44..387532.77 rows=1150 width=12) (actual time=1.555..620.812 rows=1063 loops=1)
               ->  Seq Scan on part  (cost=0.00..125980.24 rows=4886 width=30) (actual time=0.254..465.356 rows=4781 loops=1)
                     Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                     Rows Removed by Filter: 1995219
               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..53.52 rows=1 width=21) (actual time=0.029..0.032 rows=0 loops=4781)
                     Index Cond: (l_partkey = part.p_partkey)
                     Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                     Rows Removed by Filter: 30
 Planning Time: 1.196 ms
 Execution Time: 621.543 ms
(12 rows)

query 20 run 1
SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2774283.46..2774283.46 rows=1 width=52) (actual time=51720.202..51720.206 rows=1 loops=1)
   ->  Sort  (cost=2774283.46..2774283.46 rows=1 width=52) (actual time=51720.200..51720.204 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2522696.80..2774283.45 rows=1 width=52) (actual time=30406.919..51718.303 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 183372192
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.580..24.215 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.271..0.274 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.305..16.413 rows=100000 loops=1)
               ->  Materialize  (cost=2522696.80..2769631.14 rows=3 width=8) (actual time=7.080..10.210 rows=44780 loops=4095)
                     ->  Hash Join  (cost=2522696.80..2769631.13 rows=3 width=8) (actual time=28991.440..35702.110 rows=59002 loops=1)
                           Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  HashAggregate  (cost=2379177.67..2541224.85 rows=4850686 width=40) (actual time=24183.952..30097.007 rows=5448842 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 Planned Partitions: 64  Batches: 65  Memory Usage: 35345kB  Disk Usage: 388568kB
                                 ->  Bitmap Heap Scan on lineitem  (cost=146598.59..1993815.43 rows=9142978 width=13) (actual time=1255.444..19399.589 rows=9123688 loops=1)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                       Rows Removed by Index Recheck: 23164080
                                       Heap Blocks: exact=518099 lossy=530696
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144312.85 rows=9142978 width=0) (actual time=1150.031..1150.031 rows=9123688 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Hash  (cost=142306.68..142306.68 rows=80830 width=16) (actual time=4807.328..4807.329 rows=86872 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                                 ->  Nested Loop  (cost=0.43..142306.68 rows=80830 width=16) (actual time=0.844..4761.478 rows=86872 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65980.77 rows=20202 width=4) (actual time=0.513..714.012 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.59 rows=19 width=12) (actual time=0.170..0.184 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 19.432 ms
 Execution Time: 51764.664 ms
(38 rows)

SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2774283.46..2774283.46 rows=1 width=52) (actual time=36438.018..36438.022 rows=1 loops=1)
   ->  Sort  (cost=2774283.46..2774283.46 rows=1 width=52) (actual time=36438.017..36438.020 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2522696.80..2774283.45 rows=1 width=52) (actual time=15110.166..36436.097 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 183372192
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.032..20.158 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.006..12.674 rows=100000 loops=1)
               ->  Materialize  (cost=2522696.80..2769631.14 rows=3 width=8) (actual time=3.346..6.471 rows=44780 loops=4095)
                     ->  Hash Join  (cost=2522696.80..2769631.13 rows=3 width=8) (actual time=13700.850..20390.794 rows=59002 loops=1)
                           Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  HashAggregate  (cost=2379177.67..2541224.85 rows=4850686 width=40) (actual time=13123.667..19021.678 rows=5448842 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 Planned Partitions: 64  Batches: 65  Memory Usage: 35345kB  Disk Usage: 388568kB
                                 ->  Bitmap Heap Scan on lineitem  (cost=146598.59..1993815.43 rows=9142978 width=13) (actual time=1108.054..9061.116 rows=9123688 loops=1)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                       Rows Removed by Index Recheck: 23164080
                                       Heap Blocks: exact=518099 lossy=530696
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144312.85 rows=9142978 width=0) (actual time=1003.254..1003.254 rows=9123688 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Hash  (cost=142306.68..142306.68 rows=80830 width=16) (actual time=577.018..577.019 rows=86872 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                                 ->  Nested Loop  (cost=0.43..142306.68 rows=80830 width=16) (actual time=0.053..555.577 rows=86872 loops=1)
                                       ->  Seq Scan on part  (cost=0.00..65980.77 rows=20202 width=4) (actual time=0.038..338.789 rows=21718 loops=1)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 1978282
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.59 rows=19 width=12) (actual time=0.008..0.009 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.009 ms
 Execution Time: 36481.964 ms
(38 rows)

query 21 run 1
SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3768288.09..3768288.09 rows=1 width=34) (actual time=25772.213..25772.229 rows=100 loops=1)
   ->  Sort  (cost=3768288.09..3768288.09 rows=1 width=34) (actual time=25772.212..25772.221 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=3768288.06..3768288.08 rows=1 width=34) (actual time=25765.192..25771.042 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=3768288.06..3768288.06 rows=1 width=26) (actual time=25765.181..25766.618 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=1976471.86..3768288.05 rows=1 width=26) (actual time=15320.109..25593.495 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 42025
                           ->  Nested Loop Anti Join  (cost=1976471.30..3768284.40 rows=1 width=38) (actual time=15319.368..25442.338 rows=65960 loops=1)
                                 ->  Hash Join  (cost=1976470.73..2519725.55 rows=388853 width=38) (actual time=15317.818..20162.763 rows=730985 loops=1)
                                       Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..448784.18 rows=7293629 width=4) (actual time=0.486..2495.715 rows=7309184 loops=1)
                                             Filter: (o_orderstatus = 'F'::bpchar)
                                             Rows Removed by Filter: 7690816
                                       ->  Hash  (cost=1960224.50..1960224.50 rows=799779 width=34) (actual time=15316.454..15316.457 rows=1514267 loops=1)
                                             Buckets: 524288  Batches: 4  Memory Usage: 29225kB
                                             ->  Hash Join  (cost=2311.46..1960224.50 rows=799779 width=34) (actual time=39.581..14935.804 rows=1514267 loops=1)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Seq Scan on lineitem l1  (cost=0.00..1874935.95 rows=19994479 width=8) (actual time=0.566..11515.448 rows=37929348 loops=1)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 22056704
                                                   ->  Hash  (cost=2261.46..2261.46 rows=4000 width=30) (actual time=38.945..38.947 rows=3991 loops=1)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=30) (actual time=1.758..37.734 rows=3991 loops=1)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.257..0.261 rows=1 loops=1)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=34) (actual time=1.492..36.671 rows=3991 loops=1)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.935..0.935 rows=3991 loops=1)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.007..0.007 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = l1.l_orderkey)
                                       Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.002..0.002 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 21.603 ms
 Execution Time: 25773.393 ms
(44 rows)

SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3768288.09..3768288.09 rows=1 width=34) (actual time=21514.957..21514.972 rows=100 loops=1)
   ->  Sort  (cost=3768288.09..3768288.09 rows=1 width=34) (actual time=21514.956..21514.965 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=3768288.06..3768288.08 rows=1 width=34) (actual time=21507.955..21513.785 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=3768288.06..3768288.06 rows=1 width=26) (actual time=21507.943..21509.391 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Semi Join  (cost=1976471.86..3768288.05 rows=1 width=26) (actual time=12987.743..21336.937 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 42025
                           ->  Nested Loop Anti Join  (cost=1976471.30..3768284.40 rows=1 width=38) (actual time=12987.284..21194.246 rows=65960 loops=1)
                                 ->  Hash Join  (cost=1976470.73..2519725.55 rows=388853 width=38) (actual time=12986.814..17299.608 rows=730985 loops=1)
                                       Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                       ->  Seq Scan on orders  (cost=0.00..448784.18 rows=7293629 width=4) (actual time=0.023..2019.980 rows=7309184 loops=1)
                                             Filter: (o_orderstatus = 'F'::bpchar)
                                             Rows Removed by Filter: 7690816
                                       ->  Hash  (cost=1960224.50..1960224.50 rows=799779 width=34) (actual time=12985.966..12985.968 rows=1514267 loops=1)
                                             Buckets: 524288  Batches: 4  Memory Usage: 29225kB
                                             ->  Hash Join  (cost=2311.46..1960224.50 rows=799779 width=34) (actual time=15.226..12645.473 rows=1514267 loops=1)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Seq Scan on lineitem l1  (cost=0.00..1874935.95 rows=19994479 width=8) (actual time=0.034..9642.510 rows=37929348 loops=1)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 22056704
                                                   ->  Hash  (cost=2261.46..2261.46 rows=4000 width=30) (actual time=15.159..15.160 rows=3991 loops=1)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=30) (actual time=0.505..14.309 rows=3991 loops=1)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.011..0.014 rows=1 loops=1)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=34) (actual time=0.489..13.721 rows=3991 loops=1)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.300..0.300 rows=3991 loops=1)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.005..0.005 rows=1 loops=730985)
                                       Index Cond: (l_orderkey = l1.l_orderkey)
                                       Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.002..0.002 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 2.796 ms
 Execution Time: 21515.142 ms
(44 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161653.67..161653.70 rows=1 width=72) (actual time=1967.387..1967.389 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75439.51..75439.52 rows=1 width=32) (actual time=974.496..974.497 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75319.82 rows=47873 width=6) (actual time=0.018..936.046 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86214.16..86424.70 rows=7656 width=72) (actual time=1967.385..1967.386 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86214.16..86233.30 rows=7656 width=38) (actual time=1965.521..1965.899 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85720.25 rows=7656 width=38) (actual time=974.982..1944.662 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75319.82 rows=17499 width=26) (actual time=974.964..1503.334 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning Time: 16.414 ms
 Execution Time: 1967.990 ms
(20 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=161653.67..161653.70 rows=1 width=72) (actual time=1565.869..1565.871 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=75439.51..75439.52 rows=1 width=32) (actual time=724.498..724.499 rows=1 loops=1)
           ->  Seq Scan on customer customer_1  (cost=0.00..75319.82 rows=47873 width=6) (actual time=0.008..689.556 rows=382426 loops=1)
                 Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                 Rows Removed by Filter: 1117574
   ->  GroupAggregate  (cost=86214.16..86424.70 rows=7656 width=72) (actual time=1565.868..1565.869 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86214.16..86233.30 rows=7656 width=38) (actual time=1564.085..1564.414 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85720.25 rows=7656 width=38) (actual time=724.542..1544.879 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75319.82 rows=17499 width=26) (actual time=724.525..1233.264 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.001..0.001 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning Time: 0.738 ms
 Execution Time: 1565.923 ms
(20 rows)

