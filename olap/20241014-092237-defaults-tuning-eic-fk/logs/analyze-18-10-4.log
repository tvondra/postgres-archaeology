query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832781.10..1832781.73 rows=1 width=236) (actual time=17466.732..17469.113 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832781.10..1832784.91 rows=6 width=236) (actual time=17466.730..17469.110 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832781.10..1832783.97 rows=24 width=236) (actual time=17466.708..17469.091 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831781.04..1831781.05 rows=6 width=236) (actual time=17456.155..17456.156 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831780.82..1831780.96 rows=6 width=236) (actual time=17456.119..17456.124 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312603.43 rows=14833640 width=25) (actual time=0.242..4414.186 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 14.181 ms
 Execution Time: 17470.193 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832781.10..1832781.73 rows=1 width=236) (actual time=16667.828..16668.274 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832781.10..1832784.91 rows=6 width=236) (actual time=16667.827..16668.272 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832781.10..1832783.97 rows=24 width=236) (actual time=16667.796..16668.251 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831781.04..1831781.05 rows=6 width=236) (actual time=16662.459..16662.460 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831780.82..1831780.96 rows=6 width=236) (actual time=16662.426..16662.431 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312603.43 rows=14833640 width=25) (actual time=0.032..2593.028 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.864 ms
 Execution Time: 16668.343 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1088006.60..1088006.61 rows=1 width=192) (actual time=4026.568..4026.694 rows=100 loops=1)
   ->  Sort  (cost=1088006.60..1088006.61 rows=1 width=192) (actual time=4026.567..4026.687 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559045.33..1088006.59 rows=1 width=192) (actual time=3005.331..4023.723 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68721.52 rows=8473 width=30) (actual time=82.138..85.301 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.24 rows=2118 width=30) (actual time=1.391..326.002 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558036.85..566037.73 rows=1600176 width=172) (actual time=2922.035..3381.409 rows=1603828 loops=1)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Sort  (cost=558036.85..562037.29 rows=1600176 width=172) (actual time=2922.029..3207.360 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305239.57 rows=1600176 width=172) (actual time=50.929..2307.640 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255230.82 rows=8000882 width=14) (actual time=5.132..959.548 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=45.761..45.764 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=3.514..39.917 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=2.785..27.991 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.721..0.722 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.715..0.720 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.532..0.533 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.176..0.177 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.173..0.174 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.058..0.058 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.048..0.056 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.042..0.054 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.042..0.053 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.038..0.039 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.007 rows=25 loops=1)
 Planning Time: 20.803 ms
 Execution Time: 4063.951 ms
(57 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1088006.60..1088006.61 rows=1 width=192) (actual time=3253.543..3253.673 rows=100 loops=1)
   ->  Sort  (cost=1088006.60..1088006.61 rows=1 width=192) (actual time=3253.542..3253.666 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559045.33..1088006.59 rows=1 width=192) (actual time=2511.712..3251.257 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68721.52 rows=8473 width=30) (actual time=27.521..29.884 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.24 rows=2118 width=30) (actual time=0.188..124.157 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558036.85..566037.73 rows=1600176 width=172) (actual time=2484.093..2927.910 rows=1603828 loops=1)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Sort  (cost=558036.85..562037.29 rows=1600176 width=172) (actual time=2484.088..2758.195 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305239.57 rows=1600176 width=172) (actual time=46.582..1881.021 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255230.82 rows=8000882 width=14) (actual time=0.052..644.858 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=46.492..46.495 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.050..39.375 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.012..10.475 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.036..0.038 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.031..0.036 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.016..0.018 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.010..0.011 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.018..0.018 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.010..0.016 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.006..0.014 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.004 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.006 rows=25 loops=1)
 Planning Time: 1.832 ms
 Execution Time: 3289.442 ms
(57 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2299525.92..2299525.95 rows=10 width=44) (actual time=10271.392..10302.765 rows=10 loops=1)
   ->  Sort  (cost=2299525.92..2307424.21 rows=3159313 width=44) (actual time=10271.391..10302.763 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1766093.99..2231254.31 rows=3159313 width=44) (actual time=10069.562..10282.459 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1766093.99..2144373.20 rows=3159313 width=24) (actual time=10069.547..10140.927 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1765093.93..1767068.50 rows=789828 width=24) (actual time=10049.384..10051.994 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4237kB
                           Worker 0:  Sort Method: quicksort  Memory: 4184kB
                           Worker 1:  Sort Method: quicksort  Memory: 4250kB
                           Worker 2:  Sort Method: quicksort  Memory: 4318kB
                           Worker 3:  Sort Method: quicksort  Memory: 4243kB
                           ->  Nested Loop  (cost=41577.20..1677312.63 rows=789828 width=24) (actual time=274.851..10030.187 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41576.64..354477.15 rows=364156 width=12) (actual time=273.229..1804.379 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308143.94 rows=1812022 width=16) (actual time=0.541..1085.732 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.59..40634.59 rows=75364 width=4) (actual time=272.074..272.074 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.59 rows=75364 width=4) (actual time=0.120..255.302 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.028..0.028 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 21.260 ms
 Execution Time: 10303.148 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2299525.92..2299525.95 rows=10 width=44) (actual time=3872.406..3899.260 rows=10 loops=1)
   ->  Sort  (cost=2299525.92..2307424.21 rows=3159313 width=44) (actual time=3872.404..3899.257 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1766093.99..2231254.31 rows=3159313 width=44) (actual time=3664.265..3878.970 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1766093.99..2144373.20 rows=3159313 width=24) (actual time=3664.252..3737.463 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1765093.93..1767068.50 rows=789828 width=24) (actual time=3656.616..3659.240 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4182kB
                           Worker 0:  Sort Method: quicksort  Memory: 4343kB
                           Worker 1:  Sort Method: quicksort  Memory: 4181kB
                           Worker 2:  Sort Method: quicksort  Memory: 4246kB
                           Worker 3:  Sort Method: quicksort  Memory: 4280kB
                           ->  Nested Loop  (cost=41577.20..1677312.63 rows=789828 width=24) (actual time=105.545..3636.148 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41576.64..354477.15 rows=364156 width=12) (actual time=105.359..1174.204 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308143.94 rows=1812022 width=16) (actual time=0.044..530.400 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.59..40634.59 rows=75364 width=4) (actual time=103.722..103.723 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.59 rows=75364 width=4) (actual time=0.036..77.233 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.008..0.008 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.744 ms
 Execution Time: 3899.334 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=281701.05..633587.34 rows=1 width=24) (actual time=27936.763..27956.324 rows=1 loops=1)
   ->  GroupAggregate  (cost=281701.05..2041132.49 rows=5 width=24) (actual time=27936.762..27956.322 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=281701.05..2038475.42 rows=531404 width=16) (actual time=4221.343..27872.800 rows=103030 loops=1)
               ->  Gather Merge  (cost=281700.49..345342.68 rows=531527 width=20) (actual time=4220.208..4350.410 rows=112214 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=280700.43..281032.63 rows=132882 width=20) (actual time=4206.550..4209.527 rows=23453 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7482kB
                           Worker 0:  Sort Method: quicksort  Memory: 7451kB
                           Worker 1:  Sort Method: quicksort  Memory: 7435kB
                           Worker 2:  Sort Method: quicksort  Memory: 7454kB
                           Worker 3:  Sort Method: quicksort  Memory: 7432kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6131.09..269392.31 rows=132882 width=20) (actual time=130.180..4158.909 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46653
                                 Worker 0:  Heap Blocks: exact=46370
                                 Worker 1:  Heap Blocks: exact=46352
                                 Worker 2:  Heap Blocks: exact=46509
                                 Worker 3:  Heap Blocks: exact=46003
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..5998.21 rows=531527 width=0) (actual time=87.133..87.133 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.208..0.208 rows=1 loops=112214)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 17.909 ms
 Execution Time: 27957.329 ms
(29 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=281701.05..633587.34 rows=1 width=24) (actual time=1729.305..1747.269 rows=1 loops=1)
   ->  GroupAggregate  (cost=281701.05..2041132.49 rows=5 width=24) (actual time=1729.304..1747.266 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=281701.05..2038475.42 rows=531404 width=16) (actual time=726.830..1725.044 rows=103030 loops=1)
               ->  Gather Merge  (cost=281700.49..345342.68 rows=531527 width=20) (actual time=726.772..781.168 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=280700.43..281032.63 rows=132882 width=20) (actual time=713.403..715.340 rows=23447 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7740kB
                           Worker 0:  Sort Method: quicksort  Memory: 7346kB
                           Worker 1:  Sort Method: quicksort  Memory: 7378kB
                           Worker 2:  Sort Method: quicksort  Memory: 7412kB
                           Worker 3:  Sort Method: quicksort  Memory: 7378kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6131.09..269392.31 rows=132882 width=20) (actual time=126.827..674.698 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=49495
                                 Worker 0:  Heap Blocks: exact=45100
                                 Worker 1:  Heap Blocks: exact=45761
                                 Worker 2:  Heap Blocks: exact=45984
                                 Worker 3:  Heap Blocks: exact=45547
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..5998.21 rows=531527 width=0) (actual time=82.103..82.103 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.287 ms
 Execution Time: 1747.342 ms
(29 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=768698.92..768698.92 rows=1 width=58) (actual time=21826.374..21866.493 rows=1 loops=1)
   ->  Sort  (cost=768698.92..768698.98 rows=25 width=58) (actual time=21826.373..21866.490 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=768458.98..768698.79 rows=25 width=58) (actual time=21818.767..21866.474 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=768458.98..768697.73 rows=100 width=58) (actual time=21817.544..21866.443 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=767458.93..767685.76 rows=25 width=58) (actual time=21797.556..21803.088 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=767458.93..767504.23 rows=18122 width=38) (actual time=21795.602..21796.254 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1172kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1176kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1164kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1169kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1181kB
                                 ->  Parallel Hash Join  (cost=72983.10..766177.21 rows=18122 width=38) (actual time=557.557..21782.282 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69291.50..760073.77 rows=459398 width=50) (actual time=538.915..21616.872 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69290.94..341615.77 rows=114876 width=38) (actual time=538.635..2542.752 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26497.55..296381.26 rows=574381 width=8) (actual time=259.905..2039.168 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52252
                                                         Worker 0:  Heap Blocks: exact=52499
                                                         Worker 1:  Heap Blocks: exact=51876
                                                         Worker 2:  Heap Blocks: exact=52401
                                                         Worker 3:  Heap Blocks: exact=52218
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25923.17 rows=2297523 width=0) (actual time=203.022..203.022 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.87..41855.87 rows=75002 width=38) (actual time=277.808..277.811 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.87 rows=75002 width=38) (actual time=0.803..250.872 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=8) (actual time=0.414..216.940 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.382..0.384 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.373..0.380 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.132..0.134 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.235..0.235 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.231..0.232 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.198..0.209 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.486..15.486 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.118..9.440 rows=20000 loops=5)
 Planning Time: 29.036 ms
 Execution Time: 21866.866 ms
(54 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=768698.92..768698.92 rows=1 width=58) (actual time=2532.848..2575.127 rows=1 loops=1)
   ->  Sort  (cost=768698.92..768698.98 rows=25 width=58) (actual time=2532.847..2575.124 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=768458.98..768698.79 rows=25 width=58) (actual time=2525.132..2575.106 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=768458.98..768697.73 rows=100 width=58) (actual time=2523.853..2575.073 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=767458.93..767685.76 rows=25 width=58) (actual time=2509.218..2515.743 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=767458.93..767504.23 rows=18122 width=38) (actual time=2508.072..2508.733 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1182kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1226kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1156kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1178kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1120kB
                                 ->  Parallel Hash Join  (cost=72983.10..766177.21 rows=18122 width=38) (actual time=393.805..2499.438 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69291.50..760073.77 rows=459398 width=50) (actual time=376.732..2372.558 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69290.94..341615.77 rows=114876 width=38) (actual time=376.680..956.988 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26497.55..296381.26 rows=574381 width=8) (actual time=247.334..652.874 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52832
                                                         Worker 0:  Heap Blocks: exact=55433
                                                         Worker 1:  Heap Blocks: exact=51829
                                                         Worker 2:  Heap Blocks: exact=52246
                                                         Worker 3:  Heap Blocks: exact=48906
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25923.17 rows=2297523 width=0) (actual time=191.013..191.013 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.87..41855.87 rows=75002 width=38) (actual time=128.780..128.783 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25312kB
                                                         ->  Hash Join  (cost=2.51..41855.87 rows=75002 width=38) (actual time=0.080..98.269 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=8) (actual time=0.034..59.420 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.040..0.042 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.034..0.040 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.015..0.016 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.015 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.014..0.015 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.890..15.890 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.031..6.644 rows=20000 loops=5)
 Planning Time: 5.041 ms
 Execution Time: 2575.220 ms
(54 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1286620.47..1286620.48 rows=1 width=32) (actual time=10622.088..10655.363 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1286620.47..1286620.48 rows=1 width=32) (actual time=10622.086..10655.360 rows=1 loops=1)
         ->  Gather  (cost=1286620.04..1286620.45 rows=4 width=32) (actual time=10620.449..10655.345 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1285620.04..1285620.05 rows=1 width=32) (actual time=10609.873..10609.874 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=213409.45..1284130.20 rows=297967 width=12) (actual time=1377.577..10477.406 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79326 lossy=53826
                           Worker 0:  Heap Blocks: exact=79108 lossy=53418
                           Worker 1:  Heap Blocks: exact=79162 lossy=53342
                           Worker 2:  Heap Blocks: exact=79793 lossy=53556
                           Worker 3:  Heap Blocks: exact=78511 lossy=52926
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..213111.49 rows=1191869 width=0) (actual time=1292.937..1292.938 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 13.397 ms
 Execution Time: 10656.447 ms
(18 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1286620.47..1286620.48 rows=1 width=32) (actual time=3198.255..3237.378 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1286620.47..1286620.48 rows=1 width=32) (actual time=3198.254..3237.376 rows=1 loops=1)
         ->  Gather  (cost=1286620.04..1286620.45 rows=4 width=32) (actual time=3196.434..3237.362 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1285620.04..1285620.05 rows=1 width=32) (actual time=3191.698..3191.699 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=213409.45..1284130.20 rows=297967 width=12) (actual time=1239.184..3093.249 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=74446 lossy=49923
                           Worker 0:  Heap Blocks: exact=75581 lossy=51466
                           Worker 1:  Heap Blocks: exact=82056 lossy=55772
                           Worker 2:  Heap Blocks: exact=81237 lossy=54843
                           Worker 3:  Heap Blocks: exact=82580 lossy=55064
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..213111.49 rows=1191869 width=0) (actual time=1150.902..1150.903 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.688 ms
 Execution Time: 3237.424 ms
(18 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1418673.22..1419706.61 rows=1 width=116) (actual time=30033.038..30037.981 rows=1 loops=1)
   ->  GroupAggregate  (cost=1418673.22..11810424.46 rows=10056 width=116) (actual time=30033.036..30037.978 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1418673.22..11809378.08 rows=59703 width=96) (actual time=7367.747..30011.190 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349052
               ->  Nested Loop  (cost=1418672.79..6700458.11 rows=1492582 width=76) (actual time=7349.056..24190.720 rows=363473 loops=1)
                     ->  Gather Merge  (cost=1418672.36..1597386.13 rows=1492582 width=76) (actual time=7347.750..7800.951 rows=363473 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1417672.30..1418605.16 rows=373146 width=76) (actual time=7328.367..7371.766 rows=73141 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 27112kB
                                 Worker 0:  Sort Method: external merge  Disk: 26248kB
                                 Worker 1:  Sort Method: external merge  Disk: 26840kB
                                 Worker 2:  Sort Method: external merge  Disk: 26472kB
                                 Worker 3:  Sort Method: external merge  Disk: 27272kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372478.29 rows=373146 width=76) (actual time=12.360..7060.000 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350095.51 rows=4545828 width=24) (actual time=0.426..6520.710 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=11.591..11.594 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 992kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.391..10.571 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.295..8.429 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.087..0.089 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.081..0.087 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.069..0.070 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     Storage: Memory  Maximum Storage: 17kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.044..0.044 rows=1 loops=363473)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.015..0.015 rows=1 loops=363473)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 25.956 ms
 Execution Time: 30041.276 ms
(46 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1418673.22..1419706.61 rows=1 width=116) (actual time=5662.362..5668.956 rows=1 loops=1)
   ->  GroupAggregate  (cost=1418673.22..11810424.46 rows=10056 width=116) (actual time=5662.361..5668.954 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1418673.22..11809378.08 rows=59703 width=96) (actual time=3283.970..5656.620 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349032
               ->  Nested Loop  (cost=1418672.79..6700458.11 rows=1492582 width=76) (actual time=3283.849..4557.528 rows=363453 loops=1)
                     ->  Gather Merge  (cost=1418672.36..1597386.13 rows=1492582 width=76) (actual time=3283.788..3508.524 rows=363453 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1417672.30..1418605.16 rows=373146 width=76) (actual time=3259.439..3288.720 rows=73116 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26720kB
                                 Worker 0:  Sort Method: external merge  Disk: 25616kB
                                 Worker 1:  Sort Method: external merge  Disk: 29112kB
                                 Worker 2:  Sort Method: external merge  Disk: 26568kB
                                 Worker 3:  Sort Method: external merge  Disk: 25928kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372478.29 rows=373146 width=76) (actual time=12.062..2934.594 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350095.51 rows=4545828 width=24) (actual time=0.047..2343.226 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=10.346..10.348 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.082..9.362 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.045..5.324 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.031..0.033 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.026..0.031 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.014..0.016 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     Storage: Memory  Maximum Storage: 17kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.006 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=363453)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=363453)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.530 ms
 Execution Time: 5672.425 ms
(46 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386009.25..391729.40 rows=1 width=64) (actual time=34404.894..34409.890 rows=1 loops=1)
   ->  GroupAggregate  (cost=386009.25..14148688.59 rows=2406 width=64) (actual time=34404.893..34409.888 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386009.25..14148170.43 rows=23502 width=70) (actual time=2340.438..34385.472 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142651
               ->  Nested Loop  (cost=386009.25..14139622.50 rows=23502 width=20) (actual time=2340.418..34343.902 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386008.96..14061665.59 rows=23830 width=20) (actual time=2339.987..33788.108 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386008.52..3761666.40 rows=3587190 width=24) (actual time=2285.744..23371.293 rows=1816419 loops=1)
                                 ->  Gather Merge  (cost=386007.95..493410.52 rows=897005 width=8) (actual time=2284.501..2562.564 rows=454488 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385007.90..385568.52 rows=224251 width=8) (actual time=2267.043..2275.235 rows=92077 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 11885kB
                                             Worker 0:  Sort Method: quicksort  Memory: 11845kB
                                             Worker 1:  Sort Method: quicksort  Memory: 11845kB
                                             Worker 2:  Sort Method: quicksort  Memory: 11760kB
                                             Worker 3:  Sort Method: quicksort  Memory: 11837kB
                                             ->  Parallel Hash Join  (cost=42793.39..365077.86 rows=224251 width=8) (actual time=272.558..2224.691 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317519.13 rows=1121256 width=12) (actual time=0.635..1699.603 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.87..41855.87 rows=75002 width=4) (actual time=271.299..271.302 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.87 rows=75002 width=4) (actual time=0.490..255.211 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=8) (actual time=0.378..222.389 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.106..0.108 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.099..0.106 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.047..0.049 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.047..0.048 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.042..0.045 rows=4 loops=454488)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.005..0.005 rows=0 loops=1816419)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597340  Misses: 1219079  Evictions: 235565  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.007..0.007 rows=0 loops=1219079)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.046..0.046 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.008..0.017 rows=25 loops=1)
 Planning Time: 32.278 ms
 Execution Time: 34410.594 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386009.25..391729.40 rows=1 width=64) (actual time=8839.538..8844.775 rows=1 loops=1)
   ->  GroupAggregate  (cost=386009.25..14148688.59 rows=2406 width=64) (actual time=8839.537..8844.774 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386009.25..14148170.43 rows=23502 width=70) (actual time=956.302..8832.811 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142662
               ->  Nested Loop  (cost=386009.25..14139622.50 rows=23502 width=20) (actual time=956.277..8807.389 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386008.96..14061665.59 rows=23830 width=20) (actual time=956.261..8762.106 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386008.52..3761666.40 rows=3587190 width=24) (actual time=949.897..4055.724 rows=1816646 loops=1)
                                 ->  Gather Merge  (cost=386007.95..493410.52 rows=897005 width=8) (actual time=949.834..1144.690 rows=454546 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385007.90..385568.52 rows=224251 width=8) (actual time=939.615..945.319 rows=92106 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 12229kB
                                             Worker 0:  Sort Method: quicksort  Memory: 12112kB
                                             Worker 1:  Sort Method: quicksort  Memory: 10765kB
                                             Worker 2:  Sort Method: quicksort  Memory: 11721kB
                                             Worker 3:  Sort Method: quicksort  Memory: 12344kB
                                             ->  Parallel Hash Join  (cost=42793.39..365077.86 rows=224251 width=8) (actual time=125.350..895.267 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317519.13 rows=1121256 width=12) (actual time=0.041..470.166 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.87..41855.87 rows=75002 width=4) (actual time=123.666..123.669 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.87 rows=75002 width=4) (actual time=0.083..103.371 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=8) (actual time=0.043..61.855 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.036..0.038 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.031..0.037 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.012..0.014 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.015 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.006 rows=4 loops=454546)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=1816646)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597181  Misses: 1219465  Evictions: 235954  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1219465)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.009..0.011 rows=25 loops=1)
 Planning Time: 5.735 ms
 Execution Time: 8845.216 ms
(56 rows)

query 9 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=753424.53..753654.82 rows=1 width=90) (actual time=42833.700..42842.441 rows=1 loops=1)
   ->  GroupAggregate  (cost=753424.53..14604850.10 rows=60150 width=90) (actual time=42833.699..42842.439 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=753424.53..14541201.40 rows=3585511 width=81) (actual time=42825.608..42835.179 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 29kB  Peak Memory: 29kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=180801.31..14189284.95 rows=3585511 width=81) (actual time=1928.506..42624.042 rows=128453 loops=1)
                     ->  Nested Loop  (cost=180800.87..1908496.57 rows=3585511 width=53) (actual time=1927.916..22650.135 rows=128453 loops=1)
                           Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                           ->  Gather Merge  (cost=180800.43..238860.12 rows=484903 width=48) (actual time=1926.912..1954.572 rows=17183 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Sort  (cost=179800.37..180103.44 rows=121226 width=48) (actual time=1903.855..1904.420 rows=3991 loops=5)
                                       Sort Key: nation.n_name
                                       Sort Method: quicksort  Memory: 9025kB
                                       Worker 0:  Sort Method: quicksort  Memory: 9122kB
                                       Worker 1:  Sort Method: quicksort  Memory: 9212kB
                                       Worker 2:  Sort Method: quicksort  Memory: 9106kB
                                       Worker 3:  Sort Method: quicksort  Memory: 9360kB
                                       ->  Hash Join  (cost=3546.53..169564.45 rows=121226 width=48) (actual time=16.523..1836.714 rows=86650 loops=5)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Parallel Hash Join  (cost=3544.97..169190.72 rows=121226 width=26) (actual time=16.411..1816.992 rows=86650 loops=5)
                                                   Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                                   ->  Nested Loop  (cost=0.43..165327.96 rows=121226 width=18) (actual time=1.272..1757.952 rows=86650 loops=5)
                                                         ->  Parallel Seq Scan on part  (cost=0.00..47230.93 rows=30303 width=4) (actual time=0.510..163.817 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                         ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.068..0.073 rows=4 loops=108312)
                                                               Index Cond: (ps_partkey = part.p_partkey)
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=14.815..14.815 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.262..7.707 rows=20000 loops=5)
                                             ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.106..0.106 rows=25 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.097..0.100 rows=25 loops=5)
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.274..1.197 rows=7 loops=17183)
                                 Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.152..0.152 rows=1 loops=128453)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 35.936 ms
 Execution Time: 42842.910 ms
(43 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=753424.53..753654.82 rows=1 width=90) (actual time=2167.199..2181.557 rows=1 loops=1)
   ->  GroupAggregate  (cost=753424.53..14604850.10 rows=60150 width=90) (actual time=2167.198..2181.555 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=753424.53..14541201.40 rows=3585511 width=81) (actual time=2159.067..2174.322 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 29kB  Peak Memory: 29kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=180801.31..14189284.95 rows=3585511 width=81) (actual time=541.416..2090.359 rows=128453 loops=1)
                     ->  Nested Loop  (cost=180800.87..1908496.57 rows=3585511 width=53) (actual time=541.385..1164.973 rows=128453 loops=1)
                           Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                           ->  Gather Merge  (cost=180800.43..238860.12 rows=484903 width=48) (actual time=541.324..564.680 rows=17183 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Sort  (cost=179800.37..180103.44 rows=121226 width=48) (actual time=526.964..527.437 rows=4037 loops=5)
                                       Sort Key: nation.n_name
                                       Sort Method: quicksort  Memory: 8485kB
                                       Worker 0:  Sort Method: quicksort  Memory: 9151kB
                                       Worker 1:  Sort Method: quicksort  Memory: 8891kB
                                       Worker 2:  Sort Method: quicksort  Memory: 8994kB
                                       Worker 3:  Sort Method: quicksort  Memory: 10305kB
                                       ->  Hash Join  (cost=3546.53..169564.45 rows=121226 width=48) (actual time=17.427..454.550 rows=86650 loops=5)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Parallel Hash Join  (cost=3544.97..169190.72 rows=121226 width=26) (actual time=17.349..432.190 rows=86650 loops=5)
                                                   Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                                   ->  Nested Loop  (cost=0.43..165327.96 rows=121226 width=18) (actual time=0.084..370.304 rows=86650 loops=5)
                                                         ->  Parallel Seq Scan on part  (cost=0.00..47230.93 rows=30303 width=4) (actual time=0.041..129.764 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                         ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.009..0.010 rows=4 loops=108312)
                                                               Index Cond: (ps_partkey = part.p_partkey)
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=16.047..16.048 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.034..7.650 rows=20000 loops=5)
                                             ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.071..0.072 rows=25 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.016..0.019 rows=25 loops=5)
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.009..0.033 rows=7 loops=17183)
                                 Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.006..0.006 rows=1 loops=128453)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 6.936 ms
 Execution Time: 2181.664 ms
(43 rows)

query 10 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=950713.01..950713.06 rows=20 width=201) (actual time=21154.466..21223.943 rows=20 loops=1)
   ->  Sort  (cost=950713.01..952149.60 rows=574637 width=201) (actual time=21154.465..21223.939 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=852252.24..935422.12 rows=574637 width=201) (actual time=20137.946..21104.101 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=852252.24..921056.20 rows=574637 width=181) (actual time=20137.927..20458.763 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=851252.19..851611.33 rows=143659 width=181) (actual time=20114.619..20144.146 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 43648kB
                           Worker 0:  Sort Method: external merge  Disk: 43856kB
                           Worker 1:  Sort Method: external merge  Disk: 44008kB
                           Worker 2:  Sort Method: external merge  Disk: 43368kB
                           Worker 3:  Sort Method: external merge  Disk: 43640kB
                           ->  Hash Join  (cost=51055.88..838946.15 rows=143659 width=181) (actual time=565.514..19887.934 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=51054.32..838503.56 rows=143659 width=159) (actual time=565.454..19801.743 rows=229080 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Nested Loop  (cost=6669.66..793741.79 rows=143659 width=16) (actual time=127.920..19175.773 rows=229080 loops=5)
                                             ->  Parallel Bitmap Heap Scan on orders  (cost=6669.10..270105.20 rows=144540 width=8) (actual time=127.227..2308.593 rows=114632 loops=5)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=46553
                                                   Worker 0:  Heap Blocks: exact=46869
                                                   Worker 1:  Heap Blocks: exact=46920
                                                   Worker 2:  Heap Blocks: exact=46237
                                                   Worker 3:  Heap Blocks: exact=46767
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6524.56 rows=578162 width=0) (actual time=75.446..75.446 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.141..0.146 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Parallel Hash  (cost=39697.07..39697.07 rows=375007 width=147) (actual time=435.413..435.413 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 288448kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=147) (actual time=0.412..145.638 rows=300000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.056..0.057 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.049..0.052 rows=25 loops=5)
 Planning Time: 24.918 ms
 Execution Time: 21230.324 ms
(42 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=950713.01..950713.06 rows=20 width=201) (actual time=3940.075..4013.244 rows=20 loops=1)
   ->  Sort  (cost=950713.01..952149.60 rows=574637 width=201) (actual time=3940.074..4013.241 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=852252.24..935422.12 rows=574637 width=201) (actual time=2933.511..3894.217 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=852252.24..921056.20 rows=574637 width=181) (actual time=2933.493..3253.334 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=851252.19..851611.33 rows=143659 width=181) (actual time=2908.462..2937.864 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 43352kB
                           Worker 0:  Sort Method: external merge  Disk: 47672kB
                           Worker 1:  Sort Method: external merge  Disk: 39184kB
                           Worker 2:  Sort Method: external merge  Disk: 45904kB
                           Worker 3:  Sort Method: external merge  Disk: 42416kB
                           ->  Hash Join  (cost=51055.88..838946.15 rows=143659 width=181) (actual time=498.277..2700.624 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=51054.32..838503.56 rows=143659 width=159) (actual time=498.250..2638.008 rows=229080 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Nested Loop  (cost=6669.66..793741.79 rows=143659 width=16) (actual time=119.037..2111.544 rows=229080 loops=5)
                                             ->  Parallel Bitmap Heap Scan on orders  (cost=6669.10..270105.20 rows=144540 width=8) (actual time=118.810..458.240 rows=114632 loops=5)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=46379
                                                   Worker 0:  Heap Blocks: exact=50879
                                                   Worker 1:  Heap Blocks: exact=41864
                                                   Worker 2:  Heap Blocks: exact=49008
                                                   Worker 3:  Heap Blocks: exact=45216
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6524.56 rows=578162 width=0) (actual time=69.089..69.089 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.013..0.014 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Parallel Hash  (cost=39697.07..39697.07 rows=375007 width=147) (actual time=376.873..376.873 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 288416kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=147) (actual time=0.042..74.931 rows=300000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.023..0.023 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.014..0.016 rows=25 loops=5)
 Planning Time: 2.433 ms
 Execution Time: 4019.335 ms
(42 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=446359.96..446359.96 rows=1 width=36) (actual time=3931.429..3946.086 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=195100.75..195100.76 rows=1 width=32) (actual time=152.227..152.327 rows=1 loops=1)
           ->  Gather  (cost=195100.53..195100.74 rows=2 width=32) (actual time=151.712..152.315 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=194100.53..194100.54 rows=1 width=32) (actual time=149.629..149.631 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.72..193100.42 rows=133348 width=10) (actual time=0.125..125.353 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.105..15.317 rows=1337 loops=3)
                                   Join Filter: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   Rows Removed by Join Filter: 31997
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.029..6.603 rows=33333 loops=3)
                                   ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                         Storage: Memory  Maximum Storage: 17kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.052..0.053 rows=1 loops=3)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..112.53 rows=80 width=14) (actual time=0.004..0.073 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=251259.19..251525.89 rows=106678 width=36) (actual time=3931.427..3945.983 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=205451.58..250725.80 rows=106678 width=36) (actual time=3931.419..3945.974 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=205451.58..242724.93 rows=320035 width=14) (actual time=3540.084..3606.522 rows=320800 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Sort  (cost=204451.56..204784.93 rows=133348 width=14) (actual time=3531.013..3538.324 rows=106933 loops=3)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 6475kB
                           Worker 0:  Sort Method: quicksort  Memory: 6283kB
                           Worker 1:  Sort Method: quicksort  Memory: 6485kB
                           ->  Nested Loop  (cost=0.72..193100.42 rows=133348 width=14) (actual time=1.204..3492.834 rows=106933 loops=3)
                                 ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.391..24.196 rows=1337 loops=3)
                                       Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                                       Rows Removed by Join Filter: 31997
                                       ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.238..13.899 rows=33333 loops=3)
                                       ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                             Storage: Memory  Maximum Storage: 17kB
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.111..0.111 rows=1 loops=3)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                 ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..112.53 rows=80 width=18) (actual time=0.079..2.578 rows=80 loops=4010)
                                       Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 15.411 ms
 Execution Time: 3946.494 ms
(48 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=446359.96..446359.96 rows=1 width=36) (actual time=551.556..566.453 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=195100.75..195100.76 rows=1 width=32) (actual time=147.627..147.731 rows=1 loops=1)
           ->  Gather  (cost=195100.53..195100.74 rows=2 width=32) (actual time=147.285..147.720 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=194100.53..194100.54 rows=1 width=32) (actual time=145.016..145.017 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.72..193100.42 rows=133348 width=10) (actual time=0.152..120.814 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.133..15.158 rows=1337 loops=3)
                                   Join Filter: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   Rows Removed by Join Filter: 31997
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.049..6.528 rows=33333 loops=3)
                                   ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                         Storage: Memory  Maximum Storage: 17kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..112.53 rows=80 width=14) (actual time=0.003..0.070 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=251259.19..251525.89 rows=106678 width=36) (actual time=551.555..566.346 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=205451.58..250725.80 rows=106678 width=36) (actual time=551.547..566.338 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=205451.58..242724.93 rows=320035 width=14) (actual time=164.851..230.833 rows=320800 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Sort  (cost=204451.56..204784.93 rows=133348 width=14) (actual time=162.065..169.359 rows=106933 loops=3)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 6420kB
                           Worker 0:  Sort Method: quicksort  Memory: 6440kB
                           Worker 1:  Sort Method: quicksort  Memory: 6383kB
                           ->  Nested Loop  (cost=0.72..193100.42 rows=133348 width=14) (actual time=0.117..137.595 rows=106933 loops=3)
                                 ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.101..15.630 rows=1337 loops=3)
                                       Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                                       Rows Removed by Join Filter: 31997
                                       ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.025..6.898 rows=33333 loops=3)
                                       ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                             Storage: Memory  Maximum Storage: 17kB
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                 ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..112.53 rows=80 width=18) (actual time=0.004..0.082 rows=80 loops=4010)
                                       Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.333 ms
 Execution Time: 566.530 ms
(48 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469330.50..1614439.60 rows=1 width=27) (actual time=13570.067..13573.292 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469330.50..2485094.15 rows=7 width=27) (actual time=13570.066..13573.290 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469330.50..2480094.36 rows=285698 width=27) (actual time=7266.306..13490.705 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469330.07..1503538.02 rows=285698 width=15) (actual time=7265.900..7334.643 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468330.01..1468508.57 rows=71424 width=15) (actual time=7246.107..7248.412 rows=32252 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3540kB
                           Worker 0:  Sort Method: quicksort  Memory: 3460kB
                           Worker 1:  Sort Method: quicksort  Memory: 3477kB
                           Worker 2:  Sort Method: quicksort  Memory: 3458kB
                           Worker 3:  Sort Method: quicksort  Memory: 3475kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462571.77 rows=71424 width=15) (actual time=2.735..7231.773 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.039..0.039 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 16.864 ms
 Execution Time: 13573.749 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469330.50..1614439.60 rows=1 width=27) (actual time=3847.450..3848.899 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469330.50..2485094.15 rows=7 width=27) (actual time=3847.449..3848.897 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469330.50..2480094.36 rows=285698 width=27) (actual time=3352.204..3807.594 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469330.07..1503538.02 rows=285698 width=15) (actual time=3352.150..3390.362 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468330.01..1468508.57 rows=71424 width=15) (actual time=3343.997..3345.740 rows=32258 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3423kB
                           Worker 0:  Sort Method: quicksort  Memory: 3519kB
                           Worker 1:  Sort Method: quicksort  Memory: 3521kB
                           Worker 2:  Sort Method: quicksort  Memory: 3467kB
                           Worker 3:  Sort Method: quicksort  Memory: 3479kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462571.77 rows=71424 width=15) (actual time=0.112..3329.749 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.928 ms
 Execution Time: 3848.955 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361641.75..1361641.76 rows=1 width=16) (actual time=16553.109..16553.112 rows=1 loops=1)
   ->  Sort  (cost=1361641.75..1361642.25 rows=200 width=16) (actual time=16553.107..16553.110 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361638.75..1361640.75 rows=200 width=16) (actual time=16553.079..16553.087 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208131.93..1339138.33 rows=1500028 width=12) (actual time=14419.258..16386.145 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53285.20..662903.14 rows=14848784 width=8) (actual time=366.467..10626.011 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448771.78 rows=14848784 width=8) (actual time=0.675..4979.100 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.85..28674.85 rows=1500028 width=4) (actual time=363.223..363.224 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.85 rows=1500028 width=4) (actual time=0.021..164.823 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 18.692 ms
 Execution Time: 16587.029 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361641.75..1361641.76 rows=1 width=16) (actual time=16055.965..16055.967 rows=1 loops=1)
   ->  Sort  (cost=1361641.75..1361642.25 rows=200 width=16) (actual time=16055.963..16055.965 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361638.75..1361640.75 rows=200 width=16) (actual time=16055.727..16055.734 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208131.93..1339138.33 rows=1500028 width=12) (actual time=13938.013..15889.712 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53285.20..662903.14 rows=14848784 width=8) (actual time=327.806..10124.864 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448771.78 rows=14848784 width=8) (actual time=0.037..4520.277 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.85..28674.85 rows=1500028 width=4) (actual time=325.301..325.302 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.85 rows=1500028 width=4) (actual time=0.021..132.995 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.765 ms
 Execution Time: 16090.087 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=854530.82..854530.84 rows=1 width=32) (actual time=5258.742..5294.789 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=854530.82..854530.84 rows=1 width=32) (actual time=5258.740..5294.786 rows=1 loops=1)
         ->  Gather  (cost=854530.37..854530.78 rows=4 width=64) (actual time=5251.235..5294.761 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=853530.37..853530.38 rows=1 width=64) (actual time=5242.038..5242.041 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64722.27..850122.20 rows=194752 width=33) (actual time=659.935..5104.290 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12491.39..797380.09 rows=194752 width=16) (actual time=286.826..4558.145 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=81268
                                 Worker 0:  Heap Blocks: exact=83541
                                 Worker 1:  Heap Blocks: exact=87338
                                 Worker 2:  Heap Blocks: exact=82381
                                 Worker 3:  Heap Blocks: exact=82041
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12296.64 rows=779007 width=0) (actual time=187.434..187.435 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.95..45980.95 rows=499995 width=25) (actual time=371.010..371.010 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.95 rows=499995 width=25) (actual time=0.358..217.839 rows=400000 loops=5)
 Planning Time: 17.231 ms
 Execution Time: 5295.146 ms
(22 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=854530.82..854530.84 rows=1 width=32) (actual time=1622.424..1653.918 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=854530.82..854530.84 rows=1 width=32) (actual time=1622.423..1653.916 rows=1 loops=1)
         ->  Gather  (cost=854530.37..854530.78 rows=4 width=64) (actual time=1616.506..1653.894 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=853530.37..853530.38 rows=1 width=64) (actual time=1610.890..1610.893 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64722.27..850122.20 rows=194752 width=33) (actual time=522.827..1516.353 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12491.39..797380.09 rows=194752 width=16) (actual time=268.149..1108.659 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=79624
                                 Worker 0:  Heap Blocks: exact=92019
                                 Worker 1:  Heap Blocks: exact=84066
                                 Worker 2:  Heap Blocks: exact=79497
                                 Worker 3:  Heap Blocks: exact=81363
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12296.64 rows=779007 width=0) (actual time=168.607..168.608 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.95..45980.95 rows=499995 width=25) (actual time=252.693..252.694 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.95 rows=499995 width=25) (actual time=0.691..79.167 rows=400000 loops=5)
 Planning Time: 1.180 ms
 Execution Time: 1653.966 ms
(22 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2746520.89..2746628.13 rows=1 width=103) (actual time=13021.852..13068.164 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1392112.59..1392112.60 rows=1 width=32) (actual time=2812.611..2821.742 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1389577.66..1390845.13 rows=101397 width=36) (actual time=2771.995..2815.877 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 57361kB
                 ->  Gather  (cost=1344709.49..1386535.75 rows=405588 width=36) (actual time=2461.493..2543.194 rows=398567 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1343709.49..1344976.95 rows=101397 width=36) (actual time=2456.816..2502.620 rows=99642 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 43025kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=38024.35..1337780.76 rows=592873 width=16) (actual time=431.181..2022.537 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=105029 lossy=70023
                                   Worker 0:  Heap Blocks: exact=98003 lossy=65337
                                   Worker 1:  Heap Blocks: exact=98826 lossy=66053
                                   Worker 2:  Heap Blocks: exact=99295 lossy=65692
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37431.48 rows=2371491 width=0) (actual time=340.891..340.892 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1354408.29..1408777.54 rows=507 width=103) (actual time=13021.851..13059.030 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1354408.00..1407533.80 rows=507 width=36) (actual time=13021.240..13058.418 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1354408.00..1402970.93 rows=405588 width=36) (actual time=10022.635..10121.420 rows=346361 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1353407.94..1353661.43 rows=101397 width=36) (actual time=9991.999..9999.327 rows=69764 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11573kB
                           Worker 0:  Sort Method: quicksort  Memory: 11572kB
                           Worker 1:  Sort Method: quicksort  Memory: 11582kB
                           Worker 2:  Sort Method: quicksort  Memory: 11577kB
                           Worker 3:  Sort Method: quicksort  Memory: 11583kB
                           ->  Partial HashAggregate  (cost=1343709.49..1344976.95 rows=101397 width=36) (actual time=9906.989..9963.578 rows=98967 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=38024.35..1337780.76 rows=592873 width=16) (actual time=479.247..9428.979 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79277 lossy=52995
                                       Worker 0:  Heap Blocks: exact=79920 lossy=53535
                                       Worker 1:  Heap Blocks: exact=81155 lossy=54084
                                       Worker 2:  Heap Blocks: exact=79825 lossy=52812
                                       Worker 3:  Heap Blocks: exact=80976 lossy=53679
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37431.48 rows=2371491 width=0) (actual time=393.913..393.913 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.44 rows=1 width=71) (actual time=0.604..0.605 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 14.838 ms
 Execution Time: 13070.462 ms
(60 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2746520.89..2746628.13 rows=1 width=103) (actual time=5769.052..5819.612 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1392112.59..1392112.60 rows=1 width=32) (actual time=2810.656..2820.380 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1389577.66..1390845.13 rows=101397 width=36) (actual time=2767.206..2814.504 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 56337kB
                 ->  Gather  (cost=1344709.49..1386535.75 rows=405588 width=36) (actual time=2458.378..2539.880 rows=398529 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1343709.49..1344976.95 rows=101397 width=36) (actual time=2453.809..2499.544 rows=99632 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 39953kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=38024.35..1337780.76 rows=592873 width=16) (actual time=428.365..2019.005 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=105522 lossy=70392
                                   Worker 0:  Heap Blocks: exact=99162 lossy=65820
                                   Worker 1:  Heap Blocks: exact=97683 lossy=65035
                                   Worker 2:  Heap Blocks: exact=98786 lossy=65858
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37431.48 rows=2371491 width=0) (actual time=338.173..338.173 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1354408.29..1408777.54 rows=507 width=103) (actual time=5769.050..5809.885 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1354408.00..1407533.80 rows=507 width=36) (actual time=5768.999..5809.832 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1354408.00..1402970.93 rows=405588 width=36) (actual time=2773.299..2875.571 rows=346034 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1353407.94..1353661.43 rows=101397 width=36) (actual time=2743.789..2750.960 rows=69702 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11558kB
                           Worker 0:  Sort Method: quicksort  Memory: 11605kB
                           Worker 1:  Sort Method: quicksort  Memory: 11518kB
                           Worker 2:  Sort Method: quicksort  Memory: 11562kB
                           Worker 3:  Sort Method: quicksort  Memory: 11607kB
                           ->  Partial HashAggregate  (cost=1343709.49..1344976.95 rows=101397 width=36) (actual time=2658.996..2720.664 rows=98880 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=38024.35..1337780.76 rows=592873 width=16) (actual time=437.656..2249.620 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=76491 lossy=51344
                                       Worker 0:  Heap Blocks: exact=87527 lossy=57792
                                       Worker 1:  Heap Blocks: exact=71283 lossy=47392
                                       Worker 2:  Heap Blocks: exact=78033 lossy=52034
                                       Worker 3:  Heap Blocks: exact=87819 lossy=58543
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..37431.48 rows=2371491 width=0) (actual time=351.351..351.351 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.44 rows=1 width=71) (actual time=0.047..0.047 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.367 ms
 Execution Time: 5821.639 ms
(60 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=250275.12..250275.12 rows=1 width=44) (actual time=2864.860..2871.892 rows=1 loops=1)
   ->  Sort  (cost=250275.12..250657.30 rows=152872 width=44) (actual time=2864.859..2871.890 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=171972.98..249510.76 rows=152872 width=44) (actual time=2206.960..2866.654 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=171972.98..242123.23 rows=585881 width=40) (actual time=2206.909..2704.729 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=170972.92..171339.10 rows=146470 width=40) (actual time=2041.182..2056.578 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 18107kB
                           Worker 0:  Sort Method: quicksort  Memory: 19454kB
                           Worker 1:  Sort Method: quicksort  Memory: 20608kB
                           Worker 2:  Sort Method: quicksort  Memory: 21271kB
                           Worker 3:  Sort Method: quicksort  Memory: 21274kB
                           ->  Parallel Hash Join  (cost=57867.65..158405.62 rows=146470 width=40) (actual time=347.277..1097.585 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101384.12 rows=1000110 width=8) (actual time=36.664..599.247 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.207..35.756 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.87..53480.87 rows=73226 width=40) (actual time=309.983..309.984 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.87 rows=73226 width=40) (actual time=0.125..285.886 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 19.116 ms
 Execution Time: 2872.712 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=250275.12..250275.12 rows=1 width=44) (actual time=2561.663..2565.076 rows=1 loops=1)
   ->  Sort  (cost=250275.12..250657.30 rows=152872 width=44) (actual time=2561.661..2565.074 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=171972.98..249510.76 rows=152872 width=44) (actual time=1903.550..2559.905 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=171972.98..242123.23 rows=585881 width=40) (actual time=1903.501..2398.176 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=170972.92..171339.10 rows=146470 width=40) (actual time=1779.372..1794.898 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 25335kB
                           Worker 0:  Sort Method: quicksort  Memory: 18794kB
                           Worker 1:  Sort Method: quicksort  Memory: 25323kB
                           Worker 2:  Sort Method: quicksort  Memory: 20010kB
                           Worker 3:  Sort Method: quicksort  Memory: 17599kB
                           ->  Parallel Hash Join  (cost=57867.65..158405.62 rows=146470 width=40) (actual time=181.462..787.865 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101384.12 rows=1000110 width=8) (actual time=27.123..439.233 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.082..26.865 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.87..53480.87 rows=73226 width=40) (actual time=153.707..153.708 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.87 rows=73226 width=40) (actual time=0.016..125.831 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 1.315 ms
 Execution Time: 2565.159 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3366362.72..3366362.74 rows=1 width=32) (actual time=24151.926..24244.827 rows=1 loops=1)
   ->  Aggregate  (cost=3366362.72..3366362.74 rows=1 width=32) (actual time=24151.925..24244.824 rows=1 loops=1)
         ->  Merge Join  (cost=2271915.49..3366315.57 rows=18859 width=8) (actual time=18195.790..24243.979 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2270914.56..3260667.51 rows=1889063 width=36) (actual time=18164.845..24026.354 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2270914.56..3175659.68 rows=7556252 width=36) (actual time=18164.827..20134.474 rows=9972509 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2269914.50..2274637.16 rows=1889063 width=36) (actual time=17780.050..18060.477 rows=1994996 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150352kB
                                 Worker 0:  Sort Method: external merge  Disk: 150368kB
                                 Worker 1:  Sort Method: external merge  Disk: 150344kB
                                 Worker 2:  Sort Method: external merge  Disk: 150360kB
                                 Worker 3:  Sort Method: external merge  Disk: 150360kB
                                 ->  Partial HashAggregate  (cost=1869712.38..2039779.12 rows=1889063 width=36) (actual time=9949.972..16880.622 rows=1995167 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407608kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407568kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 393256kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 404488kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 405584kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275111.34 rows=14996834 width=9) (actual time=0.781..4005.958 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..100068.46 rows=59898 width=21) (actual time=28.880..72.652 rows=59951 loops=1)
                     Storage: Memory  Maximum Storage: 19kB
                     ->  Gather Merge  (cost=1000.93..99918.71 rows=59898 width=21) (actual time=28.873..65.746 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..91784.23 rows=14974 width=21) (actual time=1.581..679.860 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.24 rows=499 width=4) (actual time=0.764..204.853 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.92 rows=32 width=17) (actual time=0.708..0.943 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 17.003 ms
 Execution Time: 24312.315 ms
(39 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3366362.72..3366362.74 rows=1 width=32) (actual time=22443.426..22527.193 rows=1 loops=1)
   ->  Aggregate  (cost=3366362.72..3366362.74 rows=1 width=32) (actual time=22443.424..22527.191 rows=1 loops=1)
         ->  Merge Join  (cost=2271915.49..3366315.57 rows=18859 width=8) (actual time=16549.936..22526.484 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2270914.56..3260667.51 rows=1889063 width=36) (actual time=16540.799..22355.534 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2270914.56..3175659.68 rows=7556252 width=36) (actual time=16540.780..18480.193 rows=9972080 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2269914.50..2274637.16 rows=1889063 width=36) (actual time=16298.588..16573.916 rows=1994894 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150312kB
                                 Worker 0:  Sort Method: external merge  Disk: 150320kB
                                 Worker 1:  Sort Method: external merge  Disk: 150368kB
                                 Worker 2:  Sort Method: external merge  Disk: 150456kB
                                 Worker 3:  Sort Method: external merge  Disk: 150296kB
                                 ->  Partial HashAggregate  (cost=1869712.38..2039779.12 rows=1889063 width=36) (actual time=8395.008..15418.599 rows=1995082 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 391720kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 391768kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407568kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 424192kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 391464kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275111.34 rows=14996834 width=9) (actual time=0.069..1403.406 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..100068.46 rows=59898 width=21) (actual time=7.220..28.711 rows=59951 loops=1)
                     Storage: Memory  Maximum Storage: 19kB
                     ->  Gather Merge  (cost=1000.93..99918.71 rows=59898 width=21) (actual time=7.213..22.118 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..91784.23 rows=14974 width=21) (actual time=0.228..125.601 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.24 rows=499 width=4) (actual time=0.210..104.911 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..49.92 rows=32 width=17) (actual time=0.005..0.037 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.963 ms
 Execution Time: 22590.799 ms
(39 rows)

query 18 run 1
SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8579485.58..8579485.83 rows=100 width=71) (actual time=69442.012..69454.337 rows=99 loops=1)
   ->  Sort  (cost=8579485.58..8629463.48 rows=19991157 width=71) (actual time=69442.011..69454.330 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=829465.04..7815437.94 rows=19991157 width=71) (actual time=39419.741..69454.220 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=829465.04..7415614.80 rows=19991157 width=44) (actual time=39419.730..69453.943 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=829464.64..6690692.66 rows=19991157 width=44) (actual time=38848.597..69453.446 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829398.47..4160944.85 rows=4998945 width=43) (actual time=38543.376..58263.214 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828398.42..3564522.25 rows=1249736 width=43) (actual time=6105.275..36517.501 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828397.85..837773.04 rows=3750076 width=39) (actual time=3832.381..4171.010 rows=2996546 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 145392kB
                                             Worker 0:  Sort Method: external merge  Disk: 152488kB
                                             Worker 1:  Sort Method: external merge  Disk: 152096kB
                                             Worker 2:  Sort Method: external merge  Disk: 149320kB
                                             Worker 3:  Sort Method: external merge  Disk: 148600kB
                                             ->  Parallel Hash Join  (cost=44384.66..352997.40 rows=3750076 width=39) (actual time=354.445..3106.960 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298768.76 rows=3750076 width=20) (actual time=0.749..1259.473 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.07..39697.07 rows=375007 width=23) (actual time=351.503..351.504 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=23) (actual time=0.400..244.952 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692379.29 rows=4998945 width=4) (actual time=785.461..32134.770 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167490.10 rows=59987336 width=9) (actual time=1.475..18620.854 rows=59986052 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167490.10 rows=59987336 width=9) (actual time=0.044..7853.352 rows=59916431 loops=1)
 Planning Time: 25.816 ms
 Execution Time: 69471.132 ms
(38 rows)

SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8579485.58..8579485.83 rows=100 width=71) (actual time=67099.711..67111.028 rows=99 loops=1)
   ->  Sort  (cost=8579485.58..8629463.48 rows=19991157 width=71) (actual time=67099.710..67111.020 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=829465.04..7815437.94 rows=19991157 width=71) (actual time=38690.243..67110.912 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=829465.04..7415614.80 rows=19991157 width=44) (actual time=38690.232..67110.624 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=829464.64..6690692.66 rows=19991157 width=44) (actual time=33704.144..67110.150 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829398.47..4160944.85 rows=4998945 width=43) (actual time=33370.403..55832.906 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828398.42..3564522.25 rows=1249736 width=43) (actual time=5184.482..31906.303 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828397.85..837773.04 rows=3750076 width=39) (actual time=3058.463..3385.611 rows=2996545 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 149232kB
                                             Worker 0:  Sort Method: external merge  Disk: 147208kB
                                             Worker 1:  Sort Method: external merge  Disk: 146192kB
                                             Worker 2:  Sort Method: external merge  Disk: 157264kB
                                             Worker 3:  Sort Method: external merge  Disk: 148008kB
                                             ->  Parallel Hash Join  (cost=44384.66..352997.40 rows=3750076 width=39) (actual time=200.643..2229.537 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298768.76 rows=3750076 width=20) (actual time=0.041..383.068 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.07..39697.07 rows=375007 width=23) (actual time=197.583..197.583 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375007 width=23) (actual time=0.039..66.282 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692379.29 rows=4998945 width=4) (actual time=607.498..28315.961 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14996446
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167490.10 rows=59987336 width=9) (actual time=0.065..14966.372 rows=59972128 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167490.10 rows=59987336 width=9) (actual time=0.056..7939.000 rows=59916431 loops=1)
 Planning Time: 1.932 ms
 Execution Time: 67128.106 ms
(38 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=126269.87..126269.88 rows=1 width=32) (actual time=5046.936..5056.311 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=126269.87..126269.88 rows=1 width=32) (actual time=5046.935..5056.309 rows=1 loops=1)
         ->  Gather  (cost=126269.44..126269.85 rows=4 width=32) (actual time=5025.871..5056.283 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=125269.44..125269.45 rows=1 width=32) (actual time=5027.082..5027.083 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..125267.25 rows=292 width=12) (actual time=42.895..5026.492 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.78 rows=1213 width=30) (actual time=0.780..165.602 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.96 rows=1 width=21) (actual time=4.576..5.082 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 19.919 ms
 Execution Time: 5057.134 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=126269.87..126269.88 rows=1 width=32) (actual time=215.126..233.290 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=126269.87..126269.88 rows=1 width=32) (actual time=215.125..233.288 rows=1 loops=1)
         ->  Gather  (cost=126269.44..126269.85 rows=4 width=32) (actual time=209.824..233.271 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=125269.44..125269.45 rows=1 width=32) (actual time=204.419..204.420 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..125267.25 rows=292 width=12) (actual time=1.832..204.252 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.78 rows=1213 width=30) (actual time=1.020..124.793 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..51.96 rows=1 width=21) (actual time=0.071..0.083 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.142 ms
 Execution Time: 233.342 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2460604.56..2659863.90 rows=1 width=51) (actual time=28400.719..28402.125 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2460604.56..2659863.90 rows=1 width=51) (actual time=28400.718..28402.123 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=26.467..27.799 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=18.741..18.757 rows=392 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 275kB
                     Worker 0:  Sort Method: quicksort  Memory: 172kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.376..17.369 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.253..12.653 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.115..0.115 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.109..0.111 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2456481.63..2655105.09 rows=3 width=8) (actual time=26860.852..28373.242 rows=13474 loops=1)
               Storage: Memory  Maximum Storage: 550kB
               ->  Hash Join  (cost=2456481.63..2655105.07 rows=3 width=8) (actual time=26860.847..28370.155 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2380015.91..2542235.85 rows=4853783 width=40) (actual time=25410.260..26716.819 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146801.65..1994108.57 rows=9155911 width=13) (actual time=1218.966..20442.073 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144512.67 rows=9155911 width=0) (actual time=1095.556..1095.556 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75253.45..75253.45 rows=80818 width=16) (actual time=1450.306..1450.377 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75253.45 rows=80818 width=16) (actual time=2.179..1429.939 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.65 rows=20204 width=16) (actual time=1.268..1433.893 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.93 rows=5050 width=4) (actual time=0.561..116.250 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.282..0.302 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 26.483 ms
 Execution Time: 28449.624 ms
(47 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2460604.56..2659863.90 rows=1 width=51) (actual time=15074.839..15076.399 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2460604.56..2659863.90 rows=1 width=51) (actual time=15074.838..15076.397 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=16.750..18.241 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=14.222..14.239 rows=391 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 280kB
                     Worker 0:  Sort Method: quicksort  Memory: 167kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.080..12.817 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.032..8.298 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.024..0.025 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.018..0.020 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2456481.63..2655105.09 rows=3 width=8) (actual time=13548.965..15057.049 rows=13474 loops=1)
               Storage: Memory  Maximum Storage: 550kB
               ->  Hash Join  (cost=2456481.63..2655105.07 rows=3 width=8) (actual time=13548.959..15053.859 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2380015.91..2542235.85 rows=4853783 width=40) (actual time=13380.917..14686.360 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146801.65..1994108.57 rows=9155911 width=13) (actual time=1066.296..9270.853 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144512.67 rows=9155911 width=0) (actual time=943.362..943.362 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75253.45..75253.45 rows=80818 width=16) (actual time=167.746..167.812 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75253.45 rows=80818 width=16) (actual time=0.341..149.703 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.65 rows=20204 width=16) (actual time=0.114..147.405 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.93 rows=5050 width=4) (actual time=0.055..77.027 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.014..0.015 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.224 ms
 Execution Time: 15122.224 ms
(47 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1963268.08..1963268.09 rows=1 width=34) (actual time=11514.631..11526.596 rows=100 loops=1)
   ->  Sort  (cost=1963268.08..1963268.09 rows=1 width=34) (actual time=11514.630..11526.588 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1963264.86..1963268.07 rows=1 width=34) (actual time=10953.303..11524.197 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1963264.86..1963268.06 rows=1 width=26) (actual time=10953.095..11513.416 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1963264.29..1963264.42 rows=1 width=38) (actual time=10953.052..11000.523 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1962264.23..1962264.24 rows=1 width=38) (actual time=10925.365..10927.116 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1104kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1120kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1116kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1061kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1128kB
                                 ->  Nested Loop Anti Join  (cost=1337995.68..1962264.22 rows=1 width=38) (actual time=7264.108..10848.748 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1337995.12..1653242.77 rows=96242 width=38) (actual time=7262.249..9288.718 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308143.94 rows=1830162 width=4) (actual time=0.626..1493.714 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335530.08..1335530.08 rows=197203 width=34) (actual time=7260.431..7260.741 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335530.08 rows=197203 width=34) (actual time=16.748..7108.557 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312603.43 rows=4998945 width=8) (actual time=0.361..6331.919 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=16.173..16.175 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.519..15.726 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.452..13.715 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.059..0.060 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.056..0.057 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.010..0.010 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 23.198 ms
 Execution Time: 11527.404 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1963268.08..1963268.09 rows=1 width=34) (actual time=6695.625..6710.243 rows=100 loops=1)
   ->  Sort  (cost=1963268.08..1963268.09 rows=1 width=34) (actual time=6695.624..6710.235 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1963264.86..1963268.07 rows=1 width=34) (actual time=6173.655..6707.870 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1963264.86..1963268.06 rows=1 width=26) (actual time=6173.464..6697.493 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1963264.29..1963264.42 rows=1 width=38) (actual time=6173.433..6222.725 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1962264.23..1962264.24 rows=1 width=38) (actual time=6150.630..6152.390 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1035kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1082kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1177kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1121kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1114kB
                                 ->  Nested Loop Anti Join  (cost=1337995.68..1962264.22 rows=1 width=38) (actual time=3682.417..6074.089 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1337995.12..1653242.77 rows=96242 width=38) (actual time=3682.209..4826.226 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308143.94 rows=1830162 width=4) (actual time=0.035..555.504 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335530.08..1335530.08 rows=197203 width=34) (actual time=3680.441..3680.744 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131360kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335530.08 rows=197203 width=34) (actual time=11.567..3500.971 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312603.43 rows=4998945 width=8) (actual time=0.045..2647.255 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=9.152..9.154 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.064..8.770 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.032..6.073 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.021..0.022 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.019..0.020 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.473 ms
 Execution Time: 6710.345 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93877.31..93878.92 rows=1 width=72) (actual time=1490.568..1494.405 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46821.30..46821.31 rows=1 width=32) (actual time=317.594..317.696 rows=1 loops=1)
           ->  Gather  (cost=46820.86..46821.27 rows=4 width=32) (actual time=317.016..317.685 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.86..45820.87 rows=1 width=32) (actual time=305.201..305.202 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.93 rows=11971 width=6) (actual time=0.308..297.260 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.01..59693.38 rows=7844 width=72) (actual time=1490.567..1494.301 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.01..59497.28 rows=7844 width=38) (actual time=481.950..1488.068 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.57..49150.93 rows=17500 width=26) (actual time=480.053..499.787 rows=27130 loops=1)
                     Workers Planned: 4
                     Workers Launched: 3
                     ->  Sort  (cost=46055.51..46066.45 rows=4375 width=26) (actual time=157.370..158.276 rows=7634 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3884kB
                           Worker 0:  Sort Method: quicksort  Memory: 3787kB
                           Worker 1:  Sort Method: quicksort  Memory: 3683kB
                           Worker 2:  Sort Method: quicksort  Memory: 3751kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.93 rows=4375 width=26) (actual time=0.020..142.888 rows=47782 loops=4)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.036..0.036 rows=1 loops=27130)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 15.585 ms
 Execution Time: 1495.121 ms
(30 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93877.31..93878.92 rows=1 width=72) (actual time=423.571..427.126 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46821.30..46821.31 rows=1 width=32) (actual time=193.567..193.664 rows=1 loops=1)
           ->  Gather  (cost=46820.86..46821.27 rows=4 width=32) (actual time=191.178..193.635 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.86..45820.87 rows=1 width=32) (actual time=186.486..186.486 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.93 rows=11971 width=6) (actual time=0.021..176.447 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.01..59693.38 rows=7844 width=72) (actual time=423.570..427.026 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.01..59497.28 rows=7844 width=38) (actual time=357.111..425.022 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.57..49150.93 rows=17500 width=26) (actual time=357.042..367.519 rows=27128 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=46055.51..46066.45 rows=4375 width=26) (actual time=156.934..157.481 rows=6323 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3936kB
                           Worker 0:  Sort Method: quicksort  Memory: 3648kB
                           Worker 1:  Sort Method: quicksort  Memory: 1854kB
                           Worker 2:  Sort Method: quicksort  Memory: 3826kB
                           Worker 3:  Sort Method: quicksort  Memory: 1842kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.93 rows=4375 width=26) (actual time=0.021..144.638 rows=38226 loops=5)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 1.127 ms
 Execution Time: 427.194 ms
(31 rows)

