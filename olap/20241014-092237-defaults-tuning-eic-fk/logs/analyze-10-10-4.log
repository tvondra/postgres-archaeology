query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1905563.82..1905564.02 rows=1 width=236) (actual time=21845.337..21845.399 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1905563.82..1905565.06 rows=6 width=236) (actual time=21845.336..21845.398 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Sort  (cost=1905563.82..1905563.88 rows=24 width=236) (actual time=21845.303..21845.366 rows=6 loops=1)
               Sort Key: l_returnflag, l_linestatus
               Sort Method: quicksort  Memory: 35kB
               ->  Gather  (cost=1905560.70..1905563.27 rows=24 width=236) (actual time=21844.406..21845.330 rows=20 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=1904560.70..1904560.87 rows=6 width=236) (actual time=21836.164..21836.175 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312590.30 rows=14799260 width=25) (actual time=0.106..6078.353 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning time: 13.235 ms
 Execution time: 21846.157 ms
(16 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1905563.82..1905564.02 rows=1 width=236) (actual time=19190.115..19190.179 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1905563.82..1905565.06 rows=6 width=236) (actual time=19190.114..19190.177 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Sort  (cost=1905563.82..1905563.88 rows=24 width=236) (actual time=19190.088..19190.152 rows=6 loops=1)
               Sort Key: l_returnflag, l_linestatus
               Sort Method: quicksort  Memory: 35kB
               ->  Gather  (cost=1905560.70..1905563.27 rows=24 width=236) (actual time=19188.971..19189.907 rows=20 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=1904560.70..1904560.87 rows=6 width=236) (actual time=19185.434..19185.444 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312590.30 rows=14799260 width=25) (actual time=0.029..3092.856 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning time: 0.605 ms
 Execution time: 19190.321 ms
(16 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1072179.63..1072179.64 rows=1 width=193) (actual time=5004.905..5005.015 rows=100 loops=1)
   ->  Sort  (cost=1072179.63..1072179.64 rows=1 width=193) (actual time=5004.904..5005.008 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=558488.70..1072179.62 rows=1 width=193) (actual time=3764.198..5001.942 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68687.68 rows=8187 width=30) (actual time=10.729..16.610 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.47 rows=2047 width=30) (actual time=1.299..310.826 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=557488.11..565487.88 rows=1599953 width=173) (actual time=3752.342..4146.249 rows=1603828 loops=1)
                     ->  Sort  (cost=557488.11..561488.00 rows=1599953 width=173) (actual time=3752.339..4005.057 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293440kB
                           ->  Hash Join  (cost=4048.51..304726.67 rows=1599953 width=173) (actual time=58.336..2537.658 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255219.66 rows=7999766 width=14) (actual time=0.012..1111.897 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=167) (actual time=58.275..58.277 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=167) (actual time=0.027..52.179 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.003..39.009 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.020..0.021 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.014..0.019 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.002..0.004 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.007..0.007 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.004..0.005 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.102..0.102 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.091..0.099 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.085..0.097 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.084..0.096 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.080..0.082 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.010..0.011 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 21.932 ms
 Execution time: 5040.660 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1072179.63..1072179.64 rows=1 width=193) (actual time=3955.830..3955.945 rows=100 loops=1)
   ->  Sort  (cost=1072179.63..1072179.64 rows=1 width=193) (actual time=3955.829..3955.938 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=558488.70..1072179.62 rows=1 width=193) (actual time=3281.715..3953.684 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68687.68 rows=8187 width=30) (actual time=6.976..10.794 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.47 rows=2047 width=30) (actual time=0.141..117.722 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=557488.11..565487.88 rows=1599953 width=173) (actual time=3274.650..3658.950 rows=1603828 loops=1)
                     ->  Sort  (cost=557488.11..561488.00 rows=1599953 width=173) (actual time=3274.646..3519.210 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293440kB
                           ->  Hash Join  (cost=4048.51..304726.67 rows=1599953 width=173) (actual time=44.419..2103.196 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255219.66 rows=7999766 width=14) (actual time=0.012..798.027 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=167) (actual time=44.381..44.383 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=167) (actual time=0.024..38.990 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.003..7.751 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.017..0.019 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.012..0.017 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.002..0.003 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.006..0.006 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.004..0.005 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.016..0.016 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.009..0.014 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.011 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.003 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.010..0.010 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 1.973 ms
 Execution time: 3993.618 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2344668.76..2344668.79 rows=10 width=44) (actual time=14556.503..14590.666 rows=10 loops=1)
   ->  Sort  (cost=2344668.76..2352655.97 rows=3194883 width=44) (actual time=14556.502..14590.664 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Finalize GroupAggregate  (cost=1791253.29..2275628.49 rows=3194883 width=44) (actual time=14358.304..14568.572 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1791253.29..2195756.40 rows=3194884 width=44) (actual time=14358.296..14477.895 rows=113934 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1790253.23..1814214.86 rows=798721 width=44) (actual time=14345.829..14390.878 rows=22787 loops=5)
                           Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           ->  Sort  (cost=1790253.23..1792250.03 rows=798721 width=24) (actual time=14345.796..14349.282 rows=60306 loops=5)
                                 Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                                 Sort Method: quicksort  Memory: 6274kB
                                 ->  Nested Loop  (cost=58461.44..1701417.04 rows=798721 width=24) (actual time=598.602..14323.914 rows=60306 loops=5)
                                       ->  Hash Join  (cost=58460.88..371386.93 rows=365993 width=12) (actual time=595.186..2147.175 rows=290361 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308141.52 rows=1822674 width=16) (actual time=0.060..1172.509 rows=1447887 loops=5)
                                                   Filter: (o_orderdate < '1995-03-07'::date)
                                                   Rows Removed by Filter: 1552113
                                             ->  Hash  (cost=54696.06..54696.06 rows=301185 width=4) (actual time=593.672..593.672 rows=300276 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                                   ->  Seq Scan on customer  (cost=0.00..54696.06 rows=301185 width=4) (actual time=0.043..540.742 rows=300276 loops=5)
                                                         Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                         Rows Removed by Filter: 1199724
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.041..0.042 rows=0 loops=1451805)
                                             Index Cond: (l_orderkey = orders.o_orderkey)
                                             Filter: (l_shipdate > '1995-03-07'::date)
                                             Rows Removed by Filter: 4
 Planning time: 21.529 ms
 Execution time: 14591.395 ms
(31 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2344668.76..2344668.79 rows=10 width=44) (actual time=4301.120..4340.789 rows=10 loops=1)
   ->  Sort  (cost=2344668.76..2352655.97 rows=3194883 width=44) (actual time=4301.118..4340.787 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Finalize GroupAggregate  (cost=1791253.29..2275628.49 rows=3194883 width=44) (actual time=4095.422..4318.552 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1791253.29..2195756.40 rows=3194884 width=44) (actual time=4095.417..4226.464 rows=113934 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1790253.23..1814214.86 rows=798721 width=44) (actual time=4087.995..4134.290 rows=22787 loops=5)
                           Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           ->  Sort  (cost=1790253.23..1792250.03 rows=798721 width=24) (actual time=4087.983..4091.564 rows=60306 loops=5)
                                 Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                                 Sort Method: quicksort  Memory: 6402kB
                                 ->  Nested Loop  (cost=58461.44..1701417.04 rows=798721 width=24) (actual time=444.580..4069.585 rows=60306 loops=5)
                                       ->  Hash Join  (cost=58460.88..371386.93 rows=365993 width=12) (actual time=444.245..1325.805 rows=290361 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308141.52 rows=1822674 width=16) (actual time=0.023..523.897 rows=1447887 loops=5)
                                                   Filter: (o_orderdate < '1995-03-07'::date)
                                                   Rows Removed by Filter: 1552113
                                             ->  Hash  (cost=54696.06..54696.06 rows=301185 width=4) (actual time=442.617..442.617 rows=300276 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                                   ->  Seq Scan on customer  (cost=0.00..54696.06 rows=301185 width=4) (actual time=0.027..385.605 rows=300276 loops=5)
                                                         Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                         Rows Removed by Filter: 1199724
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.009..0.009 rows=0 loops=1451805)
                                             Index Cond: (l_orderkey = orders.o_orderkey)
                                             Filter: (l_shipdate > '1995-03-07'::date)
                                             Rows Removed by Filter: 4
 Planning time: 1.465 ms
 Execution time: 4341.116 ms
(31 rows)

query 4 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=712666.41..712666.45 rows=1 width=24) (actual time=20592.469..20636.690 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=712666.41..712666.61 rows=5 width=24) (actual time=20592.468..20636.688 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Sort  (cost=712666.41..712666.46 rows=20 width=24) (actual time=20592.463..20636.683 rows=6 loops=1)
               Sort Key: orders.o_orderpriority
               Sort Method: quicksort  Memory: 26kB
               ->  Gather  (cost=712663.93..712665.98 rows=20 width=24) (actual time=20587.929..20635.778 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=711663.93..711663.98 rows=5 width=24) (actual time=20581.301..20581.303 rows=5 loops=5)
                           Group Key: orders.o_orderpriority
                           ->  Nested Loop Semi Join  (cost=7929.30..710974.19 rows=137948 width=16) (actual time=153.684..20495.541 rows=102764 loops=5)
                                 ->  Parallel Bitmap Heap Scan on orders  (cost=7928.74..271266.48 rows=137983 width=20) (actual time=153.471..2264.569 rows=112085 loops=5)
                                       Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                       Heap Blocks: exact=46767
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..7790.76 rows=551932 width=0) (actual time=106.921..106.922 rows=560424 loops=1)
                                             Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.162..0.162 rows=1 loops=560424)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_commitdate < l_receiptdate)
                                       Rows Removed by Filter: 1
 Planning time: 16.747 ms
 Execution time: 20637.300 ms
(23 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=712666.41..712666.45 rows=1 width=24) (actual time=2155.576..2194.020 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=712666.41..712666.61 rows=5 width=24) (actual time=2155.575..2194.018 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Sort  (cost=712666.41..712666.46 rows=20 width=24) (actual time=2155.569..2194.012 rows=6 loops=1)
               Sort Key: orders.o_orderpriority
               Sort Method: quicksort  Memory: 26kB
               ->  Gather  (cost=712663.93..712665.98 rows=20 width=24) (actual time=2150.353..2193.976 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=711663.93..711663.98 rows=5 width=24) (actual time=2145.867..2145.869 rows=5 loops=5)
                           Group Key: orders.o_orderpriority
                           ->  Nested Loop Semi Join  (cost=7929.30..710974.19 rows=137948 width=16) (actual time=148.036..2101.957 rows=102764 loops=5)
                                 ->  Parallel Bitmap Heap Scan on orders  (cost=7928.74..271266.48 rows=137983 width=20) (actual time=147.967..537.841 rows=112085 loops=5)
                                       Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                       Heap Blocks: exact=45985
                                       ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..7790.76 rows=551932 width=0) (actual time=99.192..99.193 rows=560424 loops=1)
                                             Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.013..0.013 rows=1 loops=560424)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_commitdate < l_receiptdate)
                                       Rows Removed by Filter: 1
 Planning time: 1.144 ms
 Execution time: 2194.091 ms
(23 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=797551.73..797551.73 rows=1 width=58) (actual time=22809.138..22856.662 rows=1 loops=1)
   ->  Sort  (cost=797551.73..797551.79 rows=25 width=58) (actual time=22809.137..22856.660 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=797308.83..797551.61 rows=25 width=58) (actual time=22800.212..22856.645 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=797308.83..797550.54 rows=100 width=58) (actual time=22798.879..22856.612 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=796308.78..796538.58 rows=25 width=58) (actual time=22784.104..22790.660 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=796308.78..796354.67 rows=18359 width=38) (actual time=22782.835..22783.504 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1519kB
                                 ->  Hash Join  (cost=101027.28..795008.57 rows=18359 width=38) (actual time=1080.522..22768.964 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=96306.28..787877.10 rows=459137 width=50) (actual time=1034.552..22610.910 rows=363065 loops=5)
                                             ->  Hash Join  (cost=96305.72..369485.56 rows=114813 width=38) (actual time=1033.574..3082.508 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=32982.58..302861.55 rows=574064 width=8) (actual time=341.571..2224.958 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52377
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..32408.52 rows=2296258 width=0) (actual time=281.932..281.932 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Hash  (cost=59573.33..59573.33 rows=299985 width=38) (actual time=690.567..690.569 rows=299436 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                                         ->  Hash Join  (cost=2.51..59573.33 rows=299985 width=38) (actual time=0.092..626.550 rows=299436 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=8) (actual time=0.040..426.701 rows=1500000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.037..0.039 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.031..0.036 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.009..0.010 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.016..0.016 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.014 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.203..0.214 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.325..42.325 rows=100000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.020..22.700 rows=100000 loops=5)
 Planning time: 27.965 ms
 Execution time: 22857.396 ms
(46 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=797551.73..797551.73 rows=1 width=58) (actual time=3021.219..3066.848 rows=1 loops=1)
   ->  Sort  (cost=797551.73..797551.79 rows=25 width=58) (actual time=3021.218..3066.846 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=797308.83..797551.61 rows=25 width=58) (actual time=3012.217..3066.832 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=797308.83..797550.54 rows=100 width=58) (actual time=3010.841..3066.798 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=796308.78..796538.58 rows=25 width=58) (actual time=3000.000..3006.479 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=796308.78..796354.67 rows=18359 width=38) (actual time=2998.738..2999.395 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1498kB
                                 ->  Hash Join  (cost=101027.28..795008.57 rows=18359 width=38) (actual time=912.973..2990.334 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=96306.28..787877.10 rows=459137 width=50) (actual time=857.198..2843.062 rows=363065 loops=5)
                                             ->  Hash Join  (cost=96305.72..369485.56 rows=114813 width=38) (actual time=857.137..1409.154 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=32982.58..302861.55 rows=574064 width=8) (actual time=304.193..724.987 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=51065
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..32408.52 rows=2296258 width=0) (actual time=260.941..260.941 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Hash  (cost=59573.33..59573.33 rows=299985 width=38) (actual time=551.107..551.109 rows=299436 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                                         ->  Hash Join  (cost=2.51..59573.33 rows=299985 width=38) (actual time=0.099..484.407 rows=299436 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=8) (actual time=0.037..257.208 rows=1500000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.046..0.048 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.039..0.045 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.009..0.011 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.020..0.021 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.017..0.018 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.014..0.015 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=54.584..54.584 rows=100000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.017..26.099 rows=100000 loops=5)
 Planning time: 3.712 ms
 Execution time: 3067.010 ms
(46 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1059305.29..1059305.30 rows=1 width=32) (actual time=10686.307..10731.926 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1059305.29..1059305.30 rows=1 width=32) (actual time=10686.306..10731.923 rows=1 loops=1)
         ->  Gather  (cost=1059304.85..1059305.26 rows=4 width=32) (actual time=10682.613..10731.907 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1058304.85..1058304.86 rows=1 width=32) (actual time=10676.483..10676.483 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=209235.05..1056827.05 rows=295560 width=12) (actual time=1387.211..10530.520 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=80948 lossy=54307
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..208939.49 rows=1182239 width=0) (actual time=1294.480..1294.481 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 11.030 ms
 Execution time: 10732.576 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1059305.29..1059305.30 rows=1 width=32) (actual time=3262.938..3310.731 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1059305.29..1059305.30 rows=1 width=32) (actual time=3262.937..3310.729 rows=1 loops=1)
         ->  Gather  (cost=1059304.85..1059305.26 rows=4 width=32) (actual time=3261.890..3310.717 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1058304.85..1058304.86 rows=1 width=32) (actual time=3257.263..3257.264 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=209235.05..1056827.05 rows=295560 width=12) (actual time=1243.341..3150.892 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=77359 lossy=52237
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..208939.49 rows=1182239 width=0) (actual time=1149.939..1149.939 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 0.591 ms
 Execution time: 3310.770 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1470794.03..1470794.61 rows=1 width=92) (actual time=15275.193..15314.535 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1470794.03..1476697.85 rows=10040 width=92) (actual time=15275.192..15314.533 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Gather Merge  (cost=1470794.03..1476020.15 rows=40160 width=92) (actual time=15273.523..15314.522 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=1469793.97..1470236.65 rows=10040 width=92) (actual time=15260.811..15264.856 rows=3 loops=5)
                     Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                     ->  Sort  (cost=1469793.97..1469832.11 rows=15256 width=72) (actual time=15259.303..15259.834 rows=9840 loops=5)
                           Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 2002kB
                           ->  Hash Join  (cost=60682.31..1468733.90 rows=15256 width=72) (actual time=678.661..15247.522 rows=11559 loops=5)
                                 Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                 Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                 Rows Removed by Join Filter: 11632
                                 ->  Nested Loop  (cost=57052.91..1463067.00 rows=366582 width=46) (actual time=645.244..15111.967 rows=289625 loops=5)
                                       ->  Hash Join  (cost=57052.34..372881.13 rows=299990 width=30) (actual time=644.299..2364.987 rows=238235 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..298766.82 rows=3749882 width=8) (actual time=0.089..947.221 rows=3000000 loops=5)
                                             ->  Hash  (cost=55552.42..55552.42 rows=119994 width=30) (actual time=644.029..644.030 rows=119622 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                                   ->  Hash Join  (cost=1.40..55552.42 rows=119994 width=30) (actual time=0.032..618.885 rows=119622 loops=5)
                                                         Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=8) (actual time=0.010..439.361 rows=1500000 loops=5)
                                                         ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.016..0.016 rows=2 loops=5)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.008..0.010 rows=2 loops=5)
                                                                     Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                     Rows Removed by Filter: 23
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.62 rows=1 width=24) (actual time=0.052..0.053 rows=1 loops=1191175)
                                             Index Cond: (l_orderkey = orders.o_orderkey)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 3
                                 ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=29.715..29.716 rows=7981 loops=5)
                                       Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                       ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.048..28.151 rows=7981 loops=5)
                                             Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.015..16.519 rows=100000 loops=5)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.021..0.021 rows=2 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.014..0.016 rows=2 loops=5)
                                                         Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning time: 27.133 ms
 Execution time: 15315.410 ms
(45 rows)

SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1470794.03..1470794.61 rows=1 width=92) (actual time=4284.895..4323.353 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1470794.03..1476697.85 rows=10040 width=92) (actual time=4284.894..4323.351 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Gather Merge  (cost=1470794.03..1476020.15 rows=40160 width=92) (actual time=4283.277..4323.341 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=1469793.97..1470236.65 rows=10040 width=92) (actual time=4273.365..4277.376 rows=3 loops=5)
                     Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                     ->  Sort  (cost=1469793.97..1469832.11 rows=15256 width=72) (actual time=4271.021..4271.553 rows=9763 loops=5)
                           Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 2070kB
                           ->  Hash Join  (cost=60682.31..1468733.90 rows=15256 width=72) (actual time=517.723..4261.167 rows=11559 loops=5)
                                 Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                 Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                 Rows Removed by Join Filter: 11632
                                 ->  Nested Loop  (cost=57052.91..1463067.00 rows=366582 width=46) (actual time=480.267..4133.916 rows=289625 loops=5)
                                       ->  Hash Join  (cost=57052.34..372881.13 rows=299990 width=30) (actual time=480.216..1588.867 rows=238235 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..298766.82 rows=3749882 width=8) (actual time=0.024..382.005 rows=3000000 loops=5)
                                             ->  Hash  (cost=55552.42..55552.42 rows=119994 width=30) (actual time=480.033..480.034 rows=119622 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                                   ->  Hash Join  (cost=1.40..55552.42 rows=119994 width=30) (actual time=0.040..456.293 rows=119622 loops=5)
                                                         Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=8) (actual time=0.016..292.408 rows=1500000 loops=5)
                                                         ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.015..0.015 rows=2 loops=5)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.012..0.013 rows=2 loops=5)
                                                                     Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                     Rows Removed by Filter: 23
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.62 rows=1 width=24) (actual time=0.010..0.010 rows=1 loops=1191175)
                                             Index Cond: (l_orderkey = orders.o_orderkey)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 3
                                 ->  Hash  (cost=3529.40..3529.40 rows=8000 width=30) (actual time=37.084..37.085 rows=7981 loops=5)
                                       Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                       ->  Hash Join  (cost=1.40..3529.40 rows=8000 width=30) (actual time=0.047..34.250 rows=7981 loops=5)
                                             Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.015..18.279 rows=100000 loops=5)
                                             ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.021..0.021 rows=2 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.014..0.016 rows=2 loops=5)
                                                         Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                         Rows Removed by Filter: 23
 Planning time: 3.552 ms
 Execution time: 4323.490 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=636430.22..636430.85 rows=1 width=40) (actual time=18678.985..18723.170 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=636430.22..637935.39 rows=2406 width=40) (actual time=18678.984..18723.167 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=636430.22..637760.96 rows=9624 width=72) (actual time=18677.788..18723.151 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=635430.16..635614.59 rows=2406 width=72) (actual time=18663.064..18664.243 rows=2 loops=5)
                     Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                     ->  Sort  (cost=635430.16..635445.31 rows=6058 width=46) (actual time=18661.886..18662.094 rows=4768 loops=5)
                           Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 566kB
                           ->  Hash Join  (cost=67796.70..635049.58 rows=6058 width=46) (actual time=726.258..18657.420 rows=4768 loops=5)
                                 Hash Cond: (supplier.s_nationkey = n2.n_nationkey)
                                 ->  Hash Join  (cost=67795.14..634999.13 rows=6058 width=20) (actual time=726.209..18648.842 rows=4768 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=63324.14..630512.23 rows=6058 width=20) (actual time=685.111..18604.149 rows=4768 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Nested Loop  (cost=1.00..567014.93 rows=30289 width=24) (actual time=5.969..17920.339 rows=23719 loops=5)
                                                   ->  Nested Loop  (cost=0.56..225201.61 rows=99804 width=20) (actual time=1.729..11766.111 rows=77904 loops=5)
                                                         ->  Parallel Seq Scan on part  (cost=0.00..47231.02 rows=3328 width=4) (actual time=0.500..107.642 rows=2602 loops=5)
                                                               Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                               Rows Removed by Filter: 397398
                                                         ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..53.14 rows=34 width=24) (actual time=0.334..4.465 rows=30 loops=13011)
                                                               Index Cond: (l_partkey = part.p_partkey)
                                                   ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=12) (actual time=0.078..0.078 rows=0 loops=389521)
                                                         Index Cond: (o_orderkey = lineitem.l_orderkey)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 1
                                             ->  Hash  (cost=59573.33..59573.33 rows=299985 width=4) (actual time=668.723..668.725 rows=299436 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                   ->  Hash Join  (cost=2.51..59573.33 rows=299985 width=4) (actual time=0.386..618.311 rows=299436 loops=5)
                                                         Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=8) (actual time=0.056..424.919 rows=1500000 loops=5)
                                                         ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.313..0.315 rows=5 loops=5)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.023..0.031 rows=5 loops=5)
                                                                     Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                     ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.006 rows=25 loops=5)
                                                                     ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.013..0.013 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=5)
                                                                                 Filter: (r_name = 'AMERICA'::bpchar)
                                                                                 Rows Removed by Filter: 4
                                       ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=40.736..40.737 rows=100000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.017..23.760 rows=100000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.022..0.023 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.015..0.018 rows=25 loops=5)
 Planning time: 33.459 ms
 Execution time: 18723.304 ms
(51 rows)

SET
SET
SET
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=636430.22..636430.85 rows=1 width=40) (actual time=2116.196..2164.207 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=636430.22..637935.39 rows=2406 width=40) (actual time=2116.195..2164.205 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=636430.22..637760.96 rows=9624 width=72) (actual time=2114.967..2164.190 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=635430.16..635614.59 rows=2406 width=72) (actual time=2107.405..2108.566 rows=2 loops=5)
                     Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                     ->  Sort  (cost=635430.16..635445.31 rows=6058 width=46) (actual time=2105.974..2106.175 rows=4768 loops=5)
                           Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                           Sort Method: quicksort  Memory: 578kB
                           ->  Hash Join  (cost=67796.70..635049.58 rows=6058 width=46) (actual time=599.402..2102.350 rows=4768 loops=5)
                                 Hash Cond: (supplier.s_nationkey = n2.n_nationkey)
                                 ->  Hash Join  (cost=67795.14..634999.13 rows=6058 width=20) (actual time=599.347..2095.131 rows=4768 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Hash Join  (cost=63324.14..630512.23 rows=6058 width=20) (actual time=542.425..2035.220 rows=4768 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Nested Loop  (cost=1.00..567014.93 rows=30289 width=24) (actual time=0.226..1484.690 rows=23719 loops=5)
                                                   ->  Nested Loop  (cost=0.56..225201.61 rows=99804 width=20) (actual time=0.105..648.871 rows=77904 loops=5)
                                                         ->  Parallel Seq Scan on part  (cost=0.00..47231.02 rows=3328 width=4) (actual time=0.052..90.381 rows=2602 loops=5)
                                                               Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                               Rows Removed by Filter: 397398
                                                         ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..53.14 rows=34 width=24) (actual time=0.020..0.206 rows=30 loops=13011)
                                                               Index Cond: (l_partkey = part.p_partkey)
                                                   ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=12) (actual time=0.010..0.010 rows=0 loops=389521)
                                                         Index Cond: (o_orderkey = lineitem.l_orderkey)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 1
                                             ->  Hash  (cost=59573.33..59573.33 rows=299985 width=4) (actual time=539.889..539.891 rows=299436 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                   ->  Hash Join  (cost=2.51..59573.33 rows=299985 width=4) (actual time=0.401..483.054 rows=299436 loops=5)
                                                         Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                         ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=8) (actual time=0.043..225.053 rows=1500000 loops=5)
                                                         ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.347..0.348 rows=5 loops=5)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.020..0.027 rows=5 loops=5)
                                                                     Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                     ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.005 rows=25 loops=5)
                                                                     ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.010..0.011 rows=1 loops=5)
                                                                                 Filter: (r_name = 'AMERICA'::bpchar)
                                                                                 Rows Removed by Filter: 4
                                       ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=55.809..55.810 rows=100000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.020..35.752 rows=100000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.022..0.023 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.014..0.018 rows=25 loops=5)
 Planning time: 4.309 ms
 Execution time: 2164.344 ms
(51 rows)

query 9 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=993904.53..993904.54 rows=1 width=66) (actual time=46317.938..46350.896 rows=1 loops=1)
   ->  Sort  (cost=993904.53..994054.91 rows=60150 width=66) (actual time=46317.937..46350.894 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize HashAggregate  (cost=992551.16..993603.78 rows=60150 width=66) (actual time=46316.456..46349.893 rows=175 loops=1)
               Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               ->  Gather  (cost=965032.53..990145.16 rows=240600 width=66) (actual time=46157.851..46348.569 rows=875 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=964032.53..965085.16 rows=60150 width=66) (actual time=46183.789..46184.304 rows=175 loops=5)
                           Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
                           ->  Hash Join  (cost=661822.92..958731.01 rows=302944 width=57) (actual time=5632.981..45511.439 rows=649638 loops=5)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Hash Join  (cost=661821.35..956284.69 rows=302944 width=31) (actual time=5632.906..45257.753 rows=649638 loops=5)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Nested Loop  (cost=4472.00..235406.10 rows=302944 width=31) (actual time=44.173..36550.883 rows=649638 loops=5)
                                             Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                                             ->  Hash Join  (cost=4471.43..91178.63 rows=40403 width=26) (actual time=43.076..1903.166 rows=86650 loops=5)
                                                   Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                                   ->  Nested Loop  (cost=0.43..86601.57 rows=40403 width=18) (actual time=0.179..1810.513 rows=86650 loops=5)
                                                         ->  Parallel Seq Scan on part  (cost=0.00..47231.02 rows=10101 width=4) (actual time=0.095..201.561 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                         ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.069..0.073 rows=4 loops=108312)
                                                               Index Cond: (ps_partkey = part.p_partkey)
                                                   ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.609..42.609 rows=100000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                         ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.017..24.119 rows=100000 loops=5)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.065..0.396 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Hash  (cost=411263.27..411263.27 rows=14999527 width=8) (actual time=5568.069..5568.069 rows=15000000 loops=5)
                                             Buckets: 1048576  Batches: 32  Memory Usage: 26512kB
                                             ->  Seq Scan on orders  (cost=0.00..411263.27 rows=14999527 width=8) (actual time=0.036..2917.200 rows=15000000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.038..0.038 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.029..0.033 rows=25 loops=5)
 Planning time: 35.458 ms
 Execution time: 46351.980 ms
(38 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=993904.53..993904.54 rows=1 width=66) (actual time=29163.894..29195.111 rows=1 loops=1)
   ->  Sort  (cost=993904.53..994054.91 rows=60150 width=66) (actual time=29163.893..29195.109 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize HashAggregate  (cost=992551.16..993603.78 rows=60150 width=66) (actual time=29163.305..29195.008 rows=175 loops=1)
               Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               ->  Gather  (cost=965032.53..990145.16 rows=240600 width=66) (actual time=28901.259..29193.538 rows=875 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=964032.53..965085.16 rows=60150 width=66) (actual time=29045.377..29045.905 rows=175 loops=5)
                           Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
                           ->  Hash Join  (cost=661822.92..958731.01 rows=302944 width=57) (actual time=5654.317..28439.214 rows=649638 loops=5)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Hash Join  (cost=661821.35..956284.69 rows=302944 width=31) (actual time=5654.226..28209.433 rows=649638 loops=5)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Nested Loop  (cost=4472.00..235406.10 rows=302944 width=31) (actual time=43.307..19449.351 rows=649638 loops=5)
                                             Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                                             ->  Hash Join  (cost=4471.43..91178.63 rows=40403 width=26) (actual time=43.232..1715.729 rows=86650 loops=5)
                                                   Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                                   ->  Nested Loop  (cost=0.43..86601.57 rows=40403 width=18) (actual time=0.167..1622.973 rows=86650 loops=5)
                                                         ->  Parallel Seq Scan on part  (cost=0.00..47231.02 rows=10101 width=4) (actual time=0.074..215.265 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                         ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.060..0.063 rows=4 loops=108312)
                                                               Index Cond: (ps_partkey = part.p_partkey)
                                                   ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.850..42.850 rows=100000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                         ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.018..24.152 rows=100000 loops=5)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.041..0.201 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Hash  (cost=411263.27..411263.27 rows=14999527 width=8) (actual time=5606.971..5606.971 rows=15000000 loops=5)
                                             Buckets: 1048576  Batches: 32  Memory Usage: 26512kB
                                             ->  Seq Scan on orders  (cost=0.00..411263.27 rows=14999527 width=8) (actual time=0.036..3045.624 rows=15000000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.044..0.044 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.036..0.039 rows=25 loops=5)
 Planning time: 20.044 ms
 Execution time: 29196.297 ms
(38 rows)

query 10 run 1
SET
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1047451.86..1047451.91 rows=20 width=201) (actual time=27181.665..27245.583 rows=20 loops=1)
   ->  Sort  (cost=1047451.86..1048913.14 rows=584512 width=201) (actual time=27181.664..27245.579 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  Finalize GroupAggregate  (cost=945107.16..1031898.21 rows=584512 width=201) (actual time=26403.160..27137.975 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=945107.16..1018746.69 rows=584512 width=201) (actual time=26403.142..26770.909 rows=381205 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=944107.10..948125.62 rows=146128 width=201) (actual time=26375.778..26564.817 rows=76241 loops=5)
                           Group Key: customer.c_custkey, nation.n_name
                           ->  Sort  (cost=944107.10..944472.42 rows=146128 width=181) (actual time=26375.762..26407.549 rows=229080 loops=5)
                                 Sort Key: customer.c_custkey, nation.n_name
                                 Sort Method: external sort  Disk: 43816kB
                                 ->  Hash Join  (cost=335487.33..931571.60 rows=146128 width=181) (actual time=5428.368..26084.792 rows=229080 loops=5)
                                       Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                       ->  Nested Loop  (cost=335485.76..931121.43 rows=146128 width=159) (actual time=5428.332..25987.222 rows=229080 loops=5)
                                             ->  Merge Join  (cost=335485.20..394233.48 rows=148140 width=151) (actual time=5427.357..5742.244 rows=114632 loops=5)
                                                   Merge Cond: (customer.c_custkey = orders.o_custkey)
                                                   ->  Parallel Index Scan using customer_pkey on customer  (cost=0.43..53371.36 rows=374981 width=147) (actual time=1.638..106.668 rows=299999 loops=5)
                                                   ->  Sort  (cost=335484.38..336965.78 rows=592559 width=8) (actual time=5425.669..5501.652 rows=572938 loops=5)
                                                         Sort Key: orders.o_custkey
                                                         Sort Method: external sort  Disk: 12352kB
                                                         ->  Bitmap Heap Scan on orders  (cost=8511.66..278668.05 rows=592559 width=8) (actual time=211.521..5059.474 rows=573160 loops=5)
                                                               Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                               Heap Blocks: exact=233346
                                                               ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8363.52 rows=592559 width=0) (actual time=152.483..152.483 rows=573160 loops=5)
                                                                     Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.167..0.176 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.020..0.020 rows=25 loops=5)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.013..0.016 rows=25 loops=5)
 Planning time: 25.393 ms
 Execution time: 27254.464 ms
(37 rows)

SET
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1047451.86..1047451.91 rows=20 width=201) (actual time=5289.689..5345.852 rows=20 loops=1)
   ->  Sort  (cost=1047451.86..1048913.14 rows=584512 width=201) (actual time=5289.688..5345.849 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  Finalize GroupAggregate  (cost=945107.16..1031898.21 rows=584512 width=201) (actual time=4491.494..5239.682 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=945107.16..1018746.69 rows=584512 width=201) (actual time=4491.478..4872.102 rows=381205 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=944107.10..948125.62 rows=146128 width=201) (actual time=4467.241..4656.709 rows=76241 loops=5)
                           Group Key: customer.c_custkey, nation.n_name
                           ->  Sort  (cost=944107.10..944472.42 rows=146128 width=181) (actual time=4467.228..4498.870 rows=229080 loops=5)
                                 Sort Key: customer.c_custkey, nation.n_name
                                 Sort Method: external sort  Disk: 47088kB
                                 ->  Hash Join  (cost=335487.33..931571.60 rows=146128 width=181) (actual time=2174.538..4212.445 rows=229080 loops=5)
                                       Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                       ->  Nested Loop  (cost=335485.76..931121.43 rows=146128 width=159) (actual time=2174.489..4131.801 rows=229080 loops=5)
                                             ->  Merge Join  (cost=335485.20..394233.48 rows=148140 width=151) (actual time=2174.406..2451.722 rows=114632 loops=5)
                                                   Merge Cond: (customer.c_custkey = orders.o_custkey)
                                                   ->  Parallel Index Scan using customer_pkey on customer  (cost=0.43..53371.36 rows=374981 width=147) (actual time=0.035..96.236 rows=299999 loops=5)
                                                   ->  Sort  (cost=335484.38..336965.78 rows=592559 width=8) (actual time=2174.328..2241.512 rows=572938 loops=5)
                                                         Sort Key: orders.o_custkey
                                                         Sort Method: external sort  Disk: 12352kB
                                                         ->  Bitmap Heap Scan on orders  (cost=8511.66..278668.05 rows=592559 width=8) (actual time=213.356..1826.235 rows=573160 loops=5)
                                                               Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                               Heap Blocks: exact=233346
                                                               ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..8363.52 rows=592559 width=0) (actual time=159.105..159.105 rows=573160 loops=5)
                                                                     Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.013..0.014 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.026..0.026 rows=25 loops=5)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.018..0.021 rows=25 loops=5)
 Planning time: 1.873 ms
 Execution time: 5354.399 ms
(37 rows)

query 11 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=488293.88..488293.88 rows=1 width=36) (actual time=2014.550..2014.715 rows=0 loops=1)
   InitPlan 1 (returns $2)
     ->  Finalize Aggregate  (cost=207418.05..207418.06 rows=1 width=32) (actual time=471.776..471.884 rows=1 loops=1)
           ->  Gather  (cost=207417.61..207418.02 rows=4 width=32) (actual time=471.764..471.876 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=206417.61..206417.62 rows=1 width=32) (actual time=467.534..467.536 rows=1 loops=5)
                       ->  Hash Join  (cost=2323.46..205817.63 rows=79998 width=10) (actual time=5.397..442.304 rows=64160 loops=5)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195221.42 rows=1999942 width=14) (actual time=0.029..227.138 rows=1600000 loops=5)
                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=5.314..5.315 rows=4010 loops=5)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.742..3.302 rows=4010 loops=5)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.015 rows=1 loops=5)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.726..2.848 rows=4010 loops=5)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.334..0.334 rows=4010 loops=5)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=280875.82..281675.80 rows=319991 width=36) (actual time=2014.549..2014.605 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=268076.18..279275.86 rows=319991 width=36) (actual time=2014.540..2014.596 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=268076.18..268876.16 rows=319991 width=14) (actual time=1343.950..1356.688 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Gather  (cost=3323.46..238816.73 rows=319991 width=14) (actual time=29.944..1270.779 rows=320800 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=2323.46..205817.63 rows=79998 width=14) (actual time=17.982..1261.307 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195221.42 rows=1999942 width=18) (actual time=0.109..1042.530 rows=1600000 loops=5)
                                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=17.805..17.807 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.960..17.153 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.012..0.015 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.945..16.611 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.720..0.720 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 12.968 ms
 Execution time: 2015.544 ms
(50 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=488293.88..488293.88 rows=1 width=36) (actual time=1185.833..1185.998 rows=0 loops=1)
   InitPlan 1 (returns $2)
     ->  Finalize Aggregate  (cost=207418.05..207418.06 rows=1 width=32) (actual time=469.290..469.401 rows=1 loops=1)
           ->  Gather  (cost=207417.61..207418.02 rows=4 width=32) (actual time=468.059..469.379 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=206417.61..206417.62 rows=1 width=32) (actual time=463.966..463.968 rows=1 loops=5)
                       ->  Hash Join  (cost=2323.46..205817.63 rows=79998 width=10) (actual time=3.974..438.090 rows=64160 loops=5)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195221.42 rows=1999942 width=14) (actual time=0.042..228.032 rows=1600000 loops=5)
                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=3.877..3.878 rows=4010 loops=5)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.567..3.462 rows=4010 loops=5)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.012..0.014 rows=1 loops=5)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.552..3.015 rows=4010 loops=5)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.359..0.359 rows=4010 loops=5)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=280875.82..281675.80 rows=319991 width=36) (actual time=1185.832..1185.886 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=268076.18..279275.86 rows=319991 width=36) (actual time=1185.823..1185.878 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=268076.18..268876.16 rows=319991 width=14) (actual time=518.602..531.006 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Gather  (cost=3323.46..238816.73 rows=319991 width=14) (actual time=4.588..447.320 rows=320800 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=2323.46..205817.63 rows=79998 width=14) (actual time=5.331..442.019 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195221.42 rows=1999942 width=18) (actual time=0.029..226.995 rows=1600000 loops=5)
                                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=5.235..5.237 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.542..4.816 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.528..4.374 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.336..0.336 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 0.927 ms
 Execution time: 1186.066 ms
(50 rows)

query 12 run 1
SET
SET
SET
                                                                                                                       QUERY PLAN                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1706642.52..1706841.57 rows=1 width=27) (actual time=11606.869..11629.805 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1706642.52..1708035.88 rows=7 width=27) (actual time=11606.867..11629.803 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Gather Merge  (cost=1706642.52..1708035.60 rows=28 width=27) (actual time=11589.499..11629.796 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=1705642.46..1707032.21 rows=7 width=27) (actual time=11570.744..11583.323 rows=2 loops=5)
                     Group Key: lineitem.l_shipmode
                     ->  Sort  (cost=1705642.46..1705816.17 rows=69484 width=27) (actual time=11558.459..11561.901 rows=62252 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 6379kB
                           ->  Nested Loop  (cost=0.43..1700054.42 rows=69484 width=27) (actual time=0.734..11516.847 rows=62252 loops=5)
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..1462548.14 rows=69484 width=15) (actual time=0.690..7509.618 rows=62252 loops=5)
                                       Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                       Rows Removed by Filter: 11934959
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.063..0.063 rows=1 loops=311258)
                                       Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning time: 18.110 ms
 Execution time: 11630.559 ms
(19 rows)

SET
SET
SET
                                                                                                                       QUERY PLAN                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1706642.52..1706841.57 rows=1 width=27) (actual time=4001.350..4019.942 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1706642.52..1708035.88 rows=7 width=27) (actual time=4001.349..4019.939 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Gather Merge  (cost=1706642.52..1708035.60 rows=28 width=27) (actual time=3988.365..4019.931 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial GroupAggregate  (cost=1705642.46..1707032.21 rows=7 width=27) (actual time=3974.899..3985.454 rows=2 loops=5)
                     Group Key: lineitem.l_shipmode
                     ->  Sort  (cost=1705642.46..1705816.17 rows=69484 width=27) (actual time=3961.768..3965.739 rows=62252 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 8292kB
                           ->  Nested Loop  (cost=0.43..1700054.42 rows=69484 width=27) (actual time=0.205..3932.815 rows=62252 loops=5)
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..1462548.14 rows=69484 width=15) (actual time=0.187..3621.650 rows=62252 loops=5)
                                       Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                       Rows Removed by Filter: 11934959
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.004..0.004 rows=1 loops=311258)
                                       Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning time: 0.687 ms
 Execution time: 4020.012 ms
(19 rows)

query 13 run 1
SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2710945.20..2710945.20 rows=1 width=16) (actual time=19366.258..19366.260 rows=1 loops=1)
   ->  Sort  (cost=2710945.20..2710945.70 rows=200 width=16) (actual time=19366.257..19366.258 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2710942.20..2710944.20 rows=200 width=16) (actual time=19366.236..19366.243 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2562082.81..2688443.32 rows=1499925 width=12) (actual time=15801.156..19184.343 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Sort  (cost=2562082.81..2599203.23 rows=14848168 width=8) (actual time=15801.147..17614.229 rows=15337604 loops=1)
                           Sort Key: customer.c_custkey
                           Sort Method: external merge  Disk: 268424kB
                           ->  Hash Right Join  (cost=53282.37..662883.00 rows=14848168 width=8) (actual time=338.125..11200.860 rows=15337604 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..448762.09 rows=14848168 width=8) (actual time=0.292..5380.452 rows=14837583 loops=1)
                                       Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                       Rows Removed by Filter: 162417
                                 ->  Hash  (cost=28673.30..28673.30 rows=1499925 width=4) (actual time=336.287..336.287 rows=1500000 loops=1)
                                       Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                       ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.30 rows=1499925 width=4) (actual time=0.383..159.825 rows=1500000 loops=1)
                                             Heap Fetches: 0
 Planning time: 15.323 ms
 Execution time: 19408.151 ms
(22 rows)

SET
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2710945.20..2710945.20 rows=1 width=16) (actual time=18837.308..18837.310 rows=1 loops=1)
   ->  Sort  (cost=2710945.20..2710945.70 rows=200 width=16) (actual time=18837.307..18837.309 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2710942.20..2710944.20 rows=200 width=16) (actual time=18837.288..18837.295 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2562082.81..2688443.32 rows=1499925 width=12) (actual time=15229.830..18657.678 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Sort  (cost=2562082.81..2599203.23 rows=14848168 width=8) (actual time=15229.820..17096.399 rows=15337604 loops=1)
                           Sort Key: customer.c_custkey
                           Sort Method: external merge  Disk: 268424kB
                           ->  Hash Right Join  (cost=53282.37..662883.00 rows=14848168 width=8) (actual time=300.434..10640.968 rows=15337604 loops=1)
                                 Hash Cond: (orders.o_custkey = customer.c_custkey)
                                 ->  Seq Scan on orders  (cost=0.00..448762.09 rows=14848168 width=8) (actual time=0.031..4889.345 rows=14837583 loops=1)
                                       Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                       Rows Removed by Filter: 162417
                                 ->  Hash  (cost=28673.30..28673.30 rows=1499925 width=4) (actual time=299.097..299.098 rows=1500000 loops=1)
                                       Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                       ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.30 rows=1499925 width=4) (actual time=0.046..127.352 rows=1500000 loops=1)
                                             Heap Fetches: 0
 Planning time: 0.634 ms
 Execution time: 18878.590 ms
(22 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=786656.94..786656.96 rows=1 width=32) (actual time=6363.310..6393.830 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=786656.94..786656.96 rows=1 width=32) (actual time=6363.309..6393.829 rows=1 loops=1)
         ->  Gather  (cost=786656.49..786656.90 rows=4 width=64) (actual time=6208.396..6393.801 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=785656.49..785656.50 rows=1 width=64) (actual time=6263.587..6263.590 rows=1 loops=5)
                     ->  Hash Join  (cost=111870.87..782321.58 rows=190566 width=33) (actual time=1262.871..6161.787 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12217.76..666634.23 rows=190566 width=16) (actual time=287.147..4761.989 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=82681
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12027.20 rows=762263 width=0) (actual time=188.155..188.155 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Hash  (cost=60981.05..60981.05 rows=2000005 width=25) (actual time=972.564..972.565 rows=2000000 loops=5)
                                 Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                                 ->  Seq Scan on part  (cost=0.00..60981.05 rows=2000005 width=25) (actual time=0.049..641.364 rows=2000000 loops=5)
 Planning time: 15.016 ms
 Execution time: 6393.915 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=786656.94..786656.96 rows=1 width=32) (actual time=2550.087..2581.518 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=786656.94..786656.96 rows=1 width=32) (actual time=2550.086..2581.516 rows=1 loops=1)
         ->  Gather  (cost=786656.49..786656.90 rows=4 width=64) (actual time=2503.654..2581.495 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=785656.49..785656.50 rows=1 width=64) (actual time=2503.266..2503.268 rows=1 loops=5)
                     ->  Hash Join  (cost=111870.87..782321.58 rows=190566 width=33) (actual time=1038.835..2411.832 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12217.76..666634.23 rows=190566 width=16) (actual time=274.855..1239.937 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=76688
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12027.20 rows=762263 width=0) (actual time=172.457..172.457 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Hash  (cost=60981.05..60981.05 rows=2000005 width=25) (actual time=761.645..761.646 rows=2000000 loops=5)
                                 Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                                 ->  Seq Scan on part  (cost=0.00..60981.05 rows=2000005 width=25) (actual time=0.034..367.922 rows=2000000 loops=5)
 Planning time: 0.869 ms
 Execution time: 2581.604 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2682620.37..2682620.92 rows=1 width=104) (actual time=19716.540..19716.543 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1221087.31..1221087.32 rows=1 width=32) (actual time=6217.957..6217.958 rows=1 loops=1)
           ->  HashAggregate  (cost=1218637.31..1219862.31 rows=98000 width=36) (actual time=6174.194..6211.022 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36522.86..1195848.73 rows=2278858 width=16) (actual time=347.188..4696.097 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35953.15 rows=2278858 width=0) (actual time=274.801..274.801 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1461533.05..1515170.71 rows=98000 width=104) (actual time=19716.539..19716.540 rows=1 loops=1)
         Merge Cond: (supplier.s_suppkey = lineitem.l_suppkey)
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=72) (actual time=0.673..17.781 rows=69998 loops=1)
         ->  GroupAggregate  (cost=1461532.76..1508579.92 rows=98000 width=36) (actual time=19694.844..19694.845 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1461532.76..1467229.91 rows=2278858 width=16) (actual time=12781.326..12936.393 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60920kB
                     ->  Bitmap Heap Scan on lineitem  (cost=36522.86..1195848.73 rows=2278858 width=16) (actual time=408.075..11824.920 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 13223651
                           Heap Blocks: exact=401153 lossy=267105
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35953.15 rows=2278858 width=0) (actual time=334.924..334.924 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning time: 13.752 ms
 Execution time: 19725.751 ms
(29 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2682620.37..2682620.92 rows=1 width=104) (actual time=13035.570..13035.573 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1221087.31..1221087.32 rows=1 width=32) (actual time=6259.852..6259.853 rows=1 loops=1)
           ->  HashAggregate  (cost=1218637.31..1219862.31 rows=98000 width=36) (actual time=6215.738..6252.898 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=36522.86..1195848.73 rows=2278858 width=16) (actual time=348.122..4734.703 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 13223651
                       Heap Blocks: exact=401153 lossy=267105
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35953.15 rows=2278858 width=0) (actual time=275.677..275.677 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1461533.05..1515170.71 rows=98000 width=104) (actual time=13035.569..13035.570 rows=1 loops=1)
         Merge Cond: (supplier.s_suppkey = lineitem.l_suppkey)
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=72) (actual time=0.036..10.946 rows=69998 loops=1)
         ->  GroupAggregate  (cost=1461532.76..1508579.92 rows=98000 width=36) (actual time=13020.800..13020.801 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1461532.76..1467229.91 rows=2278858 width=16) (actual time=6064.175..6219.354 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60920kB
                     ->  Bitmap Heap Scan on lineitem  (cost=36522.86..1195848.73 rows=2278858 width=16) (actual time=371.830..5263.421 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 13223651
                           Heap Blocks: exact=401153 lossy=267105
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35953.15 rows=2278858 width=0) (actual time=299.349..299.349 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
 Planning time: 1.216 ms
 Execution time: 13045.235 ms
(29 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=336032.49..336032.49 rows=1 width=44) (actual time=5111.464..5111.550 rows=1 loops=1)
   ->  Sort  (cost=336032.49..336416.64 rows=153661 width=44) (actual time=5111.463..5111.548 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=326312.98..335264.18 rows=153661 width=44) (actual time=4457.600..5105.886 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=326312.98..327795.90 rows=593167 width=40) (actual time=4457.551..4803.781 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Gather  (cost=99160.00..259005.22 rows=593167 width=40) (actual time=929.921..1633.865 rows=1186319 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=98160.00..198688.52 rows=148292 width=40) (actual time=920.573..1637.954 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101375.06 rows=999971 width=8) (actual time=33.120..570.379 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.263..32.050 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Hash  (cost=90981.12..90981.12 rows=296593 width=40) (actual time=885.148..885.148 rows=296733 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                       ->  Seq Scan on part  (cost=0.00..90981.12 rows=296593 width=40) (actual time=0.053..817.905 rows=296733 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 1703267
 Planning time: 14.651 ms
 Execution time: 5120.074 ms
(29 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=336032.49..336032.49 rows=1 width=44) (actual time=4790.618..4790.702 rows=1 loops=1)
   ->  Sort  (cost=336032.49..336416.64 rows=153661 width=44) (actual time=4790.617..4790.701 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=326312.98..335264.18 rows=153661 width=44) (actual time=4137.644..4785.032 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=326312.98..327795.90 rows=593167 width=40) (actual time=4137.593..4483.106 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60592kB
                     ->  Gather  (cost=99160.00..259005.22 rows=593167 width=40) (actual time=674.454..1301.679 rows=1186319 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=98160.00..198688.52 rows=148292 width=40) (actual time=680.898..1283.407 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101375.06 rows=999971 width=8) (actual time=31.026..433.380 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.082..30.974 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Hash  (cost=90981.12..90981.12 rows=296593 width=40) (actual time=649.012..649.013 rows=296733 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                       ->  Seq Scan on part  (cost=0.00..90981.12 rows=296593 width=40) (actual time=0.037..567.494 rows=296733 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 1703267
 Planning time: 0.753 ms
 Execution time: 4798.895 ms
(29 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4410584.92..4410584.94 rows=1 width=32) (actual time=25416.462..25449.543 rows=1 loops=1)
   ->  Aggregate  (cost=4410584.92..4410584.94 rows=1 width=32) (actual time=25416.461..25449.542 rows=1 loops=1)
         ->  Merge Join  (cost=3229202.96..4410539.46 rows=18184 width=8) (actual time=10447.631..25448.354 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=3228201.91..4284923.02 rows=1768467 width=36) (actual time=10438.037..25183.791 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=3228201.91..4205342.00 rows=7073868 width=36) (actual time=10438.015..19613.728 rows=9972004 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Partial GroupAggregate  (cost=3227201.85..3361776.07 rows=1768467 width=36) (actual time=10386.759..15866.502 rows=1994933 loops=5)
                                 Group Key: lineitem_1.l_partkey
                                 ->  Sort  (cost=3227201.85..3264691.31 rows=14995784 width=9) (actual time=10386.730..12504.131 rows=11996357 loops=5)
                                       Sort Key: lineitem_1.l_partkey
                                       Sort Method: external merge  Disk: 232024kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275100.84 rows=14995784 width=9) (actual time=0.070..5891.243 rows=11997210 loops=5)
               ->  Materialize  (cost=1001.05..102674.48 rows=61693 width=21) (actual time=4.722..75.321 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1001.05..102520.25 rows=61693 width=21) (actual time=4.718..65.668 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.99..94171.96 rows=15423 width=21) (actual time=1.157..661.194 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.47 rows=514 width=4) (actual time=0.688..197.884 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..53.08 rows=34 width=17) (actual time=0.592..0.916 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning time: 16.070 ms
 Execution time: 25480.344 ms
(29 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4410584.92..4410584.94 rows=1 width=32) (actual time=22367.841..22408.587 rows=1 loops=1)
   ->  Aggregate  (cost=4410584.92..4410584.94 rows=1 width=32) (actual time=22367.840..22408.586 rows=1 loops=1)
         ->  Merge Join  (cost=3229202.96..4410539.46 rows=18184 width=8) (actual time=7419.446..22407.507 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=3228201.91..4284923.02 rows=1768467 width=36) (actual time=7406.814..22170.369 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=3228201.91..4205342.00 rows=7073868 width=36) (actual time=7406.792..16494.182 rows=9972124 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Partial GroupAggregate  (cost=3227201.85..3361776.07 rows=1768467 width=36) (actual time=7361.975..12877.524 rows=1994955 loops=5)
                                 Group Key: lineitem_1.l_partkey
                                 ->  Sort  (cost=3227201.85..3264691.31 rows=14995784 width=9) (actual time=7361.958..9551.141 rows=11996386 loops=5)
                                       Sort Key: lineitem_1.l_partkey
                                       Sort Method: external merge  Disk: 227368kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275100.84 rows=14995784 width=9) (actual time=0.320..2261.678 rows=11997210 loops=5)
               ->  Materialize  (cost=1001.05..102674.48 rows=61693 width=21) (actual time=4.475..41.214 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1001.05..102520.25 rows=61693 width=21) (actual time=4.472..31.879 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.99..94171.96 rows=15423 width=21) (actual time=0.226..137.660 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.47 rows=514 width=4) (actual time=0.207..112.983 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..53.08 rows=34 width=17) (actual time=0.007..0.043 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning time: 0.750 ms
 Execution time: 22438.925 ms
(29 rows)

query 18 run 1
SET
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=19172066.83..19172067.08 rows=100 width=71) (actual time=44843.521..44875.506 rows=99 loops=1)
   ->  Sort  (cost=19172066.83..19321987.25 rows=59968168 width=71) (actual time=44843.520..44875.499 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  Finalize GroupAggregate  (cost=8050734.92..16880126.57 rows=59968168 width=71) (actual time=44843.279..44875.408 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Gather Merge  (cost=8050734.92..15530842.79 rows=59968168 width=71) (actual time=44843.268..44875.314 rows=111 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=8049734.86..8387055.81 rows=14992042 width=71) (actual time=44633.094..44633.144 rows=22 loops=5)
                           Group Key: customer.c_custkey, orders.o_orderkey
                           ->  Sort  (cost=8049734.86..8087214.97 rows=14992042 width=44) (actual time=44633.077..44633.087 rows=139 loops=5)
                                 Sort Key: customer.c_custkey, orders.o_orderkey
                                 Sort Method: quicksort  Memory: 35kB
                                 ->  Hash Join  (cost=3920086.89..5966382.84 rows=14992042 width=44) (actual time=43365.004..44632.926 rows=139 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Hash Join  (cost=3841602.58..5634785.31 rows=14992042 width=25) (actual time=42089.953..43691.822 rows=139 loops=5)
                                             Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                             ->  Hash Join  (cost=3154957.22..4674444.01 rows=14995784 width=13) (actual time=34978.141..35954.021 rows=139 loops=5)
                                                   Hash Cond: (lineitem.l_orderkey = lineitem_1.l_orderkey)
                                                   ->  Parallel Seq Scan on lineitem  (cost=0.00..1275100.84 rows=14995784 width=9) (actual time=0.007..2319.399 rows=11997210 loops=5)
                                                   ->  Hash  (cost=2908931.92..2908931.92 rows=14995784 width=4) (actual time=30419.044..30419.045 rows=99 loops=5)
                                                         Buckets: 1048576  Batches: 32  Memory Usage: 8192kB
                                                         ->  GroupAggregate  (cost=0.56..2758974.08 rows=14995784 width=4) (actual time=724.499..30416.431 rows=99 loops=5)
                                                               Group Key: lineitem_1.l_orderkey
                                                               Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                               Rows Removed by Filter: 14999901
                                                               ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271611.10 rows=59983136 width=9) (actual time=0.021..13076.961 rows=59986052 loops=5)
                                             ->  Hash  (cost=411263.27..411263.27 rows=14999527 width=20) (actual time=6409.999..6409.999 rows=15000000 loops=5)
                                                   Buckets: 524288  Batches: 32  Memory Usage: 29716kB
                                                   ->  Seq Scan on orders  (cost=0.00..411263.27 rows=14999527 width=20) (actual time=0.353..3043.726 rows=15000000 loops=5)
                                       ->  Hash  (cost=50946.25..50946.25 rows=1499925 width=23) (actual time=747.500..747.501 rows=1500000 loops=5)
                                             Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                             ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=23) (actual time=0.833..488.966 rows=1500000 loops=5)
 Planning time: 20.934 ms
 Execution time: 44876.498 ms
(36 rows)

SET
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=19172066.83..19172067.08 rows=100 width=71) (actual time=44641.257..44641.358 rows=99 loops=1)
   ->  Sort  (cost=19172066.83..19321987.25 rows=59968168 width=71) (actual time=44641.256..44641.351 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  Finalize GroupAggregate  (cost=8050734.92..16880126.57 rows=59968168 width=71) (actual time=44641.027..44641.273 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Gather Merge  (cost=8050734.92..15530842.79 rows=59968168 width=71) (actual time=44641.019..44641.185 rows=111 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=8049734.86..8387055.81 rows=14992042 width=71) (actual time=44440.879..44440.924 rows=22 loops=5)
                           Group Key: customer.c_custkey, orders.o_orderkey
                           ->  Sort  (cost=8049734.86..8087214.97 rows=14992042 width=44) (actual time=44440.859..44440.868 rows=139 loops=5)
                                 Sort Key: customer.c_custkey, orders.o_orderkey
                                 Sort Method: quicksort  Memory: 36kB
                                 ->  Hash Join  (cost=3920086.89..5966382.84 rows=14992042 width=44) (actual time=43167.587..44440.743 rows=139 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Hash Join  (cost=3841602.58..5634785.31 rows=14992042 width=25) (actual time=41868.552..43560.527 rows=139 loops=5)
                                             Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                             ->  Hash Join  (cost=3154957.22..4674444.01 rows=14995784 width=13) (actual time=34392.788..35583.419 rows=139 loops=5)
                                                   Hash Cond: (lineitem.l_orderkey = lineitem_1.l_orderkey)
                                                   ->  Parallel Seq Scan on lineitem  (cost=0.00..1275100.84 rows=14995784 width=9) (actual time=0.011..2405.701 rows=11997210 loops=5)
                                                   ->  Hash  (cost=2908931.92..2908931.92 rows=14995784 width=4) (actual time=29792.598..29792.599 rows=99 loops=5)
                                                         Buckets: 1048576  Batches: 32  Memory Usage: 8192kB
                                                         ->  GroupAggregate  (cost=0.56..2758974.08 rows=14995784 width=4) (actual time=644.584..29789.981 rows=99 loops=5)
                                                               Group Key: lineitem_1.l_orderkey
                                                               Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                               Rows Removed by Filter: 14999901
                                                               ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271611.10 rows=59983136 width=9) (actual time=0.024..11941.857 rows=59986052 loops=5)
                                             ->  Hash  (cost=411263.27..411263.27 rows=14999527 width=20) (actual time=6625.407..6625.408 rows=15000000 loops=5)
                                                   Buckets: 524288  Batches: 32  Memory Usage: 29716kB
                                                   ->  Seq Scan on orders  (cost=0.00..411263.27 rows=14999527 width=20) (actual time=0.653..3486.070 rows=15000000 loops=5)
                                       ->  Hash  (cost=50946.25..50946.25 rows=1499925 width=23) (actual time=700.282..700.283 rows=1500000 loops=5)
                                             Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                             ->  Seq Scan on customer  (cost=0.00..50946.25 rows=1499925 width=23) (actual time=0.030..382.638 rows=1500000 loops=5)
 Planning time: 15.033 ms
 Execution time: 44642.095 ms
(36 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=132033.00..132033.01 rows=1 width=32) (actual time=5224.527..5237.868 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=132033.00..132033.01 rows=1 width=32) (actual time=5224.525..5237.866 rows=1 loops=1)
         ->  Gather  (cost=132032.56..132032.97 rows=4 width=32) (actual time=5217.398..5237.850 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=131032.56..131032.57 rows=1 width=32) (actual time=5209.986..5209.987 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..131030.33 rows=297 width=12) (actual time=46.800..5209.312 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62231.05 rows=1245 width=30) (actual time=0.411..174.969 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..55.25 rows=1 width=21) (actual time=4.747..5.263 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning time: 23.784 ms
 Execution time: 5238.625 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=132033.00..132033.01 rows=1 width=32) (actual time=211.306..231.086 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=132033.00..132033.01 rows=1 width=32) (actual time=211.305..231.084 rows=1 loops=1)
         ->  Gather  (cost=132032.56..132032.97 rows=4 width=32) (actual time=205.401..231.068 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=131032.56..131032.57 rows=1 width=32) (actual time=199.980..199.981 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..131030.33 rows=297 width=12) (actual time=0.657..198.960 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62231.05 rows=1245 width=30) (actual time=0.110..119.987 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..55.25 rows=1 width=21) (actual time=0.072..0.082 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning time: 1.301 ms
 Execution time: 231.145 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2926500.71..2926500.72 rows=1 width=52) (actual time=47446.001..47446.120 rows=1 loops=1)
   ->  Sort  (cost=2926500.71..2926500.72 rows=1 width=52) (actual time=47446.000..47446.119 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2581578.51..2926500.70 rows=1 width=52) (actual time=26444.904..47444.369 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.247..23.523 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.008 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.237..15.816 rows=100000 loops=1)
               ->  Materialize  (cost=2581578.51..2921848.40 rows=3 width=8) (actual time=6.180..9.107 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2581578.51..2921848.38 rows=3 width=8) (actual time=25308.566..31225.614 rows=59002 loops=1)
                           Merge Cond: (lineitem.l_partkey = partsupp.ps_partkey)
                           Join Filter: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity)))))
                           Rows Removed by Join Filter: 177498
                           ->  GroupAggregate  (cost=2580577.59..2745917.60 rows=4869957 width=40) (actual time=25297.010..30720.490 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2580577.59..2603650.25 rows=9229065 width=13) (actual time=25296.997..26933.595 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205344kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=147905.48..1411484.46 rows=9229065 width=13) (actual time=1234.358..21816.758 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 23164080
                                             Heap Blocks: exact=518099 lossy=530696
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145598.22 rows=9229065 width=0) (actual time=1129.424..1129.424 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Materialize  (cost=1000.92..95268.53 rows=80805 width=16) (actual time=11.140..83.026 rows=237286 loops=1)
                                 ->  Gather Merge  (cost=1000.92..95066.52 rows=80805 width=16) (actual time=11.130..63.060 rows=86872 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Nested Loop  (cost=0.86..84441.80 rows=20201 width=16) (actual time=0.716..1172.064 rows=17374 loops=5)
                                             ->  Parallel Index Scan using part_pkey on part  (cost=0.43..65462.47 rows=5050 width=4) (actual time=0.283..140.145 rows=4344 loops=5)
                                                   Filter: ((p_name)::text ~~ 'olive%'::text)
                                                   Rows Removed by Filter: 395656
                                             ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.58 rows=18 width=12) (actual time=0.220..0.236 rows=4 loops=21718)
                                                   Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 21.042 ms
 Execution time: 47469.984 ms
(42 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2926500.71..2926500.72 rows=1 width=52) (actual time=34421.716..34421.814 rows=1 loops=1)
   ->  Sort  (cost=2926500.71..2926500.72 rows=1 width=52) (actual time=34421.715..34421.813 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2581578.51..2926500.70 rows=1 width=52) (actual time=13667.813..34420.096 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=56) (actual time=0.018..19.886 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.008 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=60) (actual time=0.010..12.306 rows=100000 loops=1)
               ->  Materialize  (cost=2581578.51..2921848.40 rows=3 width=8) (actual time=3.077..5.949 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2581578.51..2921848.38 rows=3 width=8) (actual time=12599.094..18272.672 rows=59002 loops=1)
                           Merge Cond: (lineitem.l_partkey = partsupp.ps_partkey)
                           Join Filter: ((partsupp.ps_suppkey = lineitem.l_suppkey) AND ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity)))))
                           Rows Removed by Join Filter: 177498
                           ->  GroupAggregate  (cost=2580577.59..2745917.60 rows=4869957 width=40) (actual time=12593.921..17797.785 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2580577.59..2603650.25 rows=9229065 width=13) (actual time=12593.910..14184.454 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205344kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=147905.48..1411484.46 rows=9229065 width=13) (actual time=1089.535..9362.314 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 23164080
                                             Heap Blocks: exact=518099 lossy=530696
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145598.22 rows=9229065 width=0) (actual time=985.036..985.036 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Materialize  (cost=1000.92..95268.53 rows=80805 width=16) (actual time=4.788..58.627 rows=237286 loops=1)
                                 ->  Gather Merge  (cost=1000.92..95066.52 rows=80805 width=16) (actual time=4.785..38.752 rows=86872 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Nested Loop  (cost=0.86..84441.80 rows=20201 width=16) (actual time=0.130..175.688 rows=17374 loops=5)
                                             ->  Parallel Index Scan using part_pkey on part  (cost=0.43..65462.47 rows=5050 width=4) (actual time=0.091..112.053 rows=4344 loops=5)
                                                   Filter: ((p_name)::text ~~ 'olive%'::text)
                                                   Rows Removed by Filter: 395656
                                             ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.58 rows=18 width=12) (actual time=0.012..0.013 rows=4 loops=21718)
                                                   Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 1.850 ms
 Execution time: 34445.285 ms
(42 rows)

query 21 run 1
SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2070874.18..2070874.19 rows=1 width=34) (actual time=13898.390..13898.508 rows=100 loops=1)
   ->  Sort  (cost=2070874.18..2070874.19 rows=1 width=34) (actual time=13898.389..13898.501 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=2070874.15..2070874.17 rows=1 width=34) (actual time=13891.136..13897.303 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=2070874.15..2070874.16 rows=1 width=26) (actual time=13891.128..13892.771 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=3325.02..2070874.14 rows=1 width=26) (actual time=47.129..13698.015 rows=39281 loops=1)
                           ->  Nested Loop  (cost=3324.46..2070870.49 rows=1 width=34) (actual time=47.010..11114.384 rows=704306 loops=1)
                                 ->  Gather  (cost=3324.02..2070867.05 rows=1 width=38) (actual time=46.987..6253.930 rows=1460326 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Nested Loop Semi Join  (cost=2324.02..2069866.95 rows=1 width=38) (actual time=36.151..12001.186 rows=292065 loops=5)
                                             ->  Hash Join  (cost=2323.46..1335657.93 rows=199944 width=34) (actual time=36.132..8322.764 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312590.30 rows=4998595 width=8) (actual time=0.830..7105.486 rows=7585870 loops=5)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 4411341
                                                   ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=35.205..35.207 rows=3991 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=0.972..34.136 rows=3991 loops=5)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.012..0.015 rows=1 loops=5)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=0.957..33.350 rows=3991 loops=5)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.765..0.765 rows=3991 loops=5)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.63 rows=4 width=8) (actual time=0.012..0.012 rows=1 loops=1514267)
                                                   Index Cond: (l_orderkey = l1.l_orderkey)
                                                   Filter: (l_suppkey <> l1.l_suppkey)
                                                   Rows Removed by Filter: 0
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..3.44 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1460326)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 24.325 ms
 Execution time: 13899.420 ms
(45 rows)

SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2070874.18..2070874.19 rows=1 width=34) (actual time=8512.000..8512.104 rows=100 loops=1)
   ->  Sort  (cost=2070874.18..2070874.19 rows=1 width=34) (actual time=8511.999..8512.097 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=2070874.15..2070874.17 rows=1 width=34) (actual time=8504.808..8510.911 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=2070874.15..2070874.16 rows=1 width=26) (actual time=8504.799..8506.421 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=3325.02..2070874.14 rows=1 width=26) (actual time=20.938..8317.170 rows=39281 loops=1)
                           ->  Nested Loop  (cost=3324.46..2070870.49 rows=1 width=34) (actual time=20.834..5317.305 rows=704306 loops=1)
                                 ->  Gather  (cost=3324.02..2070867.05 rows=1 width=38) (actual time=20.806..1408.296 rows=1460326 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Nested Loop Semi Join  (cost=2324.02..2069866.95 rows=1 width=38) (actual time=15.165..6467.085 rows=292065 loops=5)
                                             ->  Hash Join  (cost=2323.46..1335657.93 rows=199944 width=34) (actual time=15.139..3673.267 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312590.30 rows=4998595 width=8) (actual time=0.027..2601.254 rows=7585870 loops=5)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 4411341
                                                   ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=14.996..14.997 rows=3991 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=0.616..14.256 rows=3991 loops=5)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.017..0.020 rows=1 loops=5)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=0.595..12.337 rows=3991 loops=5)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.400..0.400 rows=3991 loops=5)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.63 rows=4 width=8) (actual time=0.009..0.009 rows=1 loops=1514267)
                                                   Index Cond: (l_orderkey = l1.l_orderkey)
                                                   Filter: (l_suppkey <> l1.l_suppkey)
                                                   Rows Removed by Filter: 0
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..3.44 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=1460326)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 2.588 ms
 Execution time: 8512.196 ms
(45 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=132935.37..132935.40 rows=1 width=72) (actual time=1638.305..1638.404 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.51..46820.52 rows=1 width=32) (actual time=354.775..354.873 rows=1 loops=1)
           ->  Gather  (cost=46820.08..46820.49 rows=4 width=32) (actual time=351.262..354.843 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.08..45820.09 rows=1 width=32) (actual time=341.849..341.850 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.26 rows=11927 width=6) (actual time=0.215..332.498 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=86114.85..86338.62 rows=8137 width=72) (actual time=1638.304..1638.304 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86114.85..86135.19 rows=8137 width=38) (actual time=1636.547..1636.876 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85586.34 rows=8137 width=38) (actual time=354.843..1613.863 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75320.03 rows=17499 width=26) (actual time=354.804..909.693 rows=191129 loops=1)
                           Filter: ((c_acctbal > $1) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.20 rows=19 width=4) (actual time=0.003..0.003 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 15.200 ms
 Execution time: 1638.960 ms
(24 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=132935.37..132935.40 rows=1 width=72) (actual time=1095.443..1095.535 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.51..46820.52 rows=1 width=32) (actual time=217.899..217.988 rows=1 loops=1)
           ->  Gather  (cost=46820.08..46820.49 rows=4 width=32) (actual time=213.894..217.967 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.08..45820.09 rows=1 width=32) (actual time=209.469..209.470 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.26 rows=11927 width=6) (actual time=0.016..200.577 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=86114.85..86338.62 rows=8137 width=72) (actual time=1095.443..1095.443 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86114.85..86135.19 rows=8137 width=38) (actual time=1093.681..1094.011 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85586.34 rows=8137 width=38) (actual time=217.946..1075.440 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75320.03 rows=17499 width=26) (actual time=217.927..718.974 rows=191129 loops=1)
                           Filter: ((c_acctbal > $1) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.20 rows=19 width=4) (actual time=0.002..0.002 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 0.634 ms
 Execution time: 1095.590 ms
(24 rows)

