query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1906171.04..1906171.25 rows=1 width=236) (actual time=28697.501..28697.501 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1906171.04..1906172.29 rows=6 width=236) (actual time=28697.501..28697.501 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Sort  (cost=1906171.04..1906171.10 rows=24 width=236) (actual time=28697.468..28697.468 rows=6 loops=1)
               Sort Key: l_returnflag, l_linestatus
               Sort Method: quicksort  Memory: 35kB
               ->  Gather  (cost=1906167.93..1906170.49 rows=24 width=236) (actual time=28695.837..28696.729 rows=20 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=1905167.93..1905168.09 rows=6 width=236) (actual time=28689.108..28689.116 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312605.89 rows=14814051 width=25) (actual time=0.182..6496.366 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning time: 11.865 ms
 Execution time: 28697.640 ms
(16 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1906171.04..1906171.25 rows=1 width=236) (actual time=26225.444..26225.444 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1906171.04..1906172.29 rows=6 width=236) (actual time=26225.443..26225.443 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Sort  (cost=1906171.04..1906171.10 rows=24 width=236) (actual time=26225.418..26225.419 rows=6 loops=1)
               Sort Key: l_returnflag, l_linestatus
               Sort Method: quicksort  Memory: 35kB
               ->  Gather  (cost=1906167.93..1906170.49 rows=24 width=236) (actual time=26224.675..26225.454 rows=20 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=1905167.93..1905168.09 rows=6 width=236) (actual time=26220.479..26220.487 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312605.89 rows=14814051 width=25) (actual time=0.026..3702.089 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning time: 0.476 ms
 Execution time: 26225.568 ms
(16 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1076660.15..1076660.16 rows=1 width=192) (actual time=5746.249..5746.263 rows=100 loops=1)
   ->  Sort  (cost=1076660.15..1076660.16 rows=1 width=192) (actual time=5746.248..5746.259 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 51kB
         ->  Merge Join  (cost=557889.73..1076660.14 rows=1 width=192) (actual time=3628.924..5743.017 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89211.71 rows=7459 width=30) (actual time=0.014..796.144 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=557877.34..565874.00 rows=1599333 width=172) (actual time=3628.074..4089.686 rows=1603828 loops=1)
                     ->  Sort  (cost=557877.34..561875.67 rows=1599333 width=172) (actual time=3628.073..3955.769 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293160kB
                           ->  Hash Join  (cost=4048.53..305218.01 rows=1599333 width=172) (actual time=41.605..2428.125 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255188.65 rows=7996665 width=14) (actual time=0.010..1069.444 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.53..3798.53 rows=20000 width=166) (actual time=41.579..41.579 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.53..3798.53 rows=20000 width=166) (actual time=0.018..36.203 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.002..24.508 rows=100000 loops=1)
                                             ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.013..0.013 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.008..0.013 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.001 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.005..0.005 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.003..0.004 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.98..69.99 rows=1 width=32) (actual time=0.105..0.105 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.97 rows=4 width=6) (actual time=0.093..0.102 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.67 rows=19 width=10) (actual time=0.087..0.100 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.84 rows=19 width=10) (actual time=0.087..0.098 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.083..0.084 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.010..0.010 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning time: 19.362 ms
 Execution time: 5783.233 ms
(53 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1076660.15..1076660.16 rows=1 width=192) (actual time=4431.895..4431.910 rows=100 loops=1)
   ->  Sort  (cost=1076660.15..1076660.16 rows=1 width=192) (actual time=4431.895..4431.905 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 51kB
         ->  Merge Join  (cost=557889.73..1076660.14 rows=1 width=192) (actual time=3206.854..4429.784 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Index Scan using part_pkey on part  (cost=0.43..89211.71 rows=7459 width=30) (actual time=0.014..496.214 rows=8046 loops=1)
                     Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                     Rows Removed by Filter: 1991954
               ->  Materialize  (cost=557877.34..565874.00 rows=1599333 width=172) (actual time=3206.748..3653.952 rows=1603828 loops=1)
                     ->  Sort  (cost=557877.34..561875.67 rows=1599333 width=172) (actual time=3206.746..3523.666 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external sort  Disk: 293160kB
                           ->  Hash Join  (cost=4048.53..305218.01 rows=1599333 width=172) (actual time=25.050..2039.240 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255188.65 rows=7996665 width=14) (actual time=0.011..778.318 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.53..3798.53 rows=20000 width=166) (actual time=24.794..24.794 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.53..3798.53 rows=20000 width=166) (actual time=0.023..20.060 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.004..5.525 rows=100000 loops=1)
                                             ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.015..0.015 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.010..0.013 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.001..0.002 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.006..0.006 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.004..0.005 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.98..69.99 rows=1 width=32) (actual time=0.016..0.016 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.97 rows=4 width=6) (actual time=0.009..0.014 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.67 rows=19 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.84 rows=19 width=10) (actual time=0.004..0.011 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.002..0.003 rows=4 loops=6398)
                                               Index Cond: (part.p_partkey = ps_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.010..0.010 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.007 rows=25 loops=1)
 Planning time: 1.649 ms
 Execution time: 4469.262 ms
(53 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2622850.28..2622850.31 rows=10 width=44) (actual time=14353.105..14353.106 rows=10 loops=1)
   ->  Sort  (cost=2622850.28..2630969.80 rows=3247809 width=44) (actual time=14353.105..14353.105 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2455232.03..2552666.30 rows=3247809 width=44) (actual time=14146.914..14333.759 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Sort  (cost=2455232.03..2463351.55 rows=3247809 width=24) (actual time=14146.894..14168.924 rows=301530 loops=1)
                     Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                     Sort Method: quicksort  Memory: 31119kB
                     ->  Gather  (cost=59564.17..2061144.92 rows=3247809 width=24) (actual time=650.683..14045.616 rows=301530 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Nested Loop  (cost=58564.17..1735364.02 rows=811952 width=24) (actual time=641.066..14044.498 rows=60306 loops=5)
                                 ->  Hash Join  (cost=58563.60..377242.85 rows=373723 width=12) (actual time=638.272..2204.988 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308146.50 rows=1812138 width=16) (actual time=0.094..1174.963 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Hash  (cost=54696.78..54696.78 rows=309346 width=4) (actual time=635.909..635.909 rows=300276 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                             ->  Seq Scan on customer  (cost=0.00..54696.78 rows=309346 width=4) (actual time=0.033..580.148 rows=300276 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 1199724
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.040..0.040 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning time: 21.034 ms
 Execution time: 14353.306 ms
(29 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2622850.28..2622850.31 rows=10 width=44) (actual time=4535.917..4535.918 rows=10 loops=1)
   ->  Sort  (cost=2622850.28..2630969.80 rows=3247809 width=44) (actual time=4535.917..4535.917 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=2455232.03..2552666.30 rows=3247809 width=44) (actual time=4330.825..4516.662 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Sort  (cost=2455232.03..2463351.55 rows=3247809 width=24) (actual time=4330.807..4352.679 rows=301530 loops=1)
                     Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                     Sort Method: quicksort  Memory: 31119kB
                     ->  Gather  (cost=59564.17..2061144.92 rows=3247809 width=24) (actual time=489.220..4219.686 rows=301530 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Nested Loop  (cost=58564.17..1735364.02 rows=811952 width=24) (actual time=484.281..4220.669 rows=60306 loops=5)
                                 ->  Hash Join  (cost=58563.60..377242.85 rows=373723 width=12) (actual time=484.131..1426.376 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308146.50 rows=1812138 width=16) (actual time=0.029..574.880 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Hash  (cost=54696.78..54696.78 rows=309346 width=4) (actual time=483.195..483.195 rows=300276 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 14653kB
                                             ->  Seq Scan on customer  (cost=0.00..54696.78 rows=309346 width=4) (actual time=0.035..427.457 rows=300276 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 1199724
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.009..0.009 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning time: 1.457 ms
 Execution time: 4536.124 ms
(29 rows)

query 4 run 1
SET
SET
SET
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=767485.97..767486.01 rows=1 width=24) (actual time=21099.393..21099.394 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=767485.97..767486.17 rows=5 width=24) (actual time=21099.391..21099.391 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Sort  (cost=767485.97..767486.02 rows=20 width=24) (actual time=21099.385..21099.386 rows=6 loops=1)
               Sort Key: orders.o_orderpriority
               Sort Method: quicksort  Memory: 26kB
               ->  Gather  (cost=767483.49..767485.54 rows=20 width=24) (actual time=21093.714..21130.301 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=766483.49..766483.54 rows=5 width=24) (actual time=21085.560..21085.561 rows=5 loops=5)
                           Group Key: orders.o_orderpriority
                           ->  Nested Loop Semi Join  (cost=0.56..765780.35 rows=140628 width=16) (actual time=0.097..20999.936 rows=102764 loops=5)
                                 ->  Parallel Seq Scan on orders  (cost=0.00..317522.20 rows=140666 width=20) (actual time=0.022..1249.686 rows=112085 loops=5)
                                       Filter: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                       Rows Removed by Filter: 2887915
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.175..0.175 rows=1 loops=560424)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_commitdate < l_receiptdate)
                                       Rows Removed by Filter: 1
 Planning time: 16.431 ms
 Execution time: 21130.433 ms
(21 rows)

SET
SET
SET
                                                                               QUERY PLAN                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=767485.97..767486.01 rows=1 width=24) (actual time=2297.464..2297.465 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=767485.97..767486.17 rows=5 width=24) (actual time=2297.462..2297.462 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Sort  (cost=767485.97..767486.02 rows=20 width=24) (actual time=2297.456..2297.457 rows=6 loops=1)
               Sort Key: orders.o_orderpriority
               Sort Method: quicksort  Memory: 26kB
               ->  Gather  (cost=767483.49..767485.54 rows=20 width=24) (actual time=2293.810..2329.306 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=766483.49..766483.54 rows=5 width=24) (actual time=2290.353..2290.354 rows=5 loops=5)
                           Group Key: orders.o_orderpriority
                           ->  Nested Loop Semi Join  (cost=0.56..765780.35 rows=140628 width=16) (actual time=0.065..2244.053 rows=102764 loops=5)
                                 ->  Parallel Seq Scan on orders  (cost=0.00..317522.20 rows=140666 width=20) (actual time=0.026..604.202 rows=112085 loops=5)
                                       Filter: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                       Rows Removed by Filter: 2887915
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.014..0.014 rows=1 loops=560424)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_commitdate < l_receiptdate)
                                       Rows Removed by Filter: 1
 Planning time: 0.981 ms
 Execution time: 2329.404 ms
(21 rows)

query 5 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=805693.63..805693.63 rows=1 width=58) (actual time=22981.949..22981.949 rows=1 loops=1)
   ->  Sort  (cost=805693.63..805693.69 rows=25 width=58) (actual time=22981.947..22981.947 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=805692.19..805693.50 rows=25 width=58) (actual time=22981.920..22981.933 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=805692.19..805692.44 rows=100 width=58) (actual time=22981.910..22981.912 rows=25 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 28kB
                     ->  Gather  (cost=805453.11..805688.87 rows=100 width=58) (actual time=22968.363..23019.812 rows=25 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Partial GroupAggregate  (cost=804453.11..804678.87 rows=25 width=58) (actual time=22959.519..22967.164 rows=5 loops=5)
                                 Group Key: nation.n_name
                                 ->  Sort  (cost=804453.11..804498.20 rows=18036 width=38) (actual time=22957.821..22958.972 rows=14407 loops=5)
                                       Sort Key: nation.n_name
                                       Sort Method: quicksort  Memory: 1495kB
                                       ->  Hash Join  (cost=68045.76..803178.09 rows=18036 width=38) (actual time=742.868..22944.703 rows=14407 loops=5)
                                             Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                             ->  Nested Loop  (cost=63324.76..794895.68 rows=450806 width=50) (actual time=695.363..22785.458 rows=363065 loops=5)
                                                   ->  Hash Join  (cost=63324.19..384087.45 rows=112732 width=38) (actual time=694.238..2093.873 rows=90680 loops=5)
                                                         Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..317522.20 rows=563662 width=8) (actual time=0.285..1263.463 rows=455328 loops=5)
                                                               Filter: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                               Rows Removed by Filter: 2544672
                                                         ->  Hash  (cost=59574.24..59574.24 rows=299996 width=38) (actual time=692.544..692.544 rows=299436 loops=5)
                                                               Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                                               ->  Hash Join  (cost=2.53..59574.24 rows=299996 width=38) (actual time=0.082..629.769 rows=299436 loops=5)
                                                                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                                     ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=8) (actual time=0.039..431.661 rows=1500000 loops=5)
                                                                     ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.030..0.030 rows=5 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.024..0.028 rows=5 loops=5)
                                                                                 Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                                 ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.008..0.010 rows=25 loops=5)
                                                                                 ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.010..0.010 rows=1 loops=5)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=5)
                                                                                             Filter: (r_name = 'AMERICA'::bpchar)
                                                                                             Rows Removed by Filter: 4
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.216..0.226 rows=4 loops=453399)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                             ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=42.628..42.628 rows=100000 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.031..24.198 rows=100000 loops=5)
 Planning time: 25.731 ms
 Execution time: 23020.019 ms
(47 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=805693.63..805693.63 rows=1 width=58) (actual time=2900.720..2900.720 rows=1 loops=1)
   ->  Sort  (cost=805693.63..805693.69 rows=25 width=58) (actual time=2900.720..2900.720 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=805692.19..805693.50 rows=25 width=58) (actual time=2900.692..2900.705 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Sort  (cost=805692.19..805692.44 rows=100 width=58) (actual time=2900.681..2900.683 rows=25 loops=1)
                     Sort Key: nation.n_name
                     Sort Method: quicksort  Memory: 28kB
                     ->  Gather  (cost=805453.11..805688.87 rows=100 width=58) (actual time=2887.269..2936.988 rows=25 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Partial GroupAggregate  (cost=804453.11..804678.87 rows=25 width=58) (actual time=2882.816..2890.875 rows=5 loops=5)
                                 Group Key: nation.n_name
                                 ->  Sort  (cost=804453.11..804498.20 rows=18036 width=38) (actual time=2881.149..2882.308 rows=14407 loops=5)
                                       Sort Key: nation.n_name
                                       Sort Method: quicksort  Memory: 1510kB
                                       ->  Hash Join  (cost=68045.76..803178.09 rows=18036 width=38) (actual time=507.093..2873.086 rows=14407 loops=5)
                                             Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                             ->  Nested Loop  (cost=63324.76..794895.68 rows=450806 width=50) (actual time=452.297..2726.635 rows=363065 loops=5)
                                                   ->  Hash Join  (cost=63324.19..384087.45 rows=112732 width=38) (actual time=452.228..1189.281 rows=90680 loops=5)
                                                         Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..317522.20 rows=563662 width=8) (actual time=0.052..620.264 rows=455328 loops=5)
                                                               Filter: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                               Rows Removed by Filter: 2544672
                                                         ->  Hash  (cost=59574.24..59574.24 rows=299996 width=38) (actual time=450.605..450.605 rows=299436 loops=5)
                                                               Buckets: 524288  Batches: 1  Memory Usage: 25151kB
                                                               ->  Hash Join  (cost=2.53..59574.24 rows=299996 width=38) (actual time=0.067..380.197 rows=299436 loops=5)
                                                                     Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                                     ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=8) (actual time=0.028..108.291 rows=1500000 loops=5)
                                                                     ->  Hash  (cost=2.47..2.47 rows=5 width=30) (actual time=0.028..0.028 rows=5 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Hash Join  (cost=1.07..2.47 rows=5 width=30) (actual time=0.022..0.026 rows=5 loops=5)
                                                                                 Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                                 ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.007..0.009 rows=25 loops=5)
                                                                                 ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.010..0.010 rows=1 loops=5)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=5)
                                                                                             Filter: (r_name = 'AMERICA'::bpchar)
                                                                                             Rows Removed by Filter: 4
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.015..0.016 rows=4 loops=453399)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                             ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=54.237..54.237 rows=100000 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.024..24.411 rows=100000 loops=5)
 Planning time: 3.229 ms
 Execution time: 2937.188 ms
(47 rows)

query 6 run 1
SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1096376.25..1096376.26 rows=1 width=32) (actual time=15210.680..15210.680 rows=1 loops=1)
   ->  Aggregate  (cost=1096376.25..1096376.26 rows=1 width=32) (actual time=15210.678..15210.678 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=214375.52..1090358.63 rows=1203525 width=12) (actual time=1436.833..14457.773 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 21866393
               Heap Blocks: exact=238202 lossy=424766
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..214074.64 rows=1203525 width=0) (actual time=1384.980..1384.980 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 11.276 ms
 Execution time: 15210.738 ms
(10 rows)

SET
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1096376.25..1096376.26 rows=1 width=32) (actual time=8852.686..8852.687 rows=1 loops=1)
   ->  Aggregate  (cost=1096376.25..1096376.26 rows=1 width=32) (actual time=8852.684..8852.684 rows=1 loops=1)
         ->  Bitmap Heap Scan on lineitem  (cost=214375.52..1090358.63 rows=1203525 width=12) (actual time=1292.152..8374.210 rows=1194558 loops=1)
               Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
               Rows Removed by Index Recheck: 21866393
               Heap Blocks: exact=238202 lossy=424766
               ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..214074.64 rows=1203525 width=0) (actual time=1241.577..1241.577 rows=1194558 loops=1)
                     Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning time: 0.892 ms
 Execution time: 8852.729 ms
(10 rows)

query 7 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1480778.35..1480778.43 rows=1 width=92) (actual time=15281.754..15281.755 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1480778.35..1481556.76 rows=10044 width=92) (actual time=15281.753..15281.753 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=1480778.35..1480878.79 rows=40176 width=92) (actual time=15281.743..15281.743 rows=6 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 27kB
               ->  Gather  (cost=1473248.75..1477706.09 rows=40176 width=92) (actual time=15268.631..15320.549 rows=20 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1472248.75..1472688.49 rows=10044 width=92) (actual time=15261.848..15268.005 rows=4 loops=5)
                           Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                           ->  Sort  (cost=1472248.75..1472286.46 rows=15084 width=72) (actual time=15258.529..15259.685 rows=11559 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                                 Sort Method: quicksort  Memory: 2001kB
                                 ->  Hash Join  (cost=63051.10..1471201.86 rows=15084 width=72) (actual time=672.881..15247.072 rows=11559 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                       Rows Removed by Join Filter: 11632
                                       ->  Nested Loop  (cost=59273.70..1465409.87 rows=362461 width=46) (actual time=639.007..15109.598 rows=289625 loops=5)
                                             ->  Hash Join  (cost=59273.13..375107.72 rows=300022 width=30) (actual time=637.627..2737.509 rows=238235 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298770.80 rows=3750280 width=8) (actual time=0.562..1335.363 rows=3000000 loops=5)
                                                   ->  Hash  (cost=57773.14..57773.14 rows=119999 width=30) (actual time=636.704..636.704 rows=119622 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                                         ->  Hash Join  (cost=1.40..57773.14 rows=119999 width=30) (actual time=0.043..611.766 rows=119622 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                                               ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=8) (actual time=0.021..433.154 rows=1500000 loops=5)
                                                               ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.014..0.014 rows=2 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.013 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.62 rows=1 width=24) (actual time=0.051..0.051 rows=1 loops=1191175)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                                   Rows Removed by Filter: 3
                                       ->  Hash  (cost=3677.40..3677.40 rows=8000 width=30) (actual time=31.403..31.403 rows=7981 loops=5)
                                             Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                             ->  Hash Join  (cost=1.40..3677.40 rows=8000 width=30) (actual time=0.031..30.113 rows=7981 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.013..17.283 rows=100000 loops=5)
                                                   ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.014..0.014 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.013 rows=2 loops=5)
                                                               Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                               Rows Removed by Filter: 23
 Planning time: 24.165 ms
 Execution time: 15320.695 ms
(48 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1480778.35..1480778.43 rows=1 width=92) (actual time=4422.645..4422.645 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1480778.35..1481556.76 rows=10044 width=92) (actual time=4422.645..4422.645 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Sort  (cost=1480778.35..1480878.79 rows=40176 width=92) (actual time=4422.634..4422.635 rows=6 loops=1)
               Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 27kB
               ->  Gather  (cost=1473248.75..1477706.09 rows=40176 width=92) (actual time=4409.506..4458.496 rows=20 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1472248.75..1472688.49 rows=10044 width=92) (actual time=4406.515..4412.618 rows=4 loops=5)
                           Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                           ->  Sort  (cost=1472248.75..1472286.46 rows=15084 width=72) (actual time=4403.080..4404.204 rows=11559 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                                 Sort Method: quicksort  Memory: 2030kB
                                 ->  Hash Join  (cost=63051.10..1471201.86 rows=15084 width=72) (actual time=516.393..4393.437 rows=11559 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                       Rows Removed by Join Filter: 11632
                                       ->  Nested Loop  (cost=59273.70..1465409.87 rows=362461 width=46) (actual time=478.043..4265.576 rows=289625 loops=5)
                                             ->  Hash Join  (cost=59273.13..375107.72 rows=300022 width=30) (actual time=477.990..1609.334 rows=238235 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298770.80 rows=3750280 width=8) (actual time=0.033..410.460 rows=3000000 loops=5)
                                                   ->  Hash  (cost=57773.14..57773.14 rows=119999 width=30) (actual time=477.705..477.705 rows=119622 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 8267kB
                                                         ->  Hash Join  (cost=1.40..57773.14 rows=119999 width=30) (actual time=0.032..453.511 rows=119622 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                                               ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=8) (actual time=0.016..284.070 rows=1500000 loops=5)
                                                               ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.012..0.012 rows=2 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.009..0.011 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.62 rows=1 width=24) (actual time=0.010..0.011 rows=1 loops=1191175)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                                   Rows Removed by Filter: 3
                                       ->  Hash  (cost=3677.40..3677.40 rows=8000 width=30) (actual time=37.860..37.860 rows=7981 loops=5)
                                             Buckets: 8192  Batches: 1  Memory Usage: 548kB
                                             ->  Hash Join  (cost=1.40..3677.40 rows=8000 width=30) (actual time=0.044..36.555 rows=7981 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.016..16.805 rows=100000 loops=5)
                                                   ->  Hash  (cost=1.38..1.38 rows=2 width=30) (actual time=0.023..0.023 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.020..0.022 rows=2 loops=5)
                                                               Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                               Rows Removed by Filter: 23
 Planning time: 2.783 ms
 Execution time: 4458.650 ms
(48 rows)

query 8 run 1
SET
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=625092.54..625092.63 rows=1 width=40) (actual time=18752.808..18752.808 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=625092.54..625291.04 rows=2406 width=40) (actual time=18752.808..18752.808 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=625092.54..625116.60 rows=9624 width=72) (actual time=18752.795..18752.797 rows=6 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 26kB
               ->  Gather  (cost=623310.19..624455.80 rows=9624 width=72) (actual time=18750.997..18795.973 rows=10 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=622310.19..622493.40 rows=2406 width=72) (actual time=18735.827..18737.561 rows=2 loops=5)
                           Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                           ->  Sort  (cost=622310.19..622325.20 rows=6004 width=46) (actual time=18734.088..18734.458 rows=4768 loops=5)
                                 Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                                 Sort Method: quicksort  Memory: 569kB
                                 ->  Hash Join  (cost=67797.76..621933.39 rows=6004 width=46) (actual time=740.539..18729.686 rows=4768 loops=5)
                                       Hash Cond: (supplier.s_nationkey = n2.n_nationkey)
                                       ->  Hash Join  (cost=67796.19..621819.25 rows=6004 width=20) (actual time=740.481..18720.010 rows=4768 loops=5)
                                             Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                             ->  Hash Join  (cost=63325.19..617265.70 rows=6004 width=20) (actual time=699.381..18675.082 rows=4768 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Nested Loop  (cost=1.00..553768.89 rows=30019 width=24) (actual time=6.125..17978.974 rows=23719 loops=5)
                                                         ->  Nested Loop  (cost=0.56..210353.00 rows=99980 width=20) (actual time=0.851..11803.967 rows=77904 loops=5)
                                                               ->  Parallel Seq Scan on part  (cost=0.00..47230.89 rows=3333 width=4) (actual time=0.179..113.161 rows=2602 loops=5)
                                                                     Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                     Rows Removed by Filter: 397398
                                                               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..48.63 rows=31 width=24) (actual time=0.340..4.476 rows=30 loops=13011)
                                                                     Index Cond: (l_partkey = part.p_partkey)
                                                         ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=12) (actual time=0.078..0.078 rows=0 loops=389521)
                                                               Index Cond: (o_orderkey = lineitem.l_orderkey)
                                                               Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                               Rows Removed by Filter: 1
                                                   ->  Hash  (cost=59574.24..59574.24 rows=299996 width=4) (actual time=682.119..682.119 rows=299436 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                         ->  Hash Join  (cost=2.53..59574.24 rows=299996 width=4) (actual time=0.099..630.195 rows=299436 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=8) (actual time=0.049..432.303 rows=1500000 loops=5)
                                                               ->  Hash  (cost=2.47..2.47 rows=5 width=4) (actual time=0.034..0.034 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.47 rows=5 width=4) (actual time=0.028..0.033 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.005 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.016..0.016 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=40.904..40.904 rows=100000 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.014..20.967 rows=100000 loops=5)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.028..0.028 rows=25 loops=5)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.018..0.023 rows=25 loops=5)
 Planning time: 31.467 ms
 Execution time: 18796.362 ms
(54 rows)

SET
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=625092.54..625092.63 rows=1 width=40) (actual time=2196.200..2196.200 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=625092.54..625291.04 rows=2406 width=40) (actual time=2196.199..2196.199 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Sort  (cost=625092.54..625116.60 rows=9624 width=72) (actual time=2196.182..2196.183 rows=6 loops=1)
               Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               Sort Method: quicksort  Memory: 26kB
               ->  Gather  (cost=623310.19..624455.80 rows=9624 width=72) (actual time=2191.084..2241.793 rows=10 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=622310.19..622493.40 rows=2406 width=72) (actual time=2186.469..2188.437 rows=2 loops=5)
                           Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                           ->  Sort  (cost=622310.19..622325.20 rows=6004 width=46) (actual time=2184.759..2185.338 rows=4768 loops=5)
                                 Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                                 Sort Method: quicksort  Memory: 565kB
                                 ->  Hash Join  (cost=67797.76..621933.39 rows=6004 width=46) (actual time=587.409..2181.766 rows=4768 loops=5)
                                       Hash Cond: (supplier.s_nationkey = n2.n_nationkey)
                                       ->  Hash Join  (cost=67796.19..621819.25 rows=6004 width=20) (actual time=587.354..2175.522 rows=4768 loops=5)
                                             Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                             ->  Hash Join  (cost=63325.19..617265.70 rows=6004 width=20) (actual time=531.216..2116.204 rows=4768 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Nested Loop  (cost=1.00..553768.89 rows=30019 width=24) (actual time=0.233..1576.879 rows=23719 loops=5)
                                                         ->  Nested Loop  (cost=0.56..210353.00 rows=99980 width=20) (actual time=0.116..670.721 rows=77904 loops=5)
                                                               ->  Parallel Seq Scan on part  (cost=0.00..47230.89 rows=3333 width=4) (actual time=0.062..96.218 rows=2602 loops=5)
                                                                     Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                     Rows Removed by Filter: 397398
                                                               ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..48.63 rows=31 width=24) (actual time=0.018..0.212 rows=30 loops=13011)
                                                                     Index Cond: (l_partkey = part.p_partkey)
                                                         ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=12) (actual time=0.011..0.011 rows=0 loops=389521)
                                                               Index Cond: (o_orderkey = lineitem.l_orderkey)
                                                               Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                               Rows Removed by Filter: 1
                                                   ->  Hash  (cost=59574.24..59574.24 rows=299996 width=4) (actual time=528.638..528.638 rows=299436 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 14624kB
                                                         ->  Hash Join  (cost=2.53..59574.24 rows=299996 width=4) (actual time=0.064..476.158 rows=299436 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=8) (actual time=0.027..275.671 rows=1500000 loops=5)
                                                               ->  Hash  (cost=2.47..2.47 rows=5 width=4) (actual time=0.027..0.027 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.47 rows=5 width=4) (actual time=0.021..0.026 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.005 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.014 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.012 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Hash  (cost=3221.00..3221.00 rows=100000 width=8) (actual time=56.024..56.024 rows=100000 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4931kB
                                                   ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.016..33.554 rows=100000 loops=5)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.023..0.023 rows=25 loops=5)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.015..0.019 rows=25 loops=5)
 Planning time: 3.643 ms
 Execution time: 2242.268 ms
(54 rows)

query 9 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1315375.86..1315375.86 rows=1 width=66) (actual time=45600.436..45600.436 rows=1 loops=1)
   ->  Sort  (cost=1315375.86..1315526.24 rows=60150 width=66) (actual time=45600.436..45600.436 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize HashAggregate  (cost=1314022.49..1315075.11 rows=60150 width=66) (actual time=45600.243..45600.367 rows=175 loops=1)
               Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               ->  Gather  (cost=1286503.86..1311616.49 rows=240600 width=66) (actual time=45491.885..45632.840 rows=875 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=1285503.86..1286556.49 rows=60150 width=66) (actual time=45496.748..45496.894 rows=175 loops=5)
                           Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
                           ->  Hash Join  (cost=663240.76..1272248.94 rows=757424 width=57) (actual time=5767.813..44690.844 rows=649638 loops=5)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Nested Loop  (cost=5848.56..514007.12 rows=757424 width=53) (actual time=64.339..35706.303 rows=649638 loops=5)
                                       Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                                       ->  Hash Join  (cost=5847.99..153579.42 rows=100968 width=48) (actual time=62.867..1733.309 rows=86650 loops=5)
                                             Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                             ->  Nested Loop  (cost=0.43..146343.55 rows=100968 width=18) (actual time=0.144..1616.905 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.89 rows=25252 width=4) (actual time=0.078..200.877 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.73 rows=19 width=14) (actual time=0.060..0.064 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Hash  (cost=4597.56..4597.56 rows=100000 width=30) (actual time=62.591..62.591 rows=100000 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 7079kB
                                                   ->  Hash Join  (cost=1.56..4597.56 rows=100000 width=30) (actual time=0.035..40.352 rows=100000 loops=5)
                                                         Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                         ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.014..13.952 rows=100000 loops=5)
                                                         ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.015..0.015 rows=25 loops=5)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.008..0.012 rows=25 loops=5)
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.064..0.388 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                 ->  Hash  (cost=411279.20..411279.20 rows=15001120 width=8) (actual time=5652.001..5652.001 rows=15000000 loops=5)
                                       Buckets: 1048576  Batches: 32  Memory Usage: 26512kB
                                       ->  Seq Scan on orders  (cost=0.00..411279.20 rows=15001120 width=8) (actual time=0.041..3024.839 rows=15000000 loops=5)
 Planning time: 30.652 ms
 Execution time: 45634.029 ms
(38 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1315375.86..1315375.86 rows=1 width=66) (actual time=29129.830..29129.830 rows=1 loops=1)
   ->  Sort  (cost=1315375.86..1315526.24 rows=60150 width=66) (actual time=29129.828..29129.828 rows=1 loops=1)
         Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize HashAggregate  (cost=1314022.49..1315075.11 rows=60150 width=66) (actual time=29129.636..29129.740 rows=175 loops=1)
               Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
               ->  Gather  (cost=1286503.86..1311616.49 rows=240600 width=66) (actual time=28993.377..29160.158 rows=875 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial HashAggregate  (cost=1285503.86..1286556.49 rows=60150 width=66) (actual time=28993.914..28994.052 rows=175 loops=5)
                           Group Key: nation.n_name, date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
                           ->  Hash Join  (cost=663240.76..1272248.94 rows=757424 width=57) (actual time=5806.817..28273.471 rows=649638 loops=5)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Nested Loop  (cost=5848.56..514007.12 rows=757424 width=53) (actual time=64.338..19224.736 rows=649638 loops=5)
                                       Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                                       ->  Hash Join  (cost=5847.99..153579.42 rows=100968 width=48) (actual time=64.262..1671.456 rows=86650 loops=5)
                                             Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                             ->  Nested Loop  (cost=0.43..146343.55 rows=100968 width=18) (actual time=0.189..1554.321 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.89 rows=25252 width=4) (actual time=0.096..205.194 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.73 rows=19 width=14) (actual time=0.058..0.061 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Hash  (cost=4597.56..4597.56 rows=100000 width=30) (actual time=63.892..63.892 rows=100000 loops=5)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 7079kB
                                                   ->  Hash Join  (cost=1.56..4597.56 rows=100000 width=30) (actual time=0.039..44.759 rows=100000 loops=5)
                                                         Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                         ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=8) (actual time=0.014..19.940 rows=100000 loops=5)
                                                         ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.019..0.019 rows=25 loops=5)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                               ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.011..0.014 rows=25 loops=5)
                                       ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..3.56 rows=1 width=29) (actual time=0.038..0.199 rows=7 loops=433248)
                                             Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                 ->  Hash  (cost=411279.20..411279.20 rows=15001120 width=8) (actual time=5738.075..5738.075 rows=15000000 loops=5)
                                       Buckets: 1048576  Batches: 32  Memory Usage: 26512kB
                                       ->  Seq Scan on orders  (cost=0.00..411279.20 rows=15001120 width=8) (actual time=0.035..3197.371 rows=15000000 loops=5)
 Planning time: 17.880 ms
 Execution time: 29161.394 ms
(38 rows)

query 10 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1201986.85..1201986.90 rows=20 width=202) (actual time=25376.705..25376.707 rows=20 loops=1)
   ->  Sort  (cost=1201986.85..1203496.51 rows=603863 width=202) (actual time=25376.704..25376.706 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  GroupAggregate  (cost=1169312.04..1185918.27 rows=603863 width=202) (actual time=24234.709..25271.608 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Sort  (cost=1169312.04..1170821.70 rows=603863 width=182) (actual time=24234.689..24560.165 rows=1145402 loops=1)
                     Sort Key: customer.c_custkey, nation.n_name
                     Sort Method: external merge  Disk: 218224kB
                     ->  Gather  (cost=102925.72..1076830.28 rows=603863 width=182) (actual time=1114.875..23338.385 rows=1145402 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=101925.72..1015443.98 rows=150966 width=182) (actual time=1103.476..23418.774 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Nested Loop  (cost=101924.16..1013366.64 rows=150966 width=160) (actual time=1103.357..23319.337 rows=229080 loops=5)
                                       ->  Hash Join  (cost=101923.60..454995.23 rows=154068 width=152) (actual time=1102.261..2385.187 rows=114632 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..317522.20 rows=154068 width=8) (actual time=0.076..885.490 rows=114632 loops=5)
                                                   Filter: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Rows Removed by Filter: 2885368
                                             ->  Hash  (cost=50946.82..50946.82 rows=1499982 width=148) (actual time=1101.278..1101.278 rows=1500000 loops=5)
                                                   Buckets: 262144  Batches: 16  Memory Usage: 18791kB
                                                   ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=148) (actual time=0.025..581.868 rows=1500000 loops=5)
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.173..0.182 rows=2 loops=573160)
                                             Index Cond: (l_orderkey = orders.o_orderkey)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.028..0.028 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.014..0.019 rows=25 loops=5)
 Planning time: 24.895 ms
 Execution time: 25407.266 ms
(32 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1201986.85..1201986.90 rows=20 width=202) (actual time=6060.470..6060.475 rows=20 loops=1)
   ->  Sort  (cost=1201986.85..1203496.51 rows=603863 width=202) (actual time=6060.468..6060.471 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 30kB
         ->  GroupAggregate  (cost=1169312.04..1185918.27 rows=603863 width=202) (actual time=4914.579..5955.951 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Sort  (cost=1169312.04..1170821.70 rows=603863 width=182) (actual time=4914.558..5251.045 rows=1145402 loops=1)
                     Sort Key: customer.c_custkey, nation.n_name
                     Sort Method: external merge  Disk: 218216kB
                     ->  Gather  (cost=102925.72..1076830.28 rows=603863 width=182) (actual time=1059.401..4103.735 rows=1145402 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=101925.72..1015443.98 rows=150966 width=182) (actual time=1025.827..3987.941 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Nested Loop  (cost=101924.16..1013366.64 rows=150966 width=160) (actual time=1025.705..3922.606 rows=229080 loops=5)
                                       ->  Hash Join  (cost=101923.60..454995.23 rows=154068 width=152) (actual time=1025.621..1970.849 rows=114632 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..317522.20 rows=154068 width=8) (actual time=1.561..547.809 rows=114632 loops=5)
                                                   Filter: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Rows Removed by Filter: 2885368
                                             ->  Hash  (cost=50946.82..50946.82 rows=1499982 width=148) (actual time=1023.318..1023.318 rows=1500000 loops=5)
                                                   Buckets: 262144  Batches: 16  Memory Usage: 18791kB
                                                   ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=148) (actual time=0.017..428.134 rows=1500000 loops=5)
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.016..0.016 rows=2 loops=573160)
                                             Index Cond: (l_orderkey = orders.o_orderkey)
                                             Filter: (l_returnflag = 'R'::bpchar)
                                             Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.024..0.024 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.011..0.015 rows=25 loops=5)
 Planning time: 2.302 ms
 Execution time: 6094.451 ms
(32 rows)

query 11 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=488296.13..488296.13 rows=1 width=36) (actual time=2009.502..2009.502 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=207433.85..207433.86 rows=1 width=32) (actual time=476.879..476.879 rows=1 loops=1)
           ->  Gather  (cost=207433.42..207433.83 rows=4 width=32) (actual time=475.588..476.956 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=206433.42..206433.43 rows=1 width=32) (actual time=472.423..472.423 rows=1 loops=5)
                       ->  Hash Join  (cost=2323.46..205833.66 rows=79967 width=10) (actual time=5.474..433.955 rows=64160 loops=5)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195213.66 rows=1999166 width=14) (actual time=0.028..234.999 rows=1600000 loops=5)
                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=5.389..5.389 rows=4010 loops=5)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.555..4.958 rows=4010 loops=5)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.015 rows=1 loops=5)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.539..4.460 rows=4010 loops=5)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.346..0.346 rows=4010 loops=5)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=280862.26..281661.93 rows=319867 width=36) (actual time=2009.502..2009.502 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=268067.58..279262.93 rows=319867 width=36) (actual time=2009.492..2009.492 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=268067.58..268867.25 rows=319867 width=14) (actual time=1332.436..1352.289 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Gather  (cost=3323.46..238820.36 rows=319867 width=14) (actual time=31.500..1258.550 rows=320800 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=2323.46..205833.66 rows=79967 width=14) (actual time=23.457..1253.980 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195213.66 rows=1999166 width=18) (actual time=0.296..1037.054 rows=1600000 loops=5)
                                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=22.874..22.874 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.963..22.108 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.015..0.018 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.945..21.457 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.682..0.682 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 14.518 ms
 Execution time: 2009.716 ms
(50 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=488296.13..488296.13 rows=1 width=36) (actual time=1207.972..1207.972 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=207433.85..207433.86 rows=1 width=32) (actual time=488.940..488.940 rows=1 loops=1)
           ->  Gather  (cost=207433.42..207433.83 rows=4 width=32) (actual time=488.917..489.015 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=206433.42..206433.43 rows=1 width=32) (actual time=484.312..484.313 rows=1 loops=5)
                       ->  Hash Join  (cost=2323.46..205833.66 rows=79967 width=10) (actual time=5.598..449.354 rows=64160 loops=5)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195213.66 rows=1999166 width=14) (actual time=0.030..241.244 rows=1600000 loops=5)
                             ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=5.502..5.502 rows=4010 loops=5)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.547..5.056 rows=4010 loops=5)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.016 rows=1 loops=5)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.531..3.761 rows=4010 loops=5)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.337..0.337 rows=4010 loops=5)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=280862.26..281661.93 rows=319867 width=36) (actual time=1207.970..1207.970 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=268067.58..279262.93 rows=319867 width=36) (actual time=1207.963..1207.963 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Rows Removed by Filter: 301833
               ->  Sort  (cost=268067.58..268867.25 rows=319867 width=14) (actual time=518.736..538.513 rows=320800 loops=1)
                     Sort Key: partsupp.ps_partkey
                     Sort Method: quicksort  Memory: 25961kB
                     ->  Gather  (cost=3323.46..238820.36 rows=319867 width=14) (actual time=4.789..448.189 rows=320800 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Hash Join  (cost=2323.46..205833.66 rows=79967 width=14) (actual time=5.836..444.287 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195213.66 rows=1999166 width=18) (actual time=0.029..241.107 rows=1600000 loops=5)
                                 ->  Hash  (cost=2273.46..2273.46 rows=4000 width=4) (actual time=5.740..5.740 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=4) (actual time=0.545..5.306 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=8) (actual time=0.529..4.820 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.333..0.333 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning time: 0.900 ms
 Execution time: 1208.183 ms
(50 rows)

query 12 run 1
SET
SET
SET
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1714518.58..1714518.63 rows=1 width=27) (actual time=11665.533..11665.534 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1714518.58..1714518.93 rows=7 width=27) (actual time=11665.531..11665.531 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=1714518.58..1714518.65 rows=28 width=27) (actual time=11665.525..11665.526 rows=6 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 25kB
               ->  Gather  (cost=1713092.78..1714517.91 rows=28 width=27) (actual time=11636.308..11690.442 rows=10 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1712092.78..1713515.11 rows=7 width=27) (actual time=11632.139..11645.521 rows=2 loops=5)
                           Group Key: lineitem.l_shipmode
                           ->  Sort  (cost=1712092.78..1712270.56 rows=71113 width=27) (actual time=11614.385..11618.562 rows=62252 loops=5)
                                 Sort Key: lineitem.l_shipmode
                                 Sort Method: quicksort  Memory: 6415kB
                                 ->  Nested Loop  (cost=0.43..1706361.84 rows=71113 width=27) (actual time=0.290..11572.532 rows=62252 loops=5)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1462576.20 rows=71113 width=15) (actual time=0.248..7699.111 rows=62252 loops=5)
                                             Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                             Rows Removed by Filter: 11934959
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.061..0.061 rows=1 loops=311258)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning time: 15.386 ms
 Execution time: 11690.548 ms
(22 rows)

SET
SET
SET
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1714518.58..1714518.63 rows=1 width=27) (actual time=4366.059..4366.059 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1714518.58..1714518.93 rows=7 width=27) (actual time=4366.058..4366.059 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Sort  (cost=1714518.58..1714518.65 rows=28 width=27) (actual time=4366.053..4366.053 rows=6 loops=1)
               Sort Key: lineitem.l_shipmode
               Sort Method: quicksort  Memory: 25kB
               ->  Gather  (cost=1713092.78..1714517.91 rows=28 width=27) (actual time=4341.297..4385.997 rows=10 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=1712092.78..1713515.11 rows=7 width=27) (actual time=4328.638..4344.849 rows=2 loops=5)
                           Group Key: lineitem.l_shipmode
                           ->  Sort  (cost=1712092.78..1712270.56 rows=71113 width=27) (actual time=4310.068..4316.552 rows=62252 loops=5)
                                 Sort Key: lineitem.l_shipmode
                                 Sort Method: quicksort  Memory: 6213kB
                                 ->  Nested Loop  (cost=0.43..1706361.84 rows=71113 width=27) (actual time=0.155..4287.381 rows=62252 loops=5)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1462576.20 rows=71113 width=15) (actual time=0.135..3960.373 rows=62252 loops=5)
                                             Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                             Rows Removed by Filter: 11934959
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.004..0.005 rows=1 loops=311258)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning time: 0.736 ms
 Execution time: 4386.080 ms
(22 rows)

query 13 run 1
SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2775862.13..2775862.13 rows=1 width=16) (actual time=18581.371..18581.372 rows=1 loops=1)
   ->  Sort  (cost=2775862.13..2775862.63 rows=200 width=16) (actual time=18581.369..18581.369 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2775859.13..2775861.13 rows=200 width=16) (actual time=18581.340..18581.346 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2368453.21..2753359.40 rows=1499982 width=12) (actual time=9640.261..18375.480 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Merge Left Join  (cost=2368453.21..2663361.48 rows=14999621 width=8) (actual time=9640.245..17028.900 rows=15337604 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.16 rows=1499982 width=4) (actual time=0.231..203.888 rows=1500000 loops=1)
                                 Heap Fetches: 0
                           ->  Materialize  (cost=2368452.78..2443450.88 rows=14999621 width=8) (actual time=9640.010..14909.093 rows=14837583 loops=1)
                                 ->  Sort  (cost=2368452.78..2405951.83 rows=14999621 width=8) (actual time=9640.006..13779.161 rows=14837583 loops=1)
                                       Sort Key: orders.o_custkey
                                       Sort Method: external merge  Disk: 260704kB
                                       ->  Seq Scan on orders  (cost=0.00..448782.00 rows=14999621 width=8) (actual time=0.306..5156.043 rows=14837583 loops=1)
                                             Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                             Rows Removed by Filter: 162417
 Planning time: 12.391 ms
 Execution time: 18615.678 ms
(21 rows)

SET
SET
SET
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2775862.13..2775862.13 rows=1 width=16) (actual time=18062.599..18062.600 rows=1 loops=1)
   ->  Sort  (cost=2775862.13..2775862.63 rows=200 width=16) (actual time=18062.599..18062.599 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=2775859.13..2775861.13 rows=200 width=16) (actual time=18062.579..18062.585 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  GroupAggregate  (cost=2368453.21..2753359.40 rows=1499982 width=12) (actual time=9141.199..17857.983 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Merge Left Join  (cost=2368453.21..2663361.48 rows=14999621 width=8) (actual time=9141.182..16516.077 rows=15337604 loops=1)
                           Merge Cond: (customer.c_custkey = orders.o_custkey)
                           ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.16 rows=1499982 width=4) (actual time=0.018..165.957 rows=1500000 loops=1)
                                 Heap Fetches: 0
                           ->  Materialize  (cost=2368452.78..2443450.88 rows=14999621 width=8) (actual time=9141.161..14441.830 rows=14837583 loops=1)
                                 ->  Sort  (cost=2368452.78..2405951.83 rows=14999621 width=8) (actual time=9141.158..13301.409 rows=14837583 loops=1)
                                       Sort Key: orders.o_custkey
                                       Sort Method: external merge  Disk: 260704kB
                                       ->  Seq Scan on orders  (cost=0.00..448782.00 rows=14999621 width=8) (actual time=0.034..4675.989 rows=14837583 loops=1)
                                             Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                             Rows Removed by Filter: 162417
 Planning time: 0.570 ms
 Execution time: 18098.590 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=810013.43..810013.45 rows=1 width=32) (actual time=8159.787..8159.788 rows=1 loops=1)
   ->  Aggregate  (cost=810013.43..810013.45 rows=1 width=32) (actual time=8159.785..8159.785 rows=1 loops=1)
         ->  Hash Join  (cost=111589.55..796978.41 rows=744858 width=33) (actual time=1137.388..7650.834 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Bitmap Heap Scan on lineitem  (cost=11937.36..665205.35 rows=744858 width=16) (actual time=282.682..6110.653 rows=772942 loops=1)
                     Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                     Heap Blocks: exact=416569
                     ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11751.15 rows=744858 width=0) (actual time=186.418..186.418 rows=772942 loops=1)
                           Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60980.64..60980.64 rows=1999964 width=25) (actual time=853.348..853.348 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60980.64 rows=1999964 width=25) (actual time=0.009..542.010 rows=2000000 loops=1)
 Planning time: 15.719 ms
 Execution time: 8160.370 ms
(14 rows)

SET
SET
SET
                                                                            QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=810013.43..810013.45 rows=1 width=32) (actual time=4132.113..4132.114 rows=1 loops=1)
   ->  Aggregate  (cost=810013.43..810013.45 rows=1 width=32) (actual time=4132.111..4132.111 rows=1 loops=1)
         ->  Hash Join  (cost=111589.55..796978.41 rows=744858 width=33) (actual time=969.072..3661.669 rows=772942 loops=1)
               Hash Cond: (lineitem.l_partkey = part.p_partkey)
               ->  Bitmap Heap Scan on lineitem  (cost=11937.36..665205.35 rows=744858 width=16) (actual time=270.958..2359.494 rows=772942 loops=1)
                     Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                     Heap Blocks: exact=416569
                     ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11751.15 rows=744858 width=0) (actual time=174.789..174.789 rows=772942 loops=1)
                           Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
               ->  Hash  (cost=60980.64..60980.64 rows=1999964 width=25) (actual time=697.350..697.350 rows=2000000 loops=1)
                     Buckets: 524288  Batches: 8  Memory Usage: 18555kB
                     ->  Seq Scan on part  (cost=0.00..60980.64 rows=1999964 width=25) (actual time=0.009..394.890 rows=2000000 loops=1)
 Planning time: 1.009 ms
 Execution time: 4132.238 ms
(14 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2643807.91..2643808.43 rows=1 width=103) (actual time=22765.275..22765.275 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1206604.83..1206604.84 rows=1 width=32) (actual time=8328.263..8328.264 rows=1 loops=1)
           ->  HashAggregate  (cost=1204109.23..1205357.03 rows=99824 width=36) (actual time=8288.246..8321.478 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=35139.40..1182183.05 rows=2192618 width=16) (actual time=542.524..6324.140 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 21153354
                       Heap Blocks: exact=243444 lossy=424814
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34591.25 rows=2192618 width=0) (actual time=488.580..488.580 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1437203.07..1489184.33 rows=99824 width=103) (actual time=22765.273..22765.273 rows=1 loops=1)
         Merge Cond: (lineitem.l_suppkey = supplier.s_suppkey)
         ->  GroupAggregate  (cost=1437202.77..1482552.49 rows=99824 width=36) (actual time=22742.513..22742.513 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1437202.77..1442684.32 rows=2192618 width=16) (actual time=13385.267..13682.826 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60808kB
                     ->  Bitmap Heap Scan on lineitem  (cost=35139.40..1182183.05 rows=2192618 width=16) (actual time=610.477..12497.997 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 21153354
                           Heap Blocks: exact=243444 lossy=424814
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34591.25 rows=2192618 width=0) (actual time=556.469..556.469 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=71) (actual time=0.849..18.890 rows=69998 loops=1)
 Planning time: 14.678 ms
 Execution time: 22773.832 ms
(29 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2643807.91..2643808.43 rows=1 width=103) (actual time=16988.091..16988.091 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=1206604.83..1206604.84 rows=1 width=32) (actual time=8336.192..8336.192 rows=1 loops=1)
           ->  HashAggregate  (cost=1204109.23..1205357.03 rows=99824 width=36) (actual time=8296.398..8329.523 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=35139.40..1182183.05 rows=2192618 width=16) (actual time=545.161..6329.282 rows=2265714 loops=1)
                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                       Rows Removed by Index Recheck: 21153354
                       Heap Blocks: exact=243444 lossy=424814
                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34591.25 rows=2192618 width=0) (actual time=491.148..491.148 rows=2265714 loops=1)
                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Merge Join  (cost=1437203.07..1489184.33 rows=99824 width=103) (actual time=16988.089..16988.089 rows=1 loops=1)
         Merge Cond: (lineitem.l_suppkey = supplier.s_suppkey)
         ->  GroupAggregate  (cost=1437202.77..1482552.49 rows=99824 width=36) (actual time=16973.579..16973.579 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
               Rows Removed by Filter: 69997
               ->  Sort  (cost=1437202.77..1442684.32 rows=2192618 width=16) (actual time=7612.196..7908.160 rows=1585450 loops=1)
                     Sort Key: lineitem.l_suppkey
                     Sort Method: external merge  Disk: 60808kB
                     ->  Bitmap Heap Scan on lineitem  (cost=35139.40..1182183.05 rows=2192618 width=16) (actual time=568.190..6828.001 rows=2265714 loops=1)
                           Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                           Rows Removed by Index Recheck: 21153354
                           Heap Blocks: exact=243444 lossy=424814
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34591.25 rows=2192618 width=0) (actual time=514.669..514.669 rows=2265714 loops=1)
                                 Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4135.79 rows=100000 width=71) (actual time=0.030..10.780 rows=69998 loops=1)
 Planning time: 0.973 ms
 Execution time: 16997.251 ms
(29 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=361539.37..361539.37 rows=1 width=44) (actual time=6262.103..6262.103 rows=1 loops=1)
   ->  Sort  (cost=361539.37..361922.79 rows=153371 width=44) (actual time=6262.102..6262.102 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=351861.03..360772.51 rows=153371 width=44) (actual time=5317.953..6257.254 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=351861.03..353336.58 rows=590222 width=40) (actual time=5317.891..5950.488 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60496kB
                     ->  Hash Join  (cost=91165.50..284908.60 rows=590222 width=40) (actual time=419.264..2579.308 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176318.60 rows=3998332 width=8) (actual time=38.362..1401.061 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.241..37.513 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=84003.68..84003.68 rows=295229 width=40) (actual time=380.205..380.205 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Gather  (cost=1000.00..84003.68 rows=295229 width=40) (actual time=0.309..315.811 rows=296733 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.78 rows=73807 width=40) (actual time=0.040..327.453 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning time: 15.539 ms
 Execution time: 6270.011 ms
(29 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=361539.37..361539.37 rows=1 width=44) (actual time=5894.037..5894.037 rows=1 loops=1)
   ->  Sort  (cost=361539.37..361922.79 rows=153371 width=44) (actual time=5894.037..5894.037 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=351861.03..360772.51 rows=153371 width=44) (actual time=4947.434..5888.861 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=351861.03..353336.58 rows=590222 width=40) (actual time=4947.370..5581.076 rows=1186319 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 60496kB
                     ->  Hash Join  (cost=91165.50..284908.60 rows=590222 width=40) (actual time=242.970..2215.045 rows=1186319 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..176318.60 rows=3998332 width=8) (actual time=21.664..1216.908 rows=7995520 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 4480
                                 Heap Fetches: 0
                                 SubPlan 1
                                   ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.096..21.623 rows=56 loops=1)
                                         Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                         Rows Removed by Filter: 99944
                           ->  Hash  (cost=84003.68..84003.68 rows=295229 width=40) (actual time=220.710..220.710 rows=296733 loops=1)
                                 Buckets: 524288  Batches: 1  Memory Usage: 25593kB
                                 ->  Gather  (cost=1000.00..84003.68 rows=295229 width=40) (actual time=0.270..159.334 rows=296733 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.78 rows=73807 width=40) (actual time=0.018..167.062 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning time: 0.731 ms
 Execution time: 5902.027 ms
(29 rows)

query 17 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5365230.88..5365230.89 rows=1 width=32) (actual time=29918.381..29918.381 rows=1 loops=1)
   ->  Aggregate  (cost=5365230.88..5365230.89 rows=1 width=32) (actual time=29918.379..29918.379 rows=1 loops=1)
         ->  Merge Join  (cost=5234230.41..5365185.99 rows=17957 width=8) (actual time=23418.317..29917.339 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=5151954.50..5257882.47 rows=1925963 width=36) (actual time=22716.669..29087.102 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Sort  (cost=5151954.50..5171214.13 rows=7703852 width=36) (actual time=22716.650..24612.656 rows=9971781 loops=1)
                           Sort Key: lineitem_1.l_partkey
                           Sort Method: external merge  Disk: 516360kB
                           ->  Gather  (cost=3228385.45..4135322.92 rows=7703852 width=36) (actual time=10167.077..19770.479 rows=9975105 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Partial GroupAggregate  (cost=3227385.45..3363937.72 rows=1925963 width=36) (actual time=10205.164..17917.782 rows=1995021 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Sort  (cost=3227385.45..3264878.03 rows=14997031 width=9) (actual time=10205.150..14548.250 rows=11997210 loops=5)
                                             Sort Key: lineitem_1.l_partkey
                                             Sort Method: external merge  Disk: 219448kB
                                             ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275113.31 rows=14997031 width=9) (actual time=0.151..5781.640 rows=11997210 loops=5)
               ->  Sort  (cost=82275.90..82415.75 rows=55940 width=21) (actual time=699.500..704.294 rows=59951 loops=1)
                     Sort Key: lineitem.l_partkey
                     Sort Method: quicksort  Memory: 6220kB
                     ->  Gather  (cost=1000.57..77864.59 rows=55940 width=21) (actual time=1.541..684.393 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Nested Loop  (cost=0.56..71270.59 rows=13985 width=21) (actual time=0.668..682.075 rows=11990 loops=5)
                                 ->  Parallel Seq Scan on part  (cost=0.00..48480.86 rows=466 width=4) (actual time=0.360..223.230 rows=399 loops=5)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 399601
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..48.59 rows=31 width=17) (actual time=0.762..1.137 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning time: 15.565 ms
 Execution time: 30014.032 ms
(34 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5365230.88..5365230.89 rows=1 width=32) (actual time=26334.409..26334.409 rows=1 loops=1)
   ->  Aggregate  (cost=5365230.88..5365230.89 rows=1 width=32) (actual time=26334.408..26334.408 rows=1 loops=1)
         ->  Merge Join  (cost=5234230.41..5365185.99 rows=17957 width=8) (actual time=19886.791..26333.459 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=5151954.50..5257882.47 rows=1925963 width=36) (actual time=19768.188..26085.273 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Sort  (cost=5151954.50..5171214.13 rows=7703852 width=36) (actual time=19768.168..21621.266 rows=9971974 loops=1)
                           Sort Key: lineitem_1.l_partkey
                           Sort Method: external merge  Disk: 516368kB
                           ->  Gather  (cost=3228385.45..4135322.92 rows=7703852 width=36) (actual time=7357.199..16848.390 rows=9975299 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Partial GroupAggregate  (cost=3227385.45..3363937.72 rows=1925963 width=36) (actual time=7321.717..15110.598 rows=1995060 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Sort  (cost=3227385.45..3264878.03 rows=14997031 width=9) (actual time=7321.700..11715.411 rows=11997210 loops=5)
                                             Sort Key: lineitem_1.l_partkey
                                             Sort Method: external merge  Disk: 224808kB
                                             ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275113.31 rows=14997031 width=9) (actual time=0.035..2309.764 rows=11997210 loops=5)
               ->  Sort  (cost=82275.90..82415.75 rows=55940 width=21) (actual time=115.580..120.262 rows=59951 loops=1)
                     Sort Key: lineitem.l_partkey
                     Sort Method: quicksort  Memory: 6220kB
                     ->  Gather  (cost=1000.57..77864.59 rows=55940 width=21) (actual time=0.439..96.402 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Nested Loop  (cost=0.56..71270.59 rows=13985 width=21) (actual time=0.179..99.802 rows=11990 loops=5)
                                 ->  Parallel Seq Scan on part  (cost=0.00..48480.86 rows=466 width=4) (actual time=0.158..72.029 rows=399 loops=5)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 399601
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..48.59 rows=31 width=17) (actual time=0.012..0.064 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning time: 0.961 ms
 Execution time: 26430.879 ms
(34 rows)

query 18 run 1
SET
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=13508678.74..13508678.99 rows=100 width=71) (actual time=40553.026..40553.039 rows=99 loops=1)
   ->  Sort  (cost=13508678.74..13583663.90 rows=29994062 width=71) (actual time=40553.026..40553.034 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  GroupAggregate  (cost=11687460.86..12362327.26 rows=29994062 width=71) (actual time=40552.759..40552.953 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Sort  (cost=11687460.86..11762446.02 rows=29994062 width=44) (actual time=40552.741..40552.780 rows=693 loops=1)
                     Sort Key: customer.c_custkey, orders.o_orderkey
                     Sort Method: quicksort  Memory: 79kB
                     ->  Hash Join  (cost=78532.45..7369327.27 rows=29994062 width=44) (actual time=4251.027..40552.512 rows=693 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Merge Join  (cost=46.86..6459558.33 rows=29994062 width=25) (actual time=972.232..39783.919 rows=693 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Merge Semi Join  (cost=1.00..3719500.24 rows=7500560 width=24) (actual time=761.403..29530.356 rows=99 loops=1)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..547982.24 rows=15001120 width=20) (actual time=0.004..2826.444 rows=14982724 loops=1)
                                       ->  Materialize  (cost=0.56..2946552.32 rows=14997031 width=4) (actual time=657.908..25879.963 rows=99 loops=1)
                                             ->  GroupAggregate  (cost=0.56..2759089.43 rows=14997031 width=4) (actual time=657.906..25879.799 rows=99 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                   Rows Removed by Filter: 14999901
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271685.93 rows=59988124 width=9) (actual time=0.003..11815.574 rows=59986052 loops=1)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2271685.93 rows=59988124 width=9) (actual time=0.007..7012.987 rows=59916431 loops=1)
                           ->  Hash  (cost=50946.82..50946.82 rows=1499982 width=23) (actual time=663.672..663.672 rows=1500000 loops=1)
                                 Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                 ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=23) (actual time=0.009..422.000 rows=1500000 loops=1)
 Planning time: 21.795 ms
 Execution time: 40553.157 ms
(28 rows)

SET
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=13508678.74..13508678.99 rows=100 width=71) (actual time=37131.045..37131.056 rows=99 loops=1)
   ->  Sort  (cost=13508678.74..13583663.90 rows=29994062 width=71) (actual time=37131.045..37131.048 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  GroupAggregate  (cost=11687460.86..12362327.26 rows=29994062 width=71) (actual time=37130.777..37130.971 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Sort  (cost=11687460.86..11762446.02 rows=29994062 width=44) (actual time=37130.760..37130.802 rows=693 loops=1)
                     Sort Key: customer.c_custkey, orders.o_orderkey
                     Sort Method: quicksort  Memory: 79kB
                     ->  Hash Join  (cost=78532.45..7369327.27 rows=29994062 width=44) (actual time=3652.146..37130.531 rows=693 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Merge Join  (cost=46.86..6459558.33 rows=29994062 width=25) (actual time=839.258..36493.451 rows=693 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                 ->  Merge Semi Join  (cost=1.00..3719500.24 rows=7500560 width=24) (actual time=619.165..26037.576 rows=99 loops=1)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..547982.24 rows=15001120 width=20) (actual time=0.004..2212.773 rows=14982724 loops=1)
                                       ->  Materialize  (cost=0.56..2946552.32 rows=14997031 width=4) (actual time=544.960..23021.183 rows=99 loops=1)
                                             ->  GroupAggregate  (cost=0.56..2759089.43 rows=14997031 width=4) (actual time=544.957..23021.040 rows=99 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                                   Rows Removed by Filter: 14999901
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2271685.93 rows=59988124 width=9) (actual time=0.004..9353.225 rows=59986052 loops=1)
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2271685.93 rows=59988124 width=9) (actual time=0.008..7187.770 rows=59916431 loops=1)
                           ->  Hash  (cost=50946.82..50946.82 rows=1499982 width=23) (actual time=531.947..531.947 rows=1500000 loops=1)
                                 Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                                 ->  Seq Scan on customer  (cost=0.00..50946.82 rows=1499982 width=23) (actual time=0.010..296.306 rows=1500000 loops=1)
 Planning time: 1.905 ms
 Execution time: 37131.178 ms
(28 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=123716.88..123716.89 rows=1 width=32) (actual time=5281.236..5281.237 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=123716.88..123716.89 rows=1 width=32) (actual time=5281.234..5281.234 rows=1 loops=1)
         ->  Gather  (cost=123716.45..123716.86 rows=4 width=32) (actual time=5273.993..5293.110 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=122716.45..122716.46 rows=1 width=32) (actual time=5264.966..5264.967 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..122714.26 rows=292 width=12) (actual time=33.877..5264.210 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.62 rows=1196 width=30) (actual time=0.542..207.625 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.56 rows=1 width=21) (actual time=4.768..5.286 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning time: 17.815 ms
 Execution time: 5293.179 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=123716.88..123716.89 rows=1 width=32) (actual time=244.806..244.806 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=123716.88..123716.89 rows=1 width=32) (actual time=244.805..244.805 rows=1 loops=1)
         ->  Gather  (cost=123716.45..123716.86 rows=4 width=32) (actual time=240.312..265.828 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=122716.45..122716.46 rows=1 width=32) (actual time=235.337..235.338 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..122714.26 rows=292 width=12) (actual time=0.899..235.094 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.62 rows=1196 width=30) (actual time=0.146..145.037 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.56..50.56 rows=1 width=21) (actual time=0.086..0.094 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning time: 0.931 ms
 Execution time: 265.908 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2921731.85..2921731.85 rows=1 width=51) (actual time=54464.117..54464.117 rows=1 loops=1)
   ->  Sort  (cost=2921731.85..2921736.85 rows=2000 width=51) (actual time=54464.116..54464.116 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2681378.34..2921721.85 rows=2000 width=51) (actual time=31900.408..54462.367 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=55) (actual time=0.339..24.054 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.006..0.008 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=59) (actual time=0.326..15.516 rows=100000 loops=1)
               ->  Materialize  (cost=2681378.34..2917069.54 rows=3 width=8) (actual time=7.521..10.502 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2681378.34..2917069.53 rows=3 width=8) (actual time=30799.473..37146.020 rows=59002 loops=1)
                           Merge Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  GroupAggregate  (cost=2548062.94..2710764.72 rows=4825563 width=40) (actual time=26520.798..32529.397 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2548062.94..2570642.52 rows=9031834 width=13) (actual time=26520.782..29188.063 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205064kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=144740.86..1405361.37 rows=9031834 width=13) (actual time=1902.240..23077.018 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 27869248
                                             Heap Blocks: exact=412819 lossy=635976
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..142482.90 rows=9031834 width=0) (actual time=1808.225..1808.225 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Sort  (cost=133315.40..133517.34 rows=80776 width=16) (actual time=4278.327..4288.848 rows=86872 loops=1)
                                 Sort Key: partsupp.ps_partkey, partsupp.ps_suppkey
                                 Sort Method: quicksort  Memory: 7145kB
                                 ->  Nested Loop  (cost=1000.43..126731.50 rows=80776 width=16) (actual time=1.088..4240.394 rows=86872 loops=1)
                                       ->  Gather  (cost=1000.00..50251.09 rows=20202 width=4) (actual time=0.347..51.887 rows=21718 loops=1)
                                             Workers Planned: 4
                                             Workers Launched: 4
                                             ->  Parallel Seq Scan on part  (cost=0.00..47230.89 rows=5050 width=4) (actual time=0.053..153.917 rows=4344 loops=5)
                                                   Filter: ((p_name)::text ~~ 'olive%'::text)
                                                   Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.60 rows=19 width=12) (actual time=0.175..0.191 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 19.319 ms
 Execution time: 54487.405 ms
(44 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2921731.85..2921731.85 rows=1 width=51) (actual time=38385.378..38385.378 rows=1 loops=1)
   ->  Sort  (cost=2921731.85..2921736.85 rows=2000 width=51) (actual time=38385.377..38385.377 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=2681378.34..2921721.85 rows=2000 width=51) (actual time=15748.574..38383.668 rows=1821 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 182001415
               ->  Nested Loop  (cost=0.00..4472.31 rows=4000 width=55) (actual time=0.022..20.714 rows=4095 loops=1)
                     Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                     Rows Removed by Join Filter: 95905
                     ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.005..0.007 rows=1 loops=1)
                           Filter: (n_name = 'IRAQ'::bpchar)
                           Rows Removed by Filter: 24
                     ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=59) (actual time=0.009..12.189 rows=100000 loops=1)
               ->  Materialize  (cost=2681378.34..2917069.54 rows=3 width=8) (actual time=3.577..6.569 rows=44445 loops=4095)
                     ->  Merge Join  (cost=2681378.34..2917069.53 rows=3 width=8) (actual time=14646.197..20989.929 rows=59002 loops=1)
                           Merge Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 123
                           ->  GroupAggregate  (cost=2548062.94..2710764.72 rows=4825563 width=40) (actual time=14418.780..20423.658 rows=5448473 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Sort  (cost=2548062.94..2570642.52 rows=9031834 width=13) (actual time=14418.766..17083.551 rows=9123091 loops=1)
                                       Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                       Sort Method: external merge  Disk: 205064kB
                                       ->  Bitmap Heap Scan on lineitem  (cost=144740.86..1405361.37 rows=9031834 width=13) (actual time=1717.377..11180.682 rows=9123688 loops=1)
                                             Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                             Rows Removed by Index Recheck: 27869248
                                             Heap Blocks: exact=412819 lossy=635976
                                             ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..142482.90 rows=9031834 width=0) (actual time=1623.617..1623.617 rows=9123688 loops=1)
                                                   Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                           ->  Sort  (cost=133315.40..133517.34 rows=80776 width=16) (actual time=227.068..237.606 rows=86872 loops=1)
                                 Sort Key: partsupp.ps_partkey, partsupp.ps_suppkey
                                 Sort Method: quicksort  Memory: 7145kB
                                 ->  Nested Loop  (cost=1000.43..126731.50 rows=80776 width=16) (actual time=0.307..203.415 rows=86872 loops=1)
                                       ->  Gather  (cost=1000.00..50251.09 rows=20202 width=4) (actual time=0.278..7.466 rows=21718 loops=1)
                                             Workers Planned: 4
                                             Workers Launched: 4
                                             ->  Parallel Seq Scan on part  (cost=0.00..47230.89 rows=5050 width=4) (actual time=0.043..99.818 rows=4344 loops=5)
                                                   Filter: ((p_name)::text ~~ 'olive%'::text)
                                                   Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.60 rows=19 width=12) (actual time=0.008..0.008 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning time: 1.880 ms
 Execution time: 38411.733 ms
(44 rows)

query 21 run 1
SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2070956.40..2070956.40 rows=1 width=34) (actual time=13583.821..13583.831 rows=100 loops=1)
   ->  Sort  (cost=2070956.40..2070956.40 rows=1 width=34) (actual time=13583.820..13583.825 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  GroupAggregate  (cost=2070956.37..2070956.39 rows=1 width=34) (actual time=13575.670..13582.575 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=2070956.37..2070956.37 rows=1 width=26) (actual time=13575.662..13577.954 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=3325.02..2070956.36 rows=1 width=26) (actual time=43.659..13384.008 rows=39281 loops=1)
                           ->  Nested Loop  (cost=3324.46..2070949.63 rows=1 width=34) (actual time=43.640..10611.967 rows=704306 loops=1)
                                 ->  Gather  (cost=3324.02..2070946.18 rows=1 width=38) (actual time=43.613..5584.794 rows=1460326 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Nested Loop Semi Join  (cost=2324.02..2069946.08 rows=1 width=38) (actual time=35.707..11560.719 rows=292065 loops=5)
                                             ->  Hash Join  (cost=2323.46..1335675.23 rows=199960 width=34) (actual time=35.519..8066.365 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312605.89 rows=4999010 width=8) (actual time=0.054..6882.296 rows=7585870 loops=5)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 4411341
                                                   ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=35.377..35.377 rows=3991 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=0.984..34.245 rows=3991 loops=5)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.011..0.014 rows=1 loops=5)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=0.971..33.356 rows=3991 loops=5)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.757..0.757 rows=3991 loops=5)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.63 rows=4 width=8) (actual time=0.011..0.011 rows=1 loops=1514267)
                                                   Index Cond: (l_orderkey = l1.l_orderkey)
                                                   Filter: (l_suppkey <> l1.l_suppkey)
                                                   Rows Removed by Filter: 0
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..3.44 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1460326)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 20.036 ms
 Execution time: 13584.018 ms
(45 rows)

SET
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2070956.40..2070956.40 rows=1 width=34) (actual time=9059.864..9059.874 rows=100 loops=1)
   ->  Sort  (cost=2070956.40..2070956.40 rows=1 width=34) (actual time=9059.864..9059.871 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 32kB
         ->  GroupAggregate  (cost=2070956.37..2070956.39 rows=1 width=34) (actual time=9051.598..9058.574 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=2070956.37..2070956.37 rows=1 width=26) (actual time=9051.590..9053.954 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 4605kB
                     ->  Nested Loop Anti Join  (cost=3325.02..2070956.36 rows=1 width=26) (actual time=20.508..8879.272 rows=39281 loops=1)
                           ->  Nested Loop  (cost=3324.46..2070949.63 rows=1 width=34) (actual time=20.392..4856.165 rows=704306 loops=1)
                                 ->  Gather  (cost=3324.02..2070946.18 rows=1 width=38) (actual time=20.377..555.675 rows=1460326 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Nested Loop Semi Join  (cost=2324.02..2069946.08 rows=1 width=38) (actual time=15.492..6443.023 rows=292065 loops=5)
                                             ->  Hash Join  (cost=2323.46..1335675.23 rows=199960 width=34) (actual time=15.473..3865.307 rows=302853 loops=5)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312605.89 rows=4999010 width=8) (actual time=0.024..2809.345 rows=7585870 loops=5)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 4411341
                                                   ->  Hash  (cost=2273.46..2273.46 rows=4000 width=30) (actual time=15.348..15.348 rows=3991 loops=5)
                                                         Buckets: 4096  Batches: 1  Memory Usage: 282kB
                                                         ->  Nested Loop  (cost=49.29..2273.46 rows=4000 width=30) (actual time=0.595..14.559 rows=3991 loops=5)
                                                               ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.014..0.017 rows=1 loops=5)
                                                                     Filter: (n_name = 'PERU'::bpchar)
                                                                     Rows Removed by Filter: 24
                                                               ->  Bitmap Heap Scan on supplier  (cost=49.29..2232.15 rows=4000 width=34) (actual time=0.579..13.943 rows=3991 loops=5)
                                                                     Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                                     Heap Blocks: exact=1865
                                                                     ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..48.29 rows=4000 width=0) (actual time=0.383..0.383 rows=3991 loops=5)
                                                                           Index Cond: (s_nationkey = nation.n_nationkey)
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.63 rows=4 width=8) (actual time=0.008..0.008 rows=1 loops=1514267)
                                                   Index Cond: (l_orderkey = l1.l_orderkey)
                                                   Filter: (l_suppkey <> l1.l_suppkey)
                                                   Rows Removed by Filter: 0
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..3.44 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1460326)
                                       Index Cond: (o_orderkey = l1.l_orderkey)
                                       Filter: (o_orderstatus = 'F'::bpchar)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.005..0.005 rows=1 loops=704306)
                                 Index Cond: (l_orderkey = l1.l_orderkey)
                                 Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                 Rows Removed by Filter: 1
 Planning time: 2.464 ms
 Execution time: 9060.069 ms
(45 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=133069.40..133069.43 rows=1 width=72) (actual time=1647.423..1647.423 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Finalize Aggregate  (cost=46820.92..46820.93 rows=1 width=32) (actual time=340.996..340.996 rows=1 loops=1)
           ->  Gather  (cost=46820.49..46820.90 rows=4 width=32) (actual time=340.753..341.078 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.49..45820.50 rows=1 width=32) (actual time=334.193..334.193 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.63 rows=11942 width=6) (actual time=0.027..320.545 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=86248.47..86456.64 rows=7570 width=72) (actual time=1647.422..1647.422 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86248.47..86267.39 rows=7570 width=38) (actual time=1645.192..1645.632 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85760.73 rows=7570 width=38) (actual time=341.056..1623.853 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75321.53 rows=17500 width=26) (actual time=341.026..930.537 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.18 rows=18 width=4) (actual time=0.003..0.003 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 14.908 ms
 Execution time: 1648.146 ms
(24 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=133069.40..133069.43 rows=1 width=72) (actual time=1152.698..1152.699 rows=1 loops=1)
   InitPlan 1 (returns $0)
     ->  Finalize Aggregate  (cost=46820.92..46820.93 rows=1 width=32) (actual time=238.721..238.721 rows=1 loops=1)
           ->  Gather  (cost=46820.49..46820.90 rows=4 width=32) (actual time=234.847..238.798 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.49..45820.50 rows=1 width=32) (actual time=230.221..230.221 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.63 rows=11942 width=6) (actual time=0.017..215.373 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=86248.47..86456.64 rows=7570 width=72) (actual time=1152.696..1152.696 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=86248.47..86267.39 rows=7570 width=38) (actual time=1150.431..1150.854 rows=9006 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method: quicksort  Memory: 4513kB
               ->  Nested Loop Anti Join  (cost=0.43..85760.73 rows=7570 width=38) (actual time=238.776..1132.981 rows=63509 loops=1)
                     ->  Seq Scan on customer  (cost=0.00..75321.53 rows=17500 width=26) (actual time=238.757..779.968 rows=191129 loops=1)
                           Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                           Rows Removed by Filter: 1308871
                     ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.18 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=191129)
                           Index Cond: (o_custkey = customer.c_custkey)
                           Heap Fetches: 0
 Planning time: 0.640 ms
 Execution time: 1152.844 ms
(24 rows)

