query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1831852.76..1831853.39 rows=1 width=236) (actual time=19872.820..19873.434 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1831852.76..1831856.57 rows=6 width=236) (actual time=19872.819..19873.431 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1831852.76..1831855.63 rows=24 width=236) (actual time=19872.787..19873.403 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1830852.70..1830852.71 rows=6 width=236) (actual time=19863.194..19863.195 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1830852.49..1830852.62 rows=6 width=236) (actual time=19863.159..19863.164 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312602.73 rows=14807136 width=25) (actual time=0.991..4328.269 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 15.468 ms
 Execution Time: 19873.786 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1831852.76..1831853.39 rows=1 width=236) (actual time=19331.162..19331.927 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1831852.76..1831856.57 rows=6 width=236) (actual time=19331.161..19331.925 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1831852.76..1831855.63 rows=24 width=236) (actual time=19331.137..19331.903 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1830852.70..1830852.71 rows=6 width=236) (actual time=19326.778..19326.779 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1830852.49..1830852.62 rows=6 width=236) (actual time=19326.746..19326.752 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312602.73 rows=14807136 width=25) (actual time=0.033..2666.822 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.587 ms
 Execution Time: 19331.996 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1111009.49..1111009.50 rows=1 width=192) (actual time=4208.532..4208.653 rows=100 loops=1)
   ->  Sort  (cost=1111009.49..1111009.50 rows=1 width=192) (actual time=4208.530..4208.646 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559093.75..1111009.48 rows=1 width=192) (actual time=3204.347..4205.195 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68721.59 rows=8477 width=30) (actual time=81.484..84.640 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.84 rows=2119 width=30) (actual time=1.753..322.467 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558093.19..566094.31 rows=1600225 width=172) (actual time=3121.689..3578.486 rows=1603828 loops=1)
                     ->  Sort  (cost=558093.19..562093.75 rows=1600225 width=172) (actual time=3121.683..3400.607 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293488kB
                           ->  Hash Join  (cost=4048.51..305288.26 rows=1600225 width=172) (actual time=59.269..2484.943 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255233.27 rows=8001127 width=14) (actual time=5.462..1086.182 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=53.767..53.770 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=4.909..47.442 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=4.529..34.812 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.369..0.371 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.363..0.369 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.172..0.173 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.185..0.185 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.181..0.182 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.59..69.60 rows=1 width=32) (actual time=0.056..0.057 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.58 rows=4 width=6) (actual time=0.047..0.054 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.28 rows=19 width=10) (actual time=0.041..0.052 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.66 rows=19 width=10) (actual time=0.041..0.051 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.037..0.038 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.011 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 20.234 ms
 Execution Time: 4245.583 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1111009.49..1111009.50 rows=1 width=192) (actual time=3419.768..3419.897 rows=100 loops=1)
   ->  Sort  (cost=1111009.49..1111009.50 rows=1 width=192) (actual time=3419.767..3419.890 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559093.75..1111009.48 rows=1 width=192) (actual time=2687.870..3417.565 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68721.59 rows=8477 width=30) (actual time=28.591..30.948 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.84 rows=2119 width=30) (actual time=0.194..124.102 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558093.19..566094.31 rows=1600225 width=172) (actual time=2659.170..3106.146 rows=1603828 loops=1)
                     ->  Sort  (cost=558093.19..562093.75 rows=1600225 width=172) (actual time=2659.165..2929.268 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293488kB
                           ->  Hash Join  (cost=4048.51..305288.26 rows=1600225 width=172) (actual time=48.073..2040.268 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255233.27 rows=8001127 width=14) (actual time=0.036..764.690 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=48.009..48.012 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.043..36.354 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.010..9.624 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.029..0.031 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.023..0.029 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.008..0.010 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.011..0.011 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.59..69.60 rows=1 width=32) (actual time=0.016..0.016 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.58 rows=4 width=6) (actual time=0.009..0.015 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.28 rows=19 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.66 rows=19 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.003..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.011 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 1.724 ms
 Execution Time: 3457.792 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2270981.75..2270981.77 rows=10 width=44) (actual time=10238.751..10271.376 rows=10 loops=1)
   ->  Sort  (cost=2270981.75..2278720.33 rows=3095432 width=44) (actual time=10238.750..10271.373 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1748335.76..2204090.58 rows=3095432 width=44) (actual time=10023.903..10249.717 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1748335.76..2118966.20 rows=3095432 width=24) (actual time=10023.890..10097.245 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1747335.70..1749270.35 rows=773858 width=24) (actual time=10014.101..10016.910 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4801kB
                           Worker 0:  Sort Method: quicksort  Memory: 4748kB
                           Worker 1:  Sort Method: quicksort  Memory: 4720kB
                           Worker 2:  Sort Method: quicksort  Memory: 4687kB
                           Worker 3:  Sort Method: quicksort  Memory: 4632kB
                           ->  Nested Loop  (cost=41574.65..1661442.02 rows=773858 width=24) (actual time=259.567..9994.791 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41574.09..354426.44 rows=359801 width=12) (actual time=257.671..1912.258 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308139.37 rows=1795416 width=16) (actual time=0.611..1208.480 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.68..40634.68 rows=75153 width=4) (actual time=256.340..256.341 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.68 rows=75153 width=4) (actual time=0.122..239.327 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.027..0.028 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 22.719 ms
 Execution Time: 10271.771 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2270981.75..2270981.77 rows=10 width=44) (actual time=3785.561..3815.805 rows=10 loops=1)
   ->  Sort  (cost=2270981.75..2278720.33 rows=3095432 width=44) (actual time=3785.560..3815.802 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1748335.76..2204090.58 rows=3095432 width=44) (actual time=3564.879..3794.210 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1748335.76..2118966.20 rows=3095432 width=24) (actual time=3564.867..3640.704 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1747335.70..1749270.35 rows=773858 width=24) (actual time=3558.031..3560.847 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4645kB
                           Worker 0:  Sort Method: quicksort  Memory: 4732kB
                           Worker 1:  Sort Method: quicksort  Memory: 4373kB
                           Worker 2:  Sort Method: quicksort  Memory: 4790kB
                           Worker 3:  Sort Method: quicksort  Memory: 6584kB
                           ->  Nested Loop  (cost=41574.65..1661442.02 rows=773858 width=24) (actual time=122.693..3535.492 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41574.09..354426.44 rows=359801 width=12) (actual time=122.518..1257.943 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308139.37 rows=1795416 width=16) (actual time=0.040..588.855 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.68..40634.68 rows=75153 width=4) (actual time=120.535..120.536 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.68 rows=75153 width=4) (actual time=0.027..92.565 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.007..0.007 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.587 ms
 Execution Time: 3815.886 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282025.54..639512.70 rows=1 width=24) (actual time=29036.000..29054.984 rows=1 loops=1)
   ->  GroupAggregate  (cost=282025.54..2069461.34 rows=5 width=24) (actual time=29035.998..29054.981 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282025.54..2066761.69 rows=539920 width=16) (actual time=4217.004..28972.238 rows=103030 loops=1)
               ->  Gather Merge  (cost=282024.98..346680.97 rows=539994 width=20) (actual time=4216.094..4349.256 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281024.92..281362.42 rows=134998 width=20) (actual time=4204.252..4207.354 rows=23461 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 8335kB
                           Worker 0:  Sort Method: quicksort  Memory: 8289kB
                           Worker 1:  Sort Method: quicksort  Memory: 8331kB
                           Worker 2:  Sort Method: quicksort  Memory: 8305kB
                           Worker 3:  Sort Method: quicksort  Memory: 8373kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6228.37..269521.35 rows=134998 width=20) (actual time=131.326..4156.941 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46417
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6093.38 rows=539994 width=0) (actual time=86.389..86.390 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.218..0.218 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 17.650 ms
 Execution Time: 29056.753 ms
(25 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282025.54..639512.70 rows=1 width=24) (actual time=1671.914..1688.853 rows=1 loops=1)
   ->  GroupAggregate  (cost=282025.54..2069461.34 rows=5 width=24) (actual time=1671.913..1688.852 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282025.54..2066761.69 rows=539920 width=16) (actual time=689.136..1665.830 rows=103030 loops=1)
               ->  Gather Merge  (cost=282024.98..346680.97 rows=539994 width=20) (actual time=689.079..741.181 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281024.92..281362.42 rows=134998 width=20) (actual time=679.062..681.262 rows=23447 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 8343kB
                           Worker 0:  Sort Method: quicksort  Memory: 8195kB
                           Worker 1:  Sort Method: quicksort  Memory: 7919kB
                           Worker 2:  Sort Method: quicksort  Memory: 12382kB
                           Worker 3:  Sort Method: quicksort  Memory: 7865kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6228.37..269521.35 rows=134998 width=20) (actual time=127.477..641.001 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46556
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6093.38 rows=539994 width=0) (actual time=81.761..81.761 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.091 ms
 Execution Time: 1688.930 ms
(25 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=759598.75..759598.75 rows=1 width=58) (actual time=22628.720..22674.502 rows=1 loops=1)
   ->  Sort  (cost=759598.75..759598.81 rows=25 width=58) (actual time=22628.718..22674.499 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=759360.18..759598.62 rows=25 width=58) (actual time=22620.443..22674.484 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=759360.18..759597.56 rows=100 width=58) (actual time=22619.026..22674.456 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=758360.13..758585.59 rows=25 width=58) (actual time=22601.163..22607.385 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=758360.13..758405.16 rows=18012 width=38) (actual time=22599.840..22600.510 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1290kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1284kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1285kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1287kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1280kB
                                 ->  Parallel Hash Join  (cost=72457.68..757086.98 rows=18012 width=38) (actual time=573.546..22586.379 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68766.09..751031.15 rows=450330 width=50) (actual time=551.762..22418.618 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68765.52..340871.08 rows=112598 width=38) (actual time=551.049..2611.546 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25972.00..295684.85 rows=562990 width=8) (actual time=258.469..2089.454 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52301
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25409.02 rows=2251958 width=0) (actual time=201.855..201.855 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.98..41855.98 rows=75003 width=38) (actual time=291.690..291.693 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.98 rows=75003 width=38) (actual time=0.898..263.211 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.14 rows=375014 width=8) (actual time=0.450..226.123 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.439..0.441 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.431..0.438 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.146..0.148 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.277..0.278 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.273..0.274 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.205..0.217 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.523..15.524 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5088kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.992..8.897 rows=20000 loops=5)
 Planning Time: 25.750 ms
 Execution Time: 22674.966 ms
(50 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=759598.75..759598.75 rows=1 width=58) (actual time=2470.329..2514.621 rows=1 loops=1)
   ->  Sort  (cost=759598.75..759598.81 rows=25 width=58) (actual time=2470.328..2514.619 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=759360.18..759598.62 rows=25 width=58) (actual time=2466.016..2514.601 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=759360.18..759597.56 rows=100 width=58) (actual time=2464.486..2514.571 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=758360.13..758585.59 rows=25 width=58) (actual time=2447.875..2454.082 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=758360.13..758405.16 rows=18012 width=38) (actual time=2446.553..2447.222 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1306kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1338kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1272kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1299kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1209kB
                                 ->  Parallel Hash Join  (cost=72457.68..757086.98 rows=18012 width=38) (actual time=409.906..2438.277 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68766.09..751031.15 rows=450330 width=50) (actual time=393.932..2312.228 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68765.52..340871.08 rows=112598 width=38) (actual time=393.884..959.969 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25972.00..295684.85 rows=562990 width=8) (actual time=247.089..638.460 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=53936
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25409.02 rows=2251958 width=0) (actual time=190.750..190.751 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.98..41855.98 rows=75003 width=38) (actual time=146.202..146.205 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.98 rows=75003 width=38) (actual time=0.080..109.305 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.14 rows=375014 width=8) (actual time=0.033..66.929 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.038..0.040 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.033..0.038 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.013..0.014 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.013..0.014 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.007..15.008 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.024..7.847 rows=20000 loops=5)
 Planning Time: 4.964 ms
 Execution Time: 2514.733 ms
(50 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1279961.48..1279961.49 rows=1 width=32) (actual time=10732.242..10773.627 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1279961.48..1279961.49 rows=1 width=32) (actual time=10732.240..10773.624 rows=1 loops=1)
         ->  Gather  (cost=1279961.05..1279961.46 rows=4 width=32) (actual time=10730.919..10773.611 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1278961.05..1278961.06 rows=1 width=32) (actual time=10722.148..10722.149 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=214764.35..1277493.87 rows=293436 width=12) (actual time=1337.666..10577.155 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=78807 lossy=52954
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..214470.92 rows=1173745 width=0) (actual time=1251.259..1251.259 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 14.014 ms
 Execution Time: 10774.677 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1279961.48..1279961.49 rows=1 width=32) (actual time=3066.595..3104.671 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1279961.48..1279961.49 rows=1 width=32) (actual time=3066.594..3104.669 rows=1 loops=1)
         ->  Gather  (cost=1279961.05..1279961.46 rows=4 width=32) (actual time=3066.582..3104.659 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1278961.05..1278961.06 rows=1 width=32) (actual time=3059.617..3059.618 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=214764.35..1277493.87 rows=293436 width=12) (actual time=1196.278..2953.867 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79625 lossy=53867
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..214470.92 rows=1173745 width=0) (actual time=1108.724..1108.724 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 1.014 ms
 Execution Time: 3104.736 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419302.44..1420351.70 rows=1 width=116) (actual time=30153.236..30159.194 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419302.44..11945492.75 rows=10032 width=116) (actual time=30153.235..30159.192 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419302.44..11944435.13 rows=60476 width=96) (actual time=7286.077..30127.884 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349037
               ->  Nested Loop  (cost=1419302.01..6769419.45 rows=1511892 width=76) (actual time=7284.946..24560.186 rows=363458 loops=1)
                     ->  Gather Merge  (cost=1419301.58..1600327.42 rows=1511892 width=76) (actual time=7283.958..7754.237 rows=363458 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418301.52..1419246.45 rows=377973 width=76) (actual time=7263.933..7306.649 rows=73131 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26416kB
                                 Worker 0:  Sort Method: external merge  Disk: 26888kB
                                 Worker 1:  Sort Method: external merge  Disk: 26592kB
                                 Worker 2:  Sort Method: external merge  Disk: 27240kB
                                 Worker 3:  Sort Method: external merge  Disk: 26808kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372488.50 rows=377973 width=76) (actual time=14.680..6976.760 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350094.67 rows=4541200 width=24) (actual time=0.504..6383.798 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=13.790..13.793 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.873..12.851 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.684..10.206 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.180..0.182 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.169..0.176 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.157..0.159 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.046..0.046 rows=1 loops=363458)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.014..0.015 rows=1 loops=363458)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 25.785 ms
 Execution Time: 30163.787 ms
(45 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419302.44..1420351.70 rows=1 width=116) (actual time=5684.536..5689.985 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419302.44..11945492.75 rows=10032 width=116) (actual time=5684.534..5689.983 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419302.44..11944435.13 rows=60476 width=96) (actual time=3546.392..5676.771 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349138
               ->  Nested Loop  (cost=1419302.01..6769419.45 rows=1511892 width=76) (actual time=3544.991..4703.362 rows=363559 loops=1)
                     ->  Gather Merge  (cost=1419301.58..1600327.42 rows=1511892 width=76) (actual time=3544.939..3762.080 rows=363559 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418301.52..1419246.45 rows=377973 width=76) (actual time=3532.012..3561.615 rows=73109 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 28384kB
                                 Worker 0:  Sort Method: external merge  Disk: 25632kB
                                 Worker 1:  Sort Method: external merge  Disk: 28400kB
                                 Worker 2:  Sort Method: external merge  Disk: 25904kB
                                 Worker 3:  Sort Method: external merge  Disk: 25624kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372488.50 rows=377973 width=76) (actual time=12.008..3214.235 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350094.67 rows=4541200 width=24) (actual time=0.736..2560.052 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=10.391..10.394 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 928kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.067..8.981 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.031..6.829 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.031..0.032 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.022..0.027 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.013 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.003..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.006 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363559)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363559)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.331 ms
 Execution Time: 5694.094 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386852.60..392830.21 rows=1 width=64) (actual time=34467.666..34473.944 rows=1 loops=1)
   ->  GroupAggregate  (cost=386852.60..14768992.16 rows=2406 width=64) (actual time=34467.665..34473.942 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386852.60..14768455.06 rows=24449 width=70) (actual time=2295.535..34448.230 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142669
               ->  Nested Loop  (cost=386852.60..14759562.79 rows=24449 width=20) (actual time=2295.519..34407.038 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386852.30..14679580.90 rows=24449 width=20) (actual time=2295.107..33858.352 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386851.87..3871282.24 rows=3703125 width=24) (actual time=2235.825..23826.615 rows=1817354 loops=1)
                                 ->  Gather Merge  (cost=386851.30..497714.68 rows=925909 width=8) (actual time=2234.551..2514.509 rows=454724 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385851.24..386429.94 rows=231477 width=8) (actual time=2219.868..2227.831 rows=92109 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 13505kB
                                             Worker 0:  Sort Method: quicksort  Memory: 13295kB
                                             Worker 1:  Sort Method: quicksort  Memory: 13194kB
                                             Worker 2:  Sort Method: quicksort  Memory: 13312kB
                                             Worker 3:  Sort Method: quicksort  Memory: 12977kB
                                             ->  Parallel Hash Join  (cost=42793.52..365226.05 rows=231477 width=8) (actual time=276.852..2171.212 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317513.65 rows=1157386 width=12) (actual time=0.530..1622.266 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.98..41855.98 rows=75003 width=4) (actual time=275.555..275.558 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41855.98 rows=75003 width=4) (actual time=0.221..258.176 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.14 rows=375014 width=8) (actual time=0.112..221.925 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.103..0.105 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.097..0.104 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.037..0.039 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.050..0.052 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.043..0.046 rows=4 loops=454724)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.005..0.005 rows=0 loops=1817354)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597423  Misses: 1219931  Evictions: 236389  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.007..0.007 rows=0 loops=1219931)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.046..0.046 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.006..0.015 rows=25 loops=1)
 Planning Time: 29.138 ms
 Execution Time: 34478.485 ms
(55 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386852.60..392830.21 rows=1 width=64) (actual time=8497.824..8503.798 rows=1 loops=1)
   ->  GroupAggregate  (cost=386852.60..14768992.16 rows=2406 width=64) (actual time=8497.823..8503.795 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386852.60..14768455.06 rows=24449 width=70) (actual time=1044.492..8490.616 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142654
               ->  Nested Loop  (cost=386852.60..14759562.79 rows=24449 width=20) (actual time=1044.475..8465.407 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386852.30..14679580.90 rows=24449 width=20) (actual time=1044.462..8423.226 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386851.87..3871282.24 rows=3703125 width=24) (actual time=1040.938..4067.158 rows=1816396 loops=1)
                                 ->  Gather Merge  (cost=386851.30..497714.68 rows=925909 width=8) (actual time=1040.874..1242.348 rows=454483 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385851.24..386429.94 rows=231477 width=8) (actual time=1029.998..1036.611 rows=92026 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 12648kB
                                             Worker 0:  Sort Method: quicksort  Memory: 13396kB
                                             Worker 1:  Sort Method: quicksort  Memory: 13586kB
                                             Worker 2:  Sort Method: quicksort  Memory: 14117kB
                                             Worker 3:  Sort Method: quicksort  Memory: 12536kB
                                             ->  Parallel Hash Join  (cost=42793.52..365226.05 rows=231477 width=8) (actual time=141.911..972.962 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317513.65 rows=1157386 width=12) (actual time=0.041..521.339 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.98..41855.98 rows=75003 width=4) (actual time=140.084..140.087 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.98 rows=75003 width=4) (actual time=0.071..113.517 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.14 rows=375014 width=8) (actual time=0.029..68.619 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.037..0.040 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.032..0.038 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.007..0.009 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.021..0.022 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.005 rows=4 loops=454483)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=1816396)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597214  Misses: 1219182  Evictions: 235627  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1219182)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.005..0.009 rows=25 loops=1)
 Planning Time: 5.742 ms
 Execution Time: 8508.190 ms
(55 rows)

query 9 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=32176.03..37748.85 rows=1 width=90) (actual time=1795036.098..1795037.411 rows=1 loops=1)
   ->  GroupAggregate  (cost=32176.03..572739.02 rows=97 width=90) (actual time=1795036.097..1795037.409 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=32176.03..572735.86 rows=97 width=81) (actual time=1795027.322..1795029.446 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 13853kB  Peak Memory: 13853kB
               ->  Nested Loop  (cost=9652.78..572733.20 rows=97 width=81) (actual time=32493.572..1794928.312 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778560550
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=52.850..60.951 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=44.953..45.631 rows=2459 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4665kB
                                 Worker 0:  Sort Method: quicksort  Memory: 3877kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.492..22.659 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.243..13.551 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.202..0.203 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.082..0.086 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..405684.67 rows=98 width=35) (actual time=0.003..240.818 rows=3247443 loops=3935)
                           ->  Gather  (cost=1001.31..405684.18 rows=98 width=35) (actual time=3.715..37481.650 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..404674.38 rows=24 width=35) (actual time=2.073..38307.632 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..404592.24 rows=24 width=35) (actual time=1.572..27577.242 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..126515.25 rows=80819 width=18) (actual time=1.152..1111.564 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.79 rows=20201 width=4) (actual time=0.271..181.196 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.73 rows=19 width=14) (actual time=0.038..0.041 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.044..0.303 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.016..0.016 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 32.108 ms
 Execution Time: 1795056.786 ms
(42 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=32176.03..37748.85 rows=1 width=90) (actual time=1775646.735..1775648.336 rows=1 loops=1)
   ->  GroupAggregate  (cost=32176.03..572739.02 rows=97 width=90) (actual time=1775646.734..1775648.334 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=32176.03..572735.86 rows=97 width=81) (actual time=1775637.820..1775640.299 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 13853kB  Peak Memory: 13853kB
               ->  Nested Loop  (cost=9652.78..572733.20 rows=97 width=81) (actual time=1388.978..1775538.618 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778454557
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=53.898..62.195 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=48.659..49.326 rows=2552 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4478kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4064kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.433..26.046 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.165..16.682 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.210..0.210 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.082..0.086 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..405684.67 rows=98 width=35) (actual time=0.002..235.801 rows=3247416 loops=3935)
                           ->  Gather  (cost=1001.31..405684.18 rows=98 width=35) (actual time=0.833..16430.170 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..404674.38 rows=24 width=35) (actual time=1.009..17239.060 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..404592.24 rows=24 width=35) (actual time=0.965..11634.264 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..126515.25 rows=80819 width=18) (actual time=0.811..683.672 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.79 rows=20201 width=4) (actual time=0.262..170.532 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.73 rows=19 width=14) (actual time=0.020..0.022 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.019..0.124 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.736 ms
 Execution Time: 1775669.283 ms
(42 rows)

query 10 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=950305.13..950305.18 rows=20 width=202) (actual time=20901.932..20976.050 rows=20 loops=1)
   ->  Sort  (cost=950305.13..951744.41 rows=575715 width=202) (actual time=20901.930..20976.046 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=851659.65..934985.56 rows=575715 width=202) (actual time=19820.146..20852.532 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=851659.65..920592.68 rows=575715 width=182) (actual time=19820.127..20142.450 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=850659.59..851019.42 rows=143929 width=182) (actual time=19796.650..19824.924 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 43432kB
                           Worker 0:  Sort Method: external merge  Disk: 43880kB
                           Worker 1:  Sort Method: external merge  Disk: 43560kB
                           Worker 2:  Sort Method: external merge  Disk: 43784kB
                           Worker 3:  Sort Method: external merge  Disk: 43880kB
                           ->  Hash Join  (cost=51047.63..838328.48 rows=143929 width=182) (actual time=572.607..19568.137 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=51046.07..837885.06 rows=143929 width=160) (actual time=572.482..19489.431 rows=229080 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Nested Loop  (cost=6661.25..793122.43 rows=143929 width=16) (actual time=126.857..18858.116 rows=229080 loops=5)
                                             ->  Parallel Bitmap Heap Scan on orders  (cost=6660.69..270094.27 rows=144372 width=8) (actual time=126.204..2295.567 rows=114632 loops=5)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=46445
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6516.32 rows=577488 width=0) (actual time=74.929..74.929 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.139..0.143 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Parallel Hash  (cost=39697.14..39697.14 rows=375014 width=148) (actual time=443.419..443.420 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 288416kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39697.14 rows=375014 width=148) (actual time=0.381..161.107 rows=300000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.050..0.050 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.042..0.044 rows=25 loops=5)
 Planning Time: 24.344 ms
 Execution Time: 20982.421 ms
(38 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=950305.13..950305.18 rows=20 width=202) (actual time=3910.449..3990.280 rows=20 loops=1)
   ->  Sort  (cost=950305.13..951744.41 rows=575715 width=202) (actual time=3910.447..3990.276 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=851659.65..934985.56 rows=575715 width=202) (actual time=2830.858..3867.037 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=851659.65..920592.68 rows=575715 width=182) (actual time=2830.839..3156.917 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=850659.59..851019.42 rows=143929 width=182) (actual time=2804.638..2833.260 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 42984kB
                           Worker 0:  Sort Method: external merge  Disk: 42992kB
                           Worker 1:  Sort Method: external merge  Disk: 45816kB
                           Worker 2:  Sort Method: external merge  Disk: 43520kB
                           Worker 3:  Sort Method: external merge  Disk: 43200kB
                           ->  Hash Join  (cost=51047.63..838328.48 rows=143929 width=182) (actual time=494.619..2602.413 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=51046.07..837885.06 rows=143929 width=160) (actual time=494.517..2546.247 rows=229080 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Nested Loop  (cost=6661.25..793122.43 rows=143929 width=16) (actual time=119.252..2031.490 rows=229080 loops=5)
                                             ->  Parallel Bitmap Heap Scan on orders  (cost=6660.69..270094.27 rows=144372 width=8) (actual time=119.120..450.817 rows=114632 loops=5)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=45841
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6516.32 rows=577488 width=0) (actual time=69.159..69.160 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.012..0.013 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Parallel Hash  (cost=39697.14..39697.14 rows=375014 width=148) (actual time=373.101..373.101 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 288448kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39697.14 rows=375014 width=148) (actual time=0.030..89.475 rows=300000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.020..0.021 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.012..0.015 rows=25 loops=5)
 Planning Time: 2.367 ms
 Execution Time: 3995.804 ms
(38 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=447534.58..447534.58 rows=1 width=36) (actual time=3941.080..3957.088 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=197865.49..197865.50 rows=1 width=32) (actual time=150.683..150.766 rows=1 loops=1)
           ->  Gather  (cost=197865.26..197865.47 rows=2 width=32) (actual time=150.675..150.759 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=196865.26..196865.27 rows=1 width=32) (actual time=148.224..148.225 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..195865.12 rows=133352 width=10) (actual time=0.102..119.863 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.088..16.647 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.029..6.573 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 39585  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 30353  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 29987  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..113.92 rows=81 width=14) (actual time=0.003..0.067 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=249669.08..249935.78 rows=106682 width=36) (actual time=3941.079..3957.003 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=208216.66..249135.67 rows=106682 width=36) (actual time=3941.072..3956.996 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=208216.66..242334.71 rows=266704 width=36) (actual time=3439.204..3599.311 rows=314283 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=207216.63..210550.43 rows=133352 width=36) (actual time=3431.976..3533.040 rows=104761 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=207216.63..207550.01 rows=133352 width=14) (actual time=3431.962..3440.124 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 7107kB
                                 Worker 0:  Sort Method: quicksort  Memory: 7326kB
                                 Worker 1:  Sort Method: quicksort  Memory: 7316kB
                                 ->  Nested Loop  (cost=0.87..195865.12 rows=133352 width=14) (actual time=1.173..3396.376 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.371..26.884 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.244..14.096 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 32549  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 32915  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 34461  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.004..0.004 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..113.92 rows=81 width=18) (actual time=0.075..2.503 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 15.856 ms
 Execution Time: 3957.456 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=447534.58..447534.58 rows=1 width=36) (actual time=662.136..678.643 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=197865.49..197865.50 rows=1 width=32) (actual time=146.282..146.381 rows=1 loops=1)
           ->  Gather  (cost=197865.26..197865.47 rows=2 width=32) (actual time=146.192..146.371 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=196865.26..196865.27 rows=1 width=32) (actual time=143.747..143.748 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..195865.12 rows=133352 width=10) (actual time=0.104..115.542 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.091..16.491 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.033..6.472 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 42797  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 28523  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 28605  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..113.92 rows=81 width=14) (actual time=0.003..0.064 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=249669.08..249935.78 rows=106682 width=36) (actual time=662.134..678.542 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=208216.66..249135.67 rows=106682 width=36) (actual time=662.128..678.534 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=208216.66..242334.71 rows=266704 width=36) (actual time=157.899..323.516 rows=314505 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=207216.63..210550.43 rows=133352 width=36) (actual time=155.059..255.967 rows=104835 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=207216.63..207550.01 rows=133352 width=14) (actual time=155.048..163.224 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 7313kB
                                 Worker 0:  Sort Method: quicksort  Memory: 7201kB
                                 Worker 1:  Sort Method: quicksort  Memory: 7235kB
                                 ->  Nested Loop  (cost=0.87..195865.12 rows=133352 width=14) (actual time=0.100..131.904 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.085..17.132 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.028..6.895 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 34013  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 33363  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 32549  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..113.92 rows=81 width=18) (actual time=0.004..0.077 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.234 ms
 Execution Time: 678.747 ms
(56 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469511.10..1618821.00 rows=1 width=27) (actual time=13369.012..13372.633 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469511.10..2514680.44 rows=7 width=27) (actual time=13369.011..13372.631 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469511.10..2509535.91 rows=293969 width=27) (actual time=7148.613..13278.881 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469510.66..1504708.94 rows=293969 width=15) (actual time=7148.082..7217.033 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468510.61..1468694.34 rows=73492 width=15) (actual time=7137.703..7140.259 rows=32227 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3972kB
                           Worker 0:  Sort Method: quicksort  Memory: 3931kB
                           Worker 1:  Sort Method: quicksort  Memory: 3963kB
                           Worker 2:  Sort Method: quicksort  Memory: 3996kB
                           Worker 3:  Sort Method: quicksort  Memory: 3980kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462570.50 rows=73492 width=15) (actual time=0.978..7120.960 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.038..0.038 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 16.288 ms
 Execution Time: 13373.353 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469511.10..1618821.00 rows=1 width=27) (actual time=4105.250..4106.673 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469511.10..2514680.44 rows=7 width=27) (actual time=4105.249..4106.671 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469511.10..2509535.91 rows=293969 width=27) (actual time=3648.742..4061.812 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469510.66..1504708.94 rows=293969 width=15) (actual time=3648.700..3684.260 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468510.61..1468694.34 rows=73492 width=15) (actual time=3643.674..3645.709 rows=32343 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 4085kB
                           Worker 0:  Sort Method: quicksort  Memory: 3684kB
                           Worker 1:  Sort Method: quicksort  Memory: 3748kB
                           Worker 2:  Sort Method: quicksort  Memory: 4076kB
                           Worker 3:  Sort Method: quicksort  Memory: 5784kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462570.50 rows=73492 width=15) (actual time=0.100..3624.991 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.854 ms
 Execution Time: 4106.738 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369790.23..1369790.24 rows=1 width=16) (actual time=17007.225..17007.228 rows=1 loops=1)
   ->  Sort  (cost=1369790.23..1369790.73 rows=200 width=16) (actual time=17007.223..17007.226 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369787.23..1369789.23 rows=200 width=16) (actual time=17007.197..17007.205 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215119.12..1347286.39 rows=1500056 width=12) (actual time=14854.448..16839.171 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53285.97..664435.58 rows=14997339 width=8) (actual time=366.710..11053.808 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448753.49 rows=14997339 width=8) (actual time=0.659..5269.311 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28675.27..28675.27 rows=1500056 width=4) (actual time=363.449..363.450 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28675.27 rows=1500056 width=4) (actual time=0.021..159.150 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 15.952 ms
 Execution Time: 17040.408 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369790.23..1369790.24 rows=1 width=16) (actual time=16468.613..16468.616 rows=1 loops=1)
   ->  Sort  (cost=1369790.23..1369790.73 rows=200 width=16) (actual time=16468.612..16468.614 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369787.23..1369789.23 rows=200 width=16) (actual time=16468.586..16468.593 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215119.12..1347286.39 rows=1500056 width=12) (actual time=14296.374..16299.650 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53285.97..664435.58 rows=14997339 width=8) (actual time=331.679..10513.868 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448753.49 rows=14997339 width=8) (actual time=0.033..4808.069 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28675.27..28675.27 rows=1500056 width=4) (actual time=329.106..329.107 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28675.27 rows=1500056 width=4) (actual time=0.019..128.959 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.731 ms
 Execution Time: 16502.246 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=890865.12..890865.13 rows=1 width=32) (actual time=5264.036..5296.495 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=890865.12..890865.13 rows=1 width=32) (actual time=5264.035..5296.492 rows=1 loops=1)
         ->  Gather  (cost=890864.66..890865.07 rows=4 width=64) (actual time=5258.087..5296.471 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=889864.66..889864.67 rows=1 width=64) (actual time=5249.497..5249.500 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65648.56..886203.80 rows=209192 width=33) (actual time=670.893..5082.723 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13417.94..833424.05 rows=209192 width=16) (actual time=291.165..4524.016 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=82459
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13208.75 rows=836768 width=0) (actual time=191.409..191.409 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.83..45980.83 rows=499983 width=25) (actual time=377.608..377.608 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.83 rows=499983 width=25) (actual time=0.427..224.538 rows=400000 loops=5)
 Planning Time: 17.969 ms
 Execution Time: 5296.914 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=890865.12..890865.13 rows=1 width=32) (actual time=1652.098..1683.882 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=890865.12..890865.13 rows=1 width=32) (actual time=1652.097..1683.880 rows=1 loops=1)
         ->  Gather  (cost=890864.66..890865.07 rows=4 width=64) (actual time=1647.620..1683.855 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=889864.66..889864.67 rows=1 width=64) (actual time=1642.427..1642.429 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65648.56..886203.80 rows=209192 width=33) (actual time=542.135..1523.150 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13417.94..833424.05 rows=209192 width=16) (actual time=272.199..1107.542 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=89315
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..13208.75 rows=836768 width=0) (actual time=172.493..172.493 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.83..45980.83 rows=499983 width=25) (actual time=267.847..267.847 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.83 rows=499983 width=25) (actual time=0.043..98.238 rows=400000 loops=5)
 Planning Time: 1.034 ms
 Execution Time: 1683.936 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2740180.58..2740287.89 rows=1 width=103) (actual time=13061.111..13107.342 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1388369.59..1388369.60 rows=1 width=32) (actual time=2819.417..2828.448 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1385913.19..1387141.39 rows=98256 width=36) (actual time=2778.594..2822.751 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 57361kB
                 ->  Gather  (cost=1342434.91..1382965.51 rows=393024 width=36) (actual time=2446.855..2529.153 rows=398612 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1341434.91..1342663.11 rows=98256 width=36) (actual time=2442.528..2491.196 rows=99653 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 43025kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=36145.62..1335799.04 rows=563587 width=16) (actual time=436.719..1980.356 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=105216 lossy=70159
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35582.04 rows=2254347 width=0) (actual time=346.455..346.456 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1351810.98..1404502.41 rows=491 width=103) (actual time=13061.110..13098.308 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1351810.68..1403290.79 rows=491 width=36) (actual time=13060.311..13097.507 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1351810.68..1398869.27 rows=393024 width=36) (actual time=10032.760..10133.892 rows=346212 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1350810.63..1351056.27 rows=98256 width=36) (actual time=10004.096..10012.023 rows=69730 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 12347kB
                           Worker 0:  Sort Method: quicksort  Memory: 12345kB
                           Worker 1:  Sort Method: quicksort  Memory: 12348kB
                           Worker 2:  Sort Method: quicksort  Memory: 12350kB
                           Worker 3:  Sort Method: quicksort  Memory: 12340kB
                           ->  Partial HashAggregate  (cost=1341434.91..1342663.11 rows=98256 width=36) (actual time=9918.213..9979.164 rows=98918 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=36145.62..1335799.04 rows=563587 width=16) (actual time=486.805..9398.741 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79640 lossy=53452
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35582.04 rows=2254347 width=0) (actual time=398.596..398.597 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.46 rows=1 width=71) (actual time=0.793..0.793 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 15.149 ms
 Execution Time: 13109.595 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2740180.58..2740287.89 rows=1 width=103) (actual time=5782.124..5834.354 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1388369.59..1388369.60 rows=1 width=32) (actual time=2836.705..2848.383 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1385913.19..1387141.39 rows=98256 width=36) (actual time=2792.587..2842.593 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 54289kB
                 ->  Gather  (cost=1342434.91..1382965.51 rows=393024 width=36) (actual time=2460.140..2546.054 rows=398566 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1341434.91..1342663.11 rows=98256 width=36) (actual time=2455.812..2504.713 rows=99642 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 43025kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=36145.62..1335799.04 rows=563587 width=16) (actual time=442.289..1994.628 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=104835 lossy=69876
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35582.04 rows=2254347 width=0) (actual time=351.612..351.612 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1351810.98..1404502.41 rows=491 width=103) (actual time=5782.123..5822.674 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1351810.68..1403290.79 rows=491 width=36) (actual time=5782.066..5822.615 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1351810.68..1398869.27 rows=393024 width=36) (actual time=2739.513..2843.585 rows=346129 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1350810.63..1351056.27 rows=98256 width=36) (actual time=2713.102..2720.916 rows=69736 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 12282kB
                           Worker 0:  Sort Method: quicksort  Memory: 12349kB
                           Worker 1:  Sort Method: quicksort  Memory: 12380kB
                           Worker 2:  Sort Method: quicksort  Memory: 12352kB
                           Worker 3:  Sort Method: quicksort  Memory: 12364kB
                           ->  Partial HashAggregate  (cost=1341434.91..1342663.11 rows=98256 width=36) (actual time=2627.903..2690.778 rows=98910 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=36145.62..1335799.04 rows=563587 width=16) (actual time=445.776..2191.721 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=70947 lossy=47270
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35582.04 rows=2254347 width=0) (actual time=356.635..356.635 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.46 rows=1 width=71) (actual time=0.053..0.053 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.296 ms
 Execution Time: 5836.392 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=253596.96..253596.96 rows=1 width=44) (actual time=2824.436..2832.013 rows=1 loops=1)
   ->  Sort  (cost=253596.96..253984.71 rows=155101 width=44) (actual time=2824.434..2832.011 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172503.09..252821.45 rows=155101 width=44) (actual time=2153.140..2826.870 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172503.09..245199.02 rows=607142 width=40) (actual time=2153.100..2650.928 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171503.04..171882.50 rows=151786 width=40) (actual time=2050.454..2067.169 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 22023kB
                           Worker 0:  Sort Method: quicksort  Memory: 21629kB
                           Worker 1:  Sort Method: quicksort  Memory: 22507kB
                           Worker 2:  Sort Method: quicksort  Memory: 22623kB
                           Worker 3:  Sort Method: quicksort  Memory: 21199kB
                           ->  Parallel Hash Join  (cost=57900.54..158440.58 rows=151786 width=40) (actual time=356.064..1093.113 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101386.11 rows=1000141 width=8) (actual time=48.423..591.258 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.630..47.464 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.58..53480.58 rows=75880 width=40) (actual time=306.965..306.966 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.58 rows=75880 width=40) (actual time=0.131..277.579 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 19.314 ms
 Execution Time: 2832.672 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=253596.96..253596.96 rows=1 width=44) (actual time=2579.690..2584.732 rows=1 loops=1)
   ->  Sort  (cost=253596.96..253984.71 rows=155101 width=44) (actual time=2579.688..2584.729 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172503.09..252821.45 rows=155101 width=44) (actual time=1906.353..2579.590 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172503.09..245199.02 rows=607142 width=40) (actual time=1906.312..2403.903 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171503.04..171882.50 rows=151786 width=40) (actual time=1747.828..1764.699 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 23298kB
                           Worker 0:  Sort Method: quicksort  Memory: 20516kB
                           Worker 1:  Sort Method: quicksort  Memory: 20048kB
                           Worker 2:  Sort Method: quicksort  Memory: 26797kB
                           Worker 3:  Sort Method: quicksort  Memory: 21691kB
                           ->  Parallel Hash Join  (cost=57900.54..158440.58 rows=151786 width=40) (actual time=187.358..799.934 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101386.11 rows=1000141 width=8) (actual time=27.038..439.496 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.085..26.960 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.58..53480.58 rows=75880 width=40) (actual time=159.420..159.421 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26336kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.58 rows=75880 width=40) (actual time=0.017..129.838 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 0.862 ms
 Execution Time: 2584.813 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3437113.07..3437113.08 rows=1 width=32) (actual time=25284.545..25365.071 rows=1 loops=1)
   ->  Aggregate  (cost=3437113.07..3437113.08 rows=1 width=32) (actual time=25284.543..25365.069 rows=1 loops=1)
         ->  Merge Join  (cost=2287609.67..3437065.97 rows=18836 width=8) (actual time=18474.578..25364.232 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2286608.74..3334386.84 rows=1999811 width=36) (actual time=18448.039..25179.184 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2286608.74..3244395.35 rows=7999244 width=36) (actual time=18448.019..20520.748 rows=9972093 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2285608.68..2290608.21 rows=1999811 width=36) (actual time=18007.118..18306.530 rows=1994908 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150328kB
                                 Worker 0:  Sort Method: external merge  Disk: 150296kB
                                 Worker 1:  Sort Method: external merge  Disk: 150320kB
                                 Worker 2:  Sort Method: external merge  Disk: 150336kB
                                 Worker 3:  Sort Method: external merge  Disk: 150336kB
                                 ->  Partial HashAggregate  (cost=1869709.60..2041160.14 rows=1999811 width=36) (actual time=10024.654..17110.557 rows=1995084 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407568kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 391944kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 399368kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 406600kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407592kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275110.78 rows=14996778 width=9) (actual time=1.572..3881.508 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..96831.99 rows=56510 width=21) (actual time=24.221..63.682 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..96690.72 rows=56510 width=21) (actual time=24.216..56.528 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..88959.77 rows=14128 width=21) (actual time=0.886..474.841 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.84 rows=471 width=4) (actual time=0.666..193.909 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..46.94 rows=30 width=17) (actual time=0.337..0.554 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 15.524 ms
 Execution Time: 25434.939 ms
(38 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3437113.07..3437113.08 rows=1 width=32) (actual time=23625.223..23726.485 rows=1 loops=1)
   ->  Aggregate  (cost=3437113.07..3437113.08 rows=1 width=32) (actual time=23625.222..23726.483 rows=1 loops=1)
         ->  Merge Join  (cost=2287609.67..3437065.97 rows=18836 width=8) (actual time=16957.695..23725.754 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2286608.74..3334386.84 rows=1999811 width=36) (actual time=16948.533..23579.335 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2286608.74..3244395.35 rows=7999244 width=36) (actual time=16948.513..19039.522 rows=9971772 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2285608.68..2290608.21 rows=1999811 width=36) (actual time=16665.149..16960.128 rows=1994842 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150360kB
                                 Worker 0:  Sort Method: external merge  Disk: 150312kB
                                 Worker 1:  Sort Method: external merge  Disk: 150312kB
                                 Worker 2:  Sort Method: external merge  Disk: 150184kB
                                 Worker 3:  Sort Method: external merge  Disk: 150424kB
                                 ->  Partial HashAggregate  (cost=1869709.60..2041160.14 rows=1999811 width=36) (actual time=8657.351..15841.114 rows=1995020 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407776kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 393224kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 395272kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 375520kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 424144kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275110.78 rows=14996778 width=9) (actual time=0.054..1645.635 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..96831.99 rows=56510 width=21) (actual time=6.997..28.494 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..96690.72 rows=56510 width=21) (actual time=6.992..21.770 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..88959.77 rows=14128 width=21) (actual time=0.254..125.099 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.84 rows=471 width=4) (actual time=0.234..106.155 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..46.94 rows=30 width=17) (actual time=0.005..0.033 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.894 ms
 Execution Time: 23796.089 ms
(38 rows)

query 18 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8725683.43..8725683.68 rows=100 width=71) (actual time=41234.779..41234.793 rows=99 loops=1)
   ->  Sort  (cost=8725683.43..8775665.82 rows=19992956 width=71) (actual time=41234.778..41234.785 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  HashAggregate  (cost=7360216.40..7961567.03 rows=19992956 width=71) (actual time=41233.904..41234.680 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 128  Batches: 1  Memory Usage: 6225kB
               ->  Hash Join  (cost=78763.00..6283252.09 rows=19992956 width=44) (actual time=2989.481..41233.426 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=274.74..5870150.18 rows=19992956 width=25) (actual time=970.598..40478.954 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3340305.67 rows=4998926 width=24) (actual time=749.795..29740.862 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547948.02 rows=14998839 width=20) (actual time=0.581..3000.355 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692373.97 rows=4998926 width=4) (actual time=643.867..25876.480 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167486.75 rows=59987112 width=9) (actual time=0.488..12368.122 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167486.75 rows=59987112 width=9) (actual time=0.014..7416.130 rows=59916431 loops=1)
                     ->  Hash  (cost=50947.56..50947.56 rows=1500056 width=23) (actual time=670.414..670.414 rows=1500000 loops=1)
                           Buckets: 1048576  Batches: 2  Memory Usage: 49242kB
                           ->  Seq Scan on customer  (cost=0.00..50947.56 rows=1500056 width=23) (actual time=0.847..402.321 rows=1500000 loops=1)
 Planning Time: 22.033 ms
 Execution Time: 41236.157 ms
(25 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8725683.43..8725683.68 rows=100 width=71) (actual time=38193.256..38193.270 rows=99 loops=1)
   ->  Sort  (cost=8725683.43..8775665.82 rows=19992956 width=71) (actual time=38193.254..38193.262 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  HashAggregate  (cost=7360216.40..7961567.03 rows=19992956 width=71) (actual time=38192.392..38193.163 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 128  Batches: 1  Memory Usage: 6225kB
               ->  Hash Join  (cost=78763.00..6283252.09 rows=19992956 width=44) (actual time=2582.264..38191.937 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=274.74..5870150.18 rows=19992956 width=25) (actual time=848.089..37566.493 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3340305.67 rows=4998926 width=24) (actual time=619.928..26695.660 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547948.02 rows=14998839 width=20) (actual time=0.030..2412.226 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692373.97 rows=4998926 width=4) (actual time=542.318..23441.187 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167486.75 rows=59987112 width=9) (actual time=0.016..10047.084 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167486.75 rows=59987112 width=9) (actual time=0.013..7514.059 rows=59916431 loops=1)
                     ->  Hash  (cost=50947.56..50947.56 rows=1500056 width=23) (actual time=541.519..541.520 rows=1500000 loops=1)
                           Buckets: 1048576  Batches: 2  Memory Usage: 49242kB
                           ->  Seq Scan on customer  (cost=0.00..50947.56 rows=1500056 width=23) (actual time=0.030..278.562 rows=1500000 loops=1)
 Planning Time: 1.814 ms
 Execution Time: 38194.491 ms
(25 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=123554.07..123554.08 rows=1 width=32) (actual time=4964.094..4972.095 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=123554.07..123554.08 rows=1 width=32) (actual time=4964.084..4972.084 rows=1 loops=1)
         ->  Gather  (cost=123553.64..123554.05 rows=4 width=32) (actual time=4956.480..4972.065 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=122553.64..122553.65 rows=1 width=32) (actual time=4947.930..4947.931 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..122551.50 rows=285 width=12) (actual time=43.286..4947.321 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.29 rows=1235 width=30) (actual time=0.790..183.343 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.83 rows=1 width=21) (actual time=4.494..4.980 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 17.093 ms
 Execution Time: 4973.069 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=123554.07..123554.08 rows=1 width=32) (actual time=224.435..246.676 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=123554.07..123554.08 rows=1 width=32) (actual time=224.434..246.673 rows=1 loops=1)
         ->  Gather  (cost=123553.64..123554.05 rows=4 width=32) (actual time=220.676..246.651 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=122553.64..122553.65 rows=1 width=32) (actual time=215.794..215.795 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..122551.50 rows=285 width=12) (actual time=0.847..215.598 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.29 rows=1235 width=30) (actual time=0.149..142.923 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.83 rows=1 width=21) (actual time=0.067..0.075 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.058 ms
 Execution Time: 246.743 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2455945.18..2654047.91 rows=1 width=51) (actual time=28411.954..28413.230 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2455945.18..2654047.91 rows=1 width=51) (actual time=28411.953..28413.227 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=25.873..27.077 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=19.914..19.931 rows=394 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 287kB
                     Worker 0:  Sort Method: quicksort  Memory: 192kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.379..18.623 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.244..13.775 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.085..0.085 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.079..0.081 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2451822.25..2649289.11 rows=3 width=8) (actual time=26820.335..28384.992 rows=13474 loops=1)
               ->  Hash Join  (cost=2451822.25..2649289.09 rows=3 width=8) (actual time=26820.331..28382.112 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2375217.85..2536413.55 rows=4836134 width=40) (actual time=25409.977..26784.499 rows=1251652 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=145555.98..1992588.51 rows=9078138 width=13) (actual time=1249.292..20054.568 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..143286.45 rows=9078138 width=0) (actual time=1124.711..1124.711 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75392.13..75392.13 rows=80818 width=16) (actual time=1410.233..1410.302 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75392.13 rows=80818 width=16) (actual time=1.973..1390.394 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66310.33 rows=20204 width=16) (actual time=1.101..1395.927 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.79 rows=5050 width=4) (actual time=0.706..148.930 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.59 rows=19 width=12) (actual time=0.268..0.285 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 23.231 ms
 Execution Time: 28456.304 ms
(46 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2455945.18..2654047.91 rows=1 width=51) (actual time=14856.061..14857.429 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2455945.18..2654047.91 rows=1 width=51) (actual time=14856.060..14857.427 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=16.761..18.068 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=14.756..14.773 rows=394 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 287kB
                     Worker 0:  Sort Method: quicksort  Memory: 192kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.094..13.443 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.020..8.611 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.015 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2451822.25..2649289.11 rows=3 width=8) (actual time=13275.963..14838.232 rows=13474 loops=1)
               ->  Hash Join  (cost=2451822.25..2649289.09 rows=3 width=8) (actual time=13275.959..14835.340 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2375217.85..2536413.55 rows=4836134 width=40) (actual time=13092.571..14465.461 rows=1251652 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=145555.98..1992588.51 rows=9078138 width=13) (actual time=1100.045..9047.995 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..143286.45 rows=9078138 width=0) (actual time=976.198..976.198 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75392.13..75392.13 rows=80818 width=16) (actual time=183.261..183.319 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75392.13 rows=80818 width=16) (actual time=0.337..158.420 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66310.33 rows=20204 width=16) (actual time=0.089..165.144 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.79 rows=5050 width=4) (actual time=0.037..101.306 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.59 rows=19 width=12) (actual time=0.012..0.014 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.223 ms
 Execution Time: 14905.170 ms
(46 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1964938.90..1964938.90 rows=1 width=34) (actual time=11303.830..11315.908 rows=100 loops=1)
   ->  Sort  (cost=1964938.90..1964938.90 rows=1 width=34) (actual time=11303.829..11315.900 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1964935.67..1964938.89 rows=1 width=34) (actual time=10773.267..11313.520 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1964935.67..1964938.87 rows=1 width=26) (actual time=10773.105..11302.056 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1964935.11..1964935.23 rows=1 width=38) (actual time=10773.065..10817.748 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1963935.05..1963935.05 rows=1 width=38) (actual time=10745.201..10747.059 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1207kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1213kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1218kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1199kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1207kB
                                 ->  Nested Loop Anti Join  (cost=1338045.54..1963935.04 rows=1 width=38) (actual time=7216.553..10670.080 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338044.97..1653231.04 rows=96766 width=38) (actual time=7214.748..9250.434 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308139.37 rows=1814610 width=4) (actual time=0.520..1503.945 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335545.51..1335545.51 rows=199957 width=34) (actual time=7213.035..7213.340 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131360kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335545.51 rows=199957 width=34) (actual time=17.393..7051.456 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312602.73 rows=4998926 width=8) (actual time=0.484..6232.421 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=16.669..16.672 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.552..16.353 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.497..14.267 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.046..0.047 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.009..0.009 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 19.971 ms
 Execution Time: 11316.672 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1964938.90..1964938.90 rows=1 width=34) (actual time=6807.522..6822.026 rows=100 loops=1)
   ->  Sort  (cost=1964938.90..1964938.90 rows=1 width=34) (actual time=6807.520..6822.018 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1964935.67..1964938.89 rows=1 width=34) (actual time=6321.400..6819.639 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1964935.67..1964938.87 rows=1 width=26) (actual time=6321.228..6808.481 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1964935.11..1964935.23 rows=1 width=38) (actual time=6321.191..6367.879 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1963935.05..1963935.05 rows=1 width=38) (actual time=6295.030..6296.910 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1183kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1220kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1178kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1220kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1243kB
                                 ->  Nested Loop Anti Join  (cost=1338045.54..1963935.04 rows=1 width=38) (actual time=3861.072..6220.789 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338044.97..1653231.04 rows=96766 width=38) (actual time=3860.703..5068.148 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308139.37 rows=1814610 width=4) (actual time=0.138..607.298 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335545.51..1335545.51 rows=199957 width=34) (actual time=3858.654..3858.966 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335545.51 rows=199957 width=34) (actual time=15.066..3672.963 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312602.73 rows=4998926 width=8) (actual time=0.045..2731.670 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=9.376..9.378 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.050..9.107 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.026..7.116 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.007..0.007 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.244 ms
 Execution Time: 6822.139 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93877.54..93879.04 rows=1 width=72) (actual time=1549.237..1555.260 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46821.34..46821.35 rows=1 width=32) (actual time=332.990..333.082 rows=1 loops=1)
           ->  Gather  (cost=46820.91..46821.32 rows=4 width=32) (actual time=332.843..333.070 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.91..45820.92 rows=1 width=32) (actual time=324.214..324.214 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.12 rows=11915 width=6) (actual time=0.395..313.687 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.19..59556.03 rows=8350 width=72) (actual time=1549.236..1555.167 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.19..59347.28 rows=8350 width=38) (actual time=528.536..1548.682 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.76..49151.23 rows=17501 width=26) (actual time=526.593..549.013 rows=27130 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 3
                     ->  Sort  (cost=46055.70..46066.63 rows=4375 width=26) (actual time=188.417..189.395 rows=7586 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 4422kB
                           Worker 0:  Sort Method: quicksort  Memory: 4320kB
                           Worker 1:  Sort Method: quicksort  Memory: 3942kB
                           Worker 2:  Sort Method: quicksort  Memory: 3914kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.12 rows=4375 width=26) (actual time=0.020..172.263 rows=47782 loops=4)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.19 rows=19 width=4) (actual time=0.036..0.036 rows=1 loops=27130)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 16.379 ms
 Execution Time: 1555.350 ms
(31 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93877.54..93879.04 rows=1 width=72) (actual time=461.988..467.670 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46821.34..46821.35 rows=1 width=32) (actual time=218.624..218.718 rows=1 loops=1)
           ->  Gather  (cost=46820.91..46821.32 rows=4 width=32) (actual time=216.110..218.700 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.91..45820.92 rows=1 width=32) (actual time=211.586..211.587 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.12 rows=11915 width=6) (actual time=0.020..204.218 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.19..59556.03 rows=8350 width=72) (actual time=461.987..467.574 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.19..59347.28 rows=8350 width=38) (actual time=396.949..465.357 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.76..49151.23 rows=17501 width=26) (actual time=396.868..409.515 rows=27128 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 3
                     ->  Sort  (cost=46055.70..46066.63 rows=4375 width=26) (actual time=173.677..174.383 rows=7572 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 4422kB
                           Worker 0:  Sort Method: quicksort  Memory: 4057kB
                           Worker 1:  Sort Method: quicksort  Memory: 4052kB
                           Worker 2:  Sort Method: quicksort  Memory: 4067kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.12 rows=4375 width=26) (actual time=0.023..157.631 rows=47782 loops=4)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.19 rows=19 width=4) (actual time=0.002..0.002 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 0.785 ms
 Execution Time: 467.730 ms
(31 rows)

