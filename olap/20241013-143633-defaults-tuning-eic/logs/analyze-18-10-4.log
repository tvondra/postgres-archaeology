query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832212.63..1832213.26 rows=1 width=236) (actual time=17496.560..17498.421 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832212.63..1832216.44 rows=6 width=236) (actual time=17496.558..17498.419 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832212.63..1832215.50 rows=24 width=236) (actual time=17496.524..17498.387 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831212.57..1831212.58 rows=6 width=236) (actual time=17486.277..17486.278 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831212.35..1831212.49 rows=6 width=236) (actual time=17486.241..17486.246 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312591.70 rows=14817733 width=25) (actual time=0.248..4444.919 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 14.109 ms
 Execution Time: 17499.536 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832212.63..1832213.26 rows=1 width=236) (actual time=16706.708..16707.162 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832212.63..1832216.44 rows=6 width=236) (actual time=16706.707..16707.160 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832212.63..1832215.50 rows=24 width=236) (actual time=16706.688..16707.143 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831212.57..1831212.58 rows=6 width=236) (actual time=16700.536..16700.537 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831212.35..1831212.49 rows=6 width=236) (actual time=16700.501..16700.506 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312591.70 rows=14817733 width=25) (actual time=0.034..2600.002 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.653 ms
 Execution Time: 16707.236 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1161251.21..1161251.21 rows=1 width=193) (actual time=4045.637..4045.751 rows=100 loops=1)
   ->  Sort  (cost=1161251.21..1161251.21 rows=1 width=193) (actual time=4045.635..4045.743 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559080.63..1161251.20 rows=1 width=193) (actual time=3013.734..4042.657 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68885.43 rows=9850 width=30) (actual time=86.525..90.059 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.14 rows=2462 width=30) (actual time=3.690..329.259 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558079.35..566080.17 rows=1600164 width=173) (actual time=2925.059..3385.038 rows=1603828 loops=1)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Sort  (cost=558079.35..562079.76 rows=1600164 width=173) (actual time=2925.053..3210.492 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305283.40 rows=1600164 width=173) (actual time=42.865..2313.034 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255230.18 rows=8000818 width=14) (actual time=0.504..960.128 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=167) (actual time=42.328..42.330 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=167) (actual time=0.896..36.365 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.577..24.657 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.313..0.315 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.307..0.313 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.137..0.139 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.165..0.165 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.161..0.162 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.060..0.060 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.049..0.058 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.043..0.055 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.043..0.054 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.039..0.040 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.011 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.006 rows=25 loops=1)
 Planning Time: 21.412 ms
 Execution Time: 4082.908 ms
(57 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1161251.21..1161251.21 rows=1 width=193) (actual time=3267.555..3267.680 rows=100 loops=1)
   ->  Sort  (cost=1161251.21..1161251.21 rows=1 width=193) (actual time=3267.553..3267.673 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559080.63..1161251.20 rows=1 width=193) (actual time=2526.232..3265.231 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68885.43 rows=9850 width=30) (actual time=27.661..29.972 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.14 rows=2462 width=30) (actual time=0.171..122.696 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558079.35..566080.17 rows=1600164 width=173) (actual time=2498.474..2941.822 rows=1603828 loops=1)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Sort  (cost=558079.35..562079.76 rows=1600164 width=173) (actual time=2498.469..2771.100 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305283.40 rows=1600164 width=173) (actual time=48.140..1900.998 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255230.18 rows=8000818 width=14) (actual time=0.050..646.220 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=167) (actual time=48.065..48.067 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=167) (actual time=0.041..34.191 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=145) (actual time=0.010..15.469 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.027..0.029 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.021..0.027 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.008..0.009 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.010..0.010 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.007..0.008 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.018..0.018 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.010..0.016 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.006..0.014 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.004 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.007 rows=25 loops=1)
 Planning Time: 1.747 ms
 Execution Time: 3303.411 ms
(57 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2274953.10..2274953.12 rows=10 width=44) (actual time=10510.953..10543.882 rows=10 loops=1)
   ->  Sort  (cost=2274953.10..2282757.56 rows=3121787 width=44) (actual time=10510.952..10543.880 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1747857.22..2207492.40 rows=3121787 width=44) (actual time=10308.083..10523.420 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1747857.22..2121643.26 rows=3121787 width=24) (actual time=10308.071..10381.130 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1746857.16..1748808.27 rows=780447 width=24) (actual time=10293.930..10296.539 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4271kB
                           Worker 0:  Sort Method: quicksort  Memory: 4232kB
                           Worker 1:  Sort Method: quicksort  Memory: 4299kB
                           Worker 2:  Sort Method: quicksort  Memory: 4225kB
                           Worker 3:  Sort Method: quicksort  Memory: 4204kB
                           ->  Nested Loop  (cost=41577.86..1660185.79 rows=780447 width=24) (actual time=293.213..10274.648 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41577.29..354416.19 rows=359458 width=12) (actual time=291.384..1909.262 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308144.46 rows=1788354 width=16) (actual time=0.410..1176.729 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40635.00..40635.00 rows=75383 width=4) (actual time=290.331..290.332 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40635.00 rows=75383 width=4) (actual time=0.496..274.914 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.028..0.028 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 20.847 ms
 Execution Time: 10544.627 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2274953.10..2274953.12 rows=10 width=44) (actual time=3833.645..3863.922 rows=10 loops=1)
   ->  Sort  (cost=2274953.10..2282757.56 rows=3121787 width=44) (actual time=3833.644..3863.919 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1747857.22..2207492.40 rows=3121787 width=44) (actual time=3631.856..3843.660 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1747857.22..2121643.26 rows=3121787 width=24) (actual time=3631.844..3702.263 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1746857.16..1748808.27 rows=780447 width=24) (actual time=3625.178..3627.775 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4181kB
                           Worker 0:  Sort Method: quicksort  Memory: 6065kB
                           Worker 1:  Sort Method: quicksort  Memory: 4278kB
                           Worker 2:  Sort Method: quicksort  Memory: 4062kB
                           Worker 3:  Sort Method: quicksort  Memory: 4183kB
                           ->  Nested Loop  (cost=41577.86..1660185.79 rows=780447 width=24) (actual time=104.947..3602.756 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41577.29..354416.19 rows=359458 width=12) (actual time=104.770..1170.019 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308144.46 rows=1788354 width=16) (actual time=0.041..530.463 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40635.00..40635.00 rows=75383 width=4) (actual time=103.514..103.515 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40635.00 rows=75383 width=4) (actual time=0.036..78.674 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.008..0.008 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.604 ms
 Execution Time: 3863.994 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282707.54..651957.40 rows=1 width=24) (actual time=26143.830..26162.907 rows=1 loops=1)
   ->  GroupAggregate  (cost=282707.54..2128956.83 rows=5 width=24) (actual time=26143.829..26162.905 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282707.54..2126168.88 rows=557581 width=16) (actual time=4273.618..26078.567 rows=103030 loops=1)
               ->  Gather Merge  (cost=282706.97..349489.09 rows=557751 width=20) (actual time=4271.973..4407.474 rows=112214 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281706.91..282055.51 rows=139438 width=20) (actual time=4258.891..4261.915 rows=23420 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7453kB
                           Worker 0:  Sort Method: quicksort  Memory: 7481kB
                           Worker 1:  Sort Method: quicksort  Memory: 7451kB
                           Worker 2:  Sort Method: quicksort  Memory: 7394kB
                           Worker 3:  Sort Method: quicksort  Memory: 7476kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6432.88..269792.45 rows=139438 width=20) (actual time=130.943..4210.329 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46332
                                 Worker 0:  Heap Blocks: exact=46795
                                 Worker 1:  Heap Blocks: exact=46399
                                 Worker 2:  Heap Blocks: exact=45710
                                 Worker 3:  Heap Blocks: exact=46651
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6293.45 rows=557751 width=0) (actual time=86.538..86.538 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.192..0.192 rows=1 loops=112214)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 15.975 ms
 Execution Time: 26163.774 ms
(29 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282707.54..651957.40 rows=1 width=24) (actual time=1774.927..1793.158 rows=1 loops=1)
   ->  GroupAggregate  (cost=282707.54..2128956.83 rows=5 width=24) (actual time=1774.926..1793.157 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282707.54..2126168.88 rows=557581 width=16) (actual time=734.035..1772.058 rows=103030 loops=1)
               ->  Gather Merge  (cost=282706.97..349489.09 rows=557751 width=20) (actual time=733.975..788.870 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281706.91..282055.51 rows=139438 width=20) (actual time=725.003..727.028 rows=23388 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7267kB
                           Worker 0:  Sort Method: quicksort  Memory: 7631kB
                           Worker 1:  Sort Method: quicksort  Memory: 7420kB
                           Worker 2:  Sort Method: quicksort  Memory: 7234kB
                           Worker 3:  Sort Method: quicksort  Memory: 7701kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6432.88..269792.45 rows=139438 width=20) (actual time=128.267..684.906 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=44263
                                 Worker 0:  Heap Blocks: exact=48480
                                 Worker 1:  Heap Blocks: exact=46267
                                 Worker 2:  Heap Blocks: exact=44056
                                 Worker 3:  Heap Blocks: exact=48821
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6293.45 rows=557751 width=0) (actual time=82.100..82.100 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.151 ms
 Execution Time: 1793.223 ms
(29 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=758657.03..758657.03 rows=1 width=58) (actual time=21637.595..21681.775 rows=1 loops=1)
   ->  Sort  (cost=758657.03..758657.09 rows=25 width=58) (actual time=21637.594..21681.773 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=758419.01..758656.90 rows=25 width=58) (actual time=21629.997..21681.756 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=758419.01..758655.84 rows=100 width=58) (actual time=21628.764..21681.728 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=757418.96..757643.87 rows=25 width=58) (actual time=21609.498..21614.967 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=757418.96..757463.88 rows=17968 width=38) (actual time=21608.359..21609.003 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1173kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1185kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1170kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1172kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1162kB
                                 ->  Parallel Hash Join  (cost=72403.96..756149.24 rows=17968 width=38) (actual time=553.645..21595.085 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68712.37..750098.74 rows=449314 width=50) (actual time=534.956..21431.053 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68711.80..340794.72 rows=112363 width=38) (actual time=534.486..2647.914 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25917.81..295613.02 rows=561814 width=8) (actual time=259.834..2148.006 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52213
                                                         Worker 0:  Heap Blocks: exact=52466
                                                         Worker 1:  Heap Blocks: exact=51929
                                                         Worker 2:  Heap Blocks: exact=52256
                                                         Worker 3:  Heap Blocks: exact=52382
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25356.00 rows=2247256 width=0) (actual time=202.625..202.626 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41856.39..41856.39 rows=75008 width=38) (actual time=273.952..273.955 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41856.39 rows=75008 width=38) (actual time=0.783..248.130 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=8) (actual time=0.483..214.809 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.291..0.293 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.286..0.291 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.119..0.121 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.161..0.162 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.158..0.159 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.195..0.205 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.813..15.814 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.115..8.923 rows=20000 loops=5)
 Planning Time: 26.504 ms
 Execution Time: 21682.118 ms
(54 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=758657.03..758657.03 rows=1 width=58) (actual time=2516.553..2559.478 rows=1 loops=1)
   ->  Sort  (cost=758657.03..758657.09 rows=25 width=58) (actual time=2516.552..2559.476 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=758419.01..758656.90 rows=25 width=58) (actual time=2508.939..2559.459 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=758419.01..758655.84 rows=100 width=58) (actual time=2507.696..2559.428 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=757418.96..757643.87 rows=25 width=58) (actual time=2490.252..2496.850 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=757418.96..757463.88 rows=17968 width=38) (actual time=2489.119..2489.778 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1168kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1084kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1210kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1223kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1177kB
                                 ->  Parallel Hash Join  (cost=72403.96..756149.24 rows=17968 width=38) (actual time=392.233..2480.721 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68712.37..750098.74 rows=449314 width=50) (actual time=377.116..2354.838 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68711.80..340794.72 rows=112363 width=38) (actual time=377.067..952.265 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25917.81..295613.02 rows=561814 width=8) (actual time=246.779..648.128 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=51799
                                                         Worker 0:  Heap Blocks: exact=46200
                                                         Worker 1:  Heap Blocks: exact=54782
                                                         Worker 2:  Heap Blocks: exact=55637
                                                         Worker 3:  Heap Blocks: exact=52828
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25356.00 rows=2247256 width=0) (actual time=190.794..190.794 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41856.39..41856.39 rows=75008 width=38) (actual time=129.399..129.402 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41856.39 rows=75008 width=38) (actual time=0.088..94.327 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=8) (actual time=0.038..55.227 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.043..0.045 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.038..0.043 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.016..0.017 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.016..0.017 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.014..0.014 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=13.863..13.863 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.032..4.726 rows=20000 loops=5)
 Planning Time: 4.866 ms
 Execution Time: 2559.575 ms
(54 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1285560.47..1285560.48 rows=1 width=32) (actual time=10646.814..10683.727 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1285560.47..1285560.48 rows=1 width=32) (actual time=10646.812..10683.724 rows=1 loops=1)
         ->  Gather  (cost=1285560.04..1285560.45 rows=4 width=32) (actual time=10645.487..10683.702 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1284560.04..1284560.05 rows=1 width=32) (actual time=10635.960..10635.961 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=213316.93..1283072.92 rows=297424 width=12) (actual time=1379.649..10501.172 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79928 lossy=53822
                           Worker 0:  Heap Blocks: exact=79291 lossy=53252
                           Worker 1:  Heap Blocks: exact=79175 lossy=53400
                           Worker 2:  Heap Blocks: exact=78751 lossy=53397
                           Worker 3:  Heap Blocks: exact=78755 lossy=53197
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..213019.51 rows=1189697 width=0) (actual time=1293.903..1293.904 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 11.001 ms
 Execution Time: 10685.036 ms
(18 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1285560.47..1285560.48 rows=1 width=32) (actual time=3183.206..3217.176 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1285560.47..1285560.48 rows=1 width=32) (actual time=3183.204..3217.173 rows=1 loops=1)
         ->  Gather  (cost=1285560.04..1285560.45 rows=4 width=32) (actual time=3179.158..3217.153 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1284560.04..1284560.05 rows=1 width=32) (actual time=3174.161..3174.162 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=213316.93..1283072.92 rows=297424 width=12) (actual time=1239.043..3082.034 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=76864 lossy=52057
                           Worker 0:  Heap Blocks: exact=79111 lossy=53081
                           Worker 1:  Heap Blocks: exact=80448 lossy=54304
                           Worker 2:  Heap Blocks: exact=83840 lossy=56528
                           Worker 3:  Heap Blocks: exact=75637 lossy=51098
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..213019.51 rows=1189697 width=0) (actual time=1151.150..1151.151 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.831 ms
 Execution Time: 3217.499 ms
(18 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419809.25..1420864.86 rows=1 width=116) (actual time=26998.277..27003.487 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419809.25..12026656.38 rows=10048 width=116) (actual time=26998.275..27003.485 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419809.25..12025591.58 rows=60939 width=96) (actual time=7419.903..26977.913 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349046
               ->  Nested Loop  (cost=1419808.82..6810921.94 rows=1523477 width=76) (actual time=7351.296..20735.512 rows=363467 loops=1)
                     ->  Gather Merge  (cost=1419808.38..1602221.35 rows=1523477 width=76) (actual time=7350.377..7780.870 rows=363467 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418808.33..1419760.50 rows=380869 width=76) (actual time=7331.343..7372.019 rows=73113 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26320kB
                                 Worker 0:  Sort Method: external merge  Disk: 26960kB
                                 Worker 1:  Sort Method: external merge  Disk: 27240kB
                                 Worker 2:  Sort Method: external merge  Disk: 26848kB
                                 Worker 3:  Sort Method: external merge  Disk: 26584kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372622.80 rows=380869 width=76) (actual time=14.993..7040.794 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350081.44 rows=4575998 width=24) (actual time=0.494..6474.408 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=14.194..14.197 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 928kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.408..13.293 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.311..11.069 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.090..0.092 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.080..0.087 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.066..0.067 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=10)
                                                                     Storage: Memory  Maximum Storage: 17kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.007..0.010 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.035..0.035 rows=1 loops=363467)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.016..0.016 rows=1 loops=363467)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 23.893 ms
 Execution Time: 27006.955 ms
(46 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419809.25..1420864.86 rows=1 width=116) (actual time=5717.432..5723.616 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419809.25..12026656.38 rows=10048 width=116) (actual time=5717.431..5723.613 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419809.25..12025591.58 rows=60939 width=96) (actual time=3319.610..5711.408 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349055
               ->  Nested Loop  (cost=1419808.82..6810921.94 rows=1523477 width=76) (actual time=3319.489..4600.459 rows=363476 loops=1)
                     ->  Gather Merge  (cost=1419808.38..1602221.35 rows=1523477 width=76) (actual time=3319.440..3540.784 rows=363476 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418808.33..1419760.50 rows=380869 width=76) (actual time=3306.350..3335.700 rows=73102 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26096kB
                                 Worker 0:  Sort Method: external merge  Disk: 25720kB
                                 Worker 1:  Sort Method: external merge  Disk: 26496kB
                                 Worker 2:  Sort Method: external merge  Disk: 28248kB
                                 Worker 3:  Sort Method: external merge  Disk: 27408kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372622.80 rows=380869 width=76) (actual time=12.921..2980.312 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350081.44 rows=4575998 width=24) (actual time=0.045..2361.606 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=11.880..11.883 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.284..10.598 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.233..7.812 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.037..0.038 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.028..0.033 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.016..0.018 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     Storage: Memory  Maximum Storage: 17kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=363476)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=363476)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.542 ms
 Execution Time: 5727.186 ms
(46 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386686.73..392624.31 rows=1 width=64) (actual time=35799.879..35805.980 rows=1 loops=1)
   ->  GroupAggregate  (cost=386686.73..14672508.13 rows=2406 width=64) (actual time=35799.878..35805.978 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386686.73..14671970.55 rows=24473 width=70) (actual time=2523.400..35782.596 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142661
               ->  Nested Loop  (cost=386686.73..14663069.57 rows=24473 width=20) (actual time=2523.378..35743.769 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386686.44..14583009.17 rows=24473 width=20) (actual time=2522.962..35297.552 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386686.00..3849030.19 rows=3679039 width=24) (actual time=2467.818..24829.729 rows=1816663 loops=1)
                                 ->  Gather Merge  (cost=386685.44..496846.09 rows=920040 width=8) (actual time=2466.553..2740.621 rows=454551 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385685.38..386260.40 rows=230010 width=8) (actual time=2447.580..2454.723 rows=92081 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 11852kB
                                             Worker 0:  Sort Method: quicksort  Memory: 11834kB
                                             Worker 1:  Sort Method: quicksort  Memory: 11839kB
                                             Worker 2:  Sort Method: quicksort  Memory: 11871kB
                                             Worker 3:  Sort Method: quicksort  Memory: 11776kB
                                             ->  Parallel Hash Join  (cost=42793.99..365201.45 rows=230010 width=8) (actual time=289.342..2398.297 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317519.75 rows=1150050 width=12) (actual time=0.459..1852.981 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41856.39..41856.39 rows=75008 width=4) (actual time=288.186..288.189 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41856.39 rows=75008 width=4) (actual time=0.577..272.377 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=8) (actual time=0.123..239.348 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.449..0.451 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.440..0.448 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.040..0.042 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.082..0.083 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.075..0.076 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.045..0.048 rows=4 loops=454551)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.006..0.006 rows=0 loops=1816663)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597176  Misses: 1219487  Evictions: 235935  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.007..0.007 rows=0 loops=1219487)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.037..0.037 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.009..0.019 rows=25 loops=1)
 Planning Time: 31.438 ms
 Execution Time: 35806.891 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386686.73..392624.31 rows=1 width=64) (actual time=8983.473..8989.634 rows=1 loops=1)
   ->  GroupAggregate  (cost=386686.73..14672508.13 rows=2406 width=64) (actual time=8983.472..8989.632 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386686.73..14671970.55 rows=24473 width=70) (actual time=963.809..8977.921 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142661
               ->  Nested Loop  (cost=386686.73..14663069.57 rows=24473 width=20) (actual time=963.785..8953.293 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386686.44..14583009.17 rows=24473 width=20) (actual time=963.768..8906.599 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386686.00..3849030.19 rows=3679039 width=24) (actual time=959.863..4124.521 rows=1816663 loops=1)
                                 ->  Gather Merge  (cost=386685.44..496846.09 rows=920040 width=8) (actual time=959.800..1155.919 rows=454551 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385685.38..386260.40 rows=230010 width=8) (actual time=950.757..956.766 rows=92111 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 11582kB
                                             Worker 0:  Sort Method: quicksort  Memory: 12302kB
                                             Worker 1:  Sort Method: quicksort  Memory: 11804kB
                                             Worker 2:  Sort Method: quicksort  Memory: 12056kB
                                             Worker 3:  Sort Method: quicksort  Memory: 11428kB
                                             ->  Parallel Hash Join  (cost=42793.99..365201.45 rows=230010 width=8) (actual time=128.468..894.261 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317519.75 rows=1150050 width=12) (actual time=0.046..474.348 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41856.39..41856.39 rows=75008 width=4) (actual time=127.033..127.036 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41856.39 rows=75008 width=4) (actual time=1.370..104.528 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=8) (actual time=1.126..65.830 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.238..0.240 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.233..0.239 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.015..0.016 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.018..0.019 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.006 rows=4 loops=454551)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=1816663)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597293  Misses: 1219370  Evictions: 235851  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1219370)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     Storage: Memory  Maximum Storage: 18kB
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.009..0.013 rows=25 loops=1)
 Planning Time: 5.411 ms
 Execution Time: 8990.274 ms
(56 rows)

query 9 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27144.58..32895.36 rows=1 width=90) (actual time=1781263.629..1781264.989 rows=1 loops=1)
   ->  GroupAggregate  (cost=27144.58..446951.59 rows=73 width=90) (actual time=1781263.628..1781264.987 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=27144.58..446949.21 rows=73 width=81) (actual time=1781256.088..1781258.250 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 29kB  Peak Memory: 29kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=9652.78..446947.24 rows=73 width=81) (actual time=21432.158..1781164.745 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12779138235
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=50.697..59.075 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=44.028..44.683 rows=2522 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4009kB
                                 Worker 0:  Sort Method: quicksort  Memory: 3751kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.352..22.086 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.250..13.183 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.097..0.097 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.087..0.090 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..315898.71 rows=74 width=35) (actual time=0.002..230.637 rows=3247590 loops=3935)
                           Storage: Disk  Maximum Storage: 158361kB
                           ->  Gather  (cost=1001.31..315898.34 rows=74 width=35) (actual time=3.155..38267.150 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..314890.94 rows=18 width=35) (actual time=2.201..39070.576 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..314829.33 rows=18 width=35) (actual time=1.672..27882.842 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..106279.33 rows=60612 width=18) (actual time=1.170..1157.422 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.90 rows=15151 width=4) (actual time=0.453..179.822 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.040..0.044 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.044..0.306 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.016..0.016 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 32.551 ms
 Execution Time: 1781284.313 ms
(43 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27144.58..32895.36 rows=1 width=90) (actual time=1766426.468..1766428.038 rows=1 loops=1)
   ->  GroupAggregate  (cost=27144.58..446951.59 rows=73 width=90) (actual time=1766426.466..1766428.036 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=27144.58..446949.21 rows=73 width=81) (actual time=1766419.417..1766421.441 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=9652.78..446947.24 rows=73 width=81) (actual time=4069.137..1766327.275 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778308544
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=52.633..61.304 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=43.142..43.814 rows=2430 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4239kB
                                 Worker 0:  Sort Method: quicksort  Memory: 3521kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.275..21.397 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.181..12.418 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.087..0.088 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.077..0.080 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..315898.71 rows=74 width=35) (actual time=0.002..226.260 rows=3247379 loops=3935)
                           Storage: Disk  Maximum Storage: 158361kB
                           ->  Gather  (cost=1001.31..315898.34 rows=74 width=35) (actual time=1.420..16969.315 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..314890.94 rows=18 width=35) (actual time=1.626..17789.150 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..314829.33 rows=18 width=35) (actual time=1.585..11766.624 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..106279.33 rows=60612 width=18) (actual time=1.216..694.042 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.90 rows=15151 width=4) (actual time=0.344..166.967 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.020..0.023 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.020..0.125 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.009..0.009 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.667 ms
 Execution Time: 1766448.443 ms
(43 rows)

query 10 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=901490.19..901490.24 rows=20 width=202) (actual time=21004.512..21062.015 rows=20 loops=1)
   ->  Sort  (cost=901490.19..902800.69 rows=524199 width=202) (actual time=21004.511..21062.012 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=811671.69..887541.44 rows=524199 width=202) (actual time=20016.203..20943.871 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=811671.69..874436.47 rows=524199 width=182) (actual time=20016.183..20288.414 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=810671.63..810999.25 rows=131050 width=182) (actual time=19993.451..20019.162 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 36696kB
                           Worker 0:  Sort Method: external merge  Disk: 49568kB
                           Worker 1:  Sort Method: external merge  Disk: 52656kB
                           Worker 2:  Sort Method: external merge  Disk: 31032kB
                           Worker 3:  Sort Method: external merge  Disk: 48568kB
                           ->  Hash Join  (cost=756292.39..799532.54 rows=131050 width=182) (actual time=19533.880..19864.737 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=756290.83..799128.65 rows=131050 width=160) (actual time=19533.818..19819.403 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=148) (actual time=0.489..127.154 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=754652.70..754652.70 rows=131050 width=16) (actual time=19532.706..19532.707 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 524288)  Batches: 1 (originally 1)  Memory Usage: 89312kB
                                             ->  Nested Loop  (cost=6179.09..754652.70 rows=131050 width=16) (actual time=135.280..19345.717 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6178.52..269455.46 rows=133929 width=8) (actual time=134.280..2413.516 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46793
                                                         Worker 0:  Heap Blocks: exact=46782
                                                         Worker 1:  Heap Blocks: exact=46610
                                                         Worker 2:  Heap Blocks: exact=46244
                                                         Worker 3:  Heap Blocks: exact=46917
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6044.60 rows=535716 width=0) (actual time=88.688..88.688 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.142..0.147 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.055..0.056 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.047..0.050 rows=25 loops=5)
 Planning Time: 22.163 ms
 Execution Time: 21067.233 ms
(42 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=901490.19..901490.24 rows=20 width=202) (actual time=3591.255..3639.441 rows=20 loops=1)
   ->  Sort  (cost=901490.19..902800.69 rows=524199 width=202) (actual time=3591.254..3639.438 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=811671.69..887541.44 rows=524199 width=202) (actual time=2593.067..3521.467 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=811671.69..874436.47 rows=524199 width=182) (actual time=2593.051..2866.737 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=810671.63..810999.25 rows=131050 width=182) (actual time=2571.443..2597.339 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 54768kB
                           Worker 0:  Sort Method: external merge  Disk: 53288kB
                           Worker 1:  Sort Method: external merge  Disk: 36064kB
                           Worker 2:  Sort Method: external merge  Disk: 31840kB
                           Worker 3:  Sort Method: external merge  Disk: 42568kB
                           ->  Hash Join  (cost=756292.39..799532.54 rows=131050 width=182) (actual time=2176.809..2438.193 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=756290.83..799128.65 rows=131050 width=160) (actual time=2176.773..2387.158 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=148) (actual time=0.028..52.206 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=754652.70..754652.70 rows=131050 width=16) (actual time=2172.847..2172.848 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 524288)  Batches: 1 (originally 1)  Memory Usage: 89312kB
                                             ->  Nested Loop  (cost=6179.09..754652.70 rows=131050 width=16) (actual time=133.627..2040.690 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6178.52..269455.46 rows=133929 width=8) (actual time=133.541..470.363 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=53380
                                                         Worker 0:  Heap Blocks: exact=40973
                                                         Worker 1:  Heap Blocks: exact=41195
                                                         Worker 2:  Heap Blocks: exact=48525
                                                         Worker 3:  Heap Blocks: exact=49273
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6044.60 rows=535716 width=0) (actual time=84.068..84.069 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.012..0.013 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.030..0.030 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.021..0.023 rows=25 loops=5)
 Planning Time: 2.400 ms
 Execution Time: 3646.711 ms
(42 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=455661.95..455661.95 rows=1 width=36) (actual time=3880.949..3895.867 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=199751.93..199751.94 rows=1 width=32) (actual time=160.000..160.093 rows=1 loops=1)
           ->  Gather  (cost=199751.71..199751.92 rows=2 width=32) (actual time=159.594..160.083 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=198751.71..198751.72 rows=1 width=32) (actual time=157.001..157.002 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.72..197751.60 rows=133347 width=10) (actual time=0.132..132.637 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.115..15.454 rows=1337 loops=3)
                                   Join Filter: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   Rows Removed by Join Filter: 31997
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.031..6.683 rows=33333 loops=3)
                                   ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                         Storage: Memory  Maximum Storage: 17kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.061..0.062 rows=1 loops=3)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..115.30 rows=82 width=14) (actual time=0.004..0.078 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=255910.01..256176.70 rows=106678 width=36) (actual time=3880.948..3895.773 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=210102.67..255376.62 rows=106678 width=36) (actual time=3880.940..3895.764 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=210102.67..247375.79 rows=320033 width=14) (actual time=3498.127..3563.467 rows=320800 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Sort  (cost=209102.65..209436.02 rows=133347 width=14) (actual time=3490.110..3497.183 rows=106933 loops=3)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 6378kB
                           Worker 0:  Sort Method: quicksort  Memory: 6445kB
                           Worker 1:  Sort Method: quicksort  Memory: 6420kB
                           ->  Nested Loop  (cost=0.72..197751.60 rows=133347 width=14) (actual time=0.720..3451.911 rows=106933 loops=3)
                                 ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.382..24.541 rows=1337 loops=3)
                                       Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                                       Rows Removed by Join Filter: 31997
                                       ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.241..14.167 rows=33333 loops=3)
                                       ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                             Storage: Memory  Maximum Storage: 17kB
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.107..0.108 rows=1 loops=3)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                 ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..115.30 rows=82 width=18) (actual time=0.072..2.547 rows=80 loops=4010)
                                       Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 14.621 ms
 Execution Time: 3896.243 ms
(48 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=455661.95..455661.95 rows=1 width=36) (actual time=551.290..567.407 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=199751.93..199751.94 rows=1 width=32) (actual time=155.806..155.903 rows=1 loops=1)
           ->  Gather  (cost=199751.71..199751.92 rows=2 width=32) (actual time=154.926..155.891 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=198751.71..198751.72 rows=1 width=32) (actual time=152.550..152.552 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.72..197751.60 rows=133347 width=10) (actual time=0.154..128.179 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.137..15.256 rows=1337 loops=3)
                                   Join Filter: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   Rows Removed by Join Filter: 31997
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.052..6.552 rows=33333 loops=3)
                                   ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                         Storage: Memory  Maximum Storage: 17kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.060..0.061 rows=1 loops=3)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..115.30 rows=82 width=14) (actual time=0.004..0.075 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=255910.01..256176.70 rows=106678 width=36) (actual time=551.289..567.308 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=210102.67..255376.62 rows=106678 width=36) (actual time=551.280..567.299 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=210102.67..247375.79 rows=320033 width=14) (actual time=171.128..239.839 rows=320800 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Sort  (cost=209102.65..209436.02 rows=133347 width=14) (actual time=168.211..175.571 rows=106933 loops=3)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 6535kB
                           Worker 0:  Sort Method: quicksort  Memory: 6380kB
                           Worker 1:  Sort Method: quicksort  Memory: 6328kB
                           ->  Nested Loop  (cost=0.72..197751.60 rows=133347 width=14) (actual time=0.129..143.747 rows=106933 loops=3)
                                 ->  Nested Loop  (cost=0.29..4178.78 rows=1667 width=4) (actual time=0.113..15.726 rows=1337 loops=3)
                                       Join Filter: (supplier.s_nationkey = nation.n_nationkey)
                                       Rows Removed by Join Filter: 31997
                                       ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.033..6.917 rows=33333 loops=3)
                                       ->  Materialize  (cost=0.00..1.32 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=100000)
                                             Storage: Memory  Maximum Storage: 17kB
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.057..0.058 rows=1 loops=3)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                 ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..115.30 rows=82 width=18) (actual time=0.004..0.087 rows=80 loops=4010)
                                       Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.052 ms
 Execution Time: 567.481 ms
(48 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469370.82..1615899.53 rows=1 width=27) (actual time=13271.695..13275.001 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469370.82..2495071.77 rows=7 width=27) (actual time=13271.694..13274.999 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469370.82..2490023.07 rows=288493 width=27) (actual time=7191.882..13194.291 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469370.38..1503912.99 rows=288493 width=15) (actual time=7191.235..7260.615 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468370.33..1468550.63 rows=72123 width=15) (actual time=7179.675..7181.968 rows=32283 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3462kB
                           Worker 0:  Sort Method: quicksort  Memory: 3502kB
                           Worker 1:  Sort Method: quicksort  Memory: 3457kB
                           Worker 2:  Sort Method: quicksort  Memory: 3505kB
                           Worker 3:  Sort Method: quicksort  Memory: 3484kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462550.66 rows=72123 width=15) (actual time=4.160..7164.417 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.037..0.037 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.117 ms
 Execution Time: 13275.421 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469370.82..1615899.53 rows=1 width=27) (actual time=3856.776..3858.143 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469370.82..2495071.77 rows=7 width=27) (actual time=3856.775..3858.141 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469370.82..2490023.07 rows=288493 width=27) (actual time=3373.134..3818.955 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469370.38..1503912.99 rows=288493 width=15) (actual time=3373.089..3411.519 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468370.33..1468550.63 rows=72123 width=15) (actual time=3366.708..3368.534 rows=32241 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3471kB
                           Worker 0:  Sort Method: quicksort  Memory: 3494kB
                           Worker 1:  Sort Method: quicksort  Memory: 3427kB
                           Worker 2:  Sort Method: quicksort  Memory: 3532kB
                           Worker 3:  Sort Method: quicksort  Memory: 3487kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462550.66 rows=72123 width=15) (actual time=0.116..3350.871 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.861 ms
 Execution Time: 3858.197 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369906.87..1369906.87 rows=1 width=16) (actual time=16740.045..16740.048 rows=1 loops=1)
   ->  Sort  (cost=1369906.87..1369907.37 rows=200 width=16) (actual time=16740.044..16740.046 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369903.87..1369905.87 rows=200 width=16) (actual time=16740.018..16740.025 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215220.41..1347401.45 rows=1500161 width=12) (actual time=14587.619..16569.845 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53289.86..664477.09 rows=14998967 width=8) (actual time=366.795..10685.169 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448773.84 rows=14998967 width=8) (actual time=0.865..5035.398 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28676.84..28676.84 rows=1500161 width=4) (actual time=363.385..363.386 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28676.84 rows=1500161 width=4) (actual time=0.021..165.124 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 17.612 ms
 Execution Time: 16773.177 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369906.87..1369906.87 rows=1 width=16) (actual time=16167.328..16167.330 rows=1 loops=1)
   ->  Sort  (cost=1369906.87..1369907.37 rows=200 width=16) (actual time=16167.326..16167.328 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369903.87..1369905.87 rows=200 width=16) (actual time=16167.300..16167.308 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215220.41..1347401.45 rows=1500161 width=12) (actual time=14046.909..15999.495 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53289.86..664477.09 rows=14998967 width=8) (actual time=336.275..10154.400 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448773.84 rows=14998967 width=8) (actual time=0.037..4570.145 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28676.84..28676.84 rows=1500161 width=4) (actual time=333.674..333.675 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28676.84 rows=1500161 width=4) (actual time=0.021..133.846 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.714 ms
 Execution Time: 16201.106 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=838391.40..838391.41 rows=1 width=32) (actual time=5242.810..5274.574 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=838391.40..838391.41 rows=1 width=32) (actual time=5242.809..5274.572 rows=1 loops=1)
         ->  Gather  (cost=838390.94..838391.35 rows=4 width=64) (actual time=5237.779..5274.555 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=837390.94..837390.95 rows=1 width=64) (actual time=5226.637..5226.640 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64330.23..834089.91 rows=188630 width=33) (actual time=664.264..5089.829 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12099.42..781363.94 rows=188630 width=16) (actual time=287.664..4543.681 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=86074
                                 Worker 0:  Heap Blocks: exact=81499
                                 Worker 1:  Heap Blocks: exact=84765
                                 Worker 2:  Heap Blocks: exact=82599
                                 Worker 3:  Heap Blocks: exact=81632
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11910.79 rows=754522 width=0) (actual time=187.612..187.613 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.92..45980.92 rows=499992 width=25) (actual time=374.481..374.482 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.92 rows=499992 width=25) (actual time=0.389..228.327 rows=400000 loops=5)
 Planning Time: 17.926 ms
 Execution Time: 5275.275 ms
(22 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=838391.40..838391.41 rows=1 width=32) (actual time=1635.912..1672.660 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=838391.40..838391.41 rows=1 width=32) (actual time=1635.911..1672.658 rows=1 loops=1)
         ->  Gather  (cost=838390.94..838391.35 rows=4 width=64) (actual time=1631.521..1672.637 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=837390.94..837390.95 rows=1 width=64) (actual time=1625.752..1625.754 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64330.23..834089.91 rows=188630 width=33) (actual time=516.956..1529.008 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12099.42..781363.94 rows=188630 width=16) (actual time=267.379..1129.462 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=80292
                                 Worker 0:  Heap Blocks: exact=91176
                                 Worker 1:  Heap Blocks: exact=75561
                                 Worker 2:  Heap Blocks: exact=84655
                                 Worker 3:  Heap Blocks: exact=84885
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11910.79 rows=754522 width=0) (actual time=168.080..168.081 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.92..45980.92 rows=499992 width=25) (actual time=247.572..247.573 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.92 rows=499992 width=25) (actual time=0.084..79.553 rows=400000 loops=5)
 Planning Time: 1.102 ms
 Execution Time: 1672.707 ms
(22 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2737541.48..2737648.69 rows=1 width=104) (actual time=13153.158..13203.411 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1387070.29..1387070.30 rows=1 width=32) (actual time=2820.272..2829.301 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1384611.12..1385840.70 rows=98367 width=36) (actual time=2779.219..2823.526 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 56337kB
                 ->  Gather  (cost=1341083.72..1381660.11 rows=393468 width=36) (actual time=2471.774..2552.724 rows=398587 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1340083.72..1341313.31 rows=98367 width=36) (actual time=2467.184..2513.024 rows=99647 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 39953kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=35989.18..1334472.47 rows=561125 width=16) (actual time=445.014..2033.606 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=106316 lossy=70665
                                   Worker 0:  Heap Blocks: exact=98758 lossy=65747
                                   Worker 1:  Heap Blocks: exact=98590 lossy=65477
                                   Worker 2:  Heap Blocks: exact=97489 lossy=65216
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35428.06 rows=2244499 width=0) (actual time=354.707..354.708 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1350471.18..1403222.59 rows=492 width=104) (actual time=13153.156..13194.379 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1350470.88..1402009.15 rows=492 width=36) (actual time=13152.308..13193.530 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1350470.88..1397582.63 rows=393468 width=36) (actual time=10144.391..10247.229 rows=346205 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1349470.82..1349716.74 rows=98367 width=36) (actual time=10113.608..10121.019 rows=69730 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11574kB
                           Worker 0:  Sort Method: quicksort  Memory: 11575kB
                           Worker 1:  Sort Method: quicksort  Memory: 11571kB
                           Worker 2:  Sort Method: quicksort  Memory: 11570kB
                           Worker 3:  Sort Method: quicksort  Memory: 11575kB
                           ->  Partial HashAggregate  (cost=1340083.72..1341313.31 rows=98367 width=36) (actual time=10026.515..10090.460 rows=98916 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=35989.18..1334472.47 rows=561125 width=16) (actual time=495.469..9549.065 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=80002 lossy=53487
                                       Worker 0:  Heap Blocks: exact=80460 lossy=53499
                                       Worker 1:  Heap Blocks: exact=80610 lossy=53549
                                       Worker 2:  Heap Blocks: exact=80079 lossy=53205
                                       Worker 3:  Heap Blocks: exact=80002 lossy=53365
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35428.06 rows=2244499 width=0) (actual time=409.710..409.711 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.46 rows=1 width=72) (actual time=0.842..0.842 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 14.583 ms
 Execution Time: 13205.933 ms
(60 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2737541.48..2737648.69 rows=1 width=104) (actual time=5758.201..5806.783 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1387070.29..1387070.30 rows=1 width=32) (actual time=2804.095..2813.269 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1384611.12..1385840.70 rows=98367 width=36) (actual time=2762.198..2807.419 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 57361kB
                 ->  Gather  (cost=1341083.72..1381660.11 rows=393468 width=36) (actual time=2451.900..2532.155 rows=398612 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1340083.72..1341313.31 rows=98367 width=36) (actual time=2447.301..2493.013 rows=99653 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 39953kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=35989.18..1334472.47 rows=561125 width=16) (actual time=427.639..2014.673 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=105517 lossy=70273
                                   Worker 0:  Heap Blocks: exact=98129 lossy=65403
                                   Worker 1:  Heap Blocks: exact=98762 lossy=65581
                                   Worker 2:  Heap Blocks: exact=98745 lossy=65848
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35428.06 rows=2244499 width=0) (actual time=337.654..337.654 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1350471.18..1403222.59 rows=492 width=104) (actual time=5758.200..5797.606 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1350470.88..1402009.15 rows=492 width=36) (actual time=5758.149..5797.554 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1350470.88..1397582.63 rows=393468 width=36) (actual time=2768.185..2868.118 rows=346170 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1349470.82..1349716.74 rows=98367 width=36) (actual time=2741.312..2748.358 rows=69700 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11538kB
                           Worker 0:  Sort Method: quicksort  Memory: 11597kB
                           Worker 1:  Sort Method: quicksort  Memory: 11566kB
                           Worker 2:  Sort Method: quicksort  Memory: 11594kB
                           Worker 3:  Sort Method: quicksort  Memory: 11569kB
                           ->  Partial HashAggregate  (cost=1340083.72..1341313.31 rows=98367 width=36) (actual time=2654.028..2713.482 rows=98914 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 39953kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=35989.18..1334472.47 rows=561125 width=16) (actual time=440.431..2235.354 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=74937 lossy=49813
                                       Worker 0:  Heap Blocks: exact=84717 lossy=55984
                                       Worker 1:  Heap Blocks: exact=78547 lossy=52488
                                       Worker 2:  Heap Blocks: exact=84105 lossy=56248
                                       Worker 3:  Heap Blocks: exact=78847 lossy=52572
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35428.06 rows=2244499 width=0) (actual time=351.528..351.528 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.46 rows=1 width=72) (actual time=0.046..0.046 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.066 ms
 Execution Time: 5809.046 ms
(60 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=252192.21..252192.21 rows=1 width=44) (actual time=2818.721..2826.467 rows=1 loops=1)
   ->  Sort  (cost=252192.21..252577.66 rows=154178 width=44) (actual time=2818.720..2826.465 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172277.34..251421.32 rows=154178 width=44) (actual time=2178.293..2821.169 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172277.34..243897.93 rows=598161 width=40) (actual time=2178.241..2675.371 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171277.28..171651.13 rows=149540 width=40) (actual time=2057.669..2073.152 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 21073kB
                           Worker 0:  Sort Method: quicksort  Memory: 19859kB
                           Worker 1:  Sort Method: quicksort  Memory: 19258kB
                           Worker 2:  Sort Method: quicksort  Memory: 19788kB
                           Worker 3:  Sort Method: quicksort  Memory: 20736kB
                           ->  Parallel Hash Join  (cost=57886.76..158424.19 rows=149540 width=40) (actual time=349.528..1105.267 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101383.60 rows=1000102 width=8) (actual time=36.968..605.701 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.163..35.987 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.79..53480.79 rows=74761 width=40) (actual time=311.934..311.935 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.79 rows=74761 width=40) (actual time=1.371..283.802 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 18.657 ms
 Execution Time: 2826.875 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=252192.21..252192.21 rows=1 width=44) (actual time=2545.816..2551.167 rows=1 loops=1)
   ->  Sort  (cost=252192.21..252577.66 rows=154178 width=44) (actual time=2545.814..2551.165 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172277.34..251421.32 rows=154178 width=44) (actual time=1899.686..2545.983 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172277.34..243897.93 rows=598161 width=40) (actual time=1899.638..2401.517 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171277.28..171651.13 rows=149540 width=40) (actual time=1749.512..1764.964 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 20858kB
                           Worker 0:  Sort Method: quicksort  Memory: 19089kB
                           Worker 1:  Sort Method: quicksort  Memory: 20797kB
                           Worker 2:  Sort Method: quicksort  Memory: 21374kB
                           Worker 3:  Sort Method: quicksort  Memory: 18596kB
                           ->  Parallel Hash Join  (cost=57886.76..158424.19 rows=149540 width=40) (actual time=180.512..797.797 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101383.60 rows=1000102 width=8) (actual time=24.559..438.390 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.085..24.407 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.79..53480.79 rows=74761 width=40) (actual time=155.318..155.319 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.79 rows=74761 width=40) (actual time=0.023..120.163 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 0.980 ms
 Execution Time: 2551.243 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3431791.97..3431791.98 rows=1 width=32) (actual time=23951.093..24027.703 rows=1 loops=1)
   ->  Aggregate  (cost=3431791.97..3431791.98 rows=1 width=32) (actual time=23951.091..24027.701 rows=1 loops=1)
         ->  Merge Join  (cost=2286291.64..3431744.05 rows=19168 width=8) (actual time=17948.324..24026.845 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2285290.72..3328400.00 rows=1990900 width=36) (actual time=17919.762..23816.924 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2285290.72..3238809.50 rows=7963600 width=36) (actual time=17919.747..19892.348 rows=9972277 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2284290.66..2289267.91 rows=1990900 width=36) (actual time=17625.942..17905.601 rows=1994892 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150368kB
                                 Worker 0:  Sort Method: external merge  Disk: 150352kB
                                 Worker 1:  Sort Method: external merge  Disk: 150352kB
                                 Worker 2:  Sort Method: external merge  Disk: 150344kB
                                 Worker 3:  Sort Method: external merge  Disk: 150344kB
                                 ->  Partial HashAggregate  (cost=1869665.81..2040996.35 rows=1990900 width=36) (actual time=9824.049..16774.461 rows=1995120 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407608kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407592kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 404488kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 393232kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 394272kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275101.96 rows=14995896 width=9) (actual time=0.915..3865.103 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..97503.60 rows=57765 width=21) (actual time=26.385..66.103 rows=59951 loops=1)
                     Storage: Memory  Maximum Storage: 19kB
                     ->  Gather Merge  (cost=1000.93..97359.19 rows=57765 width=21) (actual time=26.379..59.270 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..89478.76 rows=14441 width=21) (actual time=1.927..638.411 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.14 rows=482 width=4) (actual time=0.961..197.632 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..46.93 rows=30 width=17) (actual time=0.633..0.874 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 14.146 ms
 Execution Time: 24096.260 ms
(39 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3431791.97..3431791.98 rows=1 width=32) (actual time=22435.608..22518.110 rows=1 loops=1)
   ->  Aggregate  (cost=3431791.97..3431791.98 rows=1 width=32) (actual time=22435.607..22518.107 rows=1 loops=1)
         ->  Merge Join  (cost=2286291.64..3431744.05 rows=19168 width=8) (actual time=16481.701..22517.390 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2285290.72..3328400.00 rows=1990900 width=36) (actual time=16472.234..22347.857 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2285290.72..3238809.50 rows=7963600 width=36) (actual time=16472.218..18437.127 rows=9971929 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2284290.66..2289267.91 rows=1990900 width=36) (actual time=16178.296..16455.907 rows=1994882 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150416kB
                                 Worker 0:  Sort Method: external merge  Disk: 150216kB
                                 Worker 1:  Sort Method: external merge  Disk: 150336kB
                                 Worker 2:  Sort Method: external merge  Disk: 150400kB
                                 Worker 3:  Sort Method: external merge  Disk: 150368kB
                                 ->  Partial HashAggregate  (cost=1869665.81..2040996.35 rows=1990900 width=36) (actual time=8372.232..15318.447 rows=1995051 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 408240kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 375544kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 395280kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407904kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407680kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275101.96 rows=14995896 width=9) (actual time=0.063..1388.467 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..97503.60 rows=57765 width=21) (actual time=7.554..28.883 rows=59951 loops=1)
                     Storage: Memory  Maximum Storage: 19kB
                     ->  Gather Merge  (cost=1000.93..97359.19 rows=57765 width=21) (actual time=7.548..22.237 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..89478.76 rows=14441 width=21) (actual time=0.249..126.571 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.14 rows=482 width=4) (actual time=0.228..106.081 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..46.93 rows=30 width=17) (actual time=0.005..0.036 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 1.014 ms
 Execution Time: 22583.945 ms
(39 rows)

query 18 run 1
SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8578890.08..8578890.33 rows=100 width=71) (actual time=70551.665..70563.769 rows=99 loops=1)
   ->  Sort  (cost=8578890.08..8628861.17 rows=19988435 width=71) (actual time=70551.664..70563.762 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=829674.71..7814946.47 rows=19988435 width=71) (actual time=39378.747..70563.653 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=829674.71..7415177.77 rows=19988435 width=44) (actual time=39378.736..70563.362 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=829674.31..6690277.08 rows=19988435 width=44) (actual time=38804.558..70562.886 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829404.50..4160823.13 rows=4998632 width=43) (actual time=38492.685..59486.316 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828404.44..3564437.81 rows=1249658 width=43) (actual time=5391.155..36315.588 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828403.88..837779.17 rows=3750117 width=39) (actual time=3730.395..4067.929 rows=2996546 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 150280kB
                                             Worker 0:  Sort Method: external merge  Disk: 149664kB
                                             Worker 1:  Sort Method: external merge  Disk: 155544kB
                                             Worker 2:  Sort Method: external merge  Disk: 137592kB
                                             Worker 3:  Sort Method: external merge  Disk: 154832kB
                                             ->  Parallel Hash Join  (cost=44385.40..352998.65 rows=3750117 width=39) (actual time=322.093..2990.428 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298769.17 rows=3750117 width=20) (actual time=0.593..1152.270 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.40..39697.40 rows=375040 width=23) (actual time=319.280..319.281 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98688kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=23) (actual time=0.490..212.245 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692290.19 rows=4998632 width=4) (actual time=770.096..32040.768 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167433.82 rows=59983584 width=9) (actual time=0.461..18389.640 rows=59986052 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167433.82 rows=59983584 width=9) (actual time=0.052..7744.047 rows=59916431 loops=1)
 Planning Time: 17.979 ms
 Execution Time: 70581.075 ms
(38 rows)

SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8578890.08..8578890.33 rows=100 width=71) (actual time=65742.709..65754.779 rows=99 loops=1)
   ->  Sort  (cost=8578890.08..8628861.17 rows=19988435 width=71) (actual time=65742.708..65754.771 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=829674.71..7814946.47 rows=19988435 width=71) (actual time=34319.333..65754.665 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=829674.71..7415177.77 rows=19988435 width=44) (actual time=34319.321..65754.372 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=829674.31..6690277.08 rows=19988435 width=44) (actual time=33721.422..65753.905 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829404.50..4160823.13 rows=4998632 width=43) (actual time=33413.619..54483.042 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828404.44..3564437.81 rows=1249658 width=43) (actual time=4609.655..32027.873 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828403.88..837779.17 rows=3750117 width=39) (actual time=3066.012..3406.191 rows=2996545 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 160440kB
                                             Worker 0:  Sort Method: external merge  Disk: 147192kB
                                             Worker 1:  Sort Method: external merge  Disk: 150856kB
                                             Worker 2:  Sort Method: external merge  Disk: 158120kB
                                             Worker 3:  Sort Method: external merge  Disk: 131296kB
                                             ->  Parallel Hash Join  (cost=44385.40..352998.65 rows=3750117 width=39) (actual time=213.617..2248.427 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298769.17 rows=3750117 width=20) (actual time=0.056..385.341 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.40..39697.40 rows=375040 width=23) (actual time=210.931..210.932 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98624kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.40 rows=375040 width=23) (actual time=0.040..72.468 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692290.19 rows=4998632 width=4) (actual time=614.228..28407.561 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14996446
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167433.82 rows=59983584 width=9) (actual time=0.057..14646.285 rows=59972128 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167433.82 rows=59983584 width=9) (actual time=0.049..7940.485 rows=59916431 loops=1)
 Planning Time: 1.923 ms
 Execution Time: 65772.959 ms
(38 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=120869.43..120869.44 rows=1 width=32) (actual time=5074.662..5074.779 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=120869.43..120869.44 rows=1 width=32) (actual time=5074.660..5074.777 rows=1 loops=1)
         ->  Gather  (cost=120869.00..120869.41 rows=4 width=32) (actual time=5074.636..5074.760 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=119869.00..119869.01 rows=1 width=32) (actual time=5048.729..5048.730 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..119867.03 rows=263 width=12) (actual time=44.446..5048.129 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.65 rows=1180 width=30) (actual time=0.739..166.003 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.83 rows=1 width=21) (actual time=4.601..5.104 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 16.929 ms
 Execution Time: 5075.108 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=120869.43..120869.44 rows=1 width=32) (actual time=215.665..235.820 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=120869.43..120869.44 rows=1 width=32) (actual time=215.663..235.818 rows=1 loops=1)
         ->  Gather  (cost=120869.00..120869.41 rows=4 width=32) (actual time=212.128..235.802 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=119869.00..119869.01 rows=1 width=32) (actual time=205.761..205.762 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..119867.03 rows=263 width=12) (actual time=1.270..205.588 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.65 rows=1180 width=30) (actual time=0.146..131.371 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.83 rows=1 width=21) (actual time=0.071..0.077 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.125 ms
 Execution Time: 235.871 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2463790.79..2663820.80 rows=1 width=52) (actual time=28747.319..28748.569 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2463790.79..2663820.80 rows=1 width=52) (actual time=28747.318..28748.567 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=56) (actual time=27.045..28.220 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=56) (actual time=17.739..17.755 rows=390 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 314kB
                     Worker 0:  Sort Method: quicksort  Memory: 133kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=56) (actual time=0.343..16.500 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=60) (actual time=0.248..12.033 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.078..0.079 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.074..0.076 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2459667.86..2659062.00 rows=3 width=8) (actual time=27226.316..28719.276 rows=13474 loops=1)
               Storage: Memory  Maximum Storage: 550kB
               ->  Hash Join  (cost=2459667.86..2659061.98 rows=3 width=8) (actual time=27226.312..28716.185 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2383202.18..2546106.16 rows=4865334 width=40) (actual time=25796.530..27100.347 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=147643.77..1995090.30 rows=9208215 width=13) (actual time=1218.667..20676.005 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145341.72 rows=9208215 width=0) (actual time=1094.972..1094.972 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75253.41..75253.41 rows=80818 width=16) (actual time=1429.464..1429.537 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75253.41 rows=80818 width=16) (actual time=2.200..1410.176 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.61 rows=20204 width=16) (actual time=1.483..1414.564 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.90 rows=5050 width=4) (actual time=1.007..113.171 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.278..0.298 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 22.534 ms
 Execution Time: 28792.389 ms
(47 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2463790.79..2663820.80 rows=1 width=52) (actual time=15047.958..15049.495 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2463790.79..2663820.80 rows=1 width=52) (actual time=15047.956..15049.493 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=56) (actual time=16.415..17.884 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=56) (actual time=14.089..14.105 rows=390 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 277kB
                     Worker 0:  Sort Method: quicksort  Memory: 170kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=56) (actual time=0.063..12.798 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=60) (actual time=0.039..8.267 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.017..0.018 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.015 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2459667.86..2659062.00 rows=3 width=8) (actual time=13536.159..15030.535 rows=13474 loops=1)
               Storage: Memory  Maximum Storage: 550kB
               ->  Hash Join  (cost=2459667.86..2659061.98 rows=3 width=8) (actual time=13536.154..15027.447 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2383202.18..2546106.16 rows=4865334 width=40) (actual time=13364.297..14669.660 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=147643.77..1995090.30 rows=9208215 width=13) (actual time=1065.607..9314.782 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..145341.72 rows=9208215 width=0) (actual time=943.012..943.012 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75253.41..75253.41 rows=80818 width=16) (actual time=171.527..171.593 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75253.41 rows=80818 width=16) (actual time=0.349..155.092 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.61 rows=20204 width=16) (actual time=0.664..154.856 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.90 rows=5050 width=4) (actual time=0.612..82.109 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.014..0.016 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.391 ms
 Execution Time: 15097.739 ms
(47 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1963205.58..1963205.59 rows=1 width=34) (actual time=11476.136..11486.877 rows=100 loops=1)
   ->  Sort  (cost=1963205.58..1963205.59 rows=1 width=34) (actual time=11476.135..11486.870 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1963202.36..1963205.57 rows=1 width=34) (actual time=10915.101..11484.418 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1963202.36..1963205.56 rows=1 width=26) (actual time=10914.948..11473.427 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1963201.79..1963201.92 rows=1 width=38) (actual time=10914.889..10962.841 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1962201.73..1962201.74 rows=1 width=38) (actual time=10885.115..10886.585 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1115kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1113kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1107kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1100kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1095kB
                                 ->  Nested Loop Anti Join  (cost=1338033.19..1962201.72 rows=1 width=38) (actual time=7246.095..10807.002 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338032.63..1653186.64 rows=96240 width=38) (actual time=7244.052..9323.921 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308144.46 rows=1805056 width=4) (actual time=0.551..1557.510 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335533.31..1335533.31 rows=199945 width=34) (actual time=7242.240..7242.244 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131360kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335533.31 rows=199945 width=34) (actual time=16.854..7085.068 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312591.70 rows=4998632 width=8) (actual time=0.511..6312.560 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=16.106..16.108 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.249..15.651 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.198..13.655 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.045..0.046 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.010..0.010 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 19.388 ms
 Execution Time: 11487.270 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1963205.58..1963205.59 rows=1 width=34) (actual time=6621.072..6636.416 rows=100 loops=1)
   ->  Sort  (cost=1963205.58..1963205.59 rows=1 width=34) (actual time=6621.071..6636.409 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1963202.36..1963205.57 rows=1 width=34) (actual time=6105.222..6633.955 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1963202.36..1963205.56 rows=1 width=26) (actual time=6105.061..6623.413 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1963201.79..1963201.92 rows=1 width=38) (actual time=6105.003..6156.367 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1962201.73..1962201.74 rows=1 width=38) (actual time=6078.606..6080.404 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1099kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1147kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1107kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1102kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1074kB
                                 ->  Nested Loop Anti Join  (cost=1338033.19..1962201.72 rows=1 width=38) (actual time=3626.955..6000.790 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338032.63..1653186.64 rows=96240 width=38) (actual time=3626.584..4773.981 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308144.46 rows=1805056 width=4) (actual time=0.039..554.899 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335533.31..1335533.31 rows=199945 width=34) (actual time=3624.472..3624.826 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335533.31 rows=199945 width=34) (actual time=10.978..3439.977 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312591.70 rows=4998632 width=8) (actual time=0.044..2602.441 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=9.723..9.725 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.061..9.347 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.033..6.476 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.018..0.019 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.072 ms
 Execution Time: 6636.510 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93879.03..93880.64 rows=1 width=72) (actual time=1777.877..1781.308 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46822.07..46822.08 rows=1 width=32) (actual time=322.471..322.570 rows=1 loops=1)
           ->  Gather  (cost=46821.64..46822.05 rows=4 width=32) (actual time=321.885..322.557 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45821.64..45821.65 rows=1 width=32) (actual time=310.212..310.213 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.81 rows=11932 width=6) (actual time=0.132..302.969 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.95..59693.36 rows=7855 width=72) (actual time=1777.876..1781.207 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.95..59496.99 rows=7855 width=38) (actual time=484.114..1774.456 rows=9006 loops=1)
               ->  Gather Merge  (cost=47056.51..49152.11 rows=17502 width=26) (actual time=482.763..504.099 rows=27131 loops=1)
                     Workers Planned: 4
                     Workers Launched: 3
                     ->  Sort  (cost=46056.45..46067.39 rows=4376 width=26) (actual time=155.378..156.258 rows=7612 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3870kB
                           Worker 0:  Sort Method: quicksort  Memory: 3753kB
                           Worker 1:  Sort Method: quicksort  Memory: 3728kB
                           Worker 2:  Sort Method: quicksort  Memory: 3753kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.81 rows=4376 width=26) (actual time=0.020..140.901 rows=47782 loops=4)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.046..0.046 rows=1 loops=27131)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 13.721 ms
 Execution Time: 1782.100 ms
(30 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93879.03..93880.64 rows=1 width=72) (actual time=418.150..421.393 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46822.07..46822.08 rows=1 width=32) (actual time=190.421..190.520 rows=1 loops=1)
           ->  Gather  (cost=46821.64..46822.05 rows=4 width=32) (actual time=190.137..190.507 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45821.64..45821.65 rows=1 width=32) (actual time=186.169..186.170 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.81 rows=11932 width=6) (actual time=0.021..177.592 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.95..59693.36 rows=7855 width=72) (actual time=418.149..421.292 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.95..59496.99 rows=7855 width=38) (actual time=350.886..419.260 rows=9006 loops=1)
               ->  Gather Merge  (cost=47056.51..49152.11 rows=17502 width=26) (actual time=350.847..361.187 rows=27128 loops=1)
                     Workers Planned: 4
                     Workers Launched: 3
                     ->  Sort  (cost=46056.45..46067.39 rows=4376 width=26) (actual time=154.495..155.157 rows=7555 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3864kB
                           Worker 0:  Sort Method: quicksort  Memory: 3728kB
                           Worker 1:  Sort Method: quicksort  Memory: 3752kB
                           Worker 2:  Sort Method: quicksort  Memory: 3760kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.81 rows=4376 width=26) (actual time=0.025..140.003 rows=47782 loops=4)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 0.823 ms
 Execution Time: 421.455 ms
(30 rows)

