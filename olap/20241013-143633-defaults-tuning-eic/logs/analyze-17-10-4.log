query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832303.81..1832304.44 rows=1 width=236) (actual time=19397.819..19400.540 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832303.81..1832307.62 rows=6 width=236) (actual time=19397.818..19400.537 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832303.81..1832306.68 rows=24 width=236) (actual time=19397.788..19400.510 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831303.75..1831303.76 rows=6 width=236) (actual time=19387.934..19387.935 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831303.53..1831303.67 rows=6 width=236) (actual time=19387.897..19387.902 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312605.07 rows=14819956 width=25) (actual time=0.457..4403.073 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 13.845 ms
 Execution Time: 19400.888 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832303.81..1832304.44 rows=1 width=236) (actual time=18701.072..18701.729 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832303.81..1832307.62 rows=6 width=236) (actual time=18701.071..18701.727 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832303.81..1832306.68 rows=24 width=236) (actual time=18701.047..18701.706 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831303.75..1831303.76 rows=6 width=236) (actual time=18696.215..18696.216 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831303.53..1831303.67 rows=6 width=236) (actual time=18696.182..18696.187 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312605.07 rows=14819956 width=25) (actual time=0.033..2593.708 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.599 ms
 Execution Time: 18701.793 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1176014.79..1176014.79 rows=1 width=192) (actual time=4028.203..4028.328 rows=100 loops=1)
   ->  Sort  (cost=1176014.79..1176014.79 rows=1 width=192) (actual time=4028.202..4028.321 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559038.75..1176014.78 rows=1 width=192) (actual time=3016.503..4025.436 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68918.54 rows=10130 width=30) (actual time=77.819..81.034 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.90 rows=2532 width=30) (actual time=1.730..300.637 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558038.26..566038.23 rows=1599994 width=172) (actual time=2937.556..3390.366 rows=1603828 loops=1)
                     ->  Sort  (cost=558038.26..562038.25 rows=1599994 width=172) (actual time=2937.551..3218.564 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305270.05 rows=1599994 width=172) (actual time=53.705..2316.129 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255221.71 rows=7999971 width=14) (actual time=7.894..941.278 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=45.773..45.775 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.744..39.815 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.389..27.778 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.349..0.351 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.344..0.349 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.161..0.163 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.175..0.176 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.171..0.172 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.058..0.058 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.047..0.056 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.042..0.054 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.041..0.052 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.037..0.038 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.007 rows=25 loops=1)
 Planning Time: 22.973 ms
 Execution Time: 4063.208 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1176014.79..1176014.79 rows=1 width=192) (actual time=3240.337..3240.481 rows=100 loops=1)
   ->  Sort  (cost=1176014.79..1176014.79 rows=1 width=192) (actual time=3240.336..3240.474 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=559038.75..1176014.78 rows=1 width=192) (actual time=2503.583..3238.219 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68918.54 rows=10130 width=30) (actual time=29.808..32.085 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.90 rows=2532 width=30) (actual time=0.208..127.834 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558038.26..566038.23 rows=1599994 width=172) (actual time=2473.662..2913.639 rows=1603828 loops=1)
                     ->  Sort  (cost=558038.26..562038.25 rows=1599994 width=172) (actual time=2473.658..2743.874 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305270.05 rows=1599994 width=172) (actual time=31.806..1871.186 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255221.71 rows=7999971 width=14) (actual time=0.048..632.341 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=31.732..31.735 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.042..22.504 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.013..7.303 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.025..0.026 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.019..0.024 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.007..0.008 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.018..0.018 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.010..0.016 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.006..0.014 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.004 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.013 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.004..0.007 rows=25 loops=1)
 Planning Time: 1.764 ms
 Execution Time: 3276.373 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2301815.90..2301815.93 rows=10 width=44) (actual time=10289.365..10330.804 rows=10 loops=1)
   ->  Sort  (cost=2301815.90..2309731.62 rows=3166289 width=44) (actual time=10289.364..10330.802 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1767206.11..2233393.53 rows=3166289 width=44) (actual time=10078.556..10308.719 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1767206.11..2146320.59 rows=3166289 width=24) (actual time=10078.544..10161.439 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1766206.05..1768184.98 rows=791572 width=24) (actual time=10065.573..10068.377 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4251kB
                           Worker 0:  Sort Method: quicksort  Memory: 4236kB
                           Worker 1:  Sort Method: quicksort  Memory: 4295kB
                           Worker 2:  Sort Method: quicksort  Memory: 4225kB
                           Worker 3:  Sort Method: quicksort  Memory: 4226kB
                           ->  Nested Loop  (cost=41571.46..1678216.57 rows=791572 width=24) (actual time=267.417..10047.221 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41570.90..354494.71 rows=364400 width=12) (actual time=265.605..1871.367 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308137.06 rows=1823522 width=16) (actual time=0.511..1159.866 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.23..40634.23 rows=74933 width=4) (actual time=264.351..264.352 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.23 rows=74933 width=4) (actual time=0.381..248.612 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.028..0.028 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 21.916 ms
 Execution Time: 10331.936 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2301815.90..2301815.93 rows=10 width=44) (actual time=3815.400..3842.569 rows=10 loops=1)
   ->  Sort  (cost=2301815.90..2309731.62 rows=3166289 width=44) (actual time=3815.398..3842.566 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1767206.11..2233393.53 rows=3166289 width=44) (actual time=3597.240..3820.011 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1767206.11..2146320.59 rows=3166289 width=24) (actual time=3597.227..3671.594 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1766206.05..1768184.98 rows=791572 width=24) (actual time=3589.722..3592.505 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4162kB
                           Worker 0:  Sort Method: quicksort  Memory: 4397kB
                           Worker 1:  Sort Method: quicksort  Memory: 4211kB
                           Worker 2:  Sort Method: quicksort  Memory: 4306kB
                           Worker 3:  Sort Method: quicksort  Memory: 4155kB
                           ->  Nested Loop  (cost=41571.46..1678216.57 rows=791572 width=24) (actual time=108.561..3571.131 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41570.90..354494.71 rows=364400 width=12) (actual time=108.386..1167.579 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308137.06 rows=1823522 width=16) (actual time=0.043..531.350 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.23..40634.23 rows=74933 width=4) (actual time=105.359..105.360 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15968kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.23 rows=74933 width=4) (actual time=0.035..81.474 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.008..0.008 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.703 ms
 Execution Time: 3842.650 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283077.24..658658.73 rows=1 width=24) (actual time=28679.665..28698.655 rows=1 loops=1)
   ->  GroupAggregate  (cost=283077.24..2160984.70 rows=5 width=24) (actual time=28679.664..28698.653 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283077.24..2158148.21 rows=567289 width=16) (actual time=4282.825..28617.293 rows=103030 loops=1)
               ->  Gather Merge  (cost=283076.67..351005.97 rows=567332 width=20) (actual time=4282.062..4411.851 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282076.61..282431.20 rows=141833 width=20) (actual time=4267.703..4270.661 rows=23322 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7466kB
                           Worker 0:  Sort Method: quicksort  Memory: 7434kB
                           Worker 1:  Sort Method: quicksort  Memory: 7439kB
                           Worker 2:  Sort Method: quicksort  Memory: 7460kB
                           Worker 3:  Sort Method: quicksort  Memory: 7455kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6544.59..269940.08 rows=141833 width=20) (actual time=130.035..4220.532 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46509
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6402.76 rows=567332 width=0) (actual time=86.684..86.684 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.214..0.214 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 16.511 ms
 Execution Time: 28699.057 ms
(25 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=283077.24..658658.73 rows=1 width=24) (actual time=1716.794..1735.226 rows=1 loops=1)
   ->  GroupAggregate  (cost=283077.24..2160984.70 rows=5 width=24) (actual time=1716.794..1735.224 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=283077.24..2158148.21 rows=567289 width=16) (actual time=706.758..1713.374 rows=103030 loops=1)
               ->  Gather Merge  (cost=283076.67..351005.97 rows=567332 width=20) (actual time=706.698..761.203 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=282076.61..282431.20 rows=141833 width=20) (actual time=697.490..699.623 rows=23403 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7445kB
                           Worker 0:  Sort Method: quicksort  Memory: 7400kB
                           Worker 1:  Sort Method: quicksort  Memory: 7280kB
                           Worker 2:  Sort Method: quicksort  Memory: 7617kB
                           Worker 3:  Sort Method: quicksort  Memory: 7511kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6544.59..269940.08 rows=141833 width=20) (actual time=127.556..658.241 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46261
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6402.76 rows=567332 width=0) (actual time=82.299..82.299 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.212 ms
 Execution Time: 1735.299 ms
(25 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=769281.88..769281.88 rows=1 width=58) (actual time=22009.570..22055.427 rows=1 loops=1)
   ->  Sort  (cost=769281.88..769281.94 rows=25 width=58) (actual time=22009.569..22055.425 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=769038.47..769281.75 rows=25 width=58) (actual time=22001.592..22055.407 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=769038.47..769280.69 rows=100 width=58) (actual time=22000.271..22055.379 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=768038.41..768268.72 rows=25 width=58) (actual time=21975.548..21981.426 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=768038.41..768084.41 rows=18400 width=38) (actual time=21974.294..21974.935 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1174kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1162kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1168kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1177kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1180kB
                                 ->  Parallel Hash Join  (cost=73014.18..766735.01 rows=18400 width=38) (actual time=556.942..21961.175 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69322.59..760628.27 rows=460028 width=50) (actual time=540.652..21794.864 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69322.02..341660.28 rows=115016 width=38) (actual time=538.771..2581.820 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26529.14..296423.32 rows=575078 width=8) (actual time=261.154..2074.542 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52472
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25954.07 rows=2300313 width=0) (actual time=203.062..203.062 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.43..41855.43 rows=74996 width=38) (actual time=276.997..277.001 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.43 rows=74996 width=38) (actual time=0.864..249.637 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=8) (actual time=0.414..215.076 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.439..0.441 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.431..0.437 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.159..0.161 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.265..0.266 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.212..0.213 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.199..0.210 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=13.149..13.149 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.212..6.997 rows=20000 loops=5)
 Planning Time: 28.350 ms
 Execution Time: 22055.853 ms
(50 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=769281.88..769281.88 rows=1 width=58) (actual time=2508.276..2555.600 rows=1 loops=1)
   ->  Sort  (cost=769281.88..769281.94 rows=25 width=58) (actual time=2508.275..2555.597 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=769038.47..769281.75 rows=25 width=58) (actual time=2504.454..2555.581 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=769038.47..769280.69 rows=100 width=58) (actual time=2503.182..2555.552 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=768038.41..768268.72 rows=25 width=58) (actual time=2486.580..2491.934 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=768038.41..768084.41 rows=18400 width=38) (actual time=2484.519..2485.472 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1143kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1138kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1217kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1168kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1195kB
                                 ->  Parallel Hash Join  (cost=73014.18..766735.01 rows=18400 width=38) (actual time=392.397..2476.144 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69322.59..760628.27 rows=460028 width=50) (actual time=377.881..2351.530 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69322.02..341660.28 rows=115016 width=38) (actual time=377.840..950.506 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26529.14..296423.32 rows=575078 width=8) (actual time=246.881..646.542 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=50265
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25954.07 rows=2300313 width=0) (actual time=190.750..190.750 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.43..41855.43 rows=74996 width=38) (actual time=130.414..130.417 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.43 rows=74996 width=38) (actual time=0.141..97.475 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=8) (actual time=0.035..53.732 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.096..0.098 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.090..0.096 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.017..0.018 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.067..0.068 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.014..0.014 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=13.062..13.062 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.030..6.698 rows=20000 loops=5)
 Planning Time: 4.851 ms
 Execution Time: 2555.692 ms
(50 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1278167.45..1278167.46 rows=1 width=32) (actual time=10602.860..10636.047 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1278167.45..1278167.46 rows=1 width=32) (actual time=10602.859..10636.045 rows=1 loops=1)
         ->  Gather  (cost=1278167.02..1278167.43 rows=4 width=32) (actual time=10601.375..10636.032 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1277167.02..1277167.03 rows=1 width=32) (actual time=10592.380..10592.380 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=210609.32..1275693.21 rows=294762 width=12) (actual time=1350.816..10450.637 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=80346 lossy=53738
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..210314.56 rows=1179047 width=0) (actual time=1264.390..1264.391 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 12.401 ms
 Execution Time: 10637.277 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1278167.45..1278167.46 rows=1 width=32) (actual time=3118.383..3157.940 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1278167.45..1278167.46 rows=1 width=32) (actual time=3118.382..3157.938 rows=1 loops=1)
         ->  Gather  (cost=1278167.02..1278167.43 rows=4 width=32) (actual time=3116.640..3157.925 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1277167.02..1277167.03 rows=1 width=32) (actual time=3112.396..3112.397 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=210609.32..1275693.21 rows=294762 width=12) (actual time=1212.127..3004.569 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=77630 lossy=52199
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..210314.56 rows=1179047 width=0) (actual time=1121.819..1121.819 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.636 ms
 Execution Time: 3157.988 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420055.28..1421113.62 rows=1 width=116) (actual time=26513.184..26518.494 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420055.28..12062709.08 rows=10056 width=116) (actual time=26513.183..26518.492 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420055.28..12061641.06 rows=61145 width=96) (actual time=7342.893..26492.627 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349039
               ->  Nested Loop  (cost=1420054.85..6829367.41 rows=1528620 width=76) (actual time=7321.015..20810.664 rows=363460 loops=1)
                     ->  Gather Merge  (cost=1420054.41..1603083.18 rows=1528620 width=76) (actual time=7319.954..7722.427 rows=363460 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419054.36..1420009.74 rows=382155 width=76) (actual time=7299.419..7340.252 rows=73084 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26456kB
                                 Worker 0:  Sort Method: external merge  Disk: 27000kB
                                 Worker 1:  Sort Method: external merge  Disk: 26384kB
                                 Worker 2:  Sort Method: external merge  Disk: 26720kB
                                 Worker 3:  Sort Method: external merge  Disk: 27392kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372704.33 rows=382155 width=76) (actual time=12.431..7032.282 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350097.49 rows=4591444 width=24) (actual time=0.464..6463.807 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=11.639..11.642 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 928kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.355..10.876 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.276..8.697 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.072..0.074 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.063..0.069 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.052..0.053 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.006..0.008 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.035..0.035 rows=1 loops=363460)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.015..0.015 rows=1 loops=363460)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 25.403 ms
 Execution Time: 26522.595 ms
(45 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420055.28..1421113.62 rows=1 width=116) (actual time=5526.183..5532.327 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420055.28..12062709.08 rows=10056 width=116) (actual time=5526.182..5532.325 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420055.28..12061641.06 rows=61145 width=96) (actual time=3244.774..5519.418 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349029
               ->  Nested Loop  (cost=1420054.85..6829367.41 rows=1528620 width=76) (actual time=3244.047..4458.456 rows=363450 loops=1)
                     ->  Gather Merge  (cost=1420054.41..1603083.18 rows=1528620 width=76) (actual time=3243.962..3463.415 rows=363450 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419054.36..1420009.74 rows=382155 width=76) (actual time=3225.966..3254.836 rows=73081 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 24672kB
                                 Worker 0:  Sort Method: external merge  Disk: 27792kB
                                 Worker 1:  Sort Method: external merge  Disk: 25024kB
                                 Worker 2:  Sort Method: external merge  Disk: 27672kB
                                 Worker 3:  Sort Method: external merge  Disk: 28800kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372704.33 rows=382155 width=76) (actual time=12.028..2902.433 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350097.49 rows=4591444 width=24) (actual time=0.038..2283.520 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=10.915..10.917 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 992kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.083..8.257 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.042..5.361 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.033..0.035 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.024..0.030 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.012..0.014 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363450)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=363450)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.548 ms
 Execution Time: 5535.707 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386302.25..392148.02 rows=1 width=64) (actual time=33954.048..33959.673 rows=1 loops=1)
   ->  GroupAggregate  (cost=386302.25..14451228.57 rows=2406 width=64) (actual time=33954.047..33959.670 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386302.25..14450698.63 rows=24091 width=70) (actual time=2422.843..33934.970 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142651
               ->  Nested Loop  (cost=386302.25..14441936.66 rows=24091 width=20) (actual time=2422.817..33895.129 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386301.95..14363125.93 rows=24091 width=20) (actual time=2422.385..33301.010 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386301.52..3800652.87 rows=3628876 width=24) (actual time=2346.094..23120.116 rows=1816373 loops=1)
                                 ->  Gather Merge  (cost=386300.95..494934.63 rows=907287 width=8) (actual time=2344.814..2597.810 rows=454472 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385300.89..385867.95 rows=226822 width=8) (actual time=2327.970..2335.418 rows=91986 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 11820kB
                                             Worker 0:  Sort Method: quicksort  Memory: 11818kB
                                             Worker 1:  Sort Method: quicksort  Memory: 11840kB
                                             Worker 2:  Sort Method: quicksort  Memory: 11871kB
                                             Worker 3:  Sort Method: quicksort  Memory: 11821kB
                                             ->  Parallel Hash Join  (cost=42792.88..365123.71 rows=226822 width=8) (actual time=250.583..2286.980 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317510.87 rows=1134109 width=12) (actual time=0.365..1781.840 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.43..41855.43 rows=74996 width=4) (actual time=249.479..249.482 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.43 rows=74996 width=4) (actual time=0.534..231.864 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=8) (actual time=0.425..198.680 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.101..0.104 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.095..0.102 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.045..0.047 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.041..0.044 rows=4 loops=454472)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.005..0.005 rows=0 loops=1816373)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597435  Misses: 1218938  Evictions: 235446  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.007..0.007 rows=0 loops=1218938)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.049..0.049 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.009..0.014 rows=25 loops=1)
 Planning Time: 31.394 ms
 Execution Time: 33961.046 ms
(55 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386302.25..392148.02 rows=1 width=64) (actual time=8826.548..8833.253 rows=1 loops=1)
   ->  GroupAggregate  (cost=386302.25..14451228.57 rows=2406 width=64) (actual time=8826.547..8833.252 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386302.25..14450698.63 rows=24091 width=70) (actual time=940.833..8820.496 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142648
               ->  Nested Loop  (cost=386302.25..14441936.66 rows=24091 width=20) (actual time=940.812..8794.969 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386301.95..14363125.93 rows=24091 width=20) (actual time=940.799..8750.014 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386301.52..3800652.87 rows=3628876 width=24) (actual time=935.211..4049.441 rows=1816553 loops=1)
                                 ->  Gather Merge  (cost=386300.95..494934.63 rows=907287 width=8) (actual time=935.150..1125.019 rows=454520 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385300.89..385867.95 rows=226822 width=8) (actual time=924.101..930.353 rows=92133 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 12222kB
                                             Worker 0:  Sort Method: quicksort  Memory: 11592kB
                                             Worker 1:  Sort Method: quicksort  Memory: 12050kB
                                             Worker 2:  Sort Method: quicksort  Memory: 12242kB
                                             Worker 3:  Sort Method: quicksort  Memory: 11065kB
                                             ->  Parallel Hash Join  (cost=42792.88..365123.71 rows=226822 width=8) (actual time=128.520..879.807 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317510.87 rows=1134109 width=12) (actual time=0.044..458.839 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.43..41855.43 rows=74996 width=4) (actual time=126.637..126.642 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41855.43 rows=74996 width=4) (actual time=0.089..104.696 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=8) (actual time=0.046..60.138 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.038..0.041 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.032..0.038 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.008..0.010 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.020..0.021 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.006 rows=4 loops=454520)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Memoize  (cost=0.44..3.42 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=1816553)
                                 Cache Key: lineitem.l_partkey
                                 Cache Mode: logical
                                 Hits: 597411  Misses: 1219142  Evictions: 235639  Overflows: 0  Memory Usage: 65537kB
                                 ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1219142)
                                       Index Cond: (p_partkey = lineitem.l_partkey)
                                       Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                       Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.008..0.012 rows=25 loops=1)
 Planning Time: 5.537 ms
 Execution Time: 8833.713 ms
(55 rows)

query 9 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27143.75..32816.55 rows=1 width=90) (actual time=1819165.394..1819166.587 rows=1 loops=1)
   ->  GroupAggregate  (cost=27143.75..446930.93 rows=74 width=90) (actual time=1819165.393..1819166.584 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=27143.75..446928.52 rows=74 width=81) (actual time=1819157.103..1819159.093 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 29kB  Peak Memory: 29kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=9652.78..446926.52 rows=74 width=81) (actual time=23487.719..1819055.337 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778845480
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=55.254..62.863 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=42.848..43.546 rows=2548 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4448kB
                                 Worker 0:  Sort Method: quicksort  Memory: 3312kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.345..21.781 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.215..12.921 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.079..0.080 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.071..0.073 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..315877.99 rows=74 width=35) (actual time=0.003..248.438 rows=3247516 loops=3935)
                           ->  Gather  (cost=1001.31..315877.62 rows=74 width=35) (actual time=4.806..38318.786 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..314870.22 rows=18 width=35) (actual time=2.416..39134.448 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..314808.61 rows=18 width=35) (actual time=1.896..28034.321 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..106279.24 rows=60606 width=18) (actual time=1.136..1108.276 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.81 rows=15151 width=4) (actual time=0.272..197.359 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.036..0.040 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.044..0.308 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.016..0.016 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 32.418 ms
 Execution Time: 1819187.677 ms
(42 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27143.75..32816.55 rows=1 width=90) (actual time=1758245.406..1758246.936 rows=1 loops=1)
   ->  GroupAggregate  (cost=27143.75..446930.93 rows=74 width=90) (actual time=1758245.405..1758246.934 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=27143.75..446928.52 rows=74 width=81) (actual time=1758237.319..1758239.524 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 29kB  Peak Memory: 29kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=9652.78..446926.52 rows=74 width=81) (actual time=437.652..1758136.010 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12781173914
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=55.237..63.257 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=43.299..44.044 rows=2542 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 4487kB
                                 Worker 0:  Sort Method: quicksort  Memory: 3274kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.356..21.515 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.170..12.291 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.105..0.106 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.094..0.097 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..315877.99 rows=74 width=35) (actual time=0.002..234.213 rows=3248107 loops=3935)
                           ->  Gather  (cost=1001.31..315877.62 rows=74 width=35) (actual time=0.863..16821.628 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..314870.22 rows=18 width=35) (actual time=1.218..17619.871 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..314808.61 rows=18 width=35) (actual time=1.175..11643.162 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..106279.24 rows=60606 width=18) (actual time=0.896..694.716 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.81 rows=15151 width=4) (actual time=0.229..178.926 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.020..0.022 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.020..0.124 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.009..0.009 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 18.713 ms
 Execution Time: 1758267.105 ms
(42 rows)

query 10 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=994606.47..994606.52 rows=20 width=201) (actual time=21036.879..21110.306 rows=20 loops=1)
   ->  Sort  (cost=994606.47..996125.35 rows=607550 width=201) (actual time=21036.878..21110.303 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=890506.25..978439.78 rows=607550 width=201) (actual time=19969.083..20988.474 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=890506.25..963251.03 rows=607550 width=181) (actual time=19969.060..20297.897 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=889506.19..889885.91 rows=151888 width=181) (actual time=19947.116..19977.971 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 43808kB
                           Worker 0:  Sort Method: external merge  Disk: 43496kB
                           Worker 1:  Sort Method: external merge  Disk: 43760kB
                           Worker 2:  Sort Method: external merge  Disk: 43616kB
                           Worker 3:  Sort Method: external merge  Disk: 43856kB
                           ->  Hash Join  (cost=51524.46..876434.22 rows=151888 width=181) (actual time=550.721..19726.458 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=51522.90..875966.36 rows=151888 width=159) (actual time=550.607..19639.440 rows=229080 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Nested Loop  (cost=7138.87..831183.63 rows=151888 width=16) (actual time=127.891..19027.432 rows=229080 loops=5)
                                             ->  Parallel Bitmap Heap Scan on orders  (cost=7138.31..270726.87 rows=154704 width=8) (actual time=125.872..2263.181 rows=114632 loops=5)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=46939
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6983.61 rows=618817 width=0) (actual time=74.998..74.998 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.140..0.145 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Parallel Hash  (cost=39696.79..39696.79 rows=374979 width=147) (actual time=420.551..420.552 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 288416kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=147) (actual time=0.416..134.815 rows=300000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.044..0.045 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.036..0.039 rows=25 loops=5)
 Planning Time: 24.558 ms
 Execution Time: 21117.168 ms
(38 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=994606.47..994606.52 rows=20 width=201) (actual time=3979.036..4046.879 rows=20 loops=1)
   ->  Sort  (cost=994606.47..996125.35 rows=607550 width=201) (actual time=3979.035..4046.876 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=890506.25..978439.78 rows=607550 width=201) (actual time=2911.382..3925.313 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=890506.25..963251.03 rows=607550 width=181) (actual time=2911.363..3233.419 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=889506.19..889885.91 rows=151888 width=181) (actual time=2890.310..2920.710 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 45904kB
                           Worker 0:  Sort Method: external merge  Disk: 44240kB
                           Worker 1:  Sort Method: external merge  Disk: 43904kB
                           Worker 2:  Sort Method: external merge  Disk: 37720kB
                           Worker 3:  Sort Method: external merge  Disk: 46760kB
                           ->  Hash Join  (cost=51524.46..876434.22 rows=151888 width=181) (actual time=504.141..2690.855 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=51522.90..875966.36 rows=151888 width=159) (actual time=504.046..2625.888 rows=229080 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Nested Loop  (cost=7138.87..831183.63 rows=151888 width=16) (actual time=119.497..2099.298 rows=229080 loops=5)
                                             ->  Parallel Bitmap Heap Scan on orders  (cost=7138.31..270726.87 rows=154704 width=8) (actual time=119.209..461.078 rows=114632 loops=5)
                                                   Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   Heap Blocks: exact=49227
                                                   ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6983.61 rows=618817 width=0) (actual time=69.091..69.092 rows=573160 loops=1)
                                                         Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.013..0.014 rows=2 loops=573160)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Filter: (l_returnflag = 'R'::bpchar)
                                                   Rows Removed by Filter: 2
                                       ->  Parallel Hash  (cost=39696.79..39696.79 rows=374979 width=147) (actual time=382.334..382.335 rows=300000 loops=5)
                                             Buckets: 2097152  Batches: 1  Memory Usage: 288416kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=147) (actual time=0.036..72.966 rows=300000 loops=5)
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.021..0.022 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.013..0.016 rows=25 loops=5)
 Planning Time: 2.141 ms
 Execution Time: 4052.585 ms
(38 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=442877.53..442877.53 rows=1 width=36) (actual time=3883.728..3900.704 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=195540.73..195540.74 rows=1 width=32) (actual time=154.551..154.639 rows=1 loops=1)
           ->  Gather  (cost=195540.50..195540.71 rows=2 width=32) (actual time=154.292..154.629 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=194540.50..194540.51 rows=1 width=32) (actual time=151.777..151.778 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..193540.50 rows=133333 width=10) (actual time=0.114..124.843 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.099..18.551 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.033..7.618 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 39585  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 29987  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 30353  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..112.53 rows=80 width=14) (actual time=0.004..0.070 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=247336.79..247603.45 rows=106666 width=36) (actual time=3883.727..3900.614 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=205890.28..246803.46 rows=106666 width=36) (actual time=3883.719..3900.605 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=205890.28..240003.48 rows=266666 width=36) (actual time=3407.156..3569.232 rows=313572 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=204890.26..208223.58 rows=133333 width=36) (actual time=3398.671..3492.503 rows=104524 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=204890.26..205223.59 rows=133333 width=14) (actual time=3398.656..3406.488 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 6505kB
                                 Worker 0:  Sort Method: quicksort  Memory: 6410kB
                                 Worker 1:  Sort Method: quicksort  Memory: 6328kB
                                 ->  Nested Loop  (cost=0.87..193540.50 rows=133333 width=14) (actual time=0.969..3362.629 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.596..30.353 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.211..16.640 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 33729  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 33281  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 32915  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.005..0.005 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..112.53 rows=80 width=18) (actual time=0.062..2.475 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 18.536 ms
 Execution Time: 3901.147 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=442877.53..442877.53 rows=1 width=36) (actual time=629.787..648.140 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=195540.73..195540.74 rows=1 width=32) (actual time=150.715..150.807 rows=1 loops=1)
           ->  Gather  (cost=195540.50..195540.71 rows=2 width=32) (actual time=150.193..150.789 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=194540.50..194540.51 rows=1 width=32) (actual time=147.685..147.687 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..193540.50 rows=133333 width=10) (actual time=0.124..120.804 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.111..18.598 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.037..7.555 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 41781  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 29987  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 28157  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..112.53 rows=80 width=14) (actual time=0.004..0.067 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=247336.79..247603.45 rows=106666 width=36) (actual time=629.786..648.047 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=205890.28..246803.46 rows=106666 width=36) (actual time=629.779..648.039 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=205890.28..240003.48 rows=266666 width=36) (actual time=162.100..319.916 rows=314143 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=204890.26..208223.58 rows=133333 width=36) (actual time=159.160..252.288 rows=104714 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=204890.26..205223.59 rows=133333 width=14) (actual time=159.144..166.851 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 6393kB
                                 Worker 0:  Sort Method: quicksort  Memory: 6465kB
                                 Worker 1:  Sort Method: quicksort  Memory: 6385kB
                                 ->  Nested Loop  (cost=0.87..193540.50 rows=133333 width=14) (actual time=0.111..135.249 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.098..18.796 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.028..7.848 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 32915  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 32997  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 34013  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..112.53 rows=80 width=18) (actual time=0.004..0.078 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.065 ms
 Execution Time: 648.226 ms
(56 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469312.22..1613927.78 rows=1 width=27) (actual time=13808.475..13811.878 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469312.22..2481621.14 rows=7 width=27) (actual time=13808.474..13811.877 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469312.22..2476638.37 rows=284726 width=27) (actual time=7237.869..13719.244 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469311.79..1503403.35 rows=284726 width=15) (actual time=7236.816..7307.424 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468311.73..1468489.68 rows=71182 width=15) (actual time=7225.352..7227.943 rows=32244 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3486kB
                           Worker 0:  Sort Method: quicksort  Memory: 3455kB
                           Worker 1:  Sort Method: quicksort  Memory: 3471kB
                           Worker 2:  Sort Method: quicksort  Memory: 3483kB
                           Worker 3:  Sort Method: quicksort  Memory: 3515kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462574.73 rows=71182 width=15) (actual time=1.654..7210.493 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.040..0.040 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 16.653 ms
 Execution Time: 13812.288 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469312.22..1613927.78 rows=1 width=27) (actual time=3948.106..3949.515 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469312.22..2481621.14 rows=7 width=27) (actual time=3948.105..3949.513 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469312.22..2476638.37 rows=284726 width=27) (actual time=3467.440..3898.046 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469311.79..1503403.35 rows=284726 width=15) (actual time=3467.390..3503.291 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468311.73..1468489.68 rows=71182 width=15) (actual time=3462.305..3464.251 rows=32308 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3490kB
                           Worker 0:  Sort Method: quicksort  Memory: 3439kB
                           Worker 1:  Sort Method: quicksort  Memory: 5147kB
                           Worker 2:  Sort Method: quicksort  Memory: 3452kB
                           Worker 3:  Sort Method: quicksort  Memory: 3417kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462574.73 rows=71182 width=15) (actual time=0.113..3447.085 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.848 ms
 Execution Time: 3949.571 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361487.38..1361487.38 rows=1 width=16) (actual time=16736.791..16736.794 rows=1 loops=1)
   ->  Sort  (cost=1361487.38..1361487.88 rows=200 width=16) (actual time=16736.789..16736.791 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361484.38..1361486.38 rows=200 width=16) (actual time=16736.763..16736.770 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1207997.42..1338985.65 rows=1499915 width=12) (actual time=14622.922..16567.988 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53282.09..662848.76 rows=14846602 width=8) (actual time=372.417..10777.883 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448744.22 rows=14846602 width=8) (actual time=0.760..5023.993 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28673.15..28673.15 rows=1499915 width=4) (actual time=369.124..369.124 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.15 rows=1499915 width=4) (actual time=0.021..165.450 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 18.299 ms
 Execution Time: 16769.905 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361487.38..1361487.38 rows=1 width=16) (actual time=16169.398..16169.401 rows=1 loops=1)
   ->  Sort  (cost=1361487.38..1361487.88 rows=200 width=16) (actual time=16169.397..16169.399 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361484.38..1361486.38 rows=200 width=16) (actual time=16169.370..16169.378 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1207997.42..1338985.65 rows=1499915 width=12) (actual time=14026.275..15996.627 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=53282.09..662848.76 rows=14846602 width=8) (actual time=334.825..10232.244 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448744.22 rows=14846602 width=8) (actual time=0.038..4557.993 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28673.15..28673.15 rows=1499915 width=4) (actual time=332.204..332.205 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28673.15 rows=1499915 width=4) (actual time=0.022..133.387 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.716 ms
 Execution Time: 16203.457 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=826236.70..826236.71 rows=1 width=32) (actual time=5242.824..5275.403 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=826236.70..826236.71 rows=1 width=32) (actual time=5242.822..5275.400 rows=1 loops=1)
         ->  Gather  (cost=826236.24..826236.65 rows=4 width=64) (actual time=5236.624..5275.376 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=825236.24..825236.25 rows=1 width=64) (actual time=5228.533..5228.535 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64040.51..822013.98 rows=184129 width=33) (actual time=659.280..5081.472 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=11809.84..769299.98 rows=184129 width=16) (actual time=288.196..4533.854 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=79789
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11625.72 rows=736515 width=0) (actual time=187.839..187.840 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.85..45980.85 rows=499985 width=25) (actual time=368.862..368.863 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.85 rows=499985 width=25) (actual time=0.453..217.148 rows=400000 loops=5)
 Planning Time: 17.075 ms
 Execution Time: 5276.005 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=826236.70..826236.71 rows=1 width=32) (actual time=1650.304..1681.792 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=826236.70..826236.71 rows=1 width=32) (actual time=1650.303..1681.789 rows=1 loops=1)
         ->  Gather  (cost=826236.24..826236.65 rows=4 width=64) (actual time=1643.319..1681.764 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=825236.24..825236.25 rows=1 width=64) (actual time=1638.406..1638.408 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64040.51..822013.98 rows=184129 width=33) (actual time=524.816..1526.066 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=11809.84..769299.98 rows=184129 width=16) (actual time=270.415..1121.088 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=84674
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11625.72 rows=736515 width=0) (actual time=169.823..169.823 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.85..45980.85 rows=499985 width=25) (actual time=252.350..252.350 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.85 rows=499985 width=25) (actual time=0.061..79.758 rows=400000 loops=5)
 Planning Time: 1.031 ms
 Execution Time: 1681.836 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2698413.46..2698520.78 rows=1 width=103) (actual time=13035.457..13087.309 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1367707.66..1367707.67 rows=1 width=32) (actual time=2819.731..2830.097 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1365220.89..1366464.27 rows=99471 width=36) (actual time=2776.788..2824.260 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 59409kB
                 ->  Gather  (cost=1321204.97..1362236.76 rows=397884 width=36) (actual time=2464.078..2546.185 rows=398576 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1320204.97..1321448.36 rows=99471 width=36) (actual time=2459.912..2505.652 rows=99644 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 39953kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=34564.64..1314815.68 rows=538929 width=16) (actual time=429.100..2011.040 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=107105 lossy=71263
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34025.72 rows=2155715 width=0) (actual time=338.475..338.475 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1330705.79..1384044.73 rows=497 width=103) (actual time=13035.455..13076.940 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1330705.50..1382822.19 rows=497 width=36) (actual time=13034.529..13076.013 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1330705.50..1378345.99 rows=397884 width=36) (actual time=10023.364..10128.960 rows=346214 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1329705.44..1329954.12 rows=99471 width=36) (actual time=9994.652..10002.782 rows=69782 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11564kB
                           Worker 0:  Sort Method: quicksort  Memory: 11577kB
                           Worker 1:  Sort Method: quicksort  Memory: 11574kB
                           Worker 2:  Sort Method: quicksort  Memory: 11578kB
                           Worker 3:  Sort Method: quicksort  Memory: 11576kB
                           ->  Partial HashAggregate  (cost=1320204.97..1321448.36 rows=99471 width=36) (actual time=9909.856..9971.650 rows=98923 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=34564.64..1314815.68 rows=538929 width=16) (actual time=478.671..9409.807 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79039 lossy=52749
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34025.72 rows=2155715 width=0) (actual time=390.843..390.844 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.921..0.921 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 14.602 ms
 Execution Time: 13089.772 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2698413.46..2698520.78 rows=1 width=103) (actual time=5766.583..5816.748 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1367707.66..1367707.67 rows=1 width=32) (actual time=2824.374..2834.355 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1365220.89..1366464.27 rows=99471 width=36) (actual time=2782.924..2828.449 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 56337kB
                 ->  Gather  (cost=1321204.97..1362236.76 rows=397884 width=36) (actual time=2474.130..2555.668 rows=398597 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1320204.97..1321448.36 rows=99471 width=36) (actual time=2466.733..2512.496 rows=99649 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 43025kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=34564.64..1314815.68 rows=538929 width=16) (actual time=427.923..2014.056 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=106667 lossy=71085
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34025.72 rows=2155715 width=0) (actual time=340.343..340.344 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1330705.79..1384044.73 rows=497 width=103) (actual time=5766.582..5806.764 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1330705.50..1382822.19 rows=497 width=36) (actual time=5766.528..5806.709 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1330705.50..1378345.99 rows=397884 width=36) (actual time=2753.802..2857.497 rows=345960 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1329705.44..1329954.12 rows=99471 width=36) (actual time=2726.847..2734.519 rows=69693 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11513kB
                           Worker 0:  Sort Method: quicksort  Memory: 11607kB
                           Worker 1:  Sort Method: quicksort  Memory: 11587kB
                           Worker 2:  Sort Method: quicksort  Memory: 11557kB
                           Worker 3:  Sort Method: quicksort  Memory: 11577kB
                           ->  Partial HashAggregate  (cost=1320204.97..1321448.36 rows=99471 width=36) (actual time=2642.821..2702.355 rows=98857 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=34564.64..1314815.68 rows=538929 width=16) (actual time=443.059..2206.477 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=71258 lossy=47485
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..34025.72 rows=2155715 width=0) (actual time=354.513..354.513 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.050..0.050 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.077 ms
 Execution Time: 5818.944 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=255091.66..255091.66 rows=1 width=44) (actual time=2784.319..2792.207 rows=1 loops=1)
   ->  Sort  (cost=255091.66..255481.85 rows=156077 width=44) (actual time=2784.318..2792.206 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172733.29..254311.27 rows=156077 width=44) (actual time=2137.038..2786.185 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172733.29..246582.74 rows=616776 width=40) (actual time=2136.983..2625.975 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171733.23..172118.72 rows=154194 width=40) (actual time=2035.215..2051.162 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 20786kB
                           Worker 0:  Sort Method: quicksort  Memory: 19793kB
                           Worker 1:  Sort Method: quicksort  Memory: 19834kB
                           Worker 2:  Sort Method: quicksort  Memory: 20716kB
                           Worker 3:  Sort Method: quicksort  Memory: 19585kB
                           ->  Parallel Hash Join  (cost=57915.77..158446.04 rows=154194 width=40) (actual time=356.349..1094.938 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101376.72 rows=999996 width=8) (actual time=37.651..582.600 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.115..36.694 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.62..53480.62 rows=77095 width=40) (actual time=317.996..317.997 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.62 rows=77095 width=40) (actual time=0.596..293.209 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 17.186 ms
 Execution Time: 2792.598 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=255091.66..255091.66 rows=1 width=44) (actual time=2548.043..2554.703 rows=1 loops=1)
   ->  Sort  (cost=255091.66..255481.85 rows=156077 width=44) (actual time=2548.042..2554.701 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172733.29..254311.27 rows=156077 width=44) (actual time=1892.508..2549.252 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172733.29..246582.74 rows=616776 width=40) (actual time=1892.456..2386.382 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171733.23..172118.72 rows=154194 width=40) (actual time=1770.985..1786.968 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 21325kB
                           Worker 0:  Sort Method: quicksort  Memory: 20461kB
                           Worker 1:  Sort Method: quicksort  Memory: 20764kB
                           Worker 2:  Sort Method: quicksort  Memory: 19035kB
                           Worker 3:  Sort Method: quicksort  Memory: 19129kB
                           ->  Parallel Hash Join  (cost=57915.77..158446.04 rows=154194 width=40) (actual time=184.375..799.417 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101376.72 rows=999996 width=8) (actual time=28.758..443.706 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.088..27.137 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.62..53480.62 rows=77095 width=40) (actual time=154.955..154.956 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26400kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.62 rows=77095 width=40) (actual time=0.020..122.131 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 0.843 ms
 Execution Time: 2554.780 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3414317.12..3414317.13 rows=1 width=32) (actual time=24243.391..24321.180 rows=1 loops=1)
   ->  Aggregate  (cost=3414317.12..3414317.13 rows=1 width=32) (actual time=24243.390..24321.178 rows=1 loops=1)
         ->  Merge Join  (cost=2282604.61..3414270.69 rows=18571 width=8) (actual time=17989.150..24320.356 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2281603.68..3310856.36 rows=1964453 width=36) (actual time=17956.885..24103.235 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2281603.68..3222455.98 rows=7857812 width=36) (actual time=17956.865..19981.927 rows=9972221 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2280603.63..2285514.76 rows=1964453 width=36) (actual time=17650.130..17944.775 rows=1994966 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150368kB
                                 Worker 0:  Sort Method: external merge  Disk: 150360kB
                                 Worker 1:  Sort Method: external merge  Disk: 150344kB
                                 Worker 2:  Sort Method: external merge  Disk: 150336kB
                                 Worker 3:  Sort Method: external merge  Disk: 150344kB
                                 ->  Partial HashAggregate  (cost=1869718.93..2040729.34 rows=1964453 width=36) (actual time=9877.581..16786.783 rows=1995109 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407752kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407576kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 396312kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 396296kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 394248kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275112.66 rows=14996966 width=9) (actual time=0.802..3891.555 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..97664.97 rows=56720 width=21) (actual time=30.024..91.970 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..97523.17 rows=56720 width=21) (actual time=30.019..85.438 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..89767.21 rows=14180 width=21) (actual time=1.753..637.073 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.90 rows=473 width=4) (actual time=0.745..193.553 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.43 rows=31 width=17) (actual time=0.650..0.880 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 14.599 ms
 Execution Time: 24389.134 ms
(38 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3414317.12..3414317.13 rows=1 width=32) (actual time=22571.326..22663.500 rows=1 loops=1)
   ->  Aggregate  (cost=3414317.12..3414317.13 rows=1 width=32) (actual time=22571.324..22663.498 rows=1 loops=1)
         ->  Merge Join  (cost=2282604.61..3414270.69 rows=18571 width=8) (actual time=16416.345..22662.799 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2281603.68..3310856.36 rows=1964453 width=36) (actual time=16407.464..22515.756 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2281603.68..3222455.98 rows=7857812 width=36) (actual time=16407.445..18447.711 rows=9971872 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2280603.63..2285514.76 rows=1964453 width=36) (actual time=16167.453..16456.383 rows=1994866 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 150392kB
                                 Worker 0:  Sort Method: external merge  Disk: 150368kB
                                 Worker 1:  Sort Method: external merge  Disk: 150376kB
                                 Worker 2:  Sort Method: external merge  Disk: 150360kB
                                 Worker 3:  Sort Method: external merge  Disk: 150232kB
                                 ->  Partial HashAggregate  (cost=1869718.93..2040729.34 rows=1964453 width=36) (actual time=8386.898..15309.648 rows=1995040 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 16  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407952kB
                                       Worker 0:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407752kB
                                       Worker 1:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407792kB
                                       Worker 2:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 407624kB
                                       Worker 3:  Batches: 17  Memory Usage: 65681kB  Disk Usage: 379912kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275112.66 rows=14996966 width=9) (actual time=0.076..1382.561 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..97664.97 rows=56720 width=21) (actual time=6.887..27.583 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..97523.17 rows=56720 width=21) (actual time=6.881..21.305 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..89767.21 rows=14180 width=21) (actual time=0.244..132.482 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66711.90 rows=473 width=4) (actual time=0.224..113.076 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.43 rows=31 width=17) (actual time=0.005..0.034 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.950 ms
 Execution Time: 22727.868 ms
(38 rows)

query 18 run 1
SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8579584.59..8579584.84 rows=100 width=71) (actual time=74626.869..74639.047 rows=99 loops=1)
   ->  Sort  (cost=8579584.59..8629570.71 rows=19994447 width=71) (actual time=74626.868..74639.040 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=829453.04..7815411.21 rows=19994447 width=71) (actual time=43547.025..74638.928 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=829453.04..7415522.27 rows=19994447 width=44) (actual time=43547.014..74638.653 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=829452.64..6690644.37 rows=19994447 width=44) (actual time=40225.180..74638.230 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829317.62..4160879.23 rows=4998989 width=43) (actual time=39883.478..63488.937 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828317.56..3564451.39 rows=1249747 width=43) (actual time=6684.998..37527.012 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828316.99..837690.80 rows=3749524 width=39) (actual time=3742.583..4077.635 rows=2996546 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 144824kB
                                             Worker 0:  Sort Method: external merge  Disk: 152256kB
                                             Worker 1:  Sort Method: external merge  Disk: 147920kB
                                             Worker 2:  Sort Method: external merge  Disk: 148672kB
                                             Worker 3:  Sort Method: external merge  Disk: 154232kB
                                             ->  Parallel Hash Join  (cost=44384.03..352989.79 rows=3749524 width=39) (actual time=292.681..3002.729 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298763.24 rows=3749524 width=20) (actual time=0.570..1178.405 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39696.79..39696.79 rows=374979 width=23) (actual time=289.913..289.913 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=23) (actual time=0.430..171.615 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692391.84 rows=4998989 width=4) (actual time=802.430..33240.504 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167498.02 rows=59987864 width=9) (actual time=0.582..18965.994 rows=59986052 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167498.02 rows=59987864 width=9) (actual time=0.116..7822.112 rows=59916431 loops=1)
 Planning Time: 22.002 ms
 Execution Time: 74655.776 ms
(38 rows)

SET
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8579584.59..8579584.84 rows=100 width=71) (actual time=66610.046..66622.100 rows=99 loops=1)
   ->  Sort  (cost=8579584.59..8629570.71 rows=19994447 width=71) (actual time=66610.045..66622.093 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=829453.04..7815411.21 rows=19994447 width=71) (actual time=35039.465..66621.983 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=829453.04..7415522.27 rows=19994447 width=44) (actual time=35039.454..66621.705 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=829452.64..6690644.37 rows=19994447 width=44) (actual time=34484.074..66621.281 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=829317.62..4160879.23 rows=4998989 width=43) (actual time=34146.752..55189.122 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=828317.56..3564451.39 rows=1249747 width=43) (actual time=4979.368..32926.815 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=828316.99..837690.80 rows=3749524 width=39) (actual time=3093.163..3439.193 rows=2996546 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 159536kB
                                             Worker 0:  Sort Method: external merge  Disk: 141640kB
                                             Worker 1:  Sort Method: external merge  Disk: 151376kB
                                             Worker 2:  Sort Method: external merge  Disk: 154416kB
                                             Worker 3:  Sort Method: external merge  Disk: 140944kB
                                             ->  Parallel Hash Join  (cost=44384.03..352989.79 rows=3749524 width=39) (actual time=200.691..2252.143 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298763.24 rows=3749524 width=20) (actual time=0.046..373.584 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39696.79..39696.79 rows=374979 width=23) (actual time=197.371..197.372 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39696.79 rows=374979 width=23) (actual time=0.046..58.993 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..2692391.84 rows=4998989 width=4) (actual time=646.894..29269.246 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167498.02 rows=59987864 width=9) (actual time=0.094..14747.369 rows=59986052 loops=5)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167498.02 rows=59987864 width=9) (actual time=0.060..8096.722 rows=59916431 loops=1)
 Planning Time: 1.829 ms
 Execution Time: 66640.102 ms
(38 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=123065.82..123065.83 rows=1 width=32) (actual time=4938.129..4949.579 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=123065.82..123065.83 rows=1 width=32) (actual time=4938.128..4949.576 rows=1 loops=1)
         ->  Gather  (cost=123065.39..123065.80 rows=4 width=32) (actual time=4931.655..4949.558 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=122065.39..122065.40 rows=1 width=32) (actual time=4922.560..4922.561 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..122063.32 rows=276 width=12) (actual time=47.118..4921.949 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.36 rows=1187 width=30) (actual time=0.621..165.078 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..50.40 rows=1 width=21) (actual time=4.486..4.973 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 18.576 ms
 Execution Time: 4949.976 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=123065.82..123065.83 rows=1 width=32) (actual time=209.185..235.630 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=123065.82..123065.83 rows=1 width=32) (actual time=209.184..235.628 rows=1 loops=1)
         ->  Gather  (cost=123065.39..123065.80 rows=4 width=32) (actual time=208.455..235.608 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=122065.39..122065.40 rows=1 width=32) (actual time=203.612..203.613 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..122063.32 rows=276 width=12) (actual time=0.794..203.429 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.36 rows=1187 width=30) (actual time=0.102..125.487 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..50.40 rows=1 width=21) (actual time=0.071..0.081 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.075 ms
 Execution Time: 235.683 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2461157.20..2660549.00 rows=1 width=51) (actual time=27428.400..27429.685 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2461157.20..2660549.00 rows=1 width=51) (actual time=27428.399..27429.682 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=28.336..29.547 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=18.438..18.454 rows=394 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 301kB
                     Worker 0:  Sort Method: quicksort  Memory: 146kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.372..17.197 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.233..12.501 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.088..0.089 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.084..0.086 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2457034.27..2655790.19 rows=3 width=8) (actual time=25896.398..27399.117 rows=13474 loops=1)
               ->  Hash Join  (cost=2457034.27..2655790.18 rows=3 width=8) (actual time=25896.395..27395.505 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2380570.10..2542907.30 rows=4855810 width=40) (actual time=24490.824..25804.262 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146943.82..1994287.89 rows=9164805 width=13) (actual time=1213.507..19850.253 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144652.61 rows=9164805 width=0) (actual time=1089.861..1089.861 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75252.08..75252.08 rows=80806 width=16) (actual time=1405.449..1405.520 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75252.08 rows=80806 width=16) (actual time=2.100..1385.361 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.48 rows=20202 width=16) (actual time=0.909..1390.758 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.81 rows=5050 width=4) (actual time=0.312..116.560 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.274..0.292 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 25.269 ms
 Execution Time: 27476.762 ms
(46 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2461157.20..2660549.00 rows=1 width=51) (actual time=15431.923..15433.346 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2461157.20..2660549.00 rows=1 width=51) (actual time=15431.921..15433.343 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=16.355..17.709 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=14.288..14.305 rows=390 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 270kB
                     Worker 0:  Sort Method: quicksort  Memory: 177kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.106..12.949 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.024..8.253 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.014..0.016 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2457034.27..2655790.19 rows=3 width=8) (actual time=13911.368..15414.609 rows=13474 loops=1)
               ->  Hash Join  (cost=2457034.27..2655790.18 rows=3 width=8) (actual time=13911.365..15410.948 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2380570.10..2542907.30 rows=4855810 width=40) (actual time=13738.840..15052.239 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146943.82..1994287.89 rows=9164805 width=13) (actual time=1068.112..9648.645 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144652.61 rows=9164805 width=0) (actual time=944.889..944.889 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75252.08..75252.08 rows=80806 width=16) (actual time=172.396..172.462 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75252.08 rows=80806 width=16) (actual time=0.338..148.067 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.48 rows=20202 width=16) (actual time=0.105..156.030 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.81 rows=5050 width=4) (actual time=0.056..88.432 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.013..0.014 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.229 ms
 Execution Time: 15478.828 ms
(46 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1969801.92..1969801.93 rows=1 width=34) (actual time=11505.840..11518.398 rows=100 loops=1)
   ->  Sort  (cost=1969801.92..1969801.93 rows=1 width=34) (actual time=11505.839..11518.390 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1969798.70..1969801.91 rows=1 width=34) (actual time=10963.242..11515.955 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1969798.70..1969801.90 rows=1 width=26) (actual time=10963.093..11505.075 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1969798.13..1969798.26 rows=1 width=38) (actual time=10963.018..11007.835 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1968798.07..1968798.08 rows=1 width=38) (actual time=10937.285..10939.135 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1094kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1112kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1107kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1115kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1102kB
                                 ->  Nested Loop Anti Join  (cost=1338048.17..1968798.06 rows=1 width=38) (actual time=7300.683..10862.509 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338047.61..1653338.78 rows=98247 width=38) (actual time=7297.655..9331.009 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308137.06 rows=1842266 width=4) (actual time=0.600..1511.825 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335548.11..1335548.11 rows=199960 width=34) (actual time=7295.783..7296.095 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335548.11 rows=199960 width=34) (actual time=23.440..7136.850 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312605.07 rows=4998989 width=8) (actual time=0.395..6326.111 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=22.842..22.845 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.739..22.284 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.660..20.176 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.066..0.067 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.052..0.056 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.010..0.010 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 21.092 ms
 Execution Time: 11519.416 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1969801.92..1969801.93 rows=1 width=34) (actual time=6645.067..6660.744 rows=100 loops=1)
   ->  Sort  (cost=1969801.92..1969801.93 rows=1 width=34) (actual time=6645.066..6660.736 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=1969798.70..1969801.91 rows=1 width=34) (actual time=6148.706..6658.320 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1969798.70..1969801.90 rows=1 width=26) (actual time=6148.530..6647.412 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1969798.13..1969798.26 rows=1 width=38) (actual time=6148.484..6195.757 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1968798.07..1968798.08 rows=1 width=38) (actual time=6126.276..6127.834 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1096kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1087kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1088kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1139kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1120kB
                                 ->  Nested Loop Anti Join  (cost=1338048.17..1968798.06 rows=1 width=38) (actual time=3683.658..6051.503 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338047.61..1653338.78 rows=98247 width=38) (actual time=3683.283..4844.320 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308137.06 rows=1842266 width=4) (actual time=0.037..574.147 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335548.11..1335548.11 rows=199960 width=34) (actual time=3680.854..3680.858 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131360kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335548.11 rows=199960 width=34) (actual time=11.803..3495.010 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312605.07 rows=4998989 width=8) (actual time=0.041..2574.441 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=11.002..11.004 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 384kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.059..10.588 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.027..7.762 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.022..0.023 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.245 ms
 Execution Time: 6660.842 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93875.84..93877.53 rows=1 width=72) (actual time=1724.143..1727.991 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46820.57..46820.58 rows=1 width=32) (actual time=339.174..339.275 rows=1 loops=1)
           ->  Gather  (cost=46820.14..46820.55 rows=4 width=32) (actual time=339.161..339.267 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.14..45820.15 rows=1 width=32) (actual time=328.243..328.244 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.19 rows=11977 width=6) (actual time=0.984..320.272 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.26..59774.06 rows=7540 width=72) (actual time=1724.142..1727.888 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.26..59585.56 rows=7540 width=38) (actual time=508.818..1720.759 rows=9006 loops=1)
               ->  Gather Merge  (cost=47054.83..49150.07 rows=17499 width=26) (actual time=507.445..529.259 rows=27131 loops=1)
                     Workers Planned: 4
                     Workers Launched: 3
                     ->  Sort  (cost=46054.77..46065.71 rows=4375 width=26) (actual time=164.678..165.681 rows=7627 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3888kB
                           Worker 0:  Sort Method: quicksort  Memory: 3762kB
                           Worker 1:  Sort Method: quicksort  Memory: 3688kB
                           Worker 2:  Sort Method: quicksort  Memory: 3767kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.19 rows=4375 width=26) (actual time=0.017..149.989 rows=47782 loops=4)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.043..0.043 rows=1 loops=27131)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 24.813 ms
 Execution Time: 1728.822 ms
(30 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93875.84..93877.53 rows=1 width=72) (actual time=434.605..438.102 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46820.57..46820.58 rows=1 width=32) (actual time=202.067..202.158 rows=1 loops=1)
           ->  Gather  (cost=46820.14..46820.55 rows=4 width=32) (actual time=199.706..202.140 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.14..45820.15 rows=1 width=32) (actual time=196.179..196.179 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.19 rows=11977 width=6) (actual time=0.017..189.298 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.26..59774.06 rows=7540 width=72) (actual time=434.604..438.009 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.26..59585.56 rows=7540 width=38) (actual time=367.329..435.605 rows=9006 loops=1)
               ->  Gather Merge  (cost=47054.83..49150.07 rows=17499 width=26) (actual time=367.285..378.072 rows=27128 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=46054.77..46065.71 rows=4375 width=26) (actual time=159.754..160.319 rows=6317 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3876kB
                           Worker 0:  Sort Method: quicksort  Memory: 1832kB
                           Worker 1:  Sort Method: quicksort  Memory: 1860kB
                           Worker 2:  Sort Method: quicksort  Memory: 3762kB
                           Worker 3:  Sort Method: quicksort  Memory: 3776kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.19 rows=4375 width=26) (actual time=0.020..148.338 rows=38226 loops=5)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 0.828 ms
 Execution Time: 438.168 ms
(31 rows)

