query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1831778.13..1831778.76 rows=1 width=236) (actual time=20975.780..20976.415 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1831778.13..1831781.95 rows=6 width=236) (actual time=20975.779..20976.413 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1831778.13..1831781.00 rows=24 width=236) (actual time=20975.739..20976.385 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1830778.07..1830778.09 rows=6 width=236) (actual time=20968.019..20968.020 rows=3 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1830777.86..1830777.99 rows=6 width=236) (actual time=20967.992..20968.000 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 32kB
                           Worker 0:  Batches: 1  Memory Usage: 32kB
                           Worker 1:  Batches: 1  Memory Usage: 32kB
                           Worker 2:  Batches: 1  Memory Usage: 32kB
                           Worker 3:  Batches: 1  Memory Usage: 32kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312603.31 rows=14804987 width=25) (actual time=1.294..4256.151 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 13.972 ms
 Execution Time: 20976.736 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1831778.13..1831778.76 rows=1 width=236) (actual time=20332.608..20332.699 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1831778.13..1831781.95 rows=6 width=236) (actual time=20332.607..20332.697 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1831778.13..1831781.00 rows=24 width=236) (actual time=20332.571..20332.666 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1830778.07..1830778.09 rows=6 width=236) (actual time=20328.658..20328.659 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1830777.86..1830777.99 rows=6 width=236) (actual time=20328.632..20328.641 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 32kB
                           Worker 0:  Batches: 1  Memory Usage: 32kB
                           Worker 1:  Batches: 1  Memory Usage: 32kB
                           Worker 2:  Batches: 1  Memory Usage: 32kB
                           Worker 3:  Batches: 1  Memory Usage: 32kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312603.31 rows=14804987 width=25) (actual time=0.030..2689.720 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.577 ms
 Execution Time: 20332.761 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1096097.48..1096097.49 rows=1 width=192) (actual time=4251.685..4251.904 rows=100 loops=1)
   ->  Sort  (cost=1096097.48..1096097.49 rows=1 width=192) (actual time=4251.684..4251.897 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=553847.66..1096097.47 rows=1 width=192) (actual time=3239.474..4249.236 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68771.59 rows=8892 width=30) (actual time=13.630..16.902 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.41 rows=2223 width=30) (actual time=2.222..308.824 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=552846.87..560699.00 rows=1570425 width=172) (actual time=3224.699..3684.818 rows=1603828 loops=1)
                     ->  Sort  (cost=552846.87..556772.93 rows=1570425 width=172) (actual time=3224.694..3494.908 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..304961.50 rows=1570425 width=172) (actual time=70.699..2553.607 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255212.36 rows=7999036 width=14) (actual time=3.308..1100.566 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=67.344..67.347 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=7.321..60.187 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=1.573..40.047 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=5.740..5.741 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=5.728..5.738 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=5.530..5.533 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.186..0.186 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.179..0.181 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.055..0.055 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.045..0.053 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.040..0.051 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.039..0.049 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.035..0.036 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 17.844 ms
 Execution Time: 4290.588 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1096097.48..1096097.49 rows=1 width=192) (actual time=3483.746..3483.871 rows=100 loops=1)
   ->  Sort  (cost=1096097.48..1096097.49 rows=1 width=192) (actual time=3483.744..3483.863 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=553847.66..1096097.47 rows=1 width=192) (actual time=2732.014..3481.638 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68771.59 rows=8892 width=30) (actual time=3.965..6.217 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.41 rows=2223 width=30) (actual time=0.113..123.640 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=552846.87..560699.00 rows=1570425 width=172) (actual time=2727.953..3177.296 rows=1603828 loops=1)
                     ->  Sort  (cost=552846.87..556772.93 rows=1570425 width=172) (actual time=2727.949..2987.440 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..304961.50 rows=1570425 width=172) (actual time=34.633..2078.055 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255212.36 rows=7999036 width=14) (actual time=0.039..775.694 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=34.552..34.554 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.043..28.557 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.011..8.064 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.028..0.029 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.021..0.027 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.003..0.004 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.014 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=66.25..66.26 rows=1 width=32) (actual time=0.017..0.017 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..66.24 rows=4 width=6) (actual time=0.009..0.015 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..64.95 rows=18 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..63.33 rows=18 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.75 rows=18 width=10) (actual time=0.003..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 1.888 ms
 Execution Time: 3520.088 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2335205.89..2335205.92 rows=10 width=44) (actual time=10326.852..10359.426 rows=10 loops=1)
   ->  Sort  (cost=2335205.89..2343263.20 rows=3222921 width=44) (actual time=10326.843..10359.415 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1791034.12..2265559.73 rows=3222921 width=44) (actual time=10094.921..10335.877 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1791034.12..2176929.40 rows=3222921 width=24) (actual time=10094.907..10168.641 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1790034.06..1792048.38 rows=805730 width=24) (actual time=10085.292..10088.228 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 6197kB
                           Worker 0:  Sort Method: quicksort  Memory: 6287kB
                           Worker 1:  Sort Method: quicksort  Memory: 6348kB
                           Worker 2:  Sort Method: quicksort  Memory: 6206kB
                           Worker 3:  Sort Method: quicksort  Memory: 6201kB
                           ->  Nested Loop  (cost=41591.10..1700367.70 rows=805730 width=24) (actual time=277.881..10064.479 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41590.53..354508.71 rows=370494 width=12) (actual time=275.996..1759.143 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308149.22 rows=1816742 width=16) (actual time=0.685..1025.191 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.58..40634.58 rows=76476 width=4) (actual time=274.601..274.602 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.58 rows=76476 width=4) (actual time=0.111..256.402 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.028..0.028 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 20.975 ms
 Execution Time: 10359.750 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2335205.89..2335205.92 rows=10 width=44) (actual time=3930.146..3961.913 rows=10 loops=1)
   ->  Sort  (cost=2335205.89..2343263.20 rows=3222921 width=44) (actual time=3930.145..3961.910 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1791034.12..2265559.73 rows=3222921 width=44) (actual time=3698.856..3938.199 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1791034.12..2176929.40 rows=3222921 width=24) (actual time=3698.843..3771.553 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1790034.06..1792048.38 rows=805730 width=24) (actual time=3691.740..3694.726 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 6370kB
                           Worker 0:  Sort Method: quicksort  Memory: 5725kB
                           Worker 1:  Sort Method: quicksort  Memory: 6134kB
                           Worker 2:  Sort Method: quicksort  Memory: 6540kB
                           Worker 3:  Sort Method: quicksort  Memory: 6470kB
                           ->  Nested Loop  (cost=41591.10..1700367.70 rows=805730 width=24) (actual time=131.200..3669.173 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41590.53..354508.71 rows=370494 width=12) (actual time=131.020..1211.234 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308149.22 rows=1816742 width=16) (actual time=0.037..553.585 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.58..40634.58 rows=76476 width=4) (actual time=129.313..129.314 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.58 rows=76476 width=4) (actual time=0.022..108.147 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.008..0.008 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.605 ms
 Execution Time: 3961.985 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=281802.84..635458.01 rows=1 width=24) (actual time=29172.841..29198.797 rows=1 loops=1)
   ->  GroupAggregate  (cost=281802.84..2050078.68 rows=5 width=24) (actual time=29172.839..29198.794 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=281802.84..2047408.60 rows=534007 width=16) (actual time=4204.206..29123.000 rows=103030 loops=1)
               ->  Gather Merge  (cost=281802.28..345763.44 rows=534191 width=20) (actual time=4203.227..4347.047 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=280802.22..281136.09 rows=133548 width=20) (actual time=4192.006..4195.339 rows=23428 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 11766kB
                           Worker 0:  Sort Method: quicksort  Memory: 11923kB
                           Worker 1:  Sort Method: quicksort  Memory: 11810kB
                           Worker 2:  Sort Method: quicksort  Memory: 11731kB
                           Worker 3:  Sort Method: quicksort  Memory: 11917kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6161.39..269432.61 rows=133548 width=20) (actual time=130.717..4138.403 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=45956
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6027.85 rows=534191 width=0) (actual time=86.764..86.764 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.219..0.219 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 16.628 ms
 Execution Time: 29199.865 ms
(25 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=281802.84..635458.01 rows=1 width=24) (actual time=1696.225..1723.577 rows=1 loops=1)
   ->  GroupAggregate  (cost=281802.84..2050078.68 rows=5 width=24) (actual time=1696.223..1723.575 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=281802.84..2047408.60 rows=534007 width=16) (actual time=722.673..1704.660 rows=103030 loops=1)
               ->  Gather Merge  (cost=281802.28..345763.44 rows=534191 width=20) (actual time=722.608..788.961 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=280802.22..281136.09 rows=133548 width=20) (actual time=708.501..710.925 rows=23388 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 11578kB
                           Worker 0:  Sort Method: quicksort  Memory: 12083kB
                           Worker 1:  Sort Method: quicksort  Memory: 11848kB
                           Worker 2:  Sort Method: quicksort  Memory: 11176kB
                           Worker 3:  Sort Method: quicksort  Memory: 12461kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6161.39..269432.61 rows=133548 width=20) (actual time=128.286..668.528 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=45132
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6027.85 rows=534191 width=0) (actual time=83.693..83.693 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 1.098 ms
 Execution Time: 1723.646 ms
(25 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=756985.58..756985.58 rows=1 width=58) (actual time=22040.275..22090.760 rows=1 loops=1)
   ->  Sort  (cost=756985.58..756985.64 rows=25 width=58) (actual time=22040.274..22090.757 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=756748.33..756985.45 rows=25 width=58) (actual time=22030.728..22090.740 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=756748.33..756984.39 rows=100 width=58) (actual time=22027.870..22090.702 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=755748.27..755972.42 rows=25 width=58) (actual time=22014.536..22019.937 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=755748.27..755793.04 rows=17907 width=38) (actual time=22013.215..22013.928 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1514kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1501kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1512kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1503kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1519kB
                                 ->  Parallel Hash Join  (cost=72305.94..754483.30 rows=17907 width=38) (actual time=574.436..21998.915 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68614.34..748441.65 rows=447630 width=50) (actual time=554.118..21823.587 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68613.77..340656.59 rows=111946 width=38) (actual time=553.822..2523.142 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25820.41..295484.37 rows=559731 width=8) (actual time=258.467..2003.467 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52096
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25260.68 rows=2238924 width=0) (actual time=202.162..202.163 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.86..41855.86 rows=75001 width=38) (actual time=294.584..294.587 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25312kB
                                                         ->  Hash Join  (cost=2.51..41855.86 rows=75001 width=38) (actual time=0.756..267.880 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375006 width=8) (actual time=0.403..228.161 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.344..0.346 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.338..0.343 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.182..0.184 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.148..0.149 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.145..0.146 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.200..0.211 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=16.780..16.780 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5056kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.375..10.871 rows=20000 loops=5)
 Planning Time: 26.195 ms
 Execution Time: 22091.139 ms
(50 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=756985.58..756985.58 rows=1 width=58) (actual time=2555.566..2604.333 rows=1 loops=1)
   ->  Sort  (cost=756985.58..756985.64 rows=25 width=58) (actual time=2555.564..2604.330 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=756748.33..756985.45 rows=25 width=58) (actual time=2549.516..2604.313 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=756748.33..756984.39 rows=100 width=58) (actual time=2547.729..2604.276 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=755748.27..755972.42 rows=25 width=58) (actual time=2537.780..2543.494 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=755748.27..755793.04 rows=17907 width=38) (actual time=2536.481..2537.184 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1661kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1414kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1381kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1637kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1457kB
                                 ->  Parallel Hash Join  (cost=72305.94..754483.30 rows=17907 width=38) (actual time=420.957..2527.707 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=68614.34..748441.65 rows=447630 width=50) (actual time=404.191..2393.525 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=68613.77..340656.59 rows=111946 width=38) (actual time=404.139..989.134 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=25820.41..295484.37 rows=559731 width=8) (actual time=243.506..653.714 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=58995
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25260.68 rows=2238924 width=0) (actual time=191.210..191.210 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.86..41855.86 rows=75001 width=38) (actual time=156.751..156.754 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25312kB
                                                         ->  Hash Join  (cost=2.51..41855.86 rows=75001 width=38) (actual time=0.074..127.713 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375006 width=8) (actual time=0.028..86.859 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.037..0.039 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.031..0.037 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.011..0.012 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.015 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.013..0.014 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.990..15.991 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5056kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.024..8.086 rows=20000 loops=5)
 Planning Time: 5.046 ms
 Execution Time: 2604.433 ms
(50 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1286998.52..1286998.53 rows=1 width=32) (actual time=10714.151..10757.078 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1286998.52..1286998.53 rows=1 width=32) (actual time=10714.149..10757.075 rows=1 loops=1)
         ->  Gather  (cost=1286998.09..1286998.50 rows=4 width=32) (actual time=10709.297..10757.056 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1285998.09..1285998.10 rows=1 width=32) (actual time=10701.161..10701.162 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=213283.90..1284506.81 rows=298255 width=12) (actual time=1455.795..10555.632 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79737 lossy=54020
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212985.64 rows=1193019 width=0) (actual time=1370.755..1370.755 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 13.075 ms
 Execution Time: 10758.338 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1286998.52..1286998.53 rows=1 width=32) (actual time=3238.899..3283.263 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1286998.52..1286998.53 rows=1 width=32) (actual time=3238.898..3283.261 rows=1 loops=1)
         ->  Gather  (cost=1286998.09..1286998.50 rows=4 width=32) (actual time=3235.714..3283.242 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1285998.09..1285998.10 rows=1 width=32) (actual time=3231.702..3231.703 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=213283.90..1284506.81 rows=298255 width=12) (actual time=1318.381..3130.370 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=82222 lossy=55523
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..212985.64 rows=1193019 width=0) (actual time=1229.909..1229.910 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.631 ms
 Execution Time: 3283.309 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419866.24..1420923.78 rows=1 width=116) (actual time=25203.986..25210.138 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419866.24..12033403.88 rows=10036 width=116) (actual time=25203.985..25210.135 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419866.24..12032338.67 rows=60978 width=96) (actual time=7101.565..25184.283 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349026
               ->  Nested Loop  (cost=1419865.81..6814379.61 rows=1524438 width=76) (actual time=7096.231..19243.646 rows=363447 loops=1)
                     ->  Gather Merge  (cost=1419865.37..1602393.41 rows=1524438 width=76) (actual time=7095.319..7505.099 rows=363447 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418865.32..1419818.09 rows=381110 width=76) (actual time=7066.964..7107.077 rows=73093 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26224kB
                                 Worker 0:  Sort Method: external merge  Disk: 26384kB
                                 Worker 1:  Sort Method: external merge  Disk: 27536kB
                                 Worker 2:  Sort Method: external merge  Disk: 26488kB
                                 Worker 3:  Sort Method: external merge  Disk: 27312kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372648.96 rows=381110 width=76) (actual time=14.973..6766.967 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350095.38 rows=4578882 width=24) (actual time=0.425..6159.252 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=14.187..14.190 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.325..12.529 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.142..10.035 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.175..0.177 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.166..0.172 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.153..0.155 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.006 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.007 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.032..0.032 rows=1 loops=363447)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.015..0.016 rows=1 loops=363447)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 24.073 ms
 Execution Time: 25214.073 ms
(45 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419866.24..1420923.78 rows=1 width=116) (actual time=5790.133..5795.777 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419866.24..12033403.88 rows=10036 width=116) (actual time=5790.132..5795.775 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1419866.24..12032338.67 rows=60978 width=96) (actual time=3555.810..5782.073 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349063
               ->  Nested Loop  (cost=1419865.81..6814379.61 rows=1524438 width=76) (actual time=3555.446..4759.743 rows=363484 loops=1)
                     ->  Gather Merge  (cost=1419865.37..1602393.41 rows=1524438 width=76) (actual time=3555.403..3792.495 rows=363484 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418865.32..1419818.09 rows=381110 width=76) (actual time=3526.368..3556.107 rows=73082 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 28568kB
                                 Worker 0:  Sort Method: external merge  Disk: 24648kB
                                 Worker 1:  Sort Method: external merge  Disk: 26808kB
                                 Worker 2:  Sort Method: external merge  Disk: 26704kB
                                 Worker 3:  Sort Method: external merge  Disk: 27208kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372648.96 rows=381110 width=76) (actual time=15.118..3186.349 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350095.38 rows=4578882 width=24) (actual time=0.648..2520.923 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=12.861..12.864 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 992kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.066..11.331 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.029..7.697 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.031..0.032 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.022..0.027 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.011..0.013 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.003..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.004..0.006 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363484)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=363484)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 3.559 ms
 Execution Time: 5799.892 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386449.44..393085.47 rows=1 width=64) (actual time=34408.793..34415.383 rows=1 loops=1)
   ->  GroupAggregate  (cost=386449.44..16352727.43 rows=2406 width=64) (actual time=34408.791..34415.381 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386449.44..16352195.03 rows=24214 width=70) (actual time=2182.538..34389.714 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142657
               ->  Nested Loop  (cost=386449.44..16343388.36 rows=24214 width=20) (actual time=2182.516..34348.128 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386449.15..16264175.25 rows=24214 width=20) (actual time=2182.362..33813.669 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386448.72..3817738.56 rows=3645895 width=24) (actual time=2162.030..23158.832 rows=1816453 loops=1)
                                 ->  Gather Merge  (cost=386448.16..495620.77 rows=911788 width=8) (actual time=2161.125..2448.101 rows=454495 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385448.10..386017.97 rows=227947 width=8) (actual time=2147.823..2155.691 rows=92089 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 14765kB
                                             Worker 0:  Sort Method: quicksort  Memory: 14545kB
                                             Worker 1:  Sort Method: quicksort  Memory: 14756kB
                                             Worker 2:  Sort Method: quicksort  Memory: 14540kB
                                             Worker 3:  Sort Method: quicksort  Memory: 14789kB
                                             ->  Parallel Hash Join  (cost=42793.37..365162.71 rows=227947 width=8) (actual time=267.333..2098.075 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317525.47 rows=1139735 width=12) (actual time=0.521..1562.458 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.86..41855.86 rows=75001 width=4) (actual time=266.093..266.096 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41855.86 rows=75001 width=4) (actual time=0.198..248.512 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375006 width=8) (actual time=0.100..210.057 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.093..0.095 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.087..0.093 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.033..0.034 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.050..0.051 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.047..0.048 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.042..0.045 rows=4 loops=454495)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.006..0.006 rows=0 loops=1816453)
                                 Index Cond: (p_partkey = lineitem.l_partkey)
                                 Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                 Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.044..0.044 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.006..0.015 rows=25 loops=1)
 Planning Time: 28.711 ms
 Execution Time: 34415.874 ms
(51 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386449.44..393085.47 rows=1 width=64) (actual time=9191.444..9198.222 rows=1 loops=1)
   ->  GroupAggregate  (cost=386449.44..16352727.43 rows=2406 width=64) (actual time=9191.442..9198.220 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=386449.44..16352195.03 rows=24214 width=70) (actual time=1047.119..9184.224 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142670
               ->  Nested Loop  (cost=386449.44..16343388.36 rows=24214 width=20) (actual time=1047.107..9158.221 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386449.15..16264175.25 rows=24214 width=20) (actual time=1047.086..9116.461 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386448.72..3817738.56 rows=3645895 width=24) (actual time=1046.411..4040.927 rows=1816396 loops=1)
                                 ->  Gather Merge  (cost=386448.16..495620.77 rows=911788 width=8) (actual time=1046.351..1254.630 rows=454479 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385448.10..386017.97 rows=227947 width=8) (actual time=1036.715..1043.132 rows=92083 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 14927kB
                                             Worker 0:  Sort Method: quicksort  Memory: 14996kB
                                             Worker 1:  Sort Method: quicksort  Memory: 14629kB
                                             Worker 2:  Sort Method: quicksort  Memory: 14965kB
                                             Worker 3:  Sort Method: quicksort  Memory: 13879kB
                                             ->  Parallel Hash Join  (cost=42793.37..365162.71 rows=227947 width=8) (actual time=155.082..982.813 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317525.47 rows=1139735 width=12) (actual time=0.040..517.822 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.86..41855.86 rows=75001 width=4) (actual time=154.267..154.270 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41855.86 rows=75001 width=4) (actual time=0.064..132.126 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375006 width=8) (actual time=0.029..92.285 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.030..0.032 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.024..0.030 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.006..0.008 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.014..0.014 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.011..0.012 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.005 rows=4 loops=454479)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1816396)
                                 Index Cond: (p_partkey = lineitem.l_partkey)
                                 Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                 Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.005..0.009 rows=25 loops=1)
 Planning Time: 5.688 ms
 Execution Time: 9198.323 ms
(51 rows)

query 9 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=37339.55..42655.46 rows=1 width=90) (actual time=1844865.187..1844866.395 rows=1 loops=1)
   ->  GroupAggregate  (cost=37339.55..701828.41 rows=125 width=90) (actual time=1844865.186..1844866.393 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=37339.55..701824.35 rows=125 width=81) (actual time=1844855.673..1844857.941 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 34kB  Peak Memory: 34kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 21136kB  Peak Memory: 21136kB
               ->  Nested Loop  (cost=9652.78..701819.40 rows=125 width=81) (actual time=22407.672..1844748.181 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778271746
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=57.563..65.556 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=48.862..49.693 rows=2451 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 6012kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4873kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.291..26.237 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.154..16.928 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.091..0.092 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.082..0.085 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..494270.88 rows=125 width=35) (actual time=0.003..240.805 rows=3247370 loops=3935)
                           ->  Gather  (cost=1001.31..494270.25 rows=125 width=35) (actual time=3.875..37717.202 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..493257.75 rows=31 width=35) (actual time=2.462..38554.857 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..493151.65 rows=31 width=35) (actual time=1.773..27665.340 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..145643.99 rows=100998 width=18) (actual time=1.448..1087.158 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.99 rows=25252 width=4) (actual time=0.637..171.846 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.037..0.041 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.044..0.304 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.016..0.016 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 30.096 ms
 Execution Time: 1844886.385 ms
(42 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=37339.55..42655.46 rows=1 width=90) (actual time=1807116.385..1807117.871 rows=1 loops=1)
   ->  GroupAggregate  (cost=37339.55..701828.41 rows=125 width=90) (actual time=1807116.383..1807117.869 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=37339.55..701824.35 rows=125 width=81) (actual time=1807107.865..1807109.809 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 34kB  Peak Memory: 34kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 21136kB  Peak Memory: 21136kB
               ->  Nested Loop  (cost=9652.78..701819.40 rows=125 width=81) (actual time=10987.877..1806999.233 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778614060
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=51.163..59.247 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=45.592..46.375 rows=2430 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 5931kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4955kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.340..23.148 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.154..13.751 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.092..0.093 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.083..0.086 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..494270.88 rows=125 width=35) (actual time=0.002..233.527 rows=3247457 loops=3935)
                           ->  Gather  (cost=1001.31..494270.25 rows=125 width=35) (actual time=2.004..16269.040 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..493257.75 rows=31 width=35) (actual time=1.371..17106.950 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..493151.65 rows=31 width=35) (actual time=1.325..11246.661 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..145643.99 rows=100998 width=18) (actual time=1.146..722.812 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.99 rows=25252 width=4) (actual time=0.256..164.023 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.72 rows=18 width=14) (actual time=0.022..0.024 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.019..0.119 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.175 ms
 Execution Time: 1807138.927 ms
(42 rows)

query 10 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=958219.56..958219.61 rows=20 width=202) (actual time=21324.913..21373.642 rows=20 loops=1)
   ->  Sort  (cost=958219.56..959650.84 rows=572515 width=202) (actual time=21324.911..21373.638 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=860122.39..942985.14 rows=572515 width=202) (actual time=20226.559..21252.930 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=860122.39..928672.26 rows=572515 width=182) (actual time=20226.539..20497.243 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=859122.33..859480.15 rows=143129 width=182) (actual time=20204.147..20232.406 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 42800kB
                           Worker 0:  Sort Method: external merge  Disk: 46376kB
                           Worker 1:  Sort Method: external merge  Disk: 48904kB
                           Worker 2:  Sort Method: external merge  Disk: 37992kB
                           Worker 3:  Sort Method: external merge  Disk: 42464kB
                           ->  Hash Join  (cost=803558.67..846865.51 rows=143129 width=182) (actual time=19712.140..20055.655 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=803557.11..846424.54 rows=143129 width=160) (actual time=19712.024..20002.628 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375006 width=148) (actual time=0.475..129.912 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=801768.00..801768.00 rows=143129 width=16) (actual time=19710.385..19710.386 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85216kB
                                             ->  Nested Loop  (cost=6769.47..801768.00 rows=143129 width=16) (actual time=136.268..19541.263 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6768.90..270237.68 rows=146719 width=8) (actual time=135.573..2289.827 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46580
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6622.19 rows=586875 width=0) (actual time=87.699..87.699 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.144..0.149 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.052..0.052 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.044..0.047 rows=25 loops=5)
 Planning Time: 19.955 ms
 Execution Time: 21380.045 ms
(38 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=958219.56..958219.61 rows=20 width=202) (actual time=3719.966..3770.177 rows=20 loops=1)
   ->  Sort  (cost=958219.56..959650.84 rows=572515 width=202) (actual time=3719.965..3770.174 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=860122.39..942985.14 rows=572515 width=202) (actual time=2630.571..3648.700 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=860122.39..928672.26 rows=572515 width=182) (actual time=2630.553..2890.897 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=859122.33..859480.15 rows=143129 width=182) (actual time=2618.884..2646.920 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 31528kB
                           Worker 0:  Sort Method: external merge  Disk: 51776kB
                           Worker 1:  Sort Method: external merge  Disk: 50304kB
                           Worker 2:  Sort Method: external merge  Disk: 42440kB
                           Worker 3:  Sort Method: external merge  Disk: 42480kB
                           ->  Hash Join  (cost=803558.67..846865.51 rows=143129 width=182) (actual time=2192.326..2474.948 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=803557.11..846424.54 rows=143129 width=160) (actual time=2192.225..2417.924 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.07 rows=375006 width=148) (actual time=0.027..64.429 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=801768.00..801768.00 rows=143129 width=16) (actual time=2189.600..2189.602 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6769.47..801768.00 rows=143129 width=16) (actual time=133.783..2064.671 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6768.90..270237.68 rows=146719 width=8) (actual time=133.706..486.955 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46419
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6622.19 rows=586875 width=0) (actual time=84.802..84.802 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.012..0.013 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.021..0.021 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.011..0.014 rows=25 loops=5)
 Planning Time: 2.193 ms
 Execution Time: 3774.701 ms
(38 rows)

query 11 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=437211.34..437211.34 rows=1 width=36) (actual time=3905.709..3924.175 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=193195.04..193195.05 rows=1 width=32) (actual time=148.903..148.983 rows=1 loops=1)
           ->  Gather  (cost=193194.82..193195.03 rows=2 width=32) (actual time=148.301..148.970 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=192194.82..192194.83 rows=1 width=32) (actual time=146.081..146.083 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..191213.30 rows=130869 width=10) (actual time=0.086..118.492 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.076..16.484 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.017..6.624 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 39869  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 30069  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 29987  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..111.14 rows=79 width=14) (actual time=0.003..0.067 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=244016.29..244278.03 rows=104695 width=36) (actual time=3905.708..3924.093 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=203335.72..243492.82 rows=104695 width=36) (actual time=3905.699..3924.084 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=203335.72..236818.51 rows=261738 width=36) (actual time=3402.623..3564.731 rows=313850 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=202335.70..205607.42 rows=130869 width=36) (actual time=3395.958..3496.788 rows=104617 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=202335.70..202662.87 rows=130869 width=14) (actual time=3395.947..3404.007 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 7974kB
                                 Worker 0:  Sort Method: quicksort  Memory: 8233kB
                                 Worker 1:  Sort Method: quicksort  Memory: 8049kB
                                 ->  Nested Loop  (cost=0.87..191213.30 rows=130869 width=14) (actual time=0.771..3355.201 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.306..27.625 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.181..15.151 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 32915  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 33647  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 33363  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.004..0.004 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..111.14 rows=79 width=18) (actual time=0.070..2.472 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 15.534 ms
 Execution Time: 3924.594 ms
(56 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=437211.34..437211.34 rows=1 width=36) (actual time=658.711..675.230 rows=0 loops=1)
   InitPlan 1 (returns $3)
     ->  Finalize Aggregate  (cost=193195.04..193195.05 rows=1 width=32) (actual time=143.484..143.564 rows=1 loops=1)
           ->  Gather  (cost=193194.82..193195.03 rows=2 width=32) (actual time=142.927..143.550 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=192194.82..192194.83 rows=1 width=32) (actual time=140.654..140.656 rows=1 loops=3)
                       ->  Nested Loop  (cost=0.87..191213.30 rows=130869 width=10) (actual time=0.124..113.237 rows=106933 loops=3)
                             ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.112..16.363 rows=1337 loops=3)
                                   ->  Parallel Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.044..6.545 rows=33333 loops=3)
                                   ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                         Cache Key: supplier_1.s_nationkey
                                         Cache Mode: logical
                                         Hits: 43529  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 0:  Hits: 28523  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         Worker 1:  Hits: 27873  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                         ->  Index Scan using nation_pkey on nation nation_1  (cost=0.14..0.91 rows=1 width=4) (actual time=0.002..0.002 rows=0 loops=75)
                                               Index Cond: (n_nationkey = supplier_1.s_nationkey)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 1
                             ->  Index Scan using idx_partsupp_suppkey on partsupp partsupp_1  (cost=0.43..111.14 rows=79 width=14) (actual time=0.003..0.064 rows=80 loops=4010)
                                   Index Cond: (ps_suppkey = supplier_1.s_suppkey)
   ->  Sort  (cost=244016.29..244278.03 rows=104695 width=36) (actual time=658.710..675.148 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=203335.72..243492.82 rows=104695 width=36) (actual time=658.703..675.141 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $3)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=203335.72..236818.51 rows=261738 width=36) (actual time=160.824..323.671 rows=313874 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=202335.70..205607.42 rows=130869 width=36) (actual time=157.846..261.474 rows=104625 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=202335.70..202662.87 rows=130869 width=14) (actual time=157.831..165.979 rows=106933 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: quicksort  Memory: 8158kB
                                 Worker 0:  Sort Method: quicksort  Memory: 8008kB
                                 Worker 1:  Sort Method: quicksort  Memory: 8090kB
                                 ->  Nested Loop  (cost=0.87..191213.30 rows=130869 width=14) (actual time=0.097..130.610 rows=106933 loops=3)
                                       ->  Nested Loop  (cost=0.44..4617.72 rows=1667 width=4) (actual time=0.086..16.841 rows=1337 loops=3)
                                             ->  Parallel Index Scan using supplier_pkey on supplier  (cost=0.29..3552.46 rows=41667 width=8) (actual time=0.027..6.925 rows=33333 loops=3)
                                             ->  Memoize  (cost=0.15..0.92 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=100000)
                                                   Cache Key: supplier.s_nationkey
                                                   Cache Mode: logical
                                                   Hits: 34013  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 0:  Hits: 32549  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   Worker 1:  Hits: 33363  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 2kB
                                                   ->  Index Scan using nation_pkey on nation  (cost=0.14..0.91 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=75)
                                                         Index Cond: (n_nationkey = supplier.s_nationkey)
                                                         Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                         Rows Removed by Filter: 1
                                       ->  Index Scan using idx_partsupp_suppkey on partsupp  (cost=0.43..111.14 rows=79 width=18) (actual time=0.004..0.076 rows=80 loops=4010)
                                             Index Cond: (ps_suppkey = supplier.s_suppkey)
 Planning Time: 1.086 ms
 Execution Time: 675.314 ms
(56 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469217.78..1611721.91 rows=1 width=27) (actual time=13372.793..13373.830 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469217.78..2466746.67 rows=7 width=27) (actual time=13372.792..13373.828 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469217.78..2461836.65 rows=280569 width=27) (actual time=6933.576..13289.534 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469217.35..1502811.17 rows=280569 width=15) (actual time=6932.688..7004.085 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468217.29..1468392.64 rows=70142 width=15) (actual time=6922.960..6925.557 rows=32241 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 4421kB
                           Worker 0:  Sort Method: quicksort  Memory: 4514kB
                           Worker 1:  Sort Method: quicksort  Memory: 4414kB
                           Worker 2:  Sort Method: quicksort  Memory: 4438kB
                           Worker 3:  Sort Method: quicksort  Memory: 4486kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462571.56 rows=70142 width=15) (actual time=0.725..6905.286 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.040..0.040 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 15.429 ms
 Execution Time: 13374.216 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469217.78..1611721.91 rows=1 width=27) (actual time=3957.326..3958.540 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469217.78..2466746.67 rows=7 width=27) (actual time=3957.325..3958.539 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469217.78..2461836.65 rows=280569 width=27) (actual time=3493.626..3909.997 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469217.35..1502811.17 rows=280569 width=15) (actual time=3493.591..3531.130 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468217.29..1468392.64 rows=70142 width=15) (actual time=3486.935..3488.937 rows=32163 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 4338kB
                           Worker 0:  Sort Method: quicksort  Memory: 6190kB
                           Worker 1:  Sort Method: quicksort  Memory: 4563kB
                           Worker 2:  Sort Method: quicksort  Memory: 4292kB
                           Worker 3:  Sort Method: quicksort  Memory: 4426kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462571.56 rows=70142 width=15) (actual time=0.101..3469.432 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.840 ms
 Execution Time: 3958.594 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1370000.69..1370000.70 rows=1 width=16) (actual time=18293.377..18293.380 rows=1 loops=1)
   ->  Sort  (cost=1370000.69..1370001.19 rows=200 width=16) (actual time=18293.376..18293.378 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369997.69..1369999.69 rows=200 width=16) (actual time=18293.349..18293.356 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215305.71..1347497.30 rows=1500026 width=12) (actual time=15592.832..18124.634 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53285.14..664506.43 rows=15000491 width=8) (actual time=346.462..11242.142 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448792.89 rows=15000491 width=8) (actual time=0.452..5057.407 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.82..28674.82 rows=1500026 width=4) (actual time=344.612..344.613 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.82 rows=1500026 width=4) (actual time=0.020..160.080 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 14.477 ms
 Execution Time: 18346.388 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1370000.69..1370000.70 rows=1 width=16) (actual time=17732.072..17732.075 rows=1 loops=1)
   ->  Sort  (cost=1370000.69..1370001.19 rows=200 width=16) (actual time=17732.071..17732.073 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1369997.69..1369999.69 rows=200 width=16) (actual time=17732.043..17732.051 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1215305.71..1347497.30 rows=1500026 width=12) (actual time=15012.645..17560.354 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53285.14..664506.43 rows=15000491 width=8) (actual time=310.912..10679.343 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448792.89 rows=15000491 width=8) (actual time=0.032..4586.086 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.82..28674.82 rows=1500026 width=4) (actual time=309.272..309.273 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.82 rows=1500026 width=4) (actual time=0.019..128.535 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.641 ms
 Execution Time: 17787.505 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=805710.02..805710.04 rows=1 width=32) (actual time=5332.115..5376.051 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=805710.02..805710.04 rows=1 width=32) (actual time=5332.114..5376.048 rows=1 loops=1)
         ->  Gather  (cost=805709.57..805709.98 rows=4 width=64) (actual time=5329.755..5376.027 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=804709.57..804709.58 rows=1 width=64) (actual time=5319.060..5319.063 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=63567.15..801616.51 rows=176746 width=33) (actual time=703.962..5158.422 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=11336.15..748921.55 rows=176746 width=16) (actual time=294.092..4582.286 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=82496
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11159.41 rows=706984 width=0) (actual time=193.395..193.396 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45981.00..45981.00 rows=500000 width=25) (actual time=407.705..407.706 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45981.00 rows=500000 width=25) (actual time=0.365..268.860 rows=400000 loops=5)
 Planning Time: 18.940 ms
 Execution Time: 5376.803 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=805710.02..805710.04 rows=1 width=32) (actual time=1725.695..1788.705 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=805710.02..805710.04 rows=1 width=32) (actual time=1725.693..1788.702 rows=1 loops=1)
         ->  Gather  (cost=805709.57..805709.98 rows=4 width=64) (actual time=1720.907..1788.675 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=804709.57..804709.58 rows=1 width=64) (actual time=1715.697..1715.700 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=63567.15..801616.51 rows=176746 width=33) (actual time=558.328..1614.321 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=11336.15..748921.55 rows=176746 width=16) (actual time=273.850..1203.872 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=78625
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..11159.41 rows=706984 width=0) (actual time=174.955..174.955 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45981.00..45981.00 rows=500000 width=25) (actual time=282.425..282.426 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45981.00 rows=500000 width=25) (actual time=0.207..131.299 rows=400000 loops=5)
 Planning Time: 1.470 ms
 Execution Time: 1788.771 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2742003.22..2742110.40 rows=1 width=103) (actual time=13463.430..13524.173 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1389366.65..1389366.66 rows=1 width=32) (actual time=3071.234..3080.219 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1386898.50..1388132.58 rows=98726 width=36) (actual time=2966.883..3074.268 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 48177kB  Disk Usage: 11520kB
                 ->  Gather  (cost=1343212.25..1383936.72 rows=394904 width=36) (actual time=2557.255..2719.826 rows=398558 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1342212.25..1343446.32 rows=98726 width=36) (actual time=2553.293..2679.387 rows=99640 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 5  Memory Usage: 33841kB  Disk Usage: 7536kB
                             Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7320kB
                             Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7344kB
                             Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7368kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=36787.63..1336476.50 rows=573575 width=16) (actual time=438.459..2053.228 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=108760 lossy=72952
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36214.06 rows=2294299 width=0) (actual time=348.056..348.057 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1352636.56..1405579.71 rows=494 width=103) (actual time=13463.428..13515.184 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1352636.27..1404362.63 rows=494 width=36) (actual time=13462.837..13514.593 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1352636.27..1399919.96 rows=394904 width=36) (actual time=10163.034..10283.695 rows=346228 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1351636.21..1351883.02 rows=98726 width=36) (actual time=10116.076..10123.927 rows=69795 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 16979kB
                           Worker 0:  Sort Method: quicksort  Memory: 16974kB
                           Worker 1:  Sort Method: quicksort  Memory: 16992kB
                           Worker 2:  Sort Method: quicksort  Memory: 16981kB
                           Worker 3:  Sort Method: quicksort  Memory: 16986kB
                           ->  Partial HashAggregate  (cost=1342212.25..1343446.32 rows=98726 width=36) (actual time=9946.936..10081.879 rows=98915 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 5  Memory Usage: 33841kB  Disk Usage: 7024kB
                                 Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7008kB
                                 Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7032kB
                                 Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7024kB
                                 Worker 3:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7024kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=36787.63..1336476.50 rows=573575 width=16) (actual time=490.064..9394.671 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79941 lossy=53352
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36214.06 rows=2294299 width=0) (actual time=404.057..404.058 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.584..0.584 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 14.814 ms
 Execution Time: 13529.460 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2742003.22..2742110.40 rows=1 width=103) (actual time=6254.759..6316.136 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1389366.65..1389366.66 rows=1 width=32) (actual time=3075.513..3084.785 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1386898.50..1388132.58 rows=98726 width=36) (actual time=2972.534..3078.823 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 48177kB  Disk Usage: 11488kB
                 ->  Gather  (cost=1343212.25..1383936.72 rows=394904 width=36) (actual time=2562.715..2728.015 rows=398590 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1342212.25..1343446.32 rows=98726 width=36) (actual time=2558.783..2685.000 rows=99648 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 5  Memory Usage: 33841kB  Disk Usage: 7536kB
                             Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7328kB
                             Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7328kB
                             Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7352kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=36787.63..1336476.50 rows=573575 width=16) (actual time=441.985..2059.514 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=108992 lossy=72690
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36214.06 rows=2294299 width=0) (actual time=351.383..351.383 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1352636.56..1405579.71 rows=494 width=103) (actual time=6254.758..6306.861 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1352636.27..1404362.63 rows=494 width=36) (actual time=6254.710..6306.813 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1352636.27..1399919.96 rows=394904 width=36) (actual time=2953.171..3073.382 rows=345979 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1351636.21..1351883.02 rows=98726 width=36) (actual time=2904.389..2912.174 rows=69713 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 16903kB
                           Worker 0:  Sort Method: quicksort  Memory: 16934kB
                           Worker 1:  Sort Method: quicksort  Memory: 17026kB
                           Worker 2:  Sort Method: quicksort  Memory: 16985kB
                           Worker 3:  Sort Method: quicksort  Memory: 17034kB
                           ->  Partial HashAggregate  (cost=1342212.25..1343446.32 rows=98726 width=36) (actual time=2735.918..2871.990 rows=98873 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 5  Memory Usage: 33841kB  Disk Usage: 3808kB
                                 Worker 0:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 6936kB
                                 Worker 1:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7128kB
                                 Worker 2:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7032kB
                                 Worker 3:  Batches: 5  Memory Usage: 33841kB  Disk Usage: 7144kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=36787.63..1336476.50 rows=573575 width=16) (actual time=451.559..2284.421 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=72440 lossy=48325
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..36214.06 rows=2294299 width=0) (actual time=363.606..363.607 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.043..0.044 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.236 ms
 Execution Time: 6321.098 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=252395.28..252395.28 rows=1 width=44) (actual time=2617.713..2626.713 rows=1 loops=1)
   ->  Sort  (cost=252395.28..252781.12 rows=154338 width=44) (actual time=2617.712..2626.711 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172297.28..251623.59 rows=154338 width=44) (actual time=1994.039..2619.987 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172297.28..244084.67 rows=599554 width=40) (actual time=1993.981..2352.888 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171297.23..171671.95 rows=149888 width=40) (actual time=1883.810..1903.568 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 24613kB
                           Worker 0:  Sort Method: quicksort  Memory: 24730kB
                           Worker 1:  Sort Method: quicksort  Memory: 24378kB
                           Worker 2:  Sort Method: quicksort  Memory: 24256kB
                           Worker 3:  Sort Method: quicksort  Memory: 25427kB
                           ->  Parallel Hash Join  (cost=57889.36..158411.71 rows=149888 width=40) (actual time=373.961..1129.884 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101369.12 rows=999880 width=8) (actual time=47.981..605.928 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.842..47.151 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.99..53480.99 rows=74953 width=40) (actual time=325.239..325.240 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.99 rows=74953 width=40) (actual time=0.101..300.313 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 18.266 ms
 Execution Time: 2627.810 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=252395.28..252395.28 rows=1 width=44) (actual time=2231.448..2237.364 rows=1 loops=1)
   ->  Sort  (cost=252395.28..252781.12 rows=154338 width=44) (actual time=2231.446..2237.362 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=172297.28..251623.59 rows=154338 width=44) (actual time=1607.122..2230.851 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=172297.28..244084.67 rows=599554 width=40) (actual time=1607.065..1964.746 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=171297.23..171671.95 rows=149888 width=40) (actual time=1558.159..1577.934 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 23792kB
                           Worker 0:  Sort Method: quicksort  Memory: 24913kB
                           Worker 1:  Sort Method: quicksort  Memory: 25319kB
                           Worker 2:  Sort Method: quicksort  Memory: 24504kB
                           Worker 3:  Sort Method: quicksort  Memory: 24876kB
                           ->  Parallel Hash Join  (cost=57889.36..158411.71 rows=149888 width=40) (actual time=186.003..803.975 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101369.12 rows=999880 width=8) (actual time=27.968..431.984 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.082..27.732 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.99..53480.99 rows=74953 width=40) (actual time=157.350..157.351 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26400kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.99 rows=74953 width=40) (actual time=0.011..123.469 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 1.093 ms
 Execution Time: 2237.444 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3396876.79..3396876.80 rows=1 width=32) (actual time=26301.227..26382.648 rows=1 loops=1)
   ->  Aggregate  (cost=3396876.79..3396876.80 rows=1 width=32) (actual time=26301.226..26382.646 rows=1 loops=1)
         ->  Merge Join  (cost=2274214.19..3396827.28 rows=19802 width=8) (actual time=19148.139..26381.741 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2273213.26..3271474.45 rows=1905302 width=36) (actual time=19139.658..26169.576 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2273213.26..3185735.86 rows=7621208 width=36) (actual time=19139.638..21233.967 rows=9971846 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2272213.20..2276976.46 rows=1905302 width=36) (actual time=18806.488..19116.037 rows=1994882 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 134752kB
                                 Worker 0:  Sort Method: external merge  Disk: 134744kB
                                 Worker 1:  Sort Method: external merge  Disk: 134736kB
                                 Worker 2:  Sort Method: external merge  Disk: 134736kB
                                 Worker 3:  Sort Method: external merge  Disk: 134704kB
                                 ->  Partial HashAggregate  (cost=1869711.93..2039981.57 rows=1905302 width=36) (actual time=9928.295..17809.397 rows=1995035 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 32  Batches: 33  Memory Usage: 34065kB  Disk Usage: 423688kB
                                       Worker 0:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 424984kB
                                       Worker 1:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 423512kB
                                       Worker 2:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 423544kB
                                       Worker 3:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 423368kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275111.25 rows=14996825 width=9) (actual time=0.846..3808.888 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..100638.10 rows=62357 width=21) (actual time=5.873..58.952 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..100482.21 rows=62357 width=21) (actual time=5.867..51.637 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..92054.83 rows=15589 width=21) (actual time=2.102..485.741 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.41 rows=520 width=4) (actual time=0.720..192.145 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.43 rows=31 width=17) (actual time=0.349..0.579 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 14.748 ms
 Execution Time: 26451.007 ms
(38 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3396876.79..3396876.80 rows=1 width=32) (actual time=24868.705..24957.365 rows=1 loops=1)
   ->  Aggregate  (cost=3396876.79..3396876.80 rows=1 width=32) (actual time=24868.703..24957.362 rows=1 loops=1)
         ->  Merge Join  (cost=2274214.19..3396827.28 rows=19802 width=8) (actual time=17825.713..24956.605 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2273213.26..3271474.45 rows=1905302 width=36) (actual time=17819.737..24778.615 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2273213.26..3185735.86 rows=7621208 width=36) (actual time=17819.716..19893.731 rows=9972157 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2272213.20..2276976.46 rows=1905302 width=36) (actual time=17489.773..17801.320 rows=1994943 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 134624kB
                                 Worker 0:  Sort Method: external merge  Disk: 134776kB
                                 Worker 1:  Sort Method: external merge  Disk: 134824kB
                                 Worker 2:  Sort Method: external merge  Disk: 134728kB
                                 Worker 3:  Sort Method: external merge  Disk: 134736kB
                                 ->  Partial HashAggregate  (cost=1869711.93..2039981.57 rows=1905302 width=36) (actual time=8580.060..16456.404 rows=1995097 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 32  Batches: 33  Memory Usage: 34065kB  Disk Usage: 422952kB
                                       Worker 0:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 431120kB
                                       Worker 1:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 455896kB
                                       Worker 2:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 423416kB
                                       Worker 3:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 423544kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275111.25 rows=14996825 width=9) (actual time=0.062..1636.583 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..100638.10 rows=62357 width=21) (actual time=3.674..24.749 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..100482.21 rows=62357 width=21) (actual time=3.668..18.003 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..92054.83 rows=15589 width=21) (actual time=0.211..124.524 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.41 rows=520 width=4) (actual time=0.187..105.666 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.43 rows=31 width=17) (actual time=0.005..0.033 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.917 ms
 Execution Time: 25023.766 ms
(38 rows)

query 18 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8774924.76..8774925.01 rows=100 width=71) (actual time=42328.070..42328.084 rows=99 loops=1)
   ->  Sort  (cost=8774924.76..8824896.96 rows=19988882 width=71) (actual time=42328.069..42328.076 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409735.97..8010964.06 rows=19988882 width=71) (actual time=42327.580..42327.991 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3153kB
               ->  Hash Join  (cost=78564.10..6332991.11 rows=19988882 width=44) (actual time=4379.314..42327.187 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=76.51..5919956.57 rows=19988882 width=25) (actual time=1003.204..41547.424 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390354.91 rows=4998942 width=24) (actual time=767.070..30197.664 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547995.30 rows=15001991 width=20) (actual time=0.405..2980.470 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692378.44 rows=4998942 width=4) (actual time=659.510..26323.423 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167489.56 rows=59987300 width=9) (actual time=0.470..12425.450 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167489.56 rows=59987300 width=9) (actual time=0.013..7873.153 rows=59916431 loops=1)
                     ->  Hash  (cost=50947.26..50947.26 rows=1500026 width=23) (actual time=674.905..674.906 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50947.26 rows=1500026 width=23) (actual time=0.559..417.565 rows=1500000 loops=1)
 Planning Time: 21.195 ms
 Execution Time: 42328.830 ms
(25 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8774924.76..8774925.01 rows=100 width=71) (actual time=38936.630..38936.643 rows=99 loops=1)
   ->  Sort  (cost=8774924.76..8824896.96 rows=19988882 width=71) (actual time=38936.628..38936.636 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409735.97..8010964.06 rows=19988882 width=71) (actual time=38936.146..38936.551 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3153kB
               ->  Hash Join  (cost=78564.10..6332991.11 rows=19988882 width=44) (actual time=3799.438..38935.755 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=76.51..5919956.57 rows=19988882 width=25) (actual time=872.868..38285.466 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390354.91 rows=4998942 width=24) (actual time=634.933..26960.266 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547995.30 rows=15001991 width=20) (actual time=0.019..2391.952 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692378.44 rows=4998942 width=4) (actual time=555.530..23699.145 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167489.56 rows=59987300 width=9) (actual time=0.013..10039.125 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167489.56 rows=59987300 width=9) (actual time=0.014..7852.843 rows=59916431 loops=1)
                     ->  Hash  (cost=50947.26..50947.26 rows=1500026 width=23) (actual time=545.920..545.921 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50947.26 rows=1500026 width=23) (actual time=0.024..291.727 rows=1500000 loops=1)
 Planning Time: 2.095 ms
 Execution Time: 38937.161 ms
(25 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=122764.66..122764.67 rows=1 width=32) (actual time=5096.571..5107.719 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=122764.66..122764.67 rows=1 width=32) (actual time=5096.569..5107.717 rows=1 loops=1)
         ->  Gather  (cost=122764.22..122764.63 rows=4 width=32) (actual time=5087.064..5107.694 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=121764.22..121764.23 rows=1 width=32) (actual time=5080.479..5080.480 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..121762.15 rows=276 width=12) (actual time=49.029..5079.847 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.98 rows=1181 width=30) (actual time=0.773..177.397 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..50.40 rows=1 width=21) (actual time=4.626..5.125 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 18.741 ms
 Execution Time: 5108.049 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=122764.66..122764.67 rows=1 width=32) (actual time=214.061..244.289 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=122764.66..122764.67 rows=1 width=32) (actual time=214.060..244.287 rows=1 loops=1)
         ->  Gather  (cost=122764.22..122764.63 rows=4 width=32) (actual time=213.362..244.274 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=121764.22..121764.23 rows=1 width=32) (actual time=208.167..208.168 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..121762.15 rows=276 width=12) (actual time=1.218..207.977 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.98 rows=1181 width=30) (actual time=0.107..131.980 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..50.40 rows=1 width=21) (actual time=0.070..0.079 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.049 ms
 Execution Time: 244.342 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470745.55..2721334.93 rows=1 width=51) (actual time=27948.333..27949.519 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2470745.55..2721334.93 rows=1 width=51) (actual time=27948.332..27949.517 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 12329
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=26.313..27.434 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=20.480..20.496 rows=391 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 418kB
                     Worker 0:  Sort Method: quicksort  Memory: 234kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.270..19.060 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.138..13.998 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.083..0.083 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.078..0.080 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2466622.61..2716576.12 rows=3 width=8) (actual time=26443.084..27921.081 rows=12330 loops=1)
               ->  Hash Join  (cost=2466622.61..2716576.11 rows=3 width=8) (actual time=26443.080..27918.493 rows=12330 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 25
                     ->  HashAggregate  (cost=2390159.14..2554532.49 rows=4890286 width=40) (actual time=25004.663..26301.336 rows=1144758 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 64  Batches: 117  Memory Usage: 34321kB  Disk Usage: 388616kB
                           ->  Bitmap Heap Scan on lineitem  (cost=149439.67..1997320.86 rows=9320352 width=13) (actual time=1261.146..20001.023 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..147109.59 rows=9320352 width=0) (actual time=1140.711..1140.711 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75251.51..75251.51 rows=80798 width=16) (actual time=1438.287..1438.349 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75251.51 rows=80798 width=16) (actual time=1.736..1416.632 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.71 rows=20200 width=16) (actual time=1.408..1423.728 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.99 rows=5050 width=4) (actual time=0.699..146.319 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.274..0.292 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 20.533 ms
 Execution Time: 27994.497 ms
(46 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470745.55..2721334.93 rows=1 width=51) (actual time=15018.329..15019.680 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2470745.55..2721334.93 rows=1 width=51) (actual time=15018.328..15019.677 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 12329
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=17.598..18.894 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=15.787..15.804 rows=392 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 374kB
                     Worker 0:  Sort Method: quicksort  Memory: 278kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.096..14.387 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.018..9.453 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.017..0.018 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.013..0.015 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2466622.61..2716576.12 rows=3 width=8) (actual time=13516.236..14999.791 rows=12330 loops=1)
               ->  Hash Join  (cost=2466622.61..2716576.11 rows=3 width=8) (actual time=13516.232..14997.185 rows=12330 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 25
                     ->  HashAggregate  (cost=2390159.14..2554532.49 rows=4890286 width=40) (actual time=13315.191..14613.981 rows=1144758 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 64  Batches: 117  Memory Usage: 34321kB  Disk Usage: 388616kB
                           ->  Bitmap Heap Scan on lineitem  (cost=149439.67..1997320.86 rows=9320352 width=13) (actual time=1120.220..9205.718 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..147109.59 rows=9320352 width=0) (actual time=1000.658..1000.658 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75251.51..75251.51 rows=80798 width=16) (actual time=200.908..200.960 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75251.51 rows=80798 width=16) (actual time=0.346..183.564 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66171.71 rows=20200 width=16) (actual time=0.096..183.021 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.99 rows=5050 width=4) (actual time=0.052..110.356 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.57 rows=18 width=12) (actual time=0.014..0.016 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.465 ms
 Execution Time: 15070.936 ms
(46 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1968605.61..1968605.62 rows=1 width=34) (actual time=11382.429..11394.861 rows=100 loops=1)
   ->  Sort  (cost=1968605.61..1968605.62 rows=1 width=34) (actual time=11382.428..11394.853 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=1968602.39..1968605.60 rows=1 width=34) (actual time=10834.315..11392.427 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1968602.39..1968605.59 rows=1 width=26) (actual time=10834.141..11380.607 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1968601.82..1968601.95 rows=1 width=38) (actual time=10834.094..10881.886 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1967601.77..1967601.77 rows=1 width=38) (actual time=10808.354..10810.201 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1390kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1420kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1465kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1417kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1383kB
                                 ->  Nested Loop Anti Join  (cost=1338046.20..1967601.76 rows=1 width=38) (actual time=7083.749..10733.031 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338045.63..1653324.06 rows=97879 width=38) (actual time=7081.872..8842.448 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308149.22 rows=1835868 width=4) (actual time=0.604..1240.254 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335546.16..1335546.16 rows=199958 width=34) (actual time=7080.140..7080.466 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131424kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335546.16 rows=199958 width=34) (actual time=16.386..6908.706 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312603.31 rows=4998942 width=8) (actual time=0.400..6065.348 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=15.789..15.791 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.139..15.437 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.079..13.109 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.051..0.052 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.048..0.049 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.012..0.012 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.007..0.007 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 19.980 ms
 Execution Time: 11395.257 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1968605.61..1968605.62 rows=1 width=34) (actual time=6901.479..6915.328 rows=100 loops=1)
   ->  Sort  (cost=1968605.61..1968605.62 rows=1 width=34) (actual time=6901.478..6915.320 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=1968602.39..1968605.60 rows=1 width=34) (actual time=6405.414..6912.973 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1968602.39..1968605.59 rows=1 width=26) (actual time=6405.261..6901.348 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1968601.82..1968601.95 rows=1 width=38) (actual time=6405.187..6453.086 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1967601.77..1967601.77 rows=1 width=38) (actual time=6379.068..6381.017 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1409kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1451kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1363kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1470kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1383kB
                                 ->  Nested Loop Anti Join  (cost=1338046.20..1967601.76 rows=1 width=38) (actual time=3896.838..6304.377 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338045.63..1653324.06 rows=97879 width=38) (actual time=3896.475..5086.154 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308149.22 rows=1835868 width=4) (actual time=0.039..602.168 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335546.16..1335546.16 rows=199958 width=34) (actual time=3893.968..3894.388 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131360kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335546.16 rows=199958 width=34) (actual time=11.666..3700.516 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312603.31 rows=4998942 width=8) (actual time=0.043..2766.680 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=10.280..10.282 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 384kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.053..9.968 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.026..6.329 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.017..0.018 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.014..0.015 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 3.636 ms
 Execution Time: 6915.431 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93877.21..93879.01 rows=1 width=72) (actual time=1676.176..1681.413 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46821.20..46821.21 rows=1 width=32) (actual time=331.669..331.769 rows=1 loops=1)
           ->  Gather  (cost=46820.77..46821.18 rows=4 width=32) (actual time=331.648..331.757 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.77..45820.78 rows=1 width=32) (actual time=320.075..320.076 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.92 rows=11939 width=6) (actual time=0.110..311.616 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.99..59890.92 rows=7136 width=72) (actual time=1676.175..1681.311 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.99..59712.52 rows=7136 width=38) (actual time=511.319..1674.842 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.56..49150.91 rows=17500 width=26) (actual time=509.985..532.778 rows=27130 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 4
                     ->  Sort  (cost=46055.50..46066.44 rows=4375 width=26) (actual time=173.269..174.062 rows=6268 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 5542kB
                           Worker 0:  Sort Method: quicksort  Memory: 2568kB
                           Worker 1:  Sort Method: quicksort  Memory: 5221kB
                           Worker 2:  Sort Method: quicksort  Memory: 2564kB
                           Worker 3:  Sort Method: quicksort  Memory: 5183kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.92 rows=4375 width=26) (actual time=0.017..158.560 rows=38226 loops=5)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.041..0.041 rows=1 loops=27130)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 16.320 ms
 Execution Time: 1682.215 ms
(32 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93877.21..93879.01 rows=1 width=72) (actual time=445.017..450.438 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46821.20..46821.21 rows=1 width=32) (actual time=208.283..208.379 rows=1 loops=1)
           ->  Gather  (cost=46820.77..46821.18 rows=4 width=32) (actual time=208.262..208.368 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.77..45820.78 rows=1 width=32) (actual time=202.459..202.460 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.92 rows=11939 width=6) (actual time=0.019..192.914 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.99..59890.92 rows=7136 width=72) (actual time=445.016..450.340 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47055.99..59712.52 rows=7136 width=38) (actual time=382.282..448.359 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.56..49150.91 rows=17500 width=26) (actual time=382.227..394.957 rows=27129 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 3
                     ->  Sort  (cost=46055.50..46066.44 rows=4375 width=26) (actual time=168.537..169.277 rows=7504 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 5492kB
                           Worker 0:  Sort Method: quicksort  Memory: 5178kB
                           Worker 1:  Sort Method: quicksort  Memory: 5204kB
                           Worker 2:  Sort Method: quicksort  Memory: 5203kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.92 rows=4375 width=26) (actual time=0.017..152.578 rows=47782 loops=4)
                                 Filter: ((c_acctbal > $1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.16 rows=17 width=4) (actual time=0.002..0.002 rows=1 loops=27129)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 0.788 ms
 Execution Time: 450.503 ms
(31 rows)

