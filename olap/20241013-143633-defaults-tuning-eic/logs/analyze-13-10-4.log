query 1 run 1
SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1905582.04..1905582.71 rows=1 width=236) (actual time=21864.460..21864.538 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1905582.04..1905586.09 rows=6 width=236) (actual time=21864.459..21864.536 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1905582.04..1905584.91 rows=24 width=236) (actual time=21864.420..21864.502 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1904581.98..1904581.99 rows=6 width=236) (actual time=21855.843..21855.844 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1904581.74..1904581.90 rows=6 width=236) (actual time=21855.492..21855.500 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312593.57 rows=14799704 width=25) (actual time=0.101..5292.822 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 14.037 ms
 Execution Time: 21864.890 ms
(25 rows)

SET
SET
SET
                                                                           QUERY PLAN                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1905582.04..1905582.71 rows=1 width=236) (actual time=19006.929..19006.995 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1905582.04..1905586.09 rows=6 width=236) (actual time=19006.928..19006.994 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1905582.04..1905584.91 rows=24 width=236) (actual time=19006.866..19006.934 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1904581.98..1904581.99 rows=6 width=236) (actual time=19001.884..19001.885 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     Worker 2:  Sort Method: quicksort  Memory: 27kB
                     Worker 3:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=1904581.74..1904581.90 rows=6 width=236) (actual time=19001.856..19001.864 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312593.57 rows=14799704 width=25) (actual time=0.026..2628.268 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 0.583 ms
 Execution Time: 19007.062 ms
(25 rows)

query 2 run 1
SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1090306.84..1090306.84 rows=1 width=192) (actual time=4208.383..4208.506 rows=100 loops=1)
   ->  Sort  (cost=1090306.84..1090306.84 rows=1 width=192) (actual time=4208.382..4208.499 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=559179.69..1090306.83 rows=1 width=192) (actual time=3187.147..4205.798 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68677.53 rows=8103 width=30) (actual time=12.213..16.087 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.32 rows=2026 width=30) (actual time=2.103..322.039 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558178.03..566180.86 rows=1600567 width=172) (actual time=3173.836..3631.638 rows=1603828 loops=1)
                     ->  Sort  (cost=558178.03..562179.44 rows=1600567 width=172) (actual time=3173.831..3448.142 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305315.13 rows=1600567 width=172) (actual time=65.015..2503.830 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255250.33 rows=8002833 width=14) (actual time=0.384..1091.988 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=64.597..64.600 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=2.452..56.732 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=1.748..41.002 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.694..0.696 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.688..0.693 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.512..0.513 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.164..0.165 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.160..0.161 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.59..69.60 rows=1 width=32) (actual time=0.059..0.059 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.58 rows=4 width=6) (actual time=0.048..0.056 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.28 rows=19 width=10) (actual time=0.043..0.054 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.66 rows=19 width=10) (actual time=0.042..0.053 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.039..0.040 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.012..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.007 rows=25 loops=1)
 Planning Time: 20.649 ms
 Execution Time: 4244.612 ms
(56 rows)

SET
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1090306.84..1090306.84 rows=1 width=192) (actual time=3435.809..3435.934 rows=100 loops=1)
   ->  Sort  (cost=1090306.84..1090306.84 rows=1 width=192) (actual time=3435.808..3435.926 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 71kB
         ->  Merge Join  (cost=559179.69..1090306.83 rows=1 width=192) (actual time=2703.497..3433.689 rows=4737 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 1661
               ->  Gather Merge  (cost=1000.49..68677.53 rows=8103 width=30) (actual time=4.754..7.321 rows=8046 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.32 rows=2026 width=30) (actual time=0.158..123.008 rows=1609 loops=5)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                           Rows Removed by Filter: 398391
               ->  Materialize  (cost=558178.03..566180.86 rows=1600567 width=172) (actual time=2698.645..3140.611 rows=1603828 loops=1)
                     ->  Sort  (cost=558178.03..562179.44 rows=1600567 width=172) (actual time=2698.641..2961.381 rows=1603828 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 293496kB
                           ->  Hash Join  (cost=4048.51..305315.13 rows=1600567 width=172) (actual time=29.660..2046.394 rows=1604080 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Seq Scan on partsupp  (cost=0.00..255250.33 rows=8002833 width=14) (actual time=0.048..777.240 rows=8000000 loops=1)
                                 ->  Hash  (cost=3798.51..3798.51 rows=20000 width=166) (actual time=29.579..29.582 rows=20051 loops=1)
                                       Buckets: 32768  Batches: 1  Memory Usage: 4211kB
                                       ->  Hash Join  (cost=2.51..3798.51 rows=20000 width=166) (actual time=0.048..23.670 rows=20051 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Seq Scan on supplier  (cost=0.00..3221.00 rows=100000 width=144) (actual time=0.012..7.885 rows=100000 loops=1)
                                             ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.032..0.033 rows=5 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.025..0.032 rows=5 loops=1)
                                                         Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                         ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.008..0.009 rows=25 loops=1)
                                                         ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.013..0.013 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.010..0.011 rows=1 loops=1)
                                                                     Filter: (r_name = 'AMERICA'::bpchar)
                                                                     Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=69.59..69.60 rows=1 width=32) (actual time=0.017..0.017 rows=1 loops=6398)
                       ->  Nested Loop  (cost=2.29..69.58 rows=4 width=6) (actual time=0.009..0.015 rows=2 loops=6398)
                             Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                             Rows Removed by Join Filter: 2
                             ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=6398)
                                   Filter: (r_name = 'AMERICA'::bpchar)
                                   Rows Removed by Filter: 4
                             ->  Hash Join  (cost=2.29..68.28 rows=19 width=10) (actual time=0.005..0.013 rows=4 loops=6398)
                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                   ->  Nested Loop  (cost=0.72..66.66 rows=19 width=10) (actual time=0.005..0.012 rows=4 loops=6398)
                                         ->  Index Scan using idx_partsupp_partkey on partsupp partsupp_1  (cost=0.43..3.77 rows=19 width=10) (actual time=0.003..0.003 rows=4 loops=6398)
                                               Index Cond: (ps_partkey = part.p_partkey)
                                         ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.29..3.31 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25592)
                                               Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                   ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.011..0.012 rows=25 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.003..0.006 rows=25 loops=1)
 Planning Time: 1.975 ms
 Execution Time: 3473.832 ms
(56 rows)

query 3 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2307872.03..2307872.06 rows=10 width=44) (actual time=14160.391..14195.845 rows=10 loops=1)
   ->  Sort  (cost=2307872.03..2315817.10 rows=3178028 width=44) (actual time=14160.390..14195.842 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1771280.18..2239195.99 rows=3178028 width=44) (actual time=13925.097..14174.150 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1771280.18..2151800.22 rows=3178028 width=24) (actual time=13925.083..14012.692 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1770280.12..1772266.39 rows=794507 width=24) (actual time=13915.263..13918.190 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 6220kB
                           Worker 0:  Sort Method: quicksort  Memory: 6280kB
                           Worker 1:  Sort Method: quicksort  Memory: 6220kB
                           Worker 2:  Sort Method: quicksort  Memory: 6254kB
                           Worker 3:  Sort Method: quicksort  Memory: 6266kB
                           ->  Nested Loop  (cost=41589.67..1681943.62 rows=794507 width=24) (actual time=293.409..13890.636 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41589.10..354443.76 rows=365440 width=12) (actual time=291.283..2011.748 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308144.60 rows=1794305 width=16) (actual time=0.429..1222.578 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.43..40634.43 rows=76374 width=4) (actual time=290.047..290.048 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.43 rows=76374 width=4) (actual time=0.121..271.106 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.040..0.041 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 21.820 ms
 Execution Time: 14197.433 ms
(33 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2307872.03..2307872.06 rows=10 width=44) (actual time=4127.036..4162.235 rows=10 loops=1)
   ->  Sort  (cost=2307872.03..2315817.10 rows=3178028 width=44) (actual time=4127.034..4162.232 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1771280.18..2239195.99 rows=3178028 width=44) (actual time=3894.985..4140.297 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1771280.18..2151800.22 rows=3178028 width=24) (actual time=3894.971..3979.680 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1770280.12..1772266.39 rows=794507 width=24) (actual time=3887.763..3890.710 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 6239kB
                           Worker 0:  Sort Method: quicksort  Memory: 6168kB
                           Worker 1:  Sort Method: quicksort  Memory: 6302kB
                           Worker 2:  Sort Method: quicksort  Memory: 6335kB
                           Worker 3:  Sort Method: quicksort  Memory: 6196kB
                           ->  Nested Loop  (cost=41589.67..1681943.62 rows=794507 width=24) (actual time=134.342..3867.755 rows=60306 loops=5)
                                 ->  Parallel Hash Join  (cost=41589.10..354443.76 rows=365440 width=12) (actual time=134.006..1075.541 rows=290361 loops=5)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       ->  Parallel Seq Scan on orders  (cost=0.00..308144.60 rows=1794305 width=16) (actual time=0.039..490.232 rows=1447887 loops=5)
                                             Filter: (o_orderdate < '1995-03-07'::date)
                                             Rows Removed by Filter: 1552113
                                       ->  Parallel Hash  (cost=40634.43..40634.43 rows=76374 width=4) (actual time=133.157..133.158 rows=60055 loops=5)
                                             Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                             ->  Parallel Seq Scan on customer  (cost=0.00..40634.43 rows=76374 width=4) (actual time=0.028..110.252 rows=60055 loops=5)
                                                   Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                   Rows Removed by Filter: 239945
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=2 width=16) (actual time=0.009..0.009 rows=0 loops=1451805)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 4
 Planning Time: 1.577 ms
 Execution Time: 4162.535 ms
(33 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282961.45..656572.41 rows=1 width=24) (actual time=28536.103..28561.183 rows=1 loops=1)
   ->  GroupAggregate  (cost=282961.45..2151016.23 rows=5 width=24) (actual time=28536.102..28561.181 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282961.45..2148195.33 rows=564171 width=16) (actual time=4221.209..28478.502 rows=103030 loops=1)
               ->  Gather Merge  (cost=282960.88..350531.81 rows=564339 width=20) (actual time=4220.267..4358.068 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281960.83..282313.54 rows=141085 width=20) (actual time=4208.755..4212.187 rows=23222 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 11947kB
                           Worker 0:  Sort Method: quicksort  Memory: 11747kB
                           Worker 1:  Sort Method: quicksort  Memory: 11936kB
                           Worker 2:  Sort Method: quicksort  Memory: 11822kB
                           Worker 3:  Sort Method: quicksort  Memory: 11693kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6509.41..269893.68 rows=141085 width=20) (actual time=133.530..4156.965 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=46950
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6368.33 rows=564339 width=0) (actual time=86.997..86.998 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.213..0.213 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 16.224 ms
 Execution Time: 28562.003 ms
(25 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282961.45..656572.41 rows=1 width=24) (actual time=1713.543..1736.937 rows=1 loops=1)
   ->  GroupAggregate  (cost=282961.45..2151016.23 rows=5 width=24) (actual time=1713.542..1736.935 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282961.45..2148195.33 rows=564171 width=16) (actual time=725.376..1714.582 rows=103030 loops=1)
               ->  Gather Merge  (cost=282960.88..350531.81 rows=564339 width=20) (actual time=725.327..785.672 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281960.83..282313.54 rows=141085 width=20) (actual time=716.582..719.008 rows=23274 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 12355kB
                           Worker 0:  Sort Method: quicksort  Memory: 11440kB
                           Worker 1:  Sort Method: quicksort  Memory: 12835kB
                           Worker 2:  Sort Method: quicksort  Memory: 11097kB
                           Worker 3:  Sort Method: quicksort  Memory: 11419kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6509.41..269893.68 rows=141085 width=20) (actual time=131.864..675.939 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=49322
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6368.33 rows=564339 width=0) (actual time=82.909..82.909 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Filter: (l_commitdate < l_receiptdate)
                     Rows Removed by Filter: 1
 Planning Time: 0.950 ms
 Execution Time: 1737.004 ms
(25 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=766678.44..766678.44 rows=1 width=58) (actual time=22533.308..22582.516 rows=1 loops=1)
   ->  Sort  (cost=766678.44..766678.50 rows=25 width=58) (actual time=22533.307..22582.513 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=766436.38..766678.31 rows=25 width=58) (actual time=22521.290..22582.497 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=766436.38..766677.25 rows=100 width=58) (actual time=22519.811..22582.458 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=765436.32..765665.28 rows=25 width=58) (actual time=22506.448..22512.461 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=765436.32..765482.05 rows=18292 width=38) (actual time=22505.135..22505.842 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1515kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1518kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1511kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1508kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1499kB
                                 ->  Parallel Hash Join  (cost=72864.88..764141.35 rows=18292 width=38) (actual time=567.552..22491.143 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69173.29..758048.77 rows=457330 width=50) (actual time=547.198..22318.566 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69172.72..341448.50 rows=114366 width=38) (actual time=546.391..2653.028 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26379.57..296225.05 rows=571832 width=8) (actual time=263.066..2140.850 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52186
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25807.74 rows=2287330 width=0) (actual time=202.989..202.990 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.67..41855.67 rows=74999 width=38) (actual time=282.447..282.450 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41855.67 rows=74999 width=38) (actual time=2.091..256.513 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.94 rows=374994 width=8) (actual time=0.847..216.437 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=1.183..1.185 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=1.177..1.183 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=1.058..1.059 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.107..0.108 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.102..0.103 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.204..0.215 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=15.725..15.726 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5088kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.096..9.529 rows=20000 loops=5)
 Planning Time: 23.157 ms
 Execution Time: 22583.563 ms
(50 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=766678.44..766678.44 rows=1 width=58) (actual time=2639.519..2686.897 rows=1 loops=1)
   ->  Sort  (cost=766678.44..766678.50 rows=25 width=58) (actual time=2639.518..2686.894 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=766436.38..766678.31 rows=25 width=58) (actual time=2630.412..2686.878 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=766436.38..766677.25 rows=100 width=58) (actual time=2629.051..2686.837 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=765436.32..765665.28 rows=25 width=58) (actual time=2618.979..2625.916 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=765436.32..765482.05 rows=18292 width=38) (actual time=2617.675..2618.385 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1413kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1562kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1548kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1538kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1489kB
                                 ->  Parallel Hash Join  (cost=72864.88..764141.35 rows=18292 width=38) (actual time=426.403..2609.445 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69173.29..758048.77 rows=457330 width=50) (actual time=408.796..2475.349 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69172.72..341448.50 rows=114366 width=38) (actual time=408.745..1014.536 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=26379.57..296225.05 rows=571832 width=8) (actual time=251.440..678.585 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=47548
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..25807.74 rows=2287330 width=0) (actual time=191.863..191.864 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41855.67..41855.67 rows=74999 width=38) (actual time=156.756..156.759 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25312kB
                                                         ->  Hash Join  (cost=2.51..41855.67 rows=74999 width=38) (actual time=0.899..125.982 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.94 rows=374994 width=8) (actual time=0.036..87.505 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.801..0.803 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.795..0.801 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.016..0.017 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.773..0.774 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.769..0.770 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=20) (actual time=0.014..0.015 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=16.438..16.438 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5056kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.025..7.494 rows=20000 loops=5)
 Planning Time: 3.838 ms
 Execution Time: 2686.994 ms
(50 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1284415.64..1284415.65 rows=1 width=32) (actual time=10850.269..10894.539 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1284415.64..1284415.65 rows=1 width=32) (actual time=10850.267..10894.536 rows=1 loops=1)
         ->  Gather  (cost=1284415.20..1284415.61 rows=4 width=32) (actual time=10845.210..10894.516 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1283415.20..1283415.21 rows=1 width=32) (actual time=10837.638..10837.640 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=210489.05..1281923.29 rows=298382 width=12) (actual time=1392.166..10692.304 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79919 lossy=53821
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..210190.67 rows=1193530 width=0) (actual time=1299.631..1299.631 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 11.815 ms
 Execution Time: 10895.554 ms
(14 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1284415.64..1284415.65 rows=1 width=32) (actual time=3174.586..3223.576 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1284415.64..1284415.65 rows=1 width=32) (actual time=3174.585..3223.574 rows=1 loops=1)
         ->  Gather  (cost=1284415.20..1284415.61 rows=4 width=32) (actual time=3173.396..3223.560 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1283415.20..1283415.21 rows=1 width=32) (actual time=3169.129..3169.130 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=210489.05..1281923.29 rows=298382 width=12) (actual time=1259.093..3077.414 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=79233 lossy=53820
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..210190.67 rows=1193530 width=0) (actual time=1165.115..1165.115 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 0.775 ms
 Execution Time: 3223.881 ms
(14 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419804.40..1420858.68 rows=1 width=92) (actual time=33380.325..33385.588 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419804.40..12025931.25 rows=10060 width=92) (actual time=33380.323..33385.586 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone)
         ->  Nested Loop  (cost=1419804.40..12024841.19 rows=60934 width=72) (actual time=8749.997..33357.327 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349037
               ->  Nested Loop  (cost=1419803.97..6810460.62 rows=1523348 width=76) (actual time=8721.471..27696.869 rows=363458 loops=1)
                     ->  Gather Merge  (cost=1419803.54..1602201.06 rows=1523348 width=76) (actual time=8720.257..9087.179 rows=363458 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418803.48..1419755.57 rows=380837 width=76) (actual time=8689.700..8727.448 rows=73090 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                                 Sort Method: external merge  Disk: 27352kB
                                 Worker 0:  Sort Method: external merge  Disk: 27400kB
                                 Worker 1:  Sort Method: external merge  Disk: 28624kB
                                 Worker 2:  Sort Method: external merge  Disk: 27256kB
                                 Worker 3:  Sort Method: external merge  Disk: 28976kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372623.40 rows=380837 width=76) (actual time=14.217..8425.159 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350083.69 rows=4575608 width=24) (actual time=0.427..7824.351 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=12.945..12.948 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.247..12.090 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.168..9.526 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.072..0.073 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.062..0.068 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.048..0.050 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.004..0.005 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.005..0.008 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.050..0.050 rows=1 loops=363458)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.015..0.015 rows=1 loops=363458)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 23.576 ms
 Execution Time: 33389.682 ms
(45 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1419804.40..1420858.68 rows=1 width=92) (actual time=5802.602..5809.105 rows=1 loops=1)
   ->  GroupAggregate  (cost=1419804.40..12025931.25 rows=10060 width=92) (actual time=5802.601..5809.103 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone)
         ->  Nested Loop  (cost=1419804.40..12024841.19 rows=60934 width=72) (actual time=3531.386..5796.177 rows=14421 loops=1)
               Join Filter: (n2.n_nationkey = customer.c_nationkey)
               Rows Removed by Join Filter: 349036
               ->  Nested Loop  (cost=1419803.97..6810460.62 rows=1523348 width=76) (actual time=3531.051..4783.553 rows=363457 loops=1)
                     ->  Gather Merge  (cost=1419803.54..1602201.06 rows=1523348 width=76) (actual time=3530.998..3706.988 rows=363457 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1418803.48..1419755.57 rows=380837 width=76) (actual time=3508.634..3532.814 rows=73077 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                                 Sort Method: external merge  Disk: 27312kB
                                 Worker 0:  Sort Method: external merge  Disk: 27040kB
                                 Worker 1:  Sort Method: external merge  Disk: 29360kB
                                 Worker 2:  Sort Method: external merge  Disk: 26504kB
                                 Worker 3:  Sort Method: external merge  Disk: 29376kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372623.40 rows=380837 width=76) (actual time=12.900..3216.395 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350083.69 rows=4575608 width=24) (actual time=0.036..2587.129 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=11.643..11.647 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 960kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=0.886..9.923 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.037..6.739 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=0.842..0.843 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=0.831..0.838 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=0.010..0.012 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.006..0.007 rows=2 loops=10)
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.006..0.008 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=363457)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Scan using customer_pkey on customer  (cost=0.43..3.41 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363457)
                     Index Cond: (c_custkey = orders.o_custkey)
 Planning Time: 2.901 ms
 Execution Time: 5812.936 ms
(45 rows)

query 8 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386594.88..393268.79 rows=1 width=40) (actual time=54054.671..54060.446 rows=1 loops=1)
   ->  GroupAggregate  (cost=386594.88..16444028.78 rows=2406 width=40) (actual time=54054.669..54060.444 rows=1 loops=1)
         Group Key: date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
         ->  Nested Loop  (cost=386594.88..16443485.77 rows=24444 width=46) (actual time=2259.994..54031.352 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142666
               ->  Nested Loop  (cost=386594.88..16434534.28 rows=24444 width=20) (actual time=2259.953..53986.566 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386594.59..16354568.75 rows=24444 width=20) (actual time=2259.552..53693.560 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386594.16..3837261.08 rows=3666655 width=24) (actual time=2245.223..41340.647 rows=1816719 loops=1)
                                 ->  Gather Merge  (cost=386593.59..496382.72 rows=916937 width=8) (actual time=2244.260..2512.892 rows=454555 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385593.54..386166.62 rows=229234 width=8) (actual time=2235.285..2245.641 rows=91863 loops=5)
                                             Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                                             Sort Method: quicksort  Memory: 14475kB
                                             Worker 0:  Sort Method: quicksort  Memory: 14108kB
                                             Worker 1:  Sort Method: quicksort  Memory: 15180kB
                                             Worker 2:  Sort Method: quicksort  Memory: 14393kB
                                             Worker 3:  Sort Method: quicksort  Memory: 15239kB
                                             ->  Parallel Hash Join  (cost=42793.16..365184.30 rows=229234 width=8) (actual time=274.639..2202.319 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317519.92 rows=1146171 width=12) (actual time=0.595..1664.825 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.67..41855.67 rows=74999 width=4) (actual time=272.519..272.522 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15872kB
                                                         ->  Hash Join  (cost=2.51..41855.67 rows=74999 width=4) (actual time=0.205..255.028 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.94 rows=374994 width=8) (actual time=0.098..217.001 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.102..0.104 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.096..0.102 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.041..0.043 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.050..0.051 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.045..0.046 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.078..0.084 rows=4 loops=454555)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.006..0.006 rows=0 loops=1816719)
                                 Index Cond: (p_partkey = lineitem.l_partkey)
                                 Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                 Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.024..0.024 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.010..0.021 rows=25 loops=1)
 Planning Time: 25.604 ms
 Execution Time: 54061.628 ms
(51 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=386594.88..393268.79 rows=1 width=40) (actual time=9337.343..9344.089 rows=1 loops=1)
   ->  GroupAggregate  (cost=386594.88..16444028.78 rows=2406 width=40) (actual time=9337.342..9344.087 rows=1 loops=1)
         Group Key: date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)
         ->  Nested Loop  (cost=386594.88..16443485.77 rows=24444 width=46) (actual time=1025.533..9331.029 rows=11818 loops=1)
               Join Filter: (supplier.s_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 142665
               ->  Nested Loop  (cost=386594.88..16434534.28 rows=24444 width=20) (actual time=1025.512..9306.273 rows=11818 loops=1)
                     ->  Nested Loop  (cost=386594.59..16354568.75 rows=24444 width=20) (actual time=1025.495..9263.568 rows=11818 loops=1)
                           ->  Nested Loop  (cost=386594.16..3837261.08 rows=3666655 width=24) (actual time=1023.326..4072.558 rows=1816387 loops=1)
                                 ->  Gather Merge  (cost=386593.59..496382.72 rows=916937 width=8) (actual time=1023.259..1158.116 rows=454479 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=385593.54..386166.62 rows=229234 width=8) (actual time=1015.476..1021.986 rows=91875 loops=5)
                                             Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                                             Sort Method: quicksort  Memory: 13550kB
                                             Worker 0:  Sort Method: quicksort  Memory: 14706kB
                                             Worker 1:  Sort Method: quicksort  Memory: 14924kB
                                             Worker 2:  Sort Method: quicksort  Memory: 15103kB
                                             Worker 3:  Sort Method: quicksort  Memory: 15113kB
                                             ->  Parallel Hash Join  (cost=42793.16..365184.30 rows=229234 width=8) (actual time=152.672..976.330 rows=182072 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..317519.92 rows=1146171 width=12) (actual time=0.041..517.545 rows=911503 loops=5)
                                                         Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                         Rows Removed by Filter: 2088497
                                                   ->  Parallel Hash  (cost=41855.67..41855.67 rows=74999 width=4) (actual time=151.684..151.687 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 15904kB
                                                         ->  Hash Join  (cost=2.51..41855.67 rows=74999 width=4) (actual time=0.077..129.339 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39696.94 rows=374994 width=8) (actual time=0.025..87.744 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=4) (actual time=0.047..0.049 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=4) (actual time=0.042..0.048 rows=5 loops=5)
                                                                           Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation n1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.013..0.015 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.024..0.025 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.019..0.020 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                 ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.60 rows=4 width=24) (actual time=0.005..0.006 rows=4 loops=454479)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                           ->  Index Scan using part_pkey on part  (cost=0.43..3.41 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=1816387)
                                 Index Cond: (p_partkey = lineitem.l_partkey)
                                 Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                 Rows Removed by Filter: 1
                     ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.27 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=11818)
                           Index Cond: (s_suppkey = lineitem.l_suppkey)
               ->  Materialize  (cost=0.00..1.38 rows=25 width=30) (actual time=0.000..0.001 rows=13 loops=11818)
                     ->  Seq Scan on nation n2  (cost=0.00..1.25 rows=25 width=30) (actual time=0.005..0.010 rows=25 loops=1)
 Planning Time: 4.325 ms
 Execution Time: 9344.455 ms
(51 rows)

query 9 run 1
SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=37313.94..42667.77 rows=1 width=66) (actual time=1795026.876..1795028.221 rows=1 loops=1)
   ->  GroupAggregate  (cost=37313.94..701188.40 rows=124 width=66) (actual time=1795026.874..1795028.219 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Incremental Sort  (cost=37313.94..701184.06 rows=124 width=57) (actual time=1795018.081..1795020.497 rows=11401 loops=1)
               Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 34kB  Peak Memory: 34kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 21136kB  Peak Memory: 21136kB
               ->  Nested Loop  (cost=9652.78..701179.16 rows=124 width=57) (actual time=15339.954..1794946.224 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12778599614
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=53.573..62.775 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=45.075..45.853 rows=2460 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 6191kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4695kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.325..23.431 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.183..14.305 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.088..0.089 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.080..0.083 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..495130.32 rows=124 width=35) (actual time=0.003..234.921 rows=3247453 loops=3935)
                           ->  Gather  (cost=1001.31..495129.70 rows=124 width=35) (actual time=4.801..38242.318 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..494117.30 rows=31 width=35) (actual time=2.583..39005.342 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..494011.20 rows=31 width=35) (actual time=1.703..28068.846 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..146338.38 rows=101046 width=18) (actual time=1.250..1664.093 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.96 rows=25252 width=4) (actual time=0.403..205.677 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.73 rows=19 width=14) (actual time=0.062..0.066 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.045..0.302 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.016..0.016 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 32.423 ms
 Execution Time: 1795048.708 ms
(42 rows)

SET
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=37313.94..42667.77 rows=1 width=66) (actual time=1777758.965..1777760.388 rows=1 loops=1)
   ->  GroupAggregate  (cost=37313.94..701188.40 rows=124 width=66) (actual time=1777758.963..1777760.386 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Incremental Sort  (cost=37313.94..701184.06 rows=124 width=57) (actual time=1777750.152..1777752.660 rows=11401 loops=1)
               Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 34kB  Peak Memory: 34kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 21136kB  Peak Memory: 21136kB
               ->  Nested Loop  (cost=9652.78..701179.16 rows=124 width=57) (actual time=5168.962..1777677.253 rows=128453 loops=1)
                     Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
                     Rows Removed by Join Filter: 12779437783
                     ->  Gather Merge  (cost=8651.47..20048.53 rows=100000 width=30) (actual time=50.143..59.168 rows=3935 loops=1)
                           Workers Planned: 1
                           Workers Launched: 1
                           ->  Sort  (cost=7651.46..7798.52 rows=58824 width=30) (actual time=45.278..45.989 rows=2368 loops=2)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 5913kB
                                 Worker 0:  Sort Method: quicksort  Memory: 4972kB
                                 ->  Hash Join  (cost=1.56..2991.39 rows=58824 width=30) (actual time=0.375..23.361 rows=50000 loops=2)
                                       Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                       ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.199..14.092 rows=50000 loops=2)
                                       ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.092..0.093 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.082..0.086 rows=25 loops=2)
                     ->  Materialize  (cost=1001.31..495130.32 rows=124 width=35) (actual time=0.002..230.374 rows=3247666 loops=3935)
                           ->  Gather  (cost=1001.31..495129.70 rows=124 width=35) (actual time=1.909..16928.873 rows=3248192 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=1.31..494117.30 rows=31 width=35) (actual time=1.099..17692.703 rows=649638 loops=5)
                                       ->  Nested Loop  (cost=0.87..494011.20 rows=31 width=35) (actual time=1.055..11878.119 rows=649638 loops=5)
                                             ->  Nested Loop  (cost=0.43..146338.38 rows=101046 width=18) (actual time=0.989..869.574 rows=86650 loops=5)
                                                   ->  Parallel Seq Scan on part  (cost=0.00..47230.96 rows=25252 width=4) (actual time=0.142..174.301 rows=21662 loops=5)
                                                         Filter: ((p_name)::text ~~ '%navy%'::text)
                                                         Rows Removed by Filter: 378338
                                                   ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.73 rows=19 width=14) (actual time=0.028..0.030 rows=4 loops=108312)
                                                         Index Cond: (ps_partkey = part.p_partkey)
                                             ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..3.43 rows=1 width=29) (actual time=0.020..0.125 rows=7 loops=433248)
                                                   Index Cond: ((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))
                                       ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=8) (actual time=0.008..0.008 rows=1 loops=3248192)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.979 ms
 Execution Time: 1777781.422 ms
(42 rows)

query 10 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=959476.88..959476.93 rows=20 width=202) (actual time=20553.708..20602.982 rows=20 loops=1)
   ->  Sort  (cost=959476.88..960924.70 rows=579128 width=202) (actual time=20553.707..20602.979 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=860246.61..944066.49 rows=579128 width=202) (actual time=19498.335..20478.097 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=860246.61..929588.29 rows=579128 width=182) (actual time=19498.318..19762.194 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=859246.55..859608.50 rows=144782 width=182) (actual time=19474.997..19504.199 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 41992kB
                           Worker 0:  Sort Method: external merge  Disk: 42448kB
                           Worker 1:  Sort Method: external merge  Disk: 48344kB
                           Worker 2:  Sort Method: external merge  Disk: 48128kB
                           Worker 3:  Sort Method: external merge  Disk: 37632kB
                           ->  Hash Join  (cost=803520.36..846836.18 rows=144782 width=182) (actual time=18978.341..19337.480 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=803518.79..846390.14 rows=144782 width=160) (actual time=18978.224..19289.738 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.94 rows=374994 width=148) (actual time=0.460..151.641 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=801709.02..801709.02 rows=144782 width=16) (actual time=18976.529..18976.530 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6768.82..801709.02 rows=144782 width=16) (actual time=139.069..18806.343 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6768.26..270236.80 rows=146703 width=8) (actual time=138.270..2442.557 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46617
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6621.56 rows=586812 width=0) (actual time=87.537..87.537 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.137..0.142 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.047..0.047 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.039..0.042 rows=25 loops=5)
 Planning Time: 22.820 ms
 Execution Time: 20609.129 ms
(38 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=959476.88..959476.93 rows=20 width=202) (actual time=3756.813..3802.584 rows=20 loops=1)
   ->  Sort  (cost=959476.88..960924.70 rows=579128 width=202) (actual time=3756.811..3802.580 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=860246.61..944066.49 rows=579128 width=202) (actual time=2691.780..3677.703 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=860246.61..929588.29 rows=579128 width=182) (actual time=2691.761..2956.368 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=859246.55..859608.50 rows=144782 width=182) (actual time=2670.161..2700.648 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 44720kB
                           Worker 0:  Sort Method: external merge  Disk: 40840kB
                           Worker 1:  Sort Method: external merge  Disk: 42432kB
                           Worker 2:  Sort Method: external merge  Disk: 42448kB
                           Worker 3:  Sort Method: external merge  Disk: 48096kB
                           ->  Hash Join  (cost=803520.36..846836.18 rows=144782 width=182) (actual time=2252.935..2521.463 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=803518.79..846390.14 rows=144782 width=160) (actual time=2252.821..2475.245 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39696.94 rows=374994 width=148) (actual time=0.027..56.790 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=801709.02..801709.02 rows=144782 width=16) (actual time=2250.548..2250.550 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85216kB
                                             ->  Nested Loop  (cost=6768.82..801709.02 rows=144782 width=16) (actual time=137.501..2129.554 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6768.26..270236.80 rows=146703 width=8) (actual time=137.419..496.693 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=46858
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6621.56 rows=586812 width=0) (actual time=84.929..84.929 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..3.61 rows=1 width=16) (actual time=0.013..0.014 rows=2 loops=573160)
                                                         Index Cond: (l_orderkey = orders.o_orderkey)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=0.023..0.023 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=0.014..0.017 rows=25 loops=5)
 Planning Time: 2.108 ms
 Execution Time: 3808.545 ms
(38 rows)

query 11 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=470871.33..470871.33 rows=1 width=36) (actual time=1969.767..1969.905 rows=0 loops=1)
   InitPlan 1 (returns $2)
     ->  Finalize Aggregate  (cost=207444.12..207444.13 rows=1 width=32) (actual time=455.179..455.263 rows=1 loops=1)
           ->  Gather  (cost=207443.69..207444.10 rows=4 width=32) (actual time=455.033..455.251 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=206443.69..206443.70 rows=1 width=32) (actual time=452.125..452.128 rows=1 loops=4)
                       ->  Hash Join  (cost=2311.46..205843.48 rows=80028 width=10) (actual time=4.060..428.079 rows=80200 loops=4)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195229.08 rows=2000708 width=14) (actual time=0.297..208.695 rows=2000000 loops=4)
                             ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=3.687..3.689 rows=4010 loops=4)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.498..3.255 rows=4010 loops=4)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.012..0.015 rows=1 loops=4)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.482..2.843 rows=4010 loops=4)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.287..0.287 rows=4010 loops=4)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=263427.19..263693.95 rows=106704 width=36) (actual time=1969.766..1969.820 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=213361.10..262893.67 rows=106704 width=36) (actual time=1969.758..1969.812 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=213361.10..251689.72 rows=320113 width=14) (actual time=1271.543..1321.230 rows=320800 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=212361.04..212561.11 rows=80028 width=14) (actual time=1263.080..1266.116 rows=64160 loops=5)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 4148kB
                           Worker 0:  Sort Method: quicksort  Memory: 6491kB
                           Worker 1:  Sort Method: quicksort  Memory: 4117kB
                           Worker 2:  Sort Method: quicksort  Memory: 6313kB
                           Worker 3:  Sort Method: quicksort  Memory: 6259kB
                           ->  Hash Join  (cost=2311.46..205843.48 rows=80028 width=14) (actual time=36.305..1251.171 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195229.08 rows=2000708 width=18) (actual time=0.133..1006.212 rows=1600000 loops=5)
                                 ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=36.089..36.091 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.928..34.944 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.254..0.257 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.671..34.011 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.442..0.442 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 13.244 ms
 Execution Time: 1970.341 ms
(54 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=470871.33..470871.33 rows=1 width=36) (actual time=1149.653..1149.792 rows=0 loops=1)
   InitPlan 1 (returns $2)
     ->  Finalize Aggregate  (cost=207444.12..207444.13 rows=1 width=32) (actual time=450.370..450.452 rows=1 loops=1)
           ->  Gather  (cost=207443.69..207444.10 rows=4 width=32) (actual time=450.227..450.441 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=206443.69..206443.70 rows=1 width=32) (actual time=447.394..447.397 rows=1 loops=4)
                       ->  Hash Join  (cost=2311.46..205843.48 rows=80028 width=10) (actual time=3.967..423.222 rows=80200 loops=4)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195229.08 rows=2000708 width=14) (actual time=0.030..207.425 rows=2000000 loops=4)
                             ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=3.869..3.871 rows=4010 loops=4)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=0.520..3.431 rows=4010 loops=4)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=0.011..0.014 rows=1 loops=4)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=37.29..2220.15 rows=4000 width=8) (actual time=0.506..3.021 rows=4010 loops=4)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.314..0.314 rows=4010 loops=4)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=263427.19..263693.95 rows=106704 width=36) (actual time=1149.652..1149.708 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=213361.10..262893.67 rows=106704 width=36) (actual time=1149.645..1149.700 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=213361.10..251689.72 rows=320113 width=14) (actual time=454.929..505.570 rows=320800 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=212361.04..212561.11 rows=80028 width=14) (actual time=450.820..453.937 rows=64160 loops=5)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 6735kB
                           Worker 0:  Sort Method: quicksort  Memory: 4228kB
                           Worker 1:  Sort Method: quicksort  Memory: 4436kB
                           Worker 2:  Sort Method: quicksort  Memory: 4479kB
                           Worker 3:  Sort Method: quicksort  Memory: 4379kB
                           ->  Hash Join  (cost=2311.46..205843.48 rows=80028 width=14) (actual time=5.742..438.667 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195229.08 rows=2000708 width=18) (actual time=0.029..212.050 rows=1600000 loops=5)
                                 ->  Hash  (cost=2261.46..2261.46 rows=4000 width=4) (actual time=5.630..5.632 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=37.29..2261.46 rows=4000 width=4) (actual time=1.313..5.170 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.011..0.013 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=37.29..2220.15 rows=4000 width=8) (actual time=1.300..4.744 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..36.29 rows=4000 width=0) (actual time=0.292..0.292 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 0.982 ms
 Execution Time: 1149.865 ms
(54 rows)

query 12 run 1
SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469377.45..1615979.87 rows=1 width=27) (actual time=18444.185..18445.133 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469377.45..2495594.41 rows=7 width=27) (actual time=18444.184..18445.131 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469377.45..2490543.18 rows=288638 width=27) (actual time=8682.685..18349.385 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469377.01..1503936.98 rows=288638 width=15) (actual time=8681.568..8763.899 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468376.95..1468557.35 rows=72160 width=15) (actual time=8668.957..8672.106 rows=32012 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 4427kB
                           Worker 0:  Sort Method: quicksort  Memory: 4370kB
                           Worker 1:  Sort Method: quicksort  Memory: 4445kB
                           Worker 2:  Sort Method: quicksort  Memory: 4459kB
                           Worker 3:  Sort Method: quicksort  Memory: 4572kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462554.03 rows=72160 width=15) (actual time=1.013..8649.874 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.061..0.061 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 17.284 ms
 Execution Time: 18445.856 ms
(21 rows)

SET
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1469377.45..1615979.87 rows=1 width=27) (actual time=4039.307..4040.366 rows=1 loops=1)
   ->  GroupAggregate  (cost=1469377.45..2495594.41 rows=7 width=27) (actual time=4039.306..4040.364 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=1469377.45..2490543.18 rows=288638 width=27) (actual time=3526.317..3997.499 rows=155572 loops=1)
               ->  Gather Merge  (cost=1469377.01..1503936.98 rows=288638 width=15) (actual time=3526.263..3564.558 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1468376.95..1468557.35 rows=72160 width=15) (actual time=3519.845..3521.914 rows=32092 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 4296kB
                           Worker 0:  Sort Method: quicksort  Memory: 4494kB
                           Worker 1:  Sort Method: quicksort  Memory: 6185kB
                           Worker 2:  Sort Method: quicksort  Memory: 4437kB
                           Worker 3:  Sort Method: quicksort  Memory: 4397kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1462554.03 rows=72160 width=15) (actual time=0.160..3502.393 rows=62252 loops=5)
                                 Filter: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Rows Removed by Filter: 11934959
               ->  Index Scan using orders_pkey on orders  (cost=0.43..3.42 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 0.740 ms
 Execution Time: 4040.421 ms
(21 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361651.45..1361651.45 rows=1 width=16) (actual time=17802.658..17802.661 rows=1 loops=1)
   ->  Sort  (cost=1361651.45..1361651.95 rows=200 width=16) (actual time=17802.657..17802.659 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361648.45..1361650.45 rows=200 width=16) (actual time=17802.630..17802.638 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208141.28..1339148.80 rows=1499977 width=12) (actual time=15217.775..17633.880 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53283.79..662904.90 rows=14848991 width=8) (actual time=343.370..11311.036 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448774.39 rows=14848991 width=8) (actual time=0.519..5137.321 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.08..28674.08 rows=1499977 width=4) (actual time=341.430..341.431 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.08 rows=1499977 width=4) (actual time=0.020..155.947 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 14.143 ms
 Execution Time: 17858.618 ms
(21 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1361651.45..1361651.45 rows=1 width=16) (actual time=17284.362..17284.365 rows=1 loops=1)
   ->  Sort  (cost=1361651.45..1361651.95 rows=200 width=16) (actual time=17284.360..17284.362 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1361648.45..1361650.45 rows=200 width=16) (actual time=17284.334..17284.342 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1208141.28..1339148.80 rows=1499977 width=12) (actual time=14691.784..17116.861 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 8  Batches: 9  Memory Usage: 32849kB  Disk Usage: 325144kB
                     ->  Hash Right Join  (cost=53283.79..662904.90 rows=14848991 width=8) (actual time=306.155..10803.782 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448774.39 rows=14848991 width=8) (actual time=0.031..4686.490 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=28674.08..28674.08 rows=1499977 width=4) (actual time=304.703..304.703 rows=1500000 loops=1)
                                 Buckets: 1048576  Batches: 4  Memory Usage: 21380kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..28674.08 rows=1499977 width=4) (actual time=0.019..124.471 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 0.674 ms
 Execution Time: 17336.799 ms
(21 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=842588.10..842588.11 rows=1 width=32) (actual time=5312.995..5368.738 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=842588.10..842588.11 rows=1 width=32) (actual time=5312.994..5368.735 rows=1 loops=1)
         ->  Gather  (cost=842587.64..842588.05 rows=4 width=64) (actual time=5306.730..5368.707 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=841587.64..841587.65 rows=1 width=64) (actual time=5298.712..5298.715 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64430.94..838259.03 rows=190206 width=33) (actual time=701.645..5146.202 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12200.01..785528.81 rows=190206 width=16) (actual time=297.052..4569.796 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=83828
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12009.81 rows=760824 width=0) (actual time=191.509..191.509 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.97..45980.97 rows=499997 width=25) (actual time=402.362..402.363 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.97 rows=499997 width=25) (actual time=0.894..265.547 rows=400000 loops=5)
 Planning Time: 18.385 ms
 Execution Time: 5369.452 ms
(18 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=842588.10..842588.11 rows=1 width=32) (actual time=1704.609..1743.797 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=842588.10..842588.11 rows=1 width=32) (actual time=1704.607..1743.794 rows=1 loops=1)
         ->  Gather  (cost=842587.64..842588.05 rows=4 width=64) (actual time=1700.289..1743.775 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=841587.64..841587.65 rows=1 width=64) (actual time=1693.969..1693.972 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=64430.94..838259.03 rows=190206 width=33) (actual time=560.890..1601.241 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=12200.01..785528.81 rows=190206 width=16) (actual time=280.965..1191.760 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=91805
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12009.81 rows=760824 width=0) (actual time=174.271..174.272 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.97..45980.97 rows=499997 width=25) (actual time=277.758..277.759 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.97 rows=499997 width=25) (actual time=0.039..126.792 rows=400000 loops=5)
 Planning Time: 0.919 ms
 Execution Time: 1743.849 ms
(18 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2741059.98..2741171.67 rows=1 width=103) (actual time=13238.924..13293.399 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1388934.25..1388934.26 rows=1 width=32) (actual time=2934.592..2943.586 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1386460.73..1387697.49 rows=98941 width=36) (actual time=2883.496..2937.863 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 57393kB  Disk Usage: 656kB
                 ->  Gather  (cost=1342679.34..1383492.50 rows=395764 width=36) (actual time=2510.956..2609.561 rows=398515 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1341679.34..1342916.10 rows=98941 width=36) (actual time=2507.217..2557.814 rows=99629 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 31761kB
                             Worker 0:  Batches: 1  Memory Usage: 31761kB
                             Worker 1:  Batches: 1  Memory Usage: 31761kB
                             Worker 2:  Batches: 1  Memory Usage: 31761kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=36354.80..1336011.11 rows=566823 width=16) (actual time=446.693..2059.756 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=108496 lossy=72687
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35787.98 rows=2267291 width=0) (actual time=350.307..350.308 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1352125.72..1407409.51 rows=495 width=103) (actual time=13238.923..13284.403 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1352125.43..1406190.61 rows=495 width=36) (actual time=13238.265..13283.743 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1352125.43..1399512.09 rows=395764 width=36) (actual time=10073.430..10183.620 rows=346202 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1351125.37..1351372.72 rows=98941 width=36) (actual time=10040.248..10047.951 rows=69800 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 10797kB
                           Worker 0:  Sort Method: quicksort  Memory: 10800kB
                           Worker 1:  Sort Method: quicksort  Memory: 10806kB
                           Worker 2:  Sort Method: quicksort  Memory: 10802kB
                           Worker 3:  Sort Method: quicksort  Memory: 10798kB
                           ->  Partial HashAggregate  (cost=1341679.34..1342916.10 rows=98941 width=36) (actual time=9945.589..10012.553 rows=98918 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 31761kB
                                 Worker 0:  Batches: 1  Memory Usage: 31761kB
                                 Worker 1:  Batches: 1  Memory Usage: 31761kB
                                 Worker 2:  Batches: 1  Memory Usage: 31761kB
                                 Worker 3:  Batches: 1  Memory Usage: 31761kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=36354.80..1336011.11 rows=566823 width=16) (actual time=497.477..9455.298 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=79457 lossy=53076
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35787.98 rows=2267291 width=0) (actual time=406.185..406.185 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.653..0.653 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 12.664 ms
 Execution Time: 13295.792 ms
(53 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2741059.98..2741171.67 rows=1 width=103) (actual time=5960.106..6015.041 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=1388934.25..1388934.26 rows=1 width=32) (actual time=2940.860..2951.753 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1386460.73..1387697.49 rows=98941 width=36) (actual time=2886.348..2946.023 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 5  Memory Usage: 50225kB  Disk Usage: 1688kB
                 ->  Gather  (cost=1342679.34..1383492.50 rows=395764 width=36) (actual time=2517.069..2621.526 rows=398526 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1341679.34..1342916.10 rows=98941 width=36) (actual time=2512.716..2565.170 rows=99632 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 31761kB
                             Worker 0:  Batches: 5  Memory Usage: 34865kB  Disk Usage: 240kB
                             Worker 1:  Batches: 1  Memory Usage: 31761kB
                             Worker 2:  Batches: 1  Memory Usage: 31761kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=36354.80..1336011.11 rows=566823 width=16) (actual time=449.676..2065.554 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=109615 lossy=72797
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35787.98 rows=2267291 width=0) (actual time=353.454..353.454 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1352125.72..1407409.51 rows=495 width=103) (actual time=5960.104..6004.145 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1352125.43..1406190.61 rows=495 width=36) (actual time=5960.059..6004.099 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1352125.43..1399512.09 rows=395764 width=36) (actual time=2791.073..2899.233 rows=345537 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1351125.37..1351372.72 rows=98941 width=36) (actual time=2763.938..2771.276 rows=69674 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 10793kB
                           Worker 0:  Sort Method: quicksort  Memory: 10819kB
                           Worker 1:  Sort Method: quicksort  Memory: 10825kB
                           Worker 2:  Sort Method: quicksort  Memory: 10837kB
                           Worker 3:  Sort Method: quicksort  Memory: 10651kB
                           ->  Partial HashAggregate  (cost=1341679.34..1342916.10 rows=98941 width=36) (actual time=2669.152..2733.154 rows=98718 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 31761kB
                                 Worker 0:  Batches: 5  Memory Usage: 34865kB  Disk Usage: 240kB
                                 Worker 1:  Batches: 1  Memory Usage: 31761kB
                                 Worker 2:  Batches: 1  Memory Usage: 31761kB
                                 Worker 3:  Batches: 1  Memory Usage: 31761kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=36354.80..1336011.11 rows=566823 width=16) (actual time=457.524..2259.584 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=78549 lossy=52186
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..35787.98 rows=2267291 width=0) (actual time=363.529..363.529 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..2.45 rows=1 width=71) (actual time=0.040..0.040 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 1.074 ms
 Execution Time: 6017.255 ms
(53 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=249763.57..249763.57 rows=1 width=44) (actual time=2501.565..2508.400 rows=1 loops=1)
   ->  Sort  (cost=249763.57..250144.79 rows=152489 width=44) (actual time=2501.564..2508.398 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=171905.54..249001.12 rows=152489 width=44) (actual time=1894.722..2501.264 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=171905.54..241651.21 rows=582502 width=40) (actual time=1894.665..2233.331 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=170905.49..171269.55 rows=145626 width=40) (actual time=1852.692..1872.681 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 23456kB
                           Worker 0:  Sort Method: quicksort  Memory: 24490kB
                           Worker 1:  Sort Method: quicksort  Memory: 24633kB
                           Worker 2:  Sort Method: quicksort  Memory: 25583kB
                           Worker 3:  Sort Method: quicksort  Memory: 25242kB
                           ->  Parallel Hash Join  (cost=57862.21..158416.67 rows=145626 width=40) (actual time=367.463..1109.091 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101399.98 rows=1000354 width=8) (actual time=45.888..592.997 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.999..45.054 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.93..53480.93 rows=72786 width=40) (actual time=320.836..320.836 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.93 rows=72786 width=40) (actual time=0.113..296.324 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 15.534 ms
 Execution Time: 2509.052 ms
(33 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=249763.57..249763.57 rows=1 width=44) (actual time=2208.776..2216.866 rows=1 loops=1)
   ->  Sort  (cost=249763.57..250144.79 rows=152489 width=44) (actual time=2208.774..2216.864 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=171905.54..249001.12 rows=152489 width=44) (actual time=1597.580..2209.708 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=171905.54..241651.21 rows=582502 width=40) (actual time=1597.525..1943.339 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=170905.49..171269.55 rows=145626 width=40) (actual time=1517.924..1537.776 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size
                           Sort Method: quicksort  Memory: 25945kB
                           Worker 0:  Sort Method: quicksort  Memory: 23046kB
                           Worker 1:  Sort Method: quicksort  Memory: 26509kB
                           Worker 2:  Sort Method: quicksort  Memory: 24658kB
                           Worker 3:  Sort Method: quicksort  Memory: 23247kB
                           ->  Parallel Hash Join  (cost=57862.21..158416.67 rows=145626 width=40) (actual time=189.298..783.790 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..101399.98 rows=1000354 width=8) (actual time=28.577..415.597 rows=1599104 loops=5)
                                       Filter: (NOT (hashed SubPlan 1))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.087..28.484 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.93..53480.93 rows=72786 width=40) (actual time=159.868..159.869 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26400kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.93 rows=72786 width=40) (actual time=0.013..130.384 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 0.826 ms
 Execution Time: 2216.942 ms
(33 rows)

query 17 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3435005.77..3435005.78 rows=1 width=32) (actual time=27747.899..27822.500 rows=1 loops=1)
   ->  Aggregate  (cost=3435005.77..3435005.78 rows=1 width=32) (actual time=27747.898..27822.498 rows=1 loops=1)
         ->  Merge Join  (cost=2281919.23..3434953.21 rows=21025 width=8) (actual time=20322.205..27821.627 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2280918.30..3307843.12 rows=1960010 width=36) (actual time=20314.614..27619.246 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2280918.30..3219642.67 rows=7840040 width=36) (actual time=20314.593..22365.881 rows=9972001 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2279918.24..2284818.27 rows=1960010 width=36) (actual time=20076.782..20358.584 rows=1994929 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 103552kB
                                 Worker 0:  Sort Method: external merge  Disk: 103488kB
                                 Worker 1:  Sort Method: external merge  Disk: 103480kB
                                 Worker 2:  Sort Method: external merge  Disk: 103440kB
                                 Worker 3:  Sort Method: external merge  Disk: 103488kB
                                 ->  Partial HashAggregate  (cost=1869673.25..2040619.14 rows=1960010 width=36) (actual time=11782.143..19148.469 rows=1995066 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 32  Batches: 33  Memory Usage: 35089kB  Disk Usage: 453640kB
                                       Worker 0:  Batches: 33  Memory Usage: 35089kB  Disk Usage: 423360kB
                                       Worker 1:  Batches: 33  Memory Usage: 33041kB  Disk Usage: 423216kB
                                       Worker 2:  Batches: 33  Memory Usage: 34065kB  Disk Usage: 422920kB
                                       Worker 3:  Batches: 33  Memory Usage: 35089kB  Disk Usage: 423280kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275103.46 rows=14996046 width=9) (actual time=0.365..5221.551 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..101660.60 rows=64363 width=21) (actual time=5.066..54.874 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..101499.69 rows=64363 width=21) (actual time=5.060..46.777 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..92833.38 rows=16091 width=21) (actual time=1.067..481.956 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.32 rows=536 width=4) (actual time=0.734..190.652 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.42 rows=31 width=17) (actual time=0.346..0.574 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 16.783 ms
 Execution Time: 27891.856 ms
(38 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3435005.77..3435005.78 rows=1 width=32) (actual time=24262.009..24346.125 rows=1 loops=1)
   ->  Aggregate  (cost=3435005.77..3435005.78 rows=1 width=32) (actual time=24262.008..24346.124 rows=1 loops=1)
         ->  Merge Join  (cost=2281919.23..3434953.21 rows=21025 width=8) (actual time=16897.514..24345.424 rows=5319 loops=1)
               Merge Cond: (lineitem_1.l_partkey = part.p_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 54632
               ->  Finalize GroupAggregate  (cost=2280918.30..3307843.12 rows=1960010 width=36) (actual time=16891.108..24172.529 rows=1999333 loops=1)
                     Group Key: lineitem_1.l_partkey
                     ->  Gather Merge  (cost=2280918.30..3219642.67 rows=7840040 width=36) (actual time=16891.087..18951.395 rows=9971671 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=2279918.24..2284818.27 rows=1960010 width=36) (actual time=16690.155..16965.922 rows=1994856 loops=5)
                                 Sort Key: lineitem_1.l_partkey
                                 Sort Method: external merge  Disk: 103536kB
                                 Worker 0:  Sort Method: external merge  Disk: 103552kB
                                 Worker 1:  Sort Method: external merge  Disk: 103488kB
                                 Worker 2:  Sort Method: external merge  Disk: 103384kB
                                 Worker 3:  Sort Method: external merge  Disk: 103480kB
                                 ->  Partial HashAggregate  (cost=1869673.25..2040619.14 rows=1960010 width=36) (actual time=8496.893..15764.497 rows=1994999 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       Planned Partitions: 32  Batches: 33  Memory Usage: 35089kB  Disk Usage: 423688kB
                                       Worker 0:  Batches: 33  Memory Usage: 35089kB  Disk Usage: 436232kB
                                       Worker 1:  Batches: 33  Memory Usage: 35089kB  Disk Usage: 423248kB
                                       Worker 2:  Batches: 33  Memory Usage: 35089kB  Disk Usage: 390880kB
                                       Worker 3:  Batches: 33  Memory Usage: 35089kB  Disk Usage: 423208kB
                                       ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..1275103.46 rows=14996046 width=9) (actual time=0.055..1552.526 rows=11997210 loops=5)
               ->  Materialize  (cost=1000.93..101660.60 rows=64363 width=21) (actual time=3.989..29.195 rows=59951 loops=1)
                     ->  Gather Merge  (cost=1000.93..101499.69 rows=64363 width=21) (actual time=3.984..21.607 rows=59951 loops=1)
                           Workers Planned: 4
                           Workers Launched: 3
                           ->  Nested Loop  (cost=0.87..92833.38 rows=16091 width=21) (actual time=0.224..120.367 rows=14988 loops=4)
                                 ->  Parallel Index Scan using part_pkey on part  (cost=0.43..66712.32 rows=536 width=4) (actual time=0.204..101.406 rows=499 loops=4)
                                       Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                       Rows Removed by Filter: 499501
                                 ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..48.42 rows=31 width=17) (actual time=0.005..0.033 rows=30 loops=1996)
                                       Index Cond: (l_partkey = part.p_partkey)
 Planning Time: 0.809 ms
 Execution Time: 24410.566 ms
(38 rows)

query 18 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8774834.92..8774835.17 rows=100 width=71) (actual time=40835.665..40835.678 rows=99 loops=1)
   ->  Sort  (cost=8774834.92..8824806.86 rows=19988776 width=71) (actual time=40835.664..40835.671 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409653.37..8010878.27 rows=19988776 width=71) (actual time=40835.173..40835.585 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3121kB
               ->  Hash Join  (cost=78784.53..6332914.23 rows=19988776 width=44) (actual time=4276.777..40834.785 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=299.04..5919883.06 rows=19988776 width=25) (actual time=975.383..40051.790 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390249.16 rows=4998682 width=24) (actual time=745.710..29017.687 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547973.10 rows=15000511 width=20) (actual time=0.423..2975.303 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692304.44 rows=4998682 width=4) (actual time=637.909..25154.827 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167442.82 rows=59984184 width=9) (actual time=0.473..12025.277 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167442.82 rows=59984184 width=9) (actual time=0.021..7638.004 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.77..50946.77 rows=1499977 width=23) (actual time=675.843..675.844 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50946.77 rows=1499977 width=23) (actual time=0.776..421.053 rows=1500000 loops=1)
 Planning Time: 21.524 ms
 Execution Time: 40836.523 ms
(25 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=8774834.92..8774835.17 rows=100 width=71) (actual time=37582.020..37582.033 rows=99 loops=1)
   ->  Sort  (cost=8774834.92..8824806.86 rows=19988776 width=71) (actual time=37582.018..37582.026 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 32kB
         ->  HashAggregate  (cost=7409653.37..8010878.27 rows=19988776 width=71) (actual time=37581.549..37581.940 rows=99 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               Planned Partitions: 256  Batches: 1  Memory Usage: 3121kB
               ->  Hash Join  (cost=78784.53..6332914.23 rows=19988776 width=44) (actual time=3688.168..37581.184 rows=693 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     ->  Merge Join  (cost=299.04..5919883.06 rows=19988776 width=25) (actual time=843.897..36930.553 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Merge Join  (cost=1.00..3390249.16 rows=4998682 width=24) (actual time=611.529..25871.709 rows=99 loops=1)
                                 Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                 ->  Index Scan using orders_pkey on orders  (cost=0.43..547973.10 rows=15000511 width=20) (actual time=0.020..2371.256 rows=14982724 loops=1)
                                 ->  GroupAggregate  (cost=0.56..2692304.44 rows=4998682 width=4) (actual time=531.944..22636.212 rows=99 loops=1)
                                       Group Key: lineitem_1.l_orderkey
                                       Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                       Rows Removed by Filter: 14999901
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem lineitem_1  (cost=0.56..2167442.82 rows=59984184 width=9) (actual time=0.014..9669.267 rows=59986052 loops=1)
                           ->  Index Scan using idx_lineitem_orderkey on lineitem  (cost=0.56..2167442.82 rows=59984184 width=9) (actual time=0.012..7670.515 rows=59916431 loops=1)
                     ->  Hash  (cost=50946.77..50946.77 rows=1499977 width=23) (actual time=542.880..542.880 rows=1500000 loops=1)
                           Buckets: 524288  Batches: 4  Memory Usage: 24623kB
                           ->  Seq Scan on customer  (cost=0.00..50946.77 rows=1499977 width=23) (actual time=0.024..293.573 rows=1500000 loops=1)
 Planning Time: 2.058 ms
 Execution Time: 37582.576 ms
(25 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=124980.81..124980.82 rows=1 width=32) (actual time=4929.463..4941.054 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=124980.81..124980.82 rows=1 width=32) (actual time=4929.461..4941.051 rows=1 loops=1)
         ->  Gather  (cost=124980.38..124980.79 rows=4 width=32) (actual time=4918.467..4941.025 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=123980.38..123980.39 rows=1 width=32) (actual time=4913.437..4913.438 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..123978.18 rows=292 width=12) (actual time=41.966..4912.816 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.87 rows=1225 width=30) (actual time=0.503..180.662 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..50.40 rows=1 width=21) (actual time=4.464..4.947 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 17.976 ms
 Execution Time: 4942.398 ms
(16 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=124980.81..124980.82 rows=1 width=32) (actual time=220.558..247.156 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=124980.81..124980.82 rows=1 width=32) (actual time=220.556..247.154 rows=1 loops=1)
         ->  Gather  (cost=124980.38..124980.79 rows=4 width=32) (actual time=216.432..247.136 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=123980.38..123980.39 rows=1 width=32) (actual time=212.075..212.078 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.44..123978.18 rows=292 width=12) (actual time=0.844..211.890 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.87 rows=1225 width=30) (actual time=0.175..131.088 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Scan using idx_lineitem_part_supp on lineitem  (cost=0.44..50.40 rows=1 width=21) (actual time=0.073..0.082 rows=0 loops=4781)
                                 Index Cond: (l_partkey = part.p_partkey)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 30
 Planning Time: 1.207 ms
 Execution Time: 247.214 ms
(16 rows)

query 20 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2460366.82..2708063.19 rows=1 width=51) (actual time=27115.615..27116.871 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2460366.82..2708063.19 rows=1 width=51) (actual time=27115.613..27116.869 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 12776
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=26.072..27.257 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=20.366..20.382 rows=357 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 401kB
                     Worker 0:  Sort Method: quicksort  Memory: 252kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.381..19.062 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.214..14.170 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.102..0.103 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.095..0.098 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2456243.88..2703304.38 rows=3 width=8) (actual time=25675.312..27088.554 rows=12777 loops=1)
               ->  Hash Join  (cost=2456243.88..2703304.36 rows=3 width=8) (actual time=25675.308..27086.043 rows=12777 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 26
                     ->  HashAggregate  (cost=2379637.08..2541780.95 rows=4852370 width=40) (actual time=24222.087..25459.748 rows=1183786 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 64  Batches: 65  Memory Usage: 35345kB  Disk Usage: 388568kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146715.56..1993966.57 rows=9150292 width=13) (actual time=1248.085..19520.074 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144427.98 rows=9150292 width=0) (actual time=1142.666..1142.666 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75394.25..75394.25 rows=80837 width=16) (actual time=1452.824..1452.892 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75394.25 rows=80837 width=16) (actual time=3.479..1429.960 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66310.55 rows=20209 width=16) (actual time=1.963..1430.919 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.96 rows=5050 width=4) (actual time=0.847..163.684 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.59 rows=19 width=12) (actual time=0.268..0.290 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 21.874 ms
 Execution Time: 27163.728 ms
(46 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2460366.82..2708063.19 rows=1 width=51) (actual time=14755.580..14757.033 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2460366.82..2708063.19 rows=1 width=51) (actual time=14755.579..14757.031 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 12776
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=17.682..19.064 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=15.661..15.678 rows=357 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 384kB
                     Worker 0:  Sort Method: quicksort  Memory: 268kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.101..14.335 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.020..9.519 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.021..0.022 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.016..0.018 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2456243.88..2703304.38 rows=3 width=8) (actual time=13322.104..14736.925 rows=12777 loops=1)
               ->  Hash Join  (cost=2456243.88..2703304.36 rows=3 width=8) (actual time=13322.100..14734.384 rows=12777 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 26
                     ->  HashAggregate  (cost=2379637.08..2541780.95 rows=4852370 width=40) (actual time=13097.636..14337.534 rows=1183786 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 64  Batches: 65  Memory Usage: 35345kB  Disk Usage: 388568kB
                           ->  Bitmap Heap Scan on lineitem  (cost=146715.56..1993966.57 rows=9150292 width=13) (actual time=1108.326..9036.427 rows=9123688 loops=1)
                                 Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Index Recheck: 23164080
                                 Heap Blocks: exact=518099 lossy=530696
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..144427.98 rows=9150292 width=0) (actual time=1003.340..1003.340 rows=9123688 loops=1)
                                       Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                     ->  Hash  (cost=75394.25..75394.25 rows=80837 width=16) (actual time=224.020..224.087 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.43..75394.25 rows=80837 width=16) (actual time=0.353..203.701 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.43..66310.55 rows=20209 width=16) (actual time=0.096..204.613 rows=17374 loops=5)
                                       ->  Parallel Seq Scan on part  (cost=0.00..47230.96 rows=5050 width=4) (actual time=0.055..94.024 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                       ->  Index Scan using idx_partsupp_partkey on partsupp  (cost=0.43..3.59 rows=19 width=12) (actual time=0.023..0.024 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
 Planning Time: 2.119 ms
 Execution Time: 14809.025 ms
(46 rows)

query 21 run 1
SET
SET
SET
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1964261.82..1964261.83 rows=1 width=34) (actual time=13694.896..13711.906 rows=100 loops=1)
   ->  Sort  (cost=1964261.82..1964261.83 rows=1 width=34) (actual time=13694.895..13711.898 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=1964258.60..1964261.81 rows=1 width=34) (actual time=13201.681..13709.575 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1964258.60..1964261.80 rows=1 width=26) (actual time=13201.535..13698.491 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1964258.03..1964258.15 rows=1 width=38) (actual time=13201.489..13253.047 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1963257.97..1963257.98 rows=1 width=38) (actual time=13176.275..13178.182 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1425kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1416kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1403kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1427kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1404kB
                                 ->  Nested Loop Anti Join  (cost=1338035.29..1963257.96 rows=1 width=38) (actual time=8934.505..13101.258 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338034.72..1653212.20 rows=96561 width=38) (actual time=8934.106..10536.635 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308144.60 rows=1811062 width=4) (actual time=0.527..1081.904 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335535.39..1335535.39 rows=199947 width=34) (actual time=8932.261..8932.561 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335535.39 rows=199947 width=34) (actual time=16.073..8755.531 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312593.57 rows=4998682 width=8) (actual time=0.862..7889.011 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=15.144..15.146 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 384kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.535..14.841 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.475..12.677 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.049..0.050 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.046..0.047 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.017..0.017 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 20.646 ms
 Execution Time: 13712.573 ms
(50 rows)

SET
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1964261.82..1964261.83 rows=1 width=34) (actual time=7045.371..7065.117 rows=100 loops=1)
   ->  Sort  (cost=1964261.82..1964261.83 rows=1 width=34) (actual time=7045.370..7065.110 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=1964258.60..1964261.81 rows=1 width=34) (actual time=6567.816..7062.779 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Nested Loop Semi Join  (cost=1964258.60..1964261.80 rows=1 width=26) (actual time=6567.636..7052.032 rows=39281 loops=1)
                     Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                     Rows Removed by Join Filter: 42025
                     ->  Gather Merge  (cost=1964258.03..1964258.15 rows=1 width=38) (actual time=6567.597..6620.865 rows=65960 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1963257.97..1963257.98 rows=1 width=38) (actual time=6545.959..6547.862 rows=13192 loops=5)
                                 Sort Key: supplier.s_name
                                 Sort Method: quicksort  Memory: 1438kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1398kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1402kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1428kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1409kB
                                 ->  Nested Loop Anti Join  (cost=1338035.29..1963257.96 rows=1 width=38) (actual time=3866.557..6470.642 rows=13192 loops=5)
                                       ->  Parallel Hash Join  (cost=1338034.72..1653212.20 rows=96561 width=38) (actual time=3866.361..4868.476 rows=146197 loops=5)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308144.60 rows=1811062 width=4) (actual time=0.025..512.251 rows=1461837 loops=5)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 1538163
                                             ->  Parallel Hash  (cost=1335535.39..1335535.39 rows=199947 width=34) (actual time=3865.002..3865.309 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131360kB
                                                   ->  Parallel Hash Join  (cost=3020.56..1335535.39 rows=199947 width=34) (actual time=10.634..3667.215 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Seq Scan on lineitem l1  (cost=0.00..1312593.57 rows=4998682 width=8) (actual time=0.036..2746.817 rows=7585870 loops=5)
                                                               Filter: (l_receiptdate > l_commitdate)
                                                               Rows Removed by Filter: 4411341
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=8.601..8.603 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=0.056..8.289 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.027..6.323 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.018..0.019 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                       ->  Index Scan using idx_lineitem_orderkey on lineitem l3  (cost=0.56..3.64 rows=1 width=8) (actual time=0.011..0.011 rows=1 loops=730985)
                                             Index Cond: (l_orderkey = l1.l_orderkey)
                                             Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                             Rows Removed by Filter: 1
                     ->  Index Scan using idx_lineitem_orderkey on lineitem l2  (cost=0.56..3.62 rows=4 width=8) (actual time=0.006..0.006 rows=1 loops=65960)
                           Index Cond: (l_orderkey = orders.o_orderkey)
 Planning Time: 2.762 ms
 Execution Time: 7065.234 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93876.56..93878.22 rows=1 width=72) (actual time=1859.698..1865.520 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.88..46820.89 rows=1 width=32) (actual time=366.282..366.404 rows=1 loops=1)
           ->  Gather  (cost=46820.45..46820.86 rows=4 width=32) (actual time=362.830..366.384 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.45..45820.46 rows=1 width=32) (actual time=355.286..355.287 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.60 rows=11938 width=6) (actual time=0.112..347.434 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.67..59748.20 rows=7638 width=72) (actual time=1859.697..1865.395 rows=1 loops=1)
         Group Key: "substring"((customer.c_phone)::text, 1, 2)
         ->  Nested Loop Anti Join  (cost=47055.67..59557.25 rows=7638 width=38) (actual time=548.272..1859.303 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.24..49150.59 rows=17500 width=26) (actual time=546.713..570.154 rows=27129 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 4
                     ->  Sort  (cost=46055.18..46066.12 rows=4375 width=26) (actual time=175.589..176.413 rows=6105 loops=5)
                           Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
                           Sort Method: quicksort  Memory: 5386kB
                           Worker 0:  Sort Method: quicksort  Memory: 2595kB
                           Worker 1:  Sort Method: quicksort  Memory: 2572kB
                           Worker 2:  Sort Method: quicksort  Memory: 5254kB
                           Worker 3:  Sort Method: quicksort  Memory: 5272kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.60 rows=4375 width=26) (actual time=0.020..159.007 rows=38226 loops=5)
                                 Filter: ((c_acctbal > $1) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.047..0.047 rows=1 loops=27129)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 13.341 ms
 Execution Time: 1866.249 ms
(32 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93876.56..93878.22 rows=1 width=72) (actual time=463.247..468.007 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=46820.88..46820.89 rows=1 width=32) (actual time=216.555..216.642 rows=1 loops=1)
           ->  Gather  (cost=46820.45..46820.86 rows=4 width=32) (actual time=212.848..216.611 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45820.45..45820.46 rows=1 width=32) (actual time=208.194..208.195 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45790.60 rows=11938 width=6) (actual time=0.021..200.248 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47055.67..59748.20 rows=7638 width=72) (actual time=463.246..467.918 rows=1 loops=1)
         Group Key: "substring"((customer.c_phone)::text, 1, 2)
         ->  Nested Loop Anti Join  (cost=47055.67..59557.25 rows=7638 width=38) (actual time=393.568..465.968 rows=9006 loops=1)
               ->  Gather Merge  (cost=47055.24..49150.59 rows=17500 width=26) (actual time=393.528..405.301 rows=27128 loops=1)
                     Workers Planned: 4
                     Params Evaluated: $1
                     Workers Launched: 4
                     ->  Sort  (cost=46055.18..46066.12 rows=4375 width=26) (actual time=171.673..172.272 rows=6158 loops=5)
                           Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
                           Sort Method: quicksort  Memory: 5646kB
                           Worker 0:  Sort Method: quicksort  Memory: 5143kB
                           Worker 1:  Sort Method: quicksort  Memory: 2539kB
                           Worker 2:  Sort Method: quicksort  Memory: 5191kB
                           Worker 3:  Sort Method: quicksort  Memory: 2559kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45790.60 rows=4375 width=26) (actual time=0.020..156.012 rows=38226 loops=5)
                                 Filter: ((c_acctbal > $1) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.17 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=27128)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 0.892 ms
 Execution Time: 468.390 ms
(32 rows)

